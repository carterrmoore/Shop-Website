!function(){"use strict"
class e{constructor(e,t){this.lineNumber=e,this.column=t}equals(t){return e.equals(this,t)}static equals(e,t){return!e&&!t||!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(t){return e.isBefore(this,t)}static isBefore(e,t){return e.lineNumber<t.lineNumber||!(t.lineNumber<e.lineNumber)&&e.column<t.column}isBeforeOrEqual(t){return e.isBeforeOrEqual(this,t)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber||!(t.lineNumber<e.lineNumber)&&e.column<=t.column}static compare(e,t){let i=0|e.lineNumber,n=0|t.lineNumber
return i===n?(0|e.column)-(0|t.column):i-n}clone(){return new e(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(t){return new e(t.lineNumber,t.column)}static isIPosition(e){return e&&"number"==typeof e.lineNumber&&"number"==typeof e.column}}class t{constructor(e,t,i,n){e>i||e===i&&t>n?(this.startLineNumber=i,this.startColumn=n,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=n)}isEmpty(){return t.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return t.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber)&&(!(t.lineNumber===e.startLineNumber&&t.column<e.startColumn)&&!(t.lineNumber===e.endLineNumber&&t.column>e.endColumn))}containsRange(e){return t.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber)&&(!(t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber)&&(!(t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn)&&!(t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)))}plusRange(e){return t.plusRange(this,e)}static plusRange(e,i){var n,s,r,o
return i.startLineNumber<e.startLineNumber?(n=i.startLineNumber,s=i.startColumn):i.startLineNumber===e.startLineNumber?(n=i.startLineNumber,s=Math.min(i.startColumn,e.startColumn)):(n=e.startLineNumber,s=e.startColumn),i.endLineNumber>e.endLineNumber?(r=i.endLineNumber,o=i.endColumn):i.endLineNumber===e.endLineNumber?(r=i.endLineNumber,o=Math.max(i.endColumn,e.endColumn)):(r=e.endLineNumber,o=e.endColumn),new t(n,s,r,o)}intersectRanges(e){return t.intersectRanges(this,e)}static intersectRanges(e,i){var n=e.startLineNumber,s=e.startColumn,r=e.endLineNumber,o=e.endColumn,a=i.startLineNumber,l=i.startColumn,h=i.endLineNumber,d=i.endColumn
return n<a?(n=a,s=l):n===a&&(s=Math.max(s,l)),r>h?(r=h,o=d):r===h&&(o=Math.min(o,d)),n>r?null:n===r&&s>o?null:new t(n,s,r,o)}equalsRange(e){return t.equalsRange(this,e)}static equalsRange(e,t){return!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return new e(this.endLineNumber,this.endColumn)}getStartPosition(){return new e(this.startLineNumber,this.startColumn)}cloneRange(){return new t(this.startLineNumber,this.startColumn,this.endLineNumber,this.endColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,i){return new t(this.startLineNumber,this.startColumn,e,i)}setStartPosition(e,i){return new t(e,i,this.endLineNumber,this.endColumn)}collapseToStart(){return t.collapseToStart(this)}static collapseToStart(e){return new t(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}static fromPositions(e,i=e){return new t(e.lineNumber,e.column,i.lineNumber,i.column)}static lift(e){return e?new t(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&"number"==typeof e.startLineNumber&&"number"==typeof e.startColumn&&"number"==typeof e.endLineNumber&&"number"==typeof e.endColumn}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn)&&!(t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static compareRangesUsingStarts(e,t){let i=0|e.startLineNumber,n=0|t.startLineNumber
if(i===n){let i=0|e.startColumn,n=0|t.startColumn
if(i===n){let i=0|e.endLineNumber,n=0|t.endLineNumber
return i===n?(0|e.endColumn)-(0|t.endColumn):i-n}return i-n}return i-n}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}}var i,n,s,r,o,a,l,h,d,u;(n=i||(i={}))[n.Left=1]="Left",n[n.Center=2]="Center",n[n.Right=4]="Right",n[n.Full=7]="Full",(r=s||(s={}))[r.TextDefined=0]="TextDefined",r[r.LF=1]="LF",r[r.CRLF=2]="CRLF",(a=o||(o={}))[a.LF=1]="LF",a[a.CRLF=2]="CRLF",(h=l||(l={}))[h.LF=0]="LF",h[h.CRLF=1]="CRLF"
class c{constructor(e){this.tabSize=0|e.tabSize,this.insertSpaces=Boolean(e.insertSpaces),this.defaultEOL=0|e.defaultEOL,this.trimAutoWhitespace=Boolean(e.trimAutoWhitespace)}equals(e){return this.tabSize===e.tabSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}}class g{constructor(e,t){this.range=e,this.matches=t}}(u=d||(d={}))[u.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",u[u.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",u[u.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",u[u.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"
var m={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"}
function p(e){return!(!e||"function"!=typeof e.getEditorType)&&e.getEditorType()===m.ICodeEditor}var f={ExecuteCommand:"executeCommand",ExecuteCommands:"executeCommands",Type:"type",ReplacePreviousChar:"replacePreviousChar",CompositionStart:"compositionStart",CompositionEnd:"compositionEnd",Paste:"paste",Cut:"cut",Undo:"undo",Redo:"redo"}
let _=!1,C=!1,b=!1,w=!1,v=!1,S=!1,y=void 0
if("object"==typeof process){_="win32"===process.platform,C="darwin"===process.platform,b="linux"===process.platform,w=!_&&0===process.getuid()
let e=process.env.VSCODE_NLS_CONFIG
if(e)try{let t=JSON.parse(e)
t.availableLanguages["*"]
y=t.locale}catch(e){}v=!0}else if("object"==typeof navigator){let e=navigator.userAgent
_=e.indexOf("Windows")>=0,C=e.indexOf("Macintosh")>=0,b=e.indexOf("Linux")>=0,S=!0,y=navigator.language}var x,L;(L=x||(x={}))[L.Web=0]="Web",L[L.Mac=1]="Mac",L[L.Linux=2]="Linux",L[L.Windows=3]="Windows"
let N=x.Web
v&&(C?N=x.Mac:_?N=x.Windows:b&&(N=x.Linux))
const E=_,k=C,I=b,M=v,D=S,T="object"==typeof self?self:global,O=T,R=T.setTimeout.bind(T),A=T.clearTimeout.bind(T),P=T.setInterval.bind(T),F=T.clearInterval.bind(T),W=C?2:_?1:3
function V(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}function B(e){return encodeURIComponent(e).replace(/[!'()*]/g,V)}function H(e){return e.replace(/[#?]/,V)}const z=/^\w[\w\d+.-]*$/,U=/^\//,K=/^\/\//
const $="",q="/",G=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,j=/^\/[a-zA-Z]:/,Y=/^(\/)?([A-Z]:)/,Z=/^[a-zA-Z]:/
class X{static isUri(e){return e instanceof X||!!e&&("string"==typeof e.authority&&"string"==typeof e.fragment&&"string"==typeof e.path&&"string"==typeof e.query&&"string"==typeof e.scheme)}constructor(e,t,i,n,s){"object"==typeof e?(this.scheme=e.scheme||$,this.authority=e.authority||$,this.path=e.path||$,this.query=e.query||$,this.fragment=e.fragment||$):(this.scheme=e||$,this.authority=t||$,this.path=i||$,this.query=n||$,this.fragment=s||$,function(e){if(e.scheme&&!z.test(e.scheme))throw new Error("[UriError]: Scheme contains illegal characters.")
if(e.path)if(e.authority){if(!U.test(e.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(K.test(e.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}(this))}get fsPath(){return Q(this)}with(e){if(!e)return this
let{scheme:t,authority:i,path:n,query:s,fragment:r}=e
return void 0===t?t=this.scheme:null===t&&(t=""),void 0===i?i=this.authority:null===i&&(i=""),void 0===n?n=this.path:null===n&&(n=""),void 0===s?s=this.query:null===s&&(s=""),void 0===r?r=this.fragment:null===r&&(r=""),t===this.scheme&&i===this.authority&&n===this.path&&s===this.query&&r===this.fragment?this:new J(t,i,n,s,r)}static parse(e){const t=G.exec(e)
return t?new J(t[2]||$,decodeURIComponent(t[4]||$),decodeURIComponent(t[5]||$),decodeURIComponent(t[7]||$),decodeURIComponent(t[9]||$)):new J($,$,$,$,$)}static file(e){let t=$
if(E&&(e=e.replace(/\\/g,q)),e[0]===q&&e[1]===q){let i=e.indexOf(q,2);-1===i?(t=e.substring(2),e=q):(t=e.substring(2,i),e=e.substring(i)||q)}return Z.test(e)?e=q+e:e[0]!==q&&(e=q+e),new J("file",t,e,$,$)}static from(e){return new J(e.scheme,e.authority,e.path,e.query,e.fragment)}toString(e=!1){return ee(this,e)}toJSON(){const e={$mid:1,fsPath:this.fsPath,external:this.toString()}
return this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}static revive(e){let t=new J(e)
return t._fsPath=e.fsPath,t._formatted=e.external,t}}class J extends X{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=Q(this)),this._fsPath}toString(e=!1){return e?ee(this,!0):(this._formatted||(this._formatted=ee(this,!1)),this._formatted)}}function Q(e){let t
return t=e.authority&&e.path&&"file"===e.scheme?`//${e.authority}${e.path}`:j.test(e.path)?e.path[1].toLowerCase()+e.path.substr(2):e.path,E&&(t=t.replace(/\//g,"\\")),t}function ee(e,t){const i=t?H:B,n=[]
let{scheme:s,authority:r,path:o,query:a,fragment:l}=e
if(s&&n.push(s,":"),(r||"file"===s)&&n.push("//"),r){let e=r.indexOf("@")
if(-1!==e){const t=r.substr(0,e)
r=r.substr(e+1),-1===(e=t.indexOf(":"))?n.push(i(t)):n.push(i(t.substr(0,e)),":",i(t.substr(e+1))),n.push("@")}-1===(e=(r=r.toLowerCase()).indexOf(":"))?n.push(i(r)):n.push(i(r.substr(0,e)),r.substr(e))}if(o){const e=Y.exec(o)
e&&(o=e[1]?"/"+e[2].toLowerCase()+o.substr(3):e[2].toLowerCase()+o.substr(2))
let t=0
for(;;){let e=o.indexOf(q,t)
if(-1===e){n.push(i(o.substring(t)))
break}n.push(i(o.substring(t,e)),q),t=e+1}}return a&&n.push("?",i(a)),l&&n.push("#",i(l)),n.join($)}class te{constructor(e=Number.MAX_VALUE,t=1,i){this.limit=e,this.map=new Map,this.ratio=e*t,i&&i.entries.forEach(e=>{this.set(e.key,e.value)})}setLimit(e){if(!(e<0))for(this.limit=e;this.map.size>this.limit;)this.trim()}serialize(){const e={entries:[]}
return this.map.forEach(t=>{e.entries.push({key:t.key,value:t.value})}),e}get size(){return this.map.size}set(e,t){if(this.map.has(e))return!1
const i={key:e,value:t}
return this.push(i),this.size>this.limit&&this.trim(),!0}get(e){const t=this.map.get(e)
return t?t.value:null}getOrSet(e,t){const i=this.get(e)
return i||(this.set(e,t),t)}delete(e){const t=this.map.get(e)
return t?(this.map.delete(e),t.next?t.next.prev=t.prev:this.head=t.prev,t.prev?t.prev.next=t.next:this.tail=t.next,t.value):null}has(e){return this.map.has(e)}clear(){this.map.clear(),this.head=null,this.tail=null}push(e){this.head&&(e.prev=this.head,this.head.next=e),this.tail||(this.tail=e),this.head=e,this.map.set(e.key,e)}trim(){if(this.tail)if(this.ratio<this.limit){let e=0,t=this.tail
for(;t.next;){if(this.map.delete(t.key),e===this.ratio){this.tail=t.next,this.tail.prev=null
break}t=t.next,e++}}else this.map.delete(this.tail.key),this.tail=this.tail.next,this.tail&&(this.tail.prev=null)}}class ie{reset(e){return this._value=e.replace(/\\$|\/$/,""),this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}join(e){return e.join("/")}next(){this._from=this._to
let e=!0
for(;this._to<this._value.length;this._to++){const t=this._value.charCodeAt(this._to)
if(t===ie._fwd||t===ie._bwd){if(!e)break
this._from++}else e=!1}return this}cmp(e){let t=0,i=e.length,n=this._from
for(;t<i&&n<this._to;){let i=e.charCodeAt(t)-this._value.charCodeAt(n)
if(0!==i)return i
t+=1,n+=1}return i===this._to-this._from?0:t<i?-1:1}value(){return this._value.substring(this._from,this._to)}}ie._fwd="/".charCodeAt(0),ie._bwd="\\".charCodeAt(0)
class ne{constructor(e){this.ignoreCase=e,this.map=new Map}set(e,t){this.map.set(this.toKey(e),t)}get(e){return this.map.get(this.toKey(e))}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e){this.map.forEach(e)}values(){return function(e){const t=[]
return e.forEach(e=>t.push(e)),t}(this.map)}toKey(e){let t=e.toString()
return this.ignoreCase&&(t=t.toLowerCase()),t}}class se extends ne{constructor(){super()}keys(){return function(e){const t=[]
return e.forEach((e,i)=>t.push(i)),t}(this.map).map(e=>X.parse(e))}}var re,oe;(oe=re||(re={})).None=0,oe.First=1,oe.Last=2
const ae=""
const le=/{(\d+)}/g
function he(e,...t){return 0===t.length?e:e.replace(le,function(e,i){let n=parseInt(i,10)
return isNaN(n)||n<0||n>=t.length?e:t[n]})}function de(e){return e.replace(/[<|>|&]/g,function(e){switch(e){case"<":return"&lt;"
case">":return"&gt;"
case"&":return"&amp;"
default:return e}})}function ue(e){return e.replace(/[\-\\\{\}\*\+\?\|\^\$\.\[\]\(\)\#]/g,"\\$&")}function ce(e,t=" "){return me(ge(e,t),t)}function ge(e,t){if(!e||!t)return e
let i=t.length
if(0===i||0===e.length)return e
let n=0,s=-1
for(;(s=e.indexOf(t,n))===n;)n+=i
return e.substring(n)}function me(e,t){if(!e||!t)return e
let i=t.length,n=e.length
if(0===i||0===n)return e
let s=n,r=-1
for(;-1!==(r=e.lastIndexOf(t,s-1))&&r+i===s;){if(0===r)return""
s=r}return e.substring(0,s)}function pe(e){return e.replace(/[\-\\\{\}\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&").replace(/[\*]/g,".*")}function fe(e,t){if(e.length<t.length)return!1
for(let i=0;i<t.length;i++)if(e[i]!==t[i])return!1
return!0}function _e(e,t){let i=e.length-t.length
return i>0?e.indexOf(t,i)===i:0===i&&e===t}function Ce(e,t,i={}){if(!e)throw new Error("Cannot create regex from empty string")
t||(e=ue(e)),i.wholeWord&&(/\B/.test(e.charAt(0))||(e="\\b"+e),/\B/.test(e.charAt(e.length-1))||(e+="\\b"))
let n=""
return i.global&&(n+="g"),i.matchCase||(n+="i"),i.multiline&&(n+="m"),new RegExp(e,n)}function be(e){if("^"===e.source||"^$"===e.source||"$"===e.source||"^\\s*$"===e.source)return!1
return e.exec("")&&0===e.lastIndex}const we="function"==typeof"".normalize,ve=new te(1e4)
const Se=new te(1e4)
const ye=/[^\u0000-\u0080]/
function xe(e,t,i){if(!we||!e)return e
const n=i.get(e)
if(n)return n
let s
return s=ye.test(e)?e.normalize(t):e,i.set(e,s),s}function Le(e){for(let t=0,i=e.length;t<i;t++){let i=e.charCodeAt(t)
if(32!==i&&9!==i)return t}return-1}function Ne(e,t=0,i=e.length){for(let n=t;n<i;n++){let i=e.charCodeAt(n)
if(32!==i&&9!==i)return e.substring(t,n)}return e.substring(t,i)}function Ee(e,t=e.length-1){for(let i=t;i>=0;i--){let t=e.charCodeAt(i)
if(32!==t&&9!==t)return i}return-1}function ke(e,t){return e<t?-1:e>t?1:0}function Ie(e,t){const i=Math.min(e.length,t.length)
for(let n=0;n<i;n++){let i=e.charCodeAt(n),s=t.charCodeAt(n)
if(i===s)continue
De(i)&&(i+=32),De(s)&&(s+=32)
const r=i-s
if(0!==r)return Me(i)&&Me(s)?r:ke(e.toLowerCase(),t.toLowerCase())}return e.length<t.length?-1:e.length>t.length?1:0}function Me(e){return e>=97&&e<=122}function De(e){return e>=65&&e<=90}function Te(e){return Me(e)||De(e)}function Oe(e,t){return(e?e.length:0)===(t?t.length:0)&&Re(e,t)}function Re(e,t,i=e.length){if("string"!=typeof e||"string"!=typeof t)return!1
for(let n=0;n<i;n++){const i=e.charCodeAt(n),s=t.charCodeAt(n)
if(i!==s)if(Te(i)&&Te(s)){let e=Math.abs(i-s)
if(0!==e&&32!==e)return!1}else if(String.fromCharCode(i).toLowerCase()!==String.fromCharCode(s).toLowerCase())return!1}return!0}function Ae(e,t){const i=t.length
return!(t.length>e.length)&&Re(e,t,i)}function Pe(e,t){let i,n=Math.min(e.length,t.length)
for(i=0;i<n;i++)if(e.charCodeAt(i)!==t.charCodeAt(i))return i
return n}function Fe(e,t){let i,n=Math.min(e.length,t.length),s=e.length-1,r=t.length-1
for(i=0;i<n;i++)if(e.charCodeAt(s-i)!==t.charCodeAt(r-i))return i
return n}function We(e,t,i,n,s,r){for(;t<i&&s<r;){if(e[t]!==n[s])return!1
t+=1,s+=1}return!0}function Ve(e){return 55296<=e&&e<=56319}function Be(e){return 56320<=e&&e<=57343}const He=/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u08BD\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE33\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDCFF]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD50-\uDFFF]|\uD83B[\uDC00-\uDEBB])/
function ze(e){return He.test(e)}const Ue=/(?:[\u231A\u231B\u23F0\u23F3\u2600-\u27BF\u2B50\u2B55]|\uD83C[\uDDE6-\uDDFF\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F\uDE80-\uDEF8]|\uD83E[\uDD00-\uDDE6])/
function Ke(e){return Ue.test(e)}const $e=/^[\t\n\r\x20-\x7E]*$/
function qe(e){return $e.test(e)}function Ge(e){for(let t=0,i=e.length;t<i;t++)if(je(e.charCodeAt(t)))return!0
return!1}function je(e){return(e=+e)>=11904&&e<=55215||e>=63744&&e<=64255||e>=65281&&e<=65374}const Ye=/\x1B\x5B[12]?K/g,Ze=/\x1b\[\d+m/g,Xe=/\x1b\[0?m/g
const Je=String.fromCharCode(65279)
function Qe(e){return e&&e.length>0&&65279===e.charCodeAt(0)}function et(e){return btoa(encodeURIComponent(e))}function tt(e,t){let i=""
for(let n=0;n<t;n++)i+=e
return i}var it=Object.freeze({empty:ae,isFalsyOrWhitespace:function(e){return!e||"string"!=typeof e||0===e.trim().length},pad:function(e,t,i="0"){let n=""+e,s=[n]
for(let e=n.length;e<t;e++)s.push(i)
return s.reverse().join("")},format:he,escape:de,escapeRegExpCharacters:ue,trim:ce,ltrim:ge,rtrim:me,convertSimple2RegExpPattern:pe,stripWildcards:function(e){return e.replace(/\*/g,"")},startsWith:fe,endsWith:_e,createRegExp:Ce,regExpLeadsToEndlessLoop:be,regExpContainsBackreference:function(e){return!!e.match(/([^\\]|^)(\\\\)*\\\d+/)},canNormalize:we,normalizeNFC:function(e){return xe(e,"NFC",ve)},normalizeNFD:function(e){return xe(e,"NFD",Se)},firstNonWhitespaceIndex:Le,getLeadingWhitespace:Ne,lastNonWhitespaceIndex:Ee,compare:ke,compareIgnoreCase:Ie,equalsIgnoreCase:Oe,beginsWithIgnoreCase:Ae,commonPrefixLength:Pe,commonSuffixLength:Fe,overlap:function(e,t){let i=e.length,n=t.length,s=i-n
if(0===s)return e===t?i:0
for(s<0&&(n+=s,s=0);s<i&&n>0;){if(We(e,s,i,t,0,n))return n
n-=1,s+=1}return 0},isHighSurrogate:Ve,isLowSurrogate:Be,containsRTL:ze,containsEmoji:Ke,isBasicASCII:qe,containsFullWidthCharacter:Ge,isFullWidthCharacter:je,difference:function(e,t,i=4){let n=Math.abs(e.length-t.length)
if(n>i)return 0
let s,r,o=[],a=[]
for(s=0;s<t.length+1;++s)a.push(0)
for(s=0;s<e.length+1;++s)o.push(a)
for(s=1;s<e.length+1;++s)for(r=1;r<t.length+1;++r)e[s-1]===t[r-1]?o[s][r]=o[s-1][r-1]+1:o[s][r]=Math.max(o[s-1][r],o[s][r-1])
return o[e.length][t.length]-Math.sqrt(n)},computeLineStarts:function(e){let t,i=/\r\n|\r|\n/g,n=[0]
for(;t=i.exec(e);)n.push(i.lastIndex)
return n},lcut:function(e,t){if(e.length<t)return e
let i=e.split(/\b/),n=0
for(let e=i.length-1;e>=0;e--)if((n+=i[e].length)>t){i.splice(0,e)
break}return i.join(ae).replace(/^\s/,ae)},removeAnsiEscapeCodes:function(e){return e&&(e=(e=(e=e.replace(Ye,"")).replace(Ze,"")).replace(Xe,"")),e},UTF8_BOM_CHARACTER:Je,startsWithUTF8BOM:Qe,stripUTF8BOM:function(e){return Qe(e)?e.substr(1):e},appendWithLimit:function(e,t,i){const n=e.length+t.length
return n>i&&(e="..."+e.substr(n-i)),t.length>i?e+=t.substr(t.length-i):e+=t,e},safeBtoa:et,repeat:tt,fuzzyContains:function(e,t){if(!e||!t)return!1
if(e.length<t.length)return!1
const i=t.length,n=e.toLowerCase()
let s=0,r=-1
for(;s<i;){let e=n.indexOf(t[s],r+1)
if(e<0)return!1
r=e,s++}return!0}})
const nt={number:"number",string:"string",undefined:"undefined",object:"object",function:"function"}
function st(e){return Array.isArray?Array.isArray(e):!(!e||typeof e.length!==nt.number||e.constructor!==Array)}function rt(e){return typeof e===nt.string||e instanceof String}function ot(e){return!(typeof e!==nt.object||null===e||Array.isArray(e)||e instanceof RegExp||e instanceof Date)}function at(e){return(typeof e===nt.number||e instanceof Number)&&!isNaN(e)}function lt(e){return!0===e||!1===e}function ht(e){return typeof e===nt.undefined}function dt(e){return ht(e)||null===e}const ut=Object.prototype.hasOwnProperty
function ct(e){if(!ot(e))return!1
for(let t in e)if(ut.call(e,t))return!1
return!0}function gt(e){return typeof e===nt.function}function mt(e,t){if(rt(t)){if(typeof e!==t)throw new Error(`argument does not match constraint: typeof ${t}`)}else if(gt(t)){if(e instanceof t)return
if(e&&e.constructor===t)return
if(1===t.length&&!0===t.call(void 0,e))return
throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}var pt,ft,_t=(pt={"WinJS/Core/_WinJS":{}},(ft=function(e,t,i){var n={},s=!1,r=t.map(function(e){return"exports"===e?(s=!0,n):pt[e]}),o=i.apply({},r)
pt[e]=s?n:o})("WinJS/Core/_Global",[],function(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{}}),ft("WinJS/Core/_BaseCoreUtils",["WinJS/Core/_Global"],function(e){return{hasWinRT:!!e.Windows,markSupportedForProcessing:function(e){return e.supportedForProcessing=!0,e},_setImmediate:e.setImmediate?e.setImmediate.bind(e):function(t){e.setTimeout(t,0)}}}),ft("WinJS/Core/_WriteProfilerMark",["WinJS/Core/_Global"],function(e){return e.msWriteProfilerMark||function(){}}),ft("WinJS/Core/_Base",["WinJS/Core/_WinJS","WinJS/Core/_Global","WinJS/Core/_BaseCoreUtils","WinJS/Core/_WriteProfilerMark"],function(e,t,i,n){function s(e,t,i){var n,s,r,o=Object.keys(t),a=Array.isArray(e)
for(s=0,r=o.length;s<r;s++){var l=o[s],h=95!==l.charCodeAt(0),d=t[l]
!d||"object"!=typeof d||void 0===d.value&&"function"!=typeof d.get&&"function"!=typeof d.set?h?a?e.forEach(function(e){e[l]=d}):e[l]=d:(n=n||{})[l]={value:d,enumerable:h,configurable:!0,writable:!0}:(void 0===d.enumerable&&(d.enumerable=h),i&&d.setName&&"function"==typeof d.setName&&d.setName(i+"."+l),(n=n||{})[l]=d)}n&&(a?e.forEach(function(e){Object.defineProperties(e,n)}):Object.defineProperties(e,n))}return function(){var i=e
function r(i,n){var s=i||{}
if(n){var r=n.split(".")
s===t&&"WinJS"===r[0]&&(s=e,r.splice(0,1))
for(var o=0,a=r.length;o<a;o++){var l=r[o]
s[l]||Object.defineProperty(s,l,{value:{},writable:!1,enumerable:!0,configurable:!0}),s=s[l]}}return s}function o(e,t,i){var n=r(e,t)
return i&&s(n,i,t||"<ANONYMOUS>"),n}i.Namespace||(i.Namespace=Object.create(Object.prototype))
var a={uninitialized:1,working:2,initialized:3}
Object.defineProperties(i.Namespace,{defineWithParent:{value:o,writable:!0,enumerable:!0,configurable:!0},define:{value:function(e,i){return o(t,e,i)},writable:!0,enumerable:!0,configurable:!0},_lazy:{value:function(e){var t,i,s=a.uninitialized
return{setName:function(e){t=e},get:function(){switch(s){case a.initialized:return i
case a.uninitialized:s=a.working
try{n("WinJS.Namespace._lazy:"+t+",StartTM"),i=e()}finally{n("WinJS.Namespace._lazy:"+t+",StopTM"),s=a.uninitialized}return e=null,s=a.initialized,i
case a.working:throw"Illegal: reentrancy on initialization"
default:throw"Illegal"}},set:function(e){switch(s){case a.working:throw"Illegal: reentrancy on initialization"
default:s=a.initialized,i=e}},enumerable:!0,configurable:!0}},writable:!0,enumerable:!0,configurable:!0},_moduleDefine:{value:function(e,i,n){var o=[e],a=null
return i&&(a=r(t,i),o.push(a)),s(o,n,i||"<ANONYMOUS>"),a},writable:!0,enumerable:!0,configurable:!0}})}(),function(){function t(e,t,n){return e=e||function(){},i.markSupportedForProcessing(e),t&&s(e.prototype,t),n&&s(e,n),e}e.Namespace.define("WinJS.Class",{define:t,derive:function(e,n,r,o){if(e){n=n||function(){}
var a=e.prototype
return n.prototype=Object.create(a),i.markSupportedForProcessing(n),Object.defineProperty(n.prototype,"constructor",{value:n,writable:!0,configurable:!0,enumerable:!0}),r&&s(n.prototype,r),o&&s(n,o),n}return t(n,r,o)},mix:function(e){var t,i
for(e=e||function(){},t=1,i=arguments.length;t<i;t++)s(e.prototype,arguments[t])
return e}})}(),{Namespace:e.Namespace,Class:e.Class}}),ft("WinJS/Core/_ErrorFromName",["WinJS/Core/_Base"],function(e){var t=e.Class.derive(Error,function(e,t){this.name=e,this.message=t||e},{},{supportedForProcessing:!1})
return e.Namespace.define("WinJS",{ErrorFromName:t}),t}),ft("WinJS/Core/_Events",["exports","WinJS/Core/_Base"],function(e,t){function i(e){var t="_on"+e+"state"
return{get:function(){var e=this[t]
return e&&e.userHandler},set:function(i){var n=this[t]
i?(n||(n={wrapper:function(e){return n.userHandler(e)},userHandler:i},Object.defineProperty(this,t,{value:n,enumerable:!1,writable:!0,configurable:!0}),this.addEventListener(e,n.wrapper,!1)),n.userHandler=i):n&&(this.removeEventListener(e,n.wrapper,!1),this[t]=null)},enumerable:!0}}var n=t.Class.define(function(e,t,i){this.detail=t,this.target=i,this.timeStamp=Date.now(),this.type=e},{bubbles:{value:!1,writable:!1},cancelable:{value:!1,writable:!1},currentTarget:{get:function(){return this.target}},defaultPrevented:{get:function(){return this._preventDefaultCalled}},trusted:{value:!1,writable:!1},eventPhase:{value:0,writable:!1},target:null,timeStamp:null,type:null,preventDefault:function(){this._preventDefaultCalled=!0},stopImmediatePropagation:function(){this._stopImmediatePropagationCalled=!0},stopPropagation:function(){}},{supportedForProcessing:!1}),s={_listeners:null,addEventListener:function(e,t,i){i=i||!1,this._listeners=this._listeners||{}
for(var n=this._listeners[e]=this._listeners[e]||[],s=0,r=n.length;s<r;s++){var o=n[s]
if(o.useCapture===i&&o.listener===t)return}n.push({listener:t,useCapture:i})},dispatchEvent:function(e,t){var i=this._listeners&&this._listeners[e]
if(i){for(var s=new n(e,t,this),r=0,o=(i=i.slice(0,i.length)).length;r<o&&!s._stopImmediatePropagationCalled;r++)i[r].listener(s)
return s.defaultPrevented||!1}return!1},removeEventListener:function(e,t,i){i=i||!1
var n=this._listeners&&this._listeners[e]
if(n)for(var s=0,r=n.length;s<r;s++){var o=n[s]
if(o.listener===t&&o.useCapture===i){n.splice(s,1),0===n.length&&delete this._listeners[e]
break}}}}
t.Namespace._moduleDefine(e,"WinJS.Utilities",{_createEventProperty:i,createEventProperties:function(){for(var e={},t=0,n=arguments.length;t<n;t++){var s=arguments[t]
e["on"+s]=i(s)}return e},eventMixin:s})}),ft("WinJS/Core/_Trace",["WinJS/Core/_Global"],function(e){function t(e){return e}return{_traceAsyncOperationStarting:e.Debug&&e.Debug.msTraceAsyncOperationStarting&&e.Debug.msTraceAsyncOperationStarting.bind(e.Debug)||t,_traceAsyncOperationCompleted:e.Debug&&e.Debug.msTraceAsyncOperationCompleted&&e.Debug.msTraceAsyncOperationCompleted.bind(e.Debug)||t,_traceAsyncCallbackStarting:e.Debug&&e.Debug.msTraceAsyncCallbackStarting&&e.Debug.msTraceAsyncCallbackStarting.bind(e.Debug)||t,_traceAsyncCallbackCompleted:e.Debug&&e.Debug.msTraceAsyncCallbackCompleted&&e.Debug.msTraceAsyncCallbackCompleted.bind(e.Debug)||t}}),ft("WinJS/Promise/_StateMachine",["WinJS/Core/_Global","WinJS/Core/_BaseCoreUtils","WinJS/Core/_Base","WinJS/Core/_ErrorFromName","WinJS/Core/_Events","WinJS/Core/_Trace"],function(e,t,i,n,s,r){e.Debug&&(e.Debug.setNonUserCodeExceptions=!0)
var o=new(i.Class.mix(i.Class.define(null,{},{supportedForProcessing:!1}),s.eventMixin))
o._listeners={}
var a="error",l="Canceled",h=!1,d={promise:1,thenPromise:2,errorPromise:4,exceptionPromise:8,completePromise:16}
d.all=d.promise|d.thenPromise|d.errorPromise|d.exceptionPromise|d.completePromise
var u,c,g,m,p,f,_,C,b,w,v=1
function S(){}u={name:"created",enter:function(e){e._setState(c)},cancel:S,done:S,then:S,_completed:S,_error:S,_notify:S,_progress:S,_setCompleteValue:S,_setErrorValue:S},c={name:"working",enter:S,cancel:function(e){e._setState(p)},done:M,then:B,_completed:x,_error:D,_notify:S,_progress:A,_setCompleteValue:V,_setErrorValue:W},g={name:"waiting",enter:function(e){var t=e._value
if(t instanceof z&&t._state!==w&&t._state!==C)P(t,{promise:e})
else{var i=function(n){t._errorId?e._chainedError(n,t):(R(e,n,N,t,i),e._error(n))}
i.handlesOnError=!0,t.then(e._completed.bind(e),i,e._progress.bind(e))}},cancel:function(e){e._setState(m)},done:M,then:B,_completed:x,_error:D,_notify:S,_progress:A,_setCompleteValue:V,_setErrorValue:W},m={name:"waiting_canceled",enter:function(e){e._setState(f)
var t=e._value
t.cancel&&t.cancel()},cancel:S,done:M,then:B,_completed:x,_error:D,_notify:S,_progress:A,_setCompleteValue:V,_setErrorValue:W},p={name:"canceled",enter:function(e){e._setState(f),e._cancelAction()},cancel:S,done:M,then:B,_completed:x,_error:D,_notify:S,_progress:A,_setCompleteValue:V,_setErrorValue:W},f={name:"canceling",enter:function(e){var t=new Error(l)
t.name=t.message,e._value=t,e._setState(b)},cancel:S,done:S,then:S,_completed:S,_error:S,_notify:S,_progress:S,_setCompleteValue:S,_setErrorValue:S},_={name:"complete_notify",enter:function(e){if(e.done=$.prototype.done,e.then=$.prototype.then,e._listeners)for(var t,i=[e];i.length;)(t=i.shift())._state._notify(t,i)
e._setState(C)},cancel:S,done:null,then:null,_completed:S,_error:S,_notify:T,_progress:S,_setCompleteValue:S,_setErrorValue:S},C={name:"success",enter:function(e){e.done=$.prototype.done,e.then=$.prototype.then,e._cleanupAction()},cancel:S,done:null,then:null,_completed:S,_error:S,_notify:T,_progress:S,_setCompleteValue:S,_setErrorValue:S},b={name:"error_notify",enter:function(e){if(e.done=U.prototype.done,e.then=U.prototype.then,e._listeners)for(var t,i=[e];i.length;)(t=i.shift())._state._notify(t,i)
e._setState(w)},cancel:S,done:null,then:null,_completed:S,_error:S,_notify:O,_progress:S,_setCompleteValue:S,_setErrorValue:S},w={name:"error",enter:function(e){e.done=U.prototype.done,e.then=U.prototype.then,e._cleanupAction()},cancel:S,done:null,then:null,_completed:S,_error:S,_notify:O,_progress:S,_setCompleteValue:S,_setErrorValue:S}
var y=i.Class.define(null,{_listeners:null,_nextState:null,_state:null,_value:null,cancel:function(){this._state.cancel(this),this._run()},done:function(e,t,i){this._state.done(this,e,t,i)},then:function(e,t,i){return this._state.then(this,e,t,i)},_chainedError:function(e,t){var i=this._state._error(this,e,E,t)
return this._run(),i},_completed:function(e){var t=this._state._completed(this,e)
return this._run(),t},_error:function(e){var t=this._state._error(this,e,k)
return this._run(),t},_progress:function(e){this._state._progress(this,e)},_setState:function(e){this._nextState=e},_setCompleteValue:function(e){this._state._setCompleteValue(this,e),this._run()},_setChainedErrorValue:function(e,t){var i=this._state._setErrorValue(this,e,E,t)
return this._run(),i},_setExceptionValue:function(e){var t=this._state._setErrorValue(this,e,I)
return this._run(),t},_run:function(){for(;this._nextState;)this._state=this._nextState,this._nextState=null,this._state.enter(this)}},{supportedForProcessing:!1})
function x(e,t){var i
i=t&&"object"==typeof t&&"function"==typeof t.then?g:_,e._value=t,e._setState(i)}function L(e,t,i,n,s,r){return{exception:e,error:t,promise:i,handler:r,id:n,parent:s}}function N(e,t,i,n){var s=i._isException,r=i._errorId
return L(s?t:null,s?null:t,e,r,i,n)}function E(e,t,i){var n=i._isException,s=i._errorId
return F(e,s,n),L(n?t:null,n?null:t,e,s,i)}function k(e,t){var i=++v
return F(e,i),L(null,t,e,i)}function I(e,t){var i=++v
return F(e,i,!0),L(t,null,e,i)}function M(e,t,i,n){P(e,{c:t,e:i,p:n,asyncOpID:r._traceAsyncOperationStarting("WinJS.Promise.done")})}function D(e,t,i,n){e._value=t,R(e,t,i,n),e._setState(b)}function T(t,i){var n,s,o=t._value,a=t._listeners
if(a)for(t._listeners=null,n=0,s=Array.isArray(a)?a.length:1;n<s;n++){var l=1===s?a:a[n],h=l.c,d=l.promise
if(r._traceAsyncOperationCompleted(l.asyncOpID,e.Debug&&e.Debug.MS_ASYNC_OP_STATUS_SUCCESS),d){r._traceAsyncCallbackStarting(l.asyncOpID)
try{d._setCompleteValue(h?h(o):o)}catch(e){d._setExceptionValue(e)}finally{r._traceAsyncCallbackCompleted()}d._state!==g&&d._listeners&&i.push(d)}else $.prototype.done.call(t,h)}}function O(t,i){var n,s,o=t._value,a=t._listeners
if(a)for(t._listeners=null,n=0,s=Array.isArray(a)?a.length:1;n<s;n++){var h=1===s?a:a[n],d=h.e,u=h.promise,c=e.Debug&&(o&&o.name===l?e.Debug.MS_ASYNC_OP_STATUS_CANCELED:e.Debug.MS_ASYNC_OP_STATUS_ERROR)
if(r._traceAsyncOperationCompleted(h.asyncOpID,c),u){var m=!1
try{d?(r._traceAsyncCallbackStarting(h.asyncOpID),m=!0,d.handlesOnError||R(u,o,N,t,d),u._setCompleteValue(d(o))):u._setChainedErrorValue(o,t)}catch(e){u._setExceptionValue(e)}finally{m&&r._traceAsyncCallbackCompleted()}u._state!==g&&u._listeners&&i.push(u)}else U.prototype.done.call(t,null,d)}}function R(e,t,i,n,s){if(o._listeners[a]){if(t instanceof Error&&t.message===l)return
o.dispatchEvent(a,i(e,t,n,s))}}function A(e,t){var i,n,s=e._listeners
if(s)for(i=0,n=Array.isArray(s)?s.length:1;i<n;i++){var r=1===n?s:s[i],o=r.p
if(o)try{o(t)}catch(e){}r.c||r.e||!r.promise||r.promise._progress(t)}}function P(e,t){var i=e._listeners
i?(i=Array.isArray(i)?i:[i]).push(t):i=t,e._listeners=i}function F(e,t,i){e._isException=i||!1,e._errorId=t}function W(e,t,i,n){e._value=t,R(e,t,i,n),e._setState(w)}function V(e,t){var i
i=t&&"object"==typeof t&&"function"==typeof t.then?g:C,e._value=t,e._setState(i)}function B(e,t,i,n){var s=new z(e)
return P(e,{promise:s,c:t,e:i,p:n,asyncOpID:r._traceAsyncOperationStarting("WinJS.Promise.then")}),s}var H,z=i.Class.derive(y,function(e){h&&(!0===h||h&d.thenPromise)&&(this._stack=q._getStack()),this._creator=e,this._setState(u),this._run()},{_creator:null,_cancelAction:function(){this._creator&&this._creator.cancel()},_cleanupAction:function(){this._creator=null}},{supportedForProcessing:!1}),U=i.Class.define(function(e){h&&(!0===h||h&d.errorPromise)&&(this._stack=q._getStack()),this._value=e,R(this,e,k)},{cancel:function(){},done:function(e,t){var i=this._value
if(t)try{t.handlesOnError||R(null,i,N,this,t)
var n=t(i)
return void(n&&"object"==typeof n&&"function"==typeof n.done&&n.done())}catch(e){i=e}i instanceof Error&&i.message===l||q._doneHandler(i)},then:function(e,t){if(!t)return this
var i,n=this._value
try{t.handlesOnError||R(null,n,N,this,t),i=new $(t(n))}catch(e){i=e===n?this:new K(e)}return i}},{supportedForProcessing:!1}),K=i.Class.derive(U,function(e){h&&(!0===h||h&d.exceptionPromise)&&(this._stack=q._getStack()),this._value=e,R(this,e,I)},{},{supportedForProcessing:!1}),$=i.Class.define(function(e){if(h&&(!0===h||h&d.completePromise)&&(this._stack=q._getStack()),e&&"object"==typeof e&&"function"==typeof e.then){var t=new z(null)
return t._setCompleteValue(e),t}this._value=e},{cancel:function(){},done:function(e){if(e)try{var t=e(this._value)
t&&"object"==typeof t&&"function"==typeof t.done&&t.done()}catch(e){q._doneHandler(e)}},then:function(e){try{var t=e?e(this._value):this._value
return t===this._value?this:new $(t)}catch(e){return new K(e)}}},{supportedForProcessing:!1}),q=i.Class.derive(y,function(e,t){h&&(!0===h||h&d.promise)&&(this._stack=q._getStack()),this._oncancel=t,this._setState(u),this._run()
try{e(this._completed.bind(this),this._error.bind(this),this._progress.bind(this))}catch(e){this._setExceptionValue(e)}},{_oncancel:null,_cancelAction:function(){try{if(!this._oncancel)throw new Error("Promise did not implement oncancel")
this._oncancel()}catch(e){e.message,e.stack,o.dispatchEvent("error",e)}},_cleanupAction:function(){this._oncancel=null}},{addEventListener:function(e,t,i){o.addEventListener(e,t,i)},any:function(e){return new q(function(t,i){var n=Object.keys(e)
0===n.length&&t()
var s=0
n.forEach(function(r){q.as(e[r]).then(function(){t({key:r,value:e[r]})},function(o){o instanceof Error&&o.name===l?++s===n.length&&t(q.cancel):i({key:r,value:e[r]})})})},function(){Object.keys(e).forEach(function(t){var i=q.as(e[t])
"function"==typeof i.cancel&&i.cancel()})})},as:function(e){return e&&"object"==typeof e&&"function"==typeof e.then?e:new $(e)},cancel:{get:function(){return H=H||new U(new n(l))}},dispatchEvent:function(e,t){return o.dispatchEvent(e,t)},is:function(e){return e&&"object"==typeof e&&"function"==typeof e.then},join:function(e){return new q(function(t,i,n){var s=Object.keys(e),r=Array.isArray(e)?[]:{},o=Array.isArray(e)?[]:{},a=0,h=s.length,d=function(e){if(0==--h){var a=Object.keys(r).length
if(0===a)t(o)
else{var d=0
s.forEach(function(e){var t=r[e]
t instanceof Error&&t.name===l&&d++}),d===a?t(q.cancel):i(r)}}else n({Key:e,Done:!0})}
s.forEach(function(t){var i=e[t]
void 0===i?a++:q.then(i,function(e){o[t]=e,d(t)},function(e){r[t]=e,d(t)})}),0!=(h-=a)||t(o)},function(){Object.keys(e).forEach(function(t){var i=q.as(e[t])
"function"==typeof i.cancel&&i.cancel()})})},removeEventListener:function(e,t,i){o.removeEventListener(e,t,i)},supportedForProcessing:!1,then:function(e,t,i,n){return q.as(e).then(t,i,n)},thenEach:function(e,t,i,n){var s=Array.isArray(e)?[]:{}
return Object.keys(e).forEach(function(r){s[r]=q.as(e[r]).then(t,i,n)}),q.join(s)},timeout:function(i,n){var s,r,o,a,l,h=(s=i,new q(function(i){s?r=e.setTimeout(i,s):t._setImmediate(i)},function(){r&&e.clearTimeout(r)}))
return n?(a=n,l=function(){o.cancel()},(o=h).then(function(){a.cancel()}),a.then(l,l),a):h},wrap:function(e){return new $(e)},wrapError:function(e){return new U(e)},_veryExpensiveTagWithStack:{get:function(){return h},set:function(e){h=e}},_veryExpensiveTagWithStack_tag:d,_getStack:function(){if(e.Debug&&e.Debug.debuggerEnabled)try{throw new Error}catch(e){return e.stack}},_cancelBlocker:function(e,t){if(!q.is(e))return q.wrap(e)
var i,n,s=new q(function(e,t){i=e,n=t},function(){i=null,n=null,t&&t()})
return e.then(function(e){i&&i(e)},function(e){n&&n(e)}),s}})
return Object.defineProperties(q,s.createEventProperties(a)),q._doneHandler=function(e){t._setImmediate(function(){throw e})},{PromiseStateMachine:y,Promise:q,state_created:u}}),ft("WinJS/Promise",["WinJS/Core/_Base","WinJS/Promise/_StateMachine"],function(e,t){return e.Namespace.define("WinJS",{Promise:t.Promise}),t.Promise}),pt["WinJS/Core/_WinJS"]),Ct=_t.Promise,bt=_t.Promise
_t.Promise
let wt={}
bt.addEventListener("error",function(e){const t=e.detail,i=t.id
t.parent?t.handler&&wt&&delete wt[i]:(wt[i]=t,1===Object.keys(wt).length&&setTimeout(function(){const e=wt
wt={},Object.keys(e).forEach(function(t){const i=e[t]
i.exception?St(i.exception):i.error&&St(i.error),console.log("WARNING: Promise with no error callback:"+i.id),console.log(i),i.exception&&console.log(i.exception.stack)})},0))})
const vt=new class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){R(()=>{if(e.stack)throw new Error(e.message+"\n\n"+e.stack)
throw e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}}
function St(e){Lt(e)||vt.onUnexpectedError(e)}function yt(e){Lt(e)||vt.onUnexpectedExternalError(e)}const xt="Canceled"
function Lt(e){return e instanceof Error&&e.name===xt&&e.message===xt}function Nt(){let e=new Error(xt)
return e.name=e.message,e}function Et(e){return e?new Error(`Illegal argument: ${e}`):new Error("Illegal argument")}class kt{constructor(e=null,t=null){this.type=e,this.data=t}}class It{constructor(e=null){if(this._listeners={},this._bulkListeners=[],this._collectedEvents=[],this._deferredCnt=0,e){this._allowedEventTypes={}
for(let t=0;t<e.length;t++)this._allowedEventTypes[e[t]]=!0}else this._allowedEventTypes=null}dispose(){this._listeners={},this._bulkListeners=[],this._collectedEvents=[],this._deferredCnt=0,this._allowedEventTypes=null}addListener(e,t){if("*"===e)throw new Error("Use addBulkListener(listener) to register your listener!")
if(this._allowedEventTypes&&!this._allowedEventTypes.hasOwnProperty(e))throw new Error("This object will never emit this event type!")
this._listeners.hasOwnProperty(e)?this._listeners[e].push(t):this._listeners[e]=[t]
let i=this
return{dispose:()=>{i&&(i._removeListener(e,t),i=null,t=null)}}}addOneTimeListener(e,t){const i=this.addListener(e,e=>{i.dispose(),t(e)})
return i}addBulkListener(e){return this._bulkListeners.push(e),{dispose:()=>{this._removeBulkListener(e)}}}addEmitter(e){return e.addBulkListener(e=>{0===this._deferredCnt?this._emitEvents(e):this._collectedEvents.push.apply(this._collectedEvents,e)})}_removeListener(e,t){if(this._listeners.hasOwnProperty(e)){let i=this._listeners[e]
for(let e=0,n=i.length;e<n;e++)if(i[e]===t){i.splice(e,1)
break}}}_removeBulkListener(e){for(let t=0,i=this._bulkListeners.length;t<i;t++)if(this._bulkListeners[t]===e){this._bulkListeners.splice(t,1)
break}}_emitToSpecificTypeListeners(e,t){if(this._listeners.hasOwnProperty(e)){const i=this._listeners[e].slice(0)
for(let e=0,n=i.length;e<n;e++)Tt(i[e],t)}}_emitToBulkListeners(e){const t=this._bulkListeners.slice(0)
for(let i=0,n=t.length;i<n;i++)Tt(t[i],e)}_emitEvents(e){this._bulkListeners.length>0&&this._emitToBulkListeners(e)
for(let t=0,i=e.length;t<i;t++){const i=e[t]
this._emitToSpecificTypeListeners(i.type,i.data)}}emit(e,t={}){if(this._allowedEventTypes&&!this._allowedEventTypes.hasOwnProperty(e))throw new Error("Cannot emit this event type because it wasn't listed!")
if(!this._listeners.hasOwnProperty(e)&&0===this._bulkListeners.length)return
const i=new kt(e,t)
0===this._deferredCnt?this._emitEvents([i]):this._collectedEvents.push(i)}beginDeferredEmit(){this._deferredCnt=this._deferredCnt+1}endDeferredEmit(){this._deferredCnt=this._deferredCnt-1,0===this._deferredCnt&&this._emitCollected()}deferredEmit(e){this.beginDeferredEmit()
let t=function(e){try{return e()}catch(e){St(e)}return}(e)
return this.endDeferredEmit(),t}_emitCollected(){if(0===this._collectedEvents.length)return
const e=this._collectedEvents
this._collectedEvents=[],this._emitEvents(e)}}class Mt{constructor(e,t){this.target=e,this.arg=t}}class Dt extends It{constructor(){super(null),this._emitQueue=[]}_emitToSpecificTypeListeners(e,t){if(this._listeners.hasOwnProperty(e)){let i=this._listeners[e]
for(let e=0,n=i.length;e<n;e++)this._emitQueue.push(new Mt(i[e],t))}}_emitToBulkListeners(e){let t=this._bulkListeners
for(let i=0,n=t.length;i<n;i++)this._emitQueue.push(new Mt(t[i],e))}_emitEvents(e){for(super._emitEvents(e);this._emitQueue.length>0;){let e=this._emitQueue.shift()
Tt(e.target,e.arg)}}}function Tt(e,t){try{return e(t)}catch(e){St(e)}}var Ot,Rt;(Rt=Ot||(Ot={}))[Rt.LTR=0]="LTR",Rt[Rt.RTL=1]="RTL"
class At extends t{constructor(e,t,i,n){super(e,t,i,n),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=i,this.positionColumn=n}clone(){return new At(this.selectionStartLineNumber,this.selectionStartColumn,this.positionLineNumber,this.positionColumn)}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return At.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?Ot.LTR:Ot.RTL}setEndPosition(e,t){return this.getDirection()===Ot.LTR?new At(this.startLineNumber,this.startColumn,e,t):new At(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new e(this.positionLineNumber,this.positionColumn)}setStartPosition(e,t){return this.getDirection()===Ot.LTR?new At(e,t,this.endLineNumber,this.endColumn):new At(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new At(e.lineNumber,e.column,t.lineNumber,t.column)}static liftSelection(e){return new At(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1
if(!e&&!t)return!0
if(e.length!==t.length)return!1
for(var i=0,n=e.length;i<n;i++)if(!this.selectionsEqual(e[i],t[i]))return!1
return!0}static isISelection(e){return e&&"number"==typeof e.selectionStartLineNumber&&"number"==typeof e.selectionStartColumn&&"number"==typeof e.positionLineNumber&&"number"==typeof e.positionColumn}static createWithDirection(e,t,i,n,s){return s===Ot.LTR?new At(e,t,i,n):new At(i,n,e,t)}}class Pt{static getLanguageId(e){return(255&e)>>>0}static getTokenType(e){return(1792&e)>>>8}static getFontStyle(e){return(14336&e)>>>11}static getForeground(e){return(8372224&e)>>>14}static getBackground(e){return(4286578688&e)>>>23}static getClassNameFromMetadata(e){let t="mtk"+this.getForeground(e),i=this.getFontStyle(e)
return 1&i&&(t+=" mtki"),2&i&&(t+=" mtkb"),4&i&&(t+=" mtku"),t}static getInlineStyleFromMetadata(e,t){const i=this.getForeground(e),n=this.getFontStyle(e)
let s=`color: ${t[i]};`
return 1&n&&(s+="font-style: italic;"),2&n&&(s+="font-weight: bold;"),4&n&&(s+="text-decoration: underline;"),s}}class Ft{constructor(e,t){this.endIndex=e,this._metadata=t}getForeground(){return Pt.getForeground(this._metadata)}getType(){return Pt.getClassNameFromMetadata(this._metadata)}getInlineStyle(e){return Pt.getInlineStyleFromMetadata(this._metadata,e)}static _equals(e,t){return e.endIndex===t.endIndex&&e._metadata===t._metadata}static equalsArr(e,t){const i=e.length
if(i!==t.length)return!1
for(let n=0;n<i;n++)if(!this._equals(e[n],t[n]))return!1
return!0}}class Wt{static inflateArr(e,t){let i=[]
for(let n=0,s=e.length>>>1;n<s;n++){let r=n+1<s?e[n+1<<1]:t,o=e[1+(n<<1)]
i[n]=new Ft(r,o)}return i}static sliceAndInflate(e,t,i,n,s){const r=i-t+n
let o=[],a=0
for(let l=this.findIndexInSegmentsArray(e,t),h=e.length>>>1;l<h;l++){if(e[l<<1]>=i)break
let d=l+1<h?e[l+1<<1]:s,u=Math.min(r,d-t+n),c=e[1+(l<<1)]
o[a++]=new Ft(u,c)}return o}static findIndexInSegmentsArray(e,t){let i=0,n=(e.length>>>1)-1
for(;i<n;){let s=i+Math.ceil((n-i)/2)
e[s<<1]>t?n=s-1:i=s}return i}}class Vt{get languageId(){return Pt.getLanguageId(this._metadata)}get tokenType(){return Pt.getTokenType(this._metadata)}get fontStyle(){return Pt.getFontStyle(this._metadata)}get foregroundId(){return Pt.getForeground(this._metadata)}get backgroundId(){return Pt.getBackground(this._metadata)}constructor(e,t,i,n,s,r){this._source=e,this._tokenIndex=t,this._metadata=r,this.startOffset=n,this.endOffset=s,this.hasPrev=this._tokenIndex>0,this.hasNext=this._tokenIndex+1<i}prev(){return this.hasPrev?this._source.tokenAt(this._tokenIndex-1):null}next(){return this.hasNext?this._source.tokenAt(this._tokenIndex+1):null}}class Bt{constructor(e,t){this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this._textLength=this._text.length}getTokenCount(){return this._tokensCount}getLineContent(){return this._text}getLineLength(){return this._textLength}getTokenStartOffset(e){return this._tokens[e<<1]}getLanguageId(e){let t=this._tokens[1+(e<<1)]
return Pt.getLanguageId(t)}getStandardTokenType(e){let t=this._tokens[1+(e<<1)]
return Pt.getTokenType(t)}getTokenEndOffset(e){return e+1<this._tokensCount?this._tokens[e+1<<1]:this._textLength}findTokenIndexAtOffset(e){return Wt.findIndexInSegmentsArray(this._tokens,e)}findTokenAtOffset(e){let t=this.findTokenIndexAtOffset(e)
return this.tokenAt(t)}tokenAt(e){let t,i=this._tokens[e<<1]
t=e+1<this._tokensCount?this._tokens[e+1<<1]:this._textLength
let n=this._tokens[1+(e<<1)]
return new Vt(this,e,this._tokensCount,i,t,n)}firstToken(){return 0===this._textLength?null:this.tokenAt(0)}lastToken(){return 0===this._textLength?null:this.tokenAt(this._tokensCount-1)}inflate(){return Wt.inflateArr(this._tokens,this._textLength)}sliceAndInflate(e,t,i){return Wt.sliceAndInflate(this._tokens,e,t,i,this._textLength)}}var Ht={adjust:()=>{},finish:()=>{}}
function zt(e,t){let i=0,n=0,s=e.length
for(;n<s;){let s=e.charCodeAt(n)
if(32===s)i++
else{if(9!==s)break
i=i-i%t+t}n++}return n===s?-1:i}class Ut{constructor(){}applyEdits(e){let t=0,i=this.text,n=this._createTokensAdjuster()
for(let s=0,r=e.length;s<r;s++){let r=e[s],o=t+r.startColumn,a=t+r.endColumn,l=a-o,h=r.text.length
n.adjust(r.startColumn-1,t,1)
let d=Math.min(l,h)
d>0&&n.adjust(r.startColumn-1+d,t,o),i=i.substring(0,o-1)+r.text+i.substring(a-1),t+=h-l,n.adjust(r.endColumn,t,o)}return n.finish(t,i.length),this._setText(i),t}split(e){const t=this.text.substring(0,e-1),i=this.text.substring(e-1)
return this._setText(t),this._createModelLine(i)}append(e){this._setText(this.text+e.text)}}class Kt extends Ut{get text(){return this._text}isInvalid(){return this._isInvalid}setIsInvalid(e){this._isInvalid=e}constructor(e){super(),this._isInvalid=!1,this._setText(e),this._state=null,this._lineTokens=null}_createModelLine(e){return new Kt(e)}split(e){let t=super.split(e)
return this._deleteMarkedTokens(this._markOverflowingTokensForDeletion(0,this.text.length)),t}append(e){let t=this.text.length
if(super.append(e),e instanceof Kt){let i=e._lineTokens
if(i){let e=new Uint32Array(i)
if(t>0)for(let i=0,n=e.length>>>1;i<n;i++)e[i<<1]=e[i<<1]+t
let n=this._lineTokens
if(n){let t=new Uint32Array(n),i=new Uint32Array(t.length+e.length)
i.set(t,0),i.set(e,t.length),this._lineTokens=i.buffer}else this._lineTokens=e.buffer}}}resetTokenizationState(){this._state=null,this._lineTokens=null}setState(e){this._state=e}getState(){return this._state||null}setTokens(e,t){t&&0!==t.length&&(2!==t.length||0!==t[0]||t[1]!==qt(e))?this._lineTokens=t.buffer:this._lineTokens=null}getTokens(e){let t=this._lineTokens
if(t)return new Bt(new Uint32Array(t),this._text)
let i=new Uint32Array(2)
return i[0]=0,i[1]=qt(e),new Bt(i,this._text)}_createTokensAdjuster(){if(!this._lineTokens)return Ht
let e=new Uint32Array(this._lineTokens),t=e.length>>>1,i=0,n=0,s=0,r=(r,o,a)=>{let l=a-1
for(;n<r&&i<t;){if(n>0&&0!==o){let t=Math.max(l,n+o)
if(e[i<<1]=t,o<0){let n=i
for(;n>0;){let i=e[n-1<<1]
if(!(i>=t))break
4294967295!==i&&(e[n-1<<1]=4294967295,s++),n--}}}++i<t&&(n=e[i<<1])}}
return{adjust:r,finish:(e,t)=>{r(1073741824,e,1),this._deleteMarkedTokens(this._markOverflowingTokensForDeletion(s,t))}}}_markOverflowingTokensForDeletion(e,t){if(!this._lineTokens)return e
let i=new Uint32Array(this._lineTokens),n=i.length>>>1
if(e+1===n)return e
for(let s=n-1;s>0;s--){let r=i[s<<1]
if(r<t)return e
if(4294967295!==r&&(i[s<<1]=4294967295,++e+1===n))return e}return e}_deleteMarkedTokens(e){if(0===e)return
let t=new Uint32Array(this._lineTokens),i=t.length>>>1,n=new Uint32Array(i-e<<1),s=0
for(let e=0;e<i;e++){let i=t[e<<1]
if(4294967295===i)continue
let r=t[1+(e<<1)]
n[s++]=i,n[s++]=r}this._lineTokens=n.buffer}_setText(e){this._text=e}}class $t extends Ut{get text(){return this._text}isInvalid(){return!1}setIsInvalid(e){}constructor(e){super(),this._setText(e)}_createModelLine(e){return new $t(e)}split(e){return super.split(e)}append(e){super.append(e)}resetTokenizationState(){}setState(e){}getState(){return null}setTokens(e,t){}getTokens(e){let t=new Uint32Array(2)
return t[0]=0,t[1]=qt(e),new Bt(t,this._text)}_createTokensAdjuster(){return Ht}_setText(e){this._text=e}}function qt(e){return(16384|e<<0|2<<23)>>>0}function Gt(e,t,i,n){let s
for(s=0;s<t&&s<n;s++){if(e.charCodeAt(s)!==i.charCodeAt(s))break}let r=0,o=0
for(let i=s;i<t;i++){32===e.charCodeAt(i)?r++:o++}let a=0,l=0
for(let e=s;e<n;e++){32===i.charCodeAt(e)?a++:l++}if(r>0&&o>0)return 0
if(a>0&&l>0)return 0
let h=Math.abs(o-l),d=Math.abs(r-a)
return 0===h?d:d%h==0?d/h:0}function jt(e,t,i){const n=Math.min(e.length,1e4)
let s=0,r=0,o="",a=0
let l=[0,0,0,0,0,0,0,0,0]
for(let t=0;t<n;t++){let i=e[t],n=!1,h=0,d=0,u=0
for(let e=0,t=i.length;e<t;e++){let t=i.charCodeAt(e)
if(9===t)u++
else{if(32!==t){n=!0,h=e
break}d++}}if(!n)continue
u>0?s++:d>1&&r++
let c=Gt(o,a,i,h)
c<=8&&l[c]++,o=i,a=h}let h=Gt(o,a,"",0)
h<=8&&l[h]++
let d=i
s!==r&&(d=s<r)
let u=t,c=d?0:.1*n
return[2,4,6,8].forEach(e=>{let t=l[e]
t>c&&(c=t,u=e)}),{insertSpaces:d,tabSize:u}}var Yt=function(){function e(e){this.isPseudo=e}return e.detect=function(){return new e("undefined"!=typeof document&&document.location&&document.location.hash.indexOf("pseudo=true")>=0)},e}()
function Zt(e,t,i){var n
return n=0===t.length?e:e.replace(/\{(\d+)\}/g,function(e,i){var n=i[0]
return void 0!==t[n]?t[n]:e}),i.isPseudo&&(n="［"+n.replace(/[aouei]/g,"$&$&")+"］"),n}var Xt=function(){function e(e){var t=this
this._env=e,this.localize=function(e,i){for(var n=[],s=2;s<arguments.length;s++)n[s-2]=arguments[s]
return function(e,t,i){for(var n=[],s=3;s<arguments.length;s++)n[s-3]=arguments[s]
return Zt(i,n,e)}.apply(void 0,[t._env,e,i].concat(n))}}return e.prototype.setPseudoTranslation=function(e){this._env=new Yt(e)},e.prototype.create=function(e,t){return{localize:(i=t[e],n=this._env,function(e,t){var s=Array.prototype.slice.call(arguments,2)
return Zt(i[e],s,n)})}
var i,n},e}()
Xt.DEFAULT_TAG="i-default"
let Jt=new Xt(Yt.detect()).localize
const Qt=Object.freeze({dispose(){}})
function ei(e,...t){return Array.isArray(e)?(e.forEach(e=>e&&e.dispose()),[]):0===t.length?e?(e.dispose(),e):void 0:(ei(e),ei(t),[])}function ti(e){return{dispose:()=>ei(e)}}function ii(...e){return{dispose(){for(const t of e)t()}}}class ni{constructor(){this._toDispose=[]}dispose(){this._toDispose=ei(this._toDispose)}_register(e){return this._toDispose.push(e),e}}class si{constructor(e){this.object=e}dispose(){}}class ri{constructor(e){this.element=e}}class oi{isEmpty(){return!this._first}unshift(e){return this.insert(e,!1)}push(e){return this.insert(e,!0)}insert(e,t){const i=new ri(e)
if(this._first)if(t){const e=this._last
this._last=i,i.prev=e,e.next=i}else{const e=this._first
this._first=i,i.next=e,e.prev=i}else this._first=i,this._last=i
return()=>{for(let e=this._first;e instanceof ri;e=e.next)if(e===i){if(e.prev&&e.next){let t=e.prev
t.next=e.next,e.next.prev=t}else e.prev||e.next?e.next?e.prev||(this._first=this._first.next,this._first.prev=void 0):(this._last=this._last.prev,this._last.next=void 0):(this._first=void 0,this._last=void 0)
break}}}iterator(){let e,t,i={get done(){return e},get value(){return t}},n=this._first
return{next:()=>(n?(e=!1,t=n.element,n=n.next):(e=!0,t=void 0),i)}}toArray(){let e=[]
for(let t=this._first;t instanceof ri;t=t.next)e.push(t.element)
return e}}class ai{add(e,t=null,i){this._callbacks||(this._callbacks=new oi)
const n=this._callbacks.push([e,t])
return Array.isArray(i)&&i.push({dispose:n}),n}invoke(...e){if(!this._callbacks)return
const t=[],i=this._callbacks.toArray()
for(const[n,s]of i)try{t.push(n.apply(s,e))}catch(e){St(e)}return t}entries(){return this._callbacks&&this._callbacks?this._callbacks.toArray():[]}isEmpty(){return!this._callbacks||this._callbacks.isEmpty()}dispose(){this._callbacks=void 0}}var li
!function(e){const t={dispose(){}};(li||(li={})).None=function(){return t}}()
var hi,di,ui=li
class ci{constructor(e){this._options=e}get event(){return this._event||(this._event=((e,t,i)=>{this._callbacks||(this._callbacks=new ai)
const n=this._callbacks.isEmpty()
n&&this._options&&this._options.onFirstListenerAdd&&this._options.onFirstListenerAdd(this)
const s=this._callbacks.add(e,t)
let r
return n&&this._options&&this._options.onFirstListenerDidAdd&&this._options.onFirstListenerDidAdd(this),this._options&&this._options.onListenerDidAdd&&this._options.onListenerDidAdd(this,e,t),r={dispose:()=>{r.dispose=ci._noop,this._disposed||(s(),this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}},Array.isArray(i)&&i.push(r),r})),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0,this._disposed=!0)}}function gi(e,t,i=100,n=!1){let s,r=void 0,o=void 0,a=0
const l=new ci({onFirstListenerAdd(){s=e(e=>{a++,r=t(r,e),n&&!o&&l.fire(r),clearTimeout(o),o=setTimeout(()=>{let e=r
r=void 0,o=void 0,(!n||a>1)&&l.fire(e),a=0},i)})},onLastListenerRemove(){s.dispose()}})
return l.event}ci._noop=function(){}
class mi{constructor(){this.buffers=[]}wrapEvent(e){return(t,i,n)=>e(e=>{const n=this.buffers[this.buffers.length-1]
n?n.push(()=>t.call(i,e)):t.call(i,e)},void 0,n)}bufferEvents(e){const t=[]
this.buffers.push(t),e(),this.buffers.pop(),t.forEach(e=>e())}}function pi(e,t){return(i,n=null,s)=>e(e=>i.call(n,t(e)),null,s)}class fi{constructor(e){this._event=e}get event(){return this._event}map(e){return new fi(pi(this._event,e))}filter(e){return new fi((t=this._event,i=e,(e,n=null,s)=>t(t=>i(t)&&e.call(n,t),null,s)))
var t,i}on(e,t,i){return this._event(e,t,i)}}function _i(e){return new fi(e)}(di=hi||(hi={}))[di.Auto=1]="Auto",di[di.Hidden=2]="Hidden",di[di.Visible=3]="Visible"
class Ci{constructor(e,t,i,n,s,r){t|=0,i|=0,n|=0,s|=0,r|=0,(e|=0)<0&&(e=0),i+e>t&&(i=t-e),i<0&&(i=0),n<0&&(n=0),r+n>s&&(r=s-n),r<0&&(r=0),this.width=e,this.scrollWidth=t,this.scrollLeft=i,this.height=n,this.scrollHeight=s,this.scrollTop=r}equals(e){return this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e){return new Ci(void 0!==e.width?e.width:this.width,void 0!==e.scrollWidth?e.scrollWidth:this.scrollWidth,this.scrollLeft,void 0!==e.height?e.height:this.height,void 0!==e.scrollHeight?e.scrollHeight:this.scrollHeight,this.scrollTop)}withScrollPosition(e){return new Ci(this.width,this.scrollWidth,void 0!==e.scrollLeft?e.scrollLeft:this.scrollLeft,this.height,this.scrollHeight,void 0!==e.scrollTop?e.scrollTop:this.scrollTop)}createScrollEvent(e){let t=this.width!==e.width,i=this.scrollWidth!==e.scrollWidth,n=this.scrollLeft!==e.scrollLeft,s=this.height!==e.height,r=this.scrollHeight!==e.scrollHeight,o=this.scrollTop!==e.scrollTop
return{width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:t,scrollWidthChanged:i,scrollLeftChanged:n,heightChanged:s,scrollHeightChanged:r,scrollTopChanged:o}}}class bi extends ni{constructor(e,t){super(),this._onScroll=this._register(new ci),this.onScroll=this._onScroll.event,this._smoothScrollDuration=e,this._scheduleAtNextAnimationFrame=t,this._state=new Ci(0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e){const t=this._state.withScrollDimensions(e)
this._setState(t),this._smoothScrolling&&this._smoothScrolling.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){const t=this._state.withScrollPosition(e)
this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t)}setScrollPositionSmooth(e){if(0===this._smoothScrollDuration)return this.setScrollPositionNow(e)
if(this._smoothScrolling){e={scrollLeft:void 0===e.scrollLeft?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:void 0===e.scrollTop?this._smoothScrolling.to.scrollTop:e.scrollTop}
const t=this._state.withScrollPosition(e)
if(this._smoothScrolling.to.scrollLeft===t.scrollLeft&&this._smoothScrolling.to.scrollTop===t.scrollTop)return
const i=this._smoothScrolling.combine(this._state,t,this._smoothScrollDuration)
this._smoothScrolling.dispose(),this._smoothScrolling=i}else{const t=this._state.withScrollPosition(e)
this._smoothScrolling=Si.start(this._state,t,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}_performSmoothScrolling(){const e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e)
if(this._setState(t),e.isDone)return this._smoothScrolling.dispose(),void(this._smoothScrolling=null)
this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}_setState(e){const t=this._state
t.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(t)))}}class wi{constructor(e,t,i){this.scrollLeft=e,this.scrollTop=t,this.isDone=i}}function vi(e,t){const i=t-e
return function(t){return e+i*(1-(n=1-t,Math.pow(n,3)))
var n}}class Si{constructor(e,t,i,n){this.from=e,this.to=t,this.duration=n,this._startTime=i,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,i){let n,s
return Math.abs(e-t)>2.5*i?(e<t?(n=e+.75*i,s=t-.75*i):(n=e-.75*i,s=t+.75*i),r=vi(e,n),o=vi(s,t),a=.33,function(e){return e<a?r(e/a):o((e-a)/(1-a))}):vi(e,t)
var r,o,a}dispose(){null!==this.animationFrameDisposable&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){const t=(e-this._startTime)/this.duration
if(t<1){const e=this.scrollLeft(t),i=this.scrollTop(t)
return new wi(e,i,!1)}return new wi(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,i){return Si.start(e,t,i)}static start(e,t,i){i+=10
const n=Date.now()-10
return new Si(e,t,n,i)}}const yi="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?"
const xi=function(e=""){for(var t=yi,i="(-?\\d*\\.\\d\\w*)|([^",n=0;n<t.length;n++)e.indexOf(t[n])>=0||(i+="\\"+t[n])
return i+="\\s]+)",new RegExp(i,"g")}()
function Li(e){var t=xi
if(e&&e instanceof RegExp)if(e.global)t=e
else{var i="g"
e.ignoreCase&&(i+="i"),e.multiline&&(i+="m"),t=new RegExp(e.source,i)}return t.lastIndex=0,t}function Ni(e,t,i,n){t.lastIndex=0
let s=t.exec(i)
if(!s)return null
const r=s[0].indexOf(" ")>=0?function(e,t,i,n){let s,r=e-1-n
for(t.lastIndex=0;s=t.exec(i);){if(s.index>r)return null
if(t.lastIndex>=r)return{word:s[0],startColumn:n+1+s.index,endColumn:n+1+t.lastIndex}}return null}(e,t,i,n):function(e,t,i,n){let s,r=e-1-n,o=i.lastIndexOf(" ",r-1)+1,a=i.indexOf(" ",r)
for(-1===a&&(a=i.length),t.lastIndex=o;s=t.exec(i);)if(s.index<=r&&t.lastIndex>=r)return{word:s[0],startColumn:n+1+s.index,endColumn:n+1+t.lastIndex}
return null}(e,t,i,n)
return t.lastIndex=0,r}var Ei,ki,Ii,Mi,Di,Ti,Oi,Ri;(ki=Ei||(Ei={}))[ki.None=0]="None",ki[ki.Small=1]="Small",ki[ki.Large=2]="Large",ki[ki.SmallBlocks=3]="SmallBlocks",ki[ki.LargeBlocks=4]="LargeBlocks",(Mi=Ii||(Ii={}))[Mi.None=0]="None",Mi[Mi.Same=1]="Same",Mi[Mi.Indent=2]="Indent",(Ti=Di||(Di={}))[Ti.Hidden=0]="Hidden",Ti[Ti.Blink=1]="Blink",Ti[Ti.Smooth=2]="Smooth",Ti[Ti.Phase=3]="Phase",Ti[Ti.Expand=4]="Expand",Ti[Ti.Solid=5]="Solid",(Ri=Oi||(Oi={}))[Ri.Line=1]="Line",Ri[Ri.Block=2]="Block",Ri[Ri.Underline=3]="Underline",Ri[Ri.LineThin=4]="LineThin",Ri[Ri.BlockOutline=5]="BlockOutline",Ri[Ri.UnderlineThin=6]="UnderlineThin"
class Ai{constructor(e){this.canUseLayerHinting=e.canUseLayerHinting,this.pixelRatio=e.pixelRatio,this.editorClassName=e.editorClassName,this.lineHeight=0|e.lineHeight,this.readOnly=e.readOnly,this.accessibilitySupport=e.accessibilitySupport,this.multiCursorModifier=e.multiCursorModifier,this.wordSeparators=e.wordSeparators,this.autoClosingBrackets=e.autoClosingBrackets,this.autoIndent=e.autoIndent,this.useTabStops=e.useTabStops,this.tabFocusMode=e.tabFocusMode,this.dragAndDrop=e.dragAndDrop,this.emptySelectionClipboard=e.emptySelectionClipboard,this.layoutInfo=e.layoutInfo,this.fontInfo=e.fontInfo,this.viewInfo=e.viewInfo,this.wrappingInfo=e.wrappingInfo,this.contribInfo=e.contribInfo}equals(e){return this.canUseLayerHinting===e.canUseLayerHinting&&this.pixelRatio===e.pixelRatio&&this.editorClassName===e.editorClassName&&this.lineHeight===e.lineHeight&&this.readOnly===e.readOnly&&this.accessibilitySupport===e.accessibilitySupport&&this.multiCursorModifier===e.multiCursorModifier&&this.wordSeparators===e.wordSeparators&&this.autoClosingBrackets===e.autoClosingBrackets&&this.autoIndent===e.autoIndent&&this.useTabStops===e.useTabStops&&this.tabFocusMode===e.tabFocusMode&&this.dragAndDrop===e.dragAndDrop&&this.emptySelectionClipboard===e.emptySelectionClipboard&&Ai._equalsLayoutInfo(this.layoutInfo,e.layoutInfo)&&this.fontInfo.equals(e.fontInfo)&&Ai._equalsViewOptions(this.viewInfo,e.viewInfo)&&Ai._equalsWrappingInfo(this.wrappingInfo,e.wrappingInfo)&&Ai._equalsContribOptions(this.contribInfo,e.contribInfo)}createChangeEvent(e){return{canUseLayerHinting:this.canUseLayerHinting!==e.canUseLayerHinting,pixelRatio:this.pixelRatio!==e.pixelRatio,editorClassName:this.editorClassName!==e.editorClassName,lineHeight:this.lineHeight!==e.lineHeight,readOnly:this.readOnly!==e.readOnly,accessibilitySupport:this.accessibilitySupport!==e.accessibilitySupport,multiCursorModifier:this.multiCursorModifier!==e.multiCursorModifier,wordSeparators:this.wordSeparators!==e.wordSeparators,autoClosingBrackets:this.autoClosingBrackets!==e.autoClosingBrackets,autoIndent:this.autoIndent!==e.autoIndent,useTabStops:this.useTabStops!==e.useTabStops,tabFocusMode:this.tabFocusMode!==e.tabFocusMode,dragAndDrop:this.dragAndDrop!==e.dragAndDrop,emptySelectionClipboard:this.emptySelectionClipboard!==e.emptySelectionClipboard,layoutInfo:!Ai._equalsLayoutInfo(this.layoutInfo,e.layoutInfo),fontInfo:!this.fontInfo.equals(e.fontInfo),viewInfo:!Ai._equalsViewOptions(this.viewInfo,e.viewInfo),wrappingInfo:!Ai._equalsWrappingInfo(this.wrappingInfo,e.wrappingInfo),contribInfo:!Ai._equalsContribOptions(this.contribInfo,e.contribInfo)}}static _equalsLayoutInfo(e,t){return e.width===t.width&&e.height===t.height&&e.glyphMarginLeft===t.glyphMarginLeft&&e.glyphMarginWidth===t.glyphMarginWidth&&e.glyphMarginHeight===t.glyphMarginHeight&&e.lineNumbersLeft===t.lineNumbersLeft&&e.lineNumbersWidth===t.lineNumbersWidth&&e.lineNumbersHeight===t.lineNumbersHeight&&e.decorationsLeft===t.decorationsLeft&&e.decorationsWidth===t.decorationsWidth&&e.decorationsHeight===t.decorationsHeight&&e.contentLeft===t.contentLeft&&e.contentWidth===t.contentWidth&&e.contentHeight===t.contentHeight&&e.renderMinimap===t.renderMinimap&&e.minimapWidth===t.minimapWidth&&e.viewportColumn===t.viewportColumn&&e.verticalScrollbarWidth===t.verticalScrollbarWidth&&e.horizontalScrollbarHeight===t.horizontalScrollbarHeight&&this._equalsOverviewRuler(e.overviewRuler,t.overviewRuler)}static _equalsOverviewRuler(e,t){return e.width===t.width&&e.height===t.height&&e.top===t.top&&e.right===t.right}static _equalsViewOptions(e,t){return e.extraEditorClassName===t.extraEditorClassName&&e.disableMonospaceOptimizations===t.disableMonospaceOptimizations&&this._equalsNumberArrays(e.rulers,t.rulers)&&e.ariaLabel===t.ariaLabel&&e.renderLineNumbers===t.renderLineNumbers&&e.renderCustomLineNumbers===t.renderCustomLineNumbers&&e.renderRelativeLineNumbers===t.renderRelativeLineNumbers&&e.selectOnLineNumbers===t.selectOnLineNumbers&&e.glyphMargin===t.glyphMargin&&e.revealHorizontalRightPadding===t.revealHorizontalRightPadding&&e.roundedSelection===t.roundedSelection&&e.overviewRulerLanes===t.overviewRulerLanes&&e.overviewRulerBorder===t.overviewRulerBorder&&e.cursorBlinking===t.cursorBlinking&&e.mouseWheelZoom===t.mouseWheelZoom&&e.cursorStyle===t.cursorStyle&&e.hideCursorInOverviewRuler===t.hideCursorInOverviewRuler&&e.scrollBeyondLastLine===t.scrollBeyondLastLine&&e.smoothScrolling===t.smoothScrolling&&e.stopRenderingLineAfter===t.stopRenderingLineAfter&&e.renderWhitespace===t.renderWhitespace&&e.renderControlCharacters===t.renderControlCharacters&&e.fontLigatures===t.fontLigatures&&e.renderIndentGuides===t.renderIndentGuides&&e.renderLineHighlight===t.renderLineHighlight&&this._equalsScrollbarOptions(e.scrollbar,t.scrollbar)&&this._equalsMinimapOptions(e.minimap,t.minimap)&&e.fixedOverflowWidgets===t.fixedOverflowWidgets}static _equalsScrollbarOptions(e,t){return e.arrowSize===t.arrowSize&&e.vertical===t.vertical&&e.horizontal===t.horizontal&&e.useShadows===t.useShadows&&e.verticalHasArrows===t.verticalHasArrows&&e.horizontalHasArrows===t.horizontalHasArrows&&e.handleMouseWheel===t.handleMouseWheel&&e.horizontalScrollbarSize===t.horizontalScrollbarSize&&e.horizontalSliderSize===t.horizontalSliderSize&&e.verticalScrollbarSize===t.verticalScrollbarSize&&e.verticalSliderSize===t.verticalSliderSize&&e.mouseWheelScrollSensitivity===t.mouseWheelScrollSensitivity}static _equalsMinimapOptions(e,t){return e.enabled===t.enabled&&e.showSlider===t.showSlider&&e.renderCharacters===t.renderCharacters&&e.maxColumn===t.maxColumn}static _equalsNumberArrays(e,t){if(e.length!==t.length)return!1
for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1
return!0}static _equalFindOptions(e,t){return e.seedSearchStringFromSelection===t.seedSearchStringFromSelection&&e.autoFindInSelection===t.autoFindInSelection}static _equalsWrappingInfo(e,t){return e.inDiffEditor===t.inDiffEditor&&e.isDominatedByLongLines===t.isDominatedByLongLines&&e.isWordWrapMinified===t.isWordWrapMinified&&e.isViewportWrapping===t.isViewportWrapping&&e.wrappingColumn===t.wrappingColumn&&e.wrappingIndent===t.wrappingIndent&&e.wordWrapBreakBeforeCharacters===t.wordWrapBreakBeforeCharacters&&e.wordWrapBreakAfterCharacters===t.wordWrapBreakAfterCharacters&&e.wordWrapBreakObtrusiveCharacters===t.wordWrapBreakObtrusiveCharacters}static _equalsContribOptions(e,t){return e.selectionClipboard===t.selectionClipboard&&e.hover===t.hover&&e.links===t.links&&e.contextmenu===t.contextmenu&&Ai._equalsQuickSuggestions(e.quickSuggestions,t.quickSuggestions)&&e.quickSuggestionsDelay===t.quickSuggestionsDelay&&e.parameterHints===t.parameterHints&&e.iconsInSuggestions===t.iconsInSuggestions&&e.formatOnType===t.formatOnType&&e.formatOnPaste===t.formatOnPaste&&e.suggestOnTriggerCharacters===t.suggestOnTriggerCharacters&&e.acceptSuggestionOnEnter===t.acceptSuggestionOnEnter&&e.acceptSuggestionOnCommitCharacter===t.acceptSuggestionOnCommitCharacter&&e.snippetSuggestions===t.snippetSuggestions&&e.wordBasedSuggestions===t.wordBasedSuggestions&&e.suggestFontSize===t.suggestFontSize&&e.suggestLineHeight===t.suggestLineHeight&&e.selectionHighlight===t.selectionHighlight&&e.occurrencesHighlight===t.occurrencesHighlight&&e.codeLens===t.codeLens&&e.folding===t.folding&&e.showFoldingControls===t.showFoldingControls&&e.matchBrackets===t.matchBrackets&&this._equalFindOptions(e.find,t.find)&&e.colorDecorators===t.colorDecorators&&e.lightbulbEnabled===t.lightbulbEnabled}static _equalsQuickSuggestions(e,t){return"boolean"==typeof e?"boolean"==typeof t&&e===t:"boolean"!=typeof t&&(e.comments===t.comments&&e.other===t.other&&e.strings===t.strings)}}function Pi(e,t){return void 0===e?t:"false"!==e&&Boolean(e)}function Fi(e,t){return"string"!=typeof e?t:e}function Wi(e,t,i){return"string"!=typeof e?t:-1===i.indexOf(e)?t:e}function Vi(e,t,i,n){let s
return void 0===e?s=t:(s=parseInt(e,10),isNaN(s)&&(s=t)),s=Math.max(i,s),0|(s=Math.min(n,s))}function Bi(e,t){if("string"!=typeof e)return t
switch(e){case"hidden":return hi.Hidden
case"visible":return hi.Visible
default:return hi.Auto}}class Hi{static validate(e,t){let i=e.wordWrap
!0===i?i="on":!1===i&&(i="off"),i=Wi(i,t.wordWrap,["off","on","wordWrapColumn","bounded"])
const n=this._sanitizeViewInfo(e,t.viewInfo),s=this._sanitizeContribInfo(e,t.contribInfo)
let r
"string"==typeof e.multiCursorModifier&&(r="ctrlCmd"===e.multiCursorModifier?k?"metaKey":"ctrlKey":"altKey")
const o=Wi(r,t.multiCursorModifier,["altKey","metaKey","ctrlKey"])
return{inDiffEditor:Pi(e.inDiffEditor,t.inDiffEditor),wordSeparators:Fi(e.wordSeparators,t.wordSeparators),lineNumbersMinChars:Vi(e.lineNumbersMinChars,t.lineNumbersMinChars,1,10),lineDecorationsWidth:void 0===e.lineDecorationsWidth?t.lineDecorationsWidth:e.lineDecorationsWidth,readOnly:Pi(e.readOnly,t.readOnly),mouseStyle:Wi(e.mouseStyle,t.mouseStyle,["text","default","copy"]),disableLayerHinting:Pi(e.disableLayerHinting,t.disableLayerHinting),automaticLayout:Pi(e.automaticLayout,t.automaticLayout),wordWrap:i,wordWrapColumn:Vi(e.wordWrapColumn,t.wordWrapColumn,1,1073741824),wordWrapMinified:Pi(e.wordWrapMinified,t.wordWrapMinified),wrappingIndent:(a=e.wrappingIndent,l=t.wrappingIndent,"string"!=typeof a?l:"indent"===a?Ii.Indent:"same"===a?Ii.Same:Ii.None),wordWrapBreakBeforeCharacters:Fi(e.wordWrapBreakBeforeCharacters,t.wordWrapBreakBeforeCharacters),wordWrapBreakAfterCharacters:Fi(e.wordWrapBreakAfterCharacters,t.wordWrapBreakAfterCharacters),wordWrapBreakObtrusiveCharacters:Fi(e.wordWrapBreakObtrusiveCharacters,t.wordWrapBreakObtrusiveCharacters),autoClosingBrackets:Pi(e.autoClosingBrackets,t.autoClosingBrackets),autoIndent:Pi(e.autoIndent,t.autoIndent),dragAndDrop:Pi(e.dragAndDrop,t.dragAndDrop),emptySelectionClipboard:Pi(e.emptySelectionClipboard,t.emptySelectionClipboard),useTabStops:Pi(e.useTabStops,t.useTabStops),multiCursorModifier:o,accessibilitySupport:Wi(e.accessibilitySupport,t.accessibilitySupport,["auto","on","off"]),viewInfo:n,contribInfo:s}
var a,l}static _sanitizeScrollbarOpts(e,t,i){if("object"!=typeof e)return t
const n=Vi(e.horizontalScrollbarSize,t.horizontalScrollbarSize,0,1e3),s=Vi(e.verticalScrollbarSize,t.verticalScrollbarSize,0,1e3)
return{vertical:Bi(e.vertical,t.vertical),horizontal:Bi(e.horizontal,t.horizontal),arrowSize:Vi(e.arrowSize,t.arrowSize,0,1e3),useShadows:Pi(e.useShadows,t.useShadows),verticalHasArrows:Pi(e.verticalHasArrows,t.verticalHasArrows),horizontalHasArrows:Pi(e.horizontalHasArrows,t.horizontalHasArrows),horizontalScrollbarSize:n,horizontalSliderSize:Vi(e.horizontalSliderSize,n,0,1e3),verticalScrollbarSize:s,verticalSliderSize:Vi(e.verticalSliderSize,s,0,1e3),handleMouseWheel:Pi(e.handleMouseWheel,t.handleMouseWheel),mouseWheelScrollSensitivity:i}}static _sanitizeMinimapOpts(e,t){return"object"!=typeof e?t:{enabled:Pi(e.enabled,t.enabled),showSlider:Wi(e.showSlider,t.showSlider,["always","mouseover"]),renderCharacters:Pi(e.renderCharacters,t.renderCharacters),maxColumn:Vi(e.maxColumn,t.maxColumn,1,1e4)}}static _santizeFindOpts(e,t){return"object"!=typeof e?t:{seedSearchStringFromSelection:Pi(e.seedSearchStringFromSelection,t.seedSearchStringFromSelection),autoFindInSelection:Pi(e.autoFindInSelection,t.autoFindInSelection)}}static _sanitizeViewInfo(e,t){let i=[]
if(Array.isArray(e.rulers)){for(let t=0,n=e.rulers.length;t<n;t++)i.push(Vi(e.rulers[t],0,0,1e4))
i.sort()}let n=t.renderLineNumbers,s=t.renderCustomLineNumbers,r=t.renderRelativeLineNumbers
if(void 0!==e.lineNumbers){let t=e.lineNumbers
!0===t?t="on":!1===t&&(t="off"),"function"==typeof t?(n=!0,s=t,r=!1):"relative"===t?(n=!0,s=null,r=!0):"on"===t?(n=!0,s=null,r=!1):(n=!1,s=null,r=!1)}const o=Pi(e.fontLigatures,t.fontLigatures),a=Pi(e.disableMonospaceOptimizations,t.disableMonospaceOptimizations)||o
let l=e.renderWhitespace
!0===l?l="boundary":!1===l&&(l="none"),l=Wi(e.renderWhitespace,t.renderWhitespace,["none","boundary","all"])
let h=e.renderLineHighlight
!0===h?h="line":!1===h&&(h="none"),h=Wi(e.renderLineHighlight,t.renderLineHighlight,["none","gutter","line","all"])
const d=function(e,t){let i=parseFloat(e)
return isNaN(i)&&(i=t),i}(e.mouseWheelScrollSensitivity,t.scrollbar.mouseWheelScrollSensitivity),u=this._sanitizeScrollbarOpts(e.scrollbar,t.scrollbar,d),c=this._sanitizeMinimapOpts(e.minimap,t.minimap)
return{extraEditorClassName:Fi(e.extraEditorClassName,t.extraEditorClassName),disableMonospaceOptimizations:a,rulers:i,ariaLabel:Fi(e.ariaLabel,t.ariaLabel),renderLineNumbers:n,renderCustomLineNumbers:s,renderRelativeLineNumbers:r,selectOnLineNumbers:Pi(e.selectOnLineNumbers,t.selectOnLineNumbers),glyphMargin:Pi(e.glyphMargin,t.glyphMargin),revealHorizontalRightPadding:Vi(e.revealHorizontalRightPadding,t.revealHorizontalRightPadding,0,1e3),roundedSelection:Pi(e.roundedSelection,t.roundedSelection),overviewRulerLanes:Vi(e.overviewRulerLanes,t.overviewRulerLanes,0,3),overviewRulerBorder:Pi(e.overviewRulerBorder,t.overviewRulerBorder),cursorBlinking:function(e,t){if("string"!=typeof e)return t
switch(e){case"blink":return Di.Blink
case"smooth":return Di.Smooth
case"phase":return Di.Phase
case"expand":return Di.Expand
case"visible":case"solid":return Di.Solid}return Di.Blink}(e.cursorBlinking,t.cursorBlinking),mouseWheelZoom:Pi(e.mouseWheelZoom,t.mouseWheelZoom),cursorStyle:(g=e.cursorStyle,m=t.cursorStyle,"string"!=typeof g?m:"line"===g?Oi.Line:"block"===g?Oi.Block:"underline"===g?Oi.Underline:"line-thin"===g?Oi.LineThin:"block-outline"===g?Oi.BlockOutline:"underline-thin"===g?Oi.UnderlineThin:Oi.Line),hideCursorInOverviewRuler:Pi(e.hideCursorInOverviewRuler,t.hideCursorInOverviewRuler),scrollBeyondLastLine:Pi(e.scrollBeyondLastLine,t.scrollBeyondLastLine),smoothScrolling:Pi(e.smoothScrolling,t.smoothScrolling),stopRenderingLineAfter:Vi(e.stopRenderingLineAfter,t.stopRenderingLineAfter,-1,1073741824),renderWhitespace:l,renderControlCharacters:Pi(e.renderControlCharacters,t.renderControlCharacters),fontLigatures:o,renderIndentGuides:Pi(e.renderIndentGuides,t.renderIndentGuides),renderLineHighlight:h,scrollbar:u,minimap:c,fixedOverflowWidgets:Pi(e.fixedOverflowWidgets,t.fixedOverflowWidgets)}
var g,m}static _sanitizeContribInfo(e,t){let i
i="object"==typeof e.quickSuggestions?Object.assign({other:!0},e.quickSuggestions):Pi(e.quickSuggestions,t.quickSuggestions)
const n=this._santizeFindOpts(e.find,t.find)
return{selectionClipboard:Pi(e.selectionClipboard,t.selectionClipboard),hover:Pi(e.hover,t.hover),links:Pi(e.links,t.links),contextmenu:Pi(e.contextmenu,t.contextmenu),quickSuggestions:i,quickSuggestionsDelay:Vi(e.quickSuggestionsDelay,t.quickSuggestionsDelay,-1073741824,1073741824),parameterHints:Pi(e.parameterHints,t.parameterHints),iconsInSuggestions:Pi(e.iconsInSuggestions,t.iconsInSuggestions),formatOnType:Pi(e.formatOnType,t.formatOnType),formatOnPaste:Pi(e.formatOnPaste,t.formatOnPaste),suggestOnTriggerCharacters:Pi(e.suggestOnTriggerCharacters,t.suggestOnTriggerCharacters),acceptSuggestionOnEnter:"string"==typeof e.acceptSuggestionOnEnter?Wi(e.acceptSuggestionOnEnter,t.acceptSuggestionOnEnter,["on","smart","off"]):e.acceptSuggestionOnEnter?"on":"off",acceptSuggestionOnCommitCharacter:Pi(e.acceptSuggestionOnCommitCharacter,t.acceptSuggestionOnCommitCharacter),snippetSuggestions:Wi(e.snippetSuggestions,t.snippetSuggestions,["top","bottom","inline","none"]),wordBasedSuggestions:Pi(e.wordBasedSuggestions,t.wordBasedSuggestions),suggestFontSize:Vi(e.suggestFontSize,t.suggestFontSize,0,1e3),suggestLineHeight:Vi(e.suggestLineHeight,t.suggestLineHeight,0,1e3),selectionHighlight:Pi(e.selectionHighlight,t.selectionHighlight),occurrencesHighlight:Pi(e.occurrencesHighlight,t.occurrencesHighlight),codeLens:Pi(e.codeLens,t.codeLens)&&Pi(e.referenceInfos,!0),folding:Pi(e.folding,t.folding),showFoldingControls:Wi(e.showFoldingControls,t.showFoldingControls,["always","mouseover"]),matchBrackets:Pi(e.matchBrackets,t.matchBrackets),find:n,colorDecorators:Pi(e.colorDecorators,t.colorDecorators),lightbulbEnabled:Pi(!!e.lightbulb&&e.lightbulb.enabled,t.lightbulbEnabled)}}}class zi{static _tweakValidatedOptions(e,t){const i=2===t,n=1===t
return{inDiffEditor:e.inDiffEditor,wordSeparators:e.wordSeparators,lineNumbersMinChars:e.lineNumbersMinChars,lineDecorationsWidth:e.lineDecorationsWidth,readOnly:e.readOnly,mouseStyle:e.mouseStyle,disableLayerHinting:e.disableLayerHinting,automaticLayout:e.automaticLayout,wordWrap:e.wordWrap,wordWrapColumn:e.wordWrapColumn,wordWrapMinified:e.wordWrapMinified,wrappingIndent:e.wrappingIndent,wordWrapBreakBeforeCharacters:e.wordWrapBreakBeforeCharacters,wordWrapBreakAfterCharacters:e.wordWrapBreakAfterCharacters,wordWrapBreakObtrusiveCharacters:e.wordWrapBreakObtrusiveCharacters,autoClosingBrackets:e.autoClosingBrackets,autoIndent:e.autoIndent,dragAndDrop:e.dragAndDrop,emptySelectionClipboard:e.emptySelectionClipboard,useTabStops:e.useTabStops,multiCursorModifier:e.multiCursorModifier,accessibilitySupport:e.accessibilitySupport,viewInfo:{extraEditorClassName:e.viewInfo.extraEditorClassName,disableMonospaceOptimizations:e.viewInfo.disableMonospaceOptimizations,rulers:e.viewInfo.rulers,ariaLabel:n?Jt("accessibilityOffAriaLabel","The editor is not accessible at this time. Press Alt+F1 for options."):e.viewInfo.ariaLabel,renderLineNumbers:e.viewInfo.renderLineNumbers,renderCustomLineNumbers:e.viewInfo.renderCustomLineNumbers,renderRelativeLineNumbers:e.viewInfo.renderRelativeLineNumbers,selectOnLineNumbers:e.viewInfo.selectOnLineNumbers,glyphMargin:e.viewInfo.glyphMargin,revealHorizontalRightPadding:e.viewInfo.revealHorizontalRightPadding,roundedSelection:!i&&e.viewInfo.roundedSelection,overviewRulerLanes:e.viewInfo.overviewRulerLanes,overviewRulerBorder:e.viewInfo.overviewRulerBorder,cursorBlinking:e.viewInfo.cursorBlinking,mouseWheelZoom:e.viewInfo.mouseWheelZoom,cursorStyle:e.viewInfo.cursorStyle,hideCursorInOverviewRuler:e.viewInfo.hideCursorInOverviewRuler,scrollBeyondLastLine:e.viewInfo.scrollBeyondLastLine,smoothScrolling:e.viewInfo.smoothScrolling,stopRenderingLineAfter:e.viewInfo.stopRenderingLineAfter,renderWhitespace:i?"none":e.viewInfo.renderWhitespace,renderControlCharacters:!i&&e.viewInfo.renderControlCharacters,fontLigatures:!i&&e.viewInfo.fontLigatures,renderIndentGuides:!i&&e.viewInfo.renderIndentGuides,renderLineHighlight:e.viewInfo.renderLineHighlight,scrollbar:e.viewInfo.scrollbar,minimap:{enabled:!i&&e.viewInfo.minimap.enabled,renderCharacters:e.viewInfo.minimap.renderCharacters,showSlider:e.viewInfo.minimap.showSlider,maxColumn:e.viewInfo.minimap.maxColumn},fixedOverflowWidgets:e.viewInfo.fixedOverflowWidgets},contribInfo:{selectionClipboard:e.contribInfo.selectionClipboard,hover:e.contribInfo.hover,links:!i&&e.contribInfo.links,contextmenu:e.contribInfo.contextmenu,quickSuggestions:e.contribInfo.quickSuggestions,quickSuggestionsDelay:e.contribInfo.quickSuggestionsDelay,parameterHints:e.contribInfo.parameterHints,iconsInSuggestions:e.contribInfo.iconsInSuggestions,formatOnType:e.contribInfo.formatOnType,formatOnPaste:e.contribInfo.formatOnPaste,suggestOnTriggerCharacters:e.contribInfo.suggestOnTriggerCharacters,acceptSuggestionOnEnter:e.contribInfo.acceptSuggestionOnEnter,acceptSuggestionOnCommitCharacter:e.contribInfo.acceptSuggestionOnCommitCharacter,snippetSuggestions:e.contribInfo.snippetSuggestions,wordBasedSuggestions:e.contribInfo.wordBasedSuggestions,suggestFontSize:e.contribInfo.suggestFontSize,suggestLineHeight:e.contribInfo.suggestLineHeight,selectionHighlight:!i&&e.contribInfo.selectionHighlight,occurrencesHighlight:!i&&e.contribInfo.occurrencesHighlight,codeLens:!i&&e.contribInfo.codeLens,folding:!i&&e.contribInfo.folding,showFoldingControls:e.contribInfo.showFoldingControls,matchBrackets:!i&&e.contribInfo.matchBrackets,find:e.contribInfo.find,colorDecorators:e.contribInfo.colorDecorators,lightbulbEnabled:e.contribInfo.lightbulbEnabled}}}static createInternalEditorOptions(e,t){let i
i="auto"===t.accessibilitySupport?e.accessibilitySupport:"on"===t.accessibilitySupport?2:1
const n=this._tweakValidatedOptions(t,i)
let s
"string"==typeof n.lineDecorationsWidth&&/^\d+(\.\d+)?ch$/.test(n.lineDecorationsWidth)?s=parseFloat(n.lineDecorationsWidth.substr(0,n.lineDecorationsWidth.length-2))*e.fontInfo.typicalHalfwidthCharacterWidth:s=Vi(n.lineDecorationsWidth,0,0,1e3)
n.contribInfo.folding&&(s+=16)
const r=Ui.compute({outerWidth:e.outerWidth,outerHeight:e.outerHeight,showGlyphMargin:n.viewInfo.glyphMargin,lineHeight:e.fontInfo.lineHeight,showLineNumbers:n.viewInfo.renderLineNumbers,lineNumbersMinChars:n.lineNumbersMinChars,lineNumbersDigitCount:e.lineNumbersDigitCount,lineDecorationsWidth:s,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,verticalScrollbarWidth:n.viewInfo.scrollbar.verticalScrollbarSize,horizontalScrollbarHeight:n.viewInfo.scrollbar.horizontalScrollbarSize,scrollbarArrowSize:n.viewInfo.scrollbar.arrowSize,verticalScrollbarHasArrows:n.viewInfo.scrollbar.verticalHasArrows,minimap:n.viewInfo.minimap.enabled,minimapRenderCharacters:n.viewInfo.minimap.renderCharacters,minimapMaxColumn:n.viewInfo.minimap.maxColumn,pixelRatio:e.pixelRatio})
let o=null
{const t=n.wordWrap,s=n.wordWrapColumn,a=n.wordWrapMinified
o=2===i?{isWordWrapMinified:!1,isViewportWrapping:!1,wrappingColumn:-1}:a&&e.isDominatedByLongLines?{isWordWrapMinified:!0,isViewportWrapping:!0,wrappingColumn:Math.max(1,r.viewportColumn)}:"on"===t?{isWordWrapMinified:!1,isViewportWrapping:!0,wrappingColumn:Math.max(1,r.viewportColumn)}:"bounded"===t?{isWordWrapMinified:!1,isViewportWrapping:!0,wrappingColumn:Math.min(Math.max(1,r.viewportColumn),s)}:"wordWrapColumn"===t?{isWordWrapMinified:!1,isViewportWrapping:!1,wrappingColumn:s}:{isWordWrapMinified:!1,isViewportWrapping:!1,wrappingColumn:-1}}const a={inDiffEditor:n.inDiffEditor,isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:o.isWordWrapMinified,isViewportWrapping:o.isViewportWrapping,wrappingColumn:o.wrappingColumn,wrappingIndent:n.wrappingIndent,wordWrapBreakBeforeCharacters:n.wordWrapBreakBeforeCharacters,wordWrapBreakAfterCharacters:n.wordWrapBreakAfterCharacters,wordWrapBreakObtrusiveCharacters:n.wordWrapBreakObtrusiveCharacters}
let l="monaco-editor"
return n.viewInfo.extraEditorClassName&&(l+=" "+n.viewInfo.extraEditorClassName),e.extraEditorClassName&&(l+=" "+e.extraEditorClassName),n.viewInfo.fontLigatures&&(l+=" enable-ligatures"),"default"===n.mouseStyle?l+=" mouse-default":"copy"===n.mouseStyle&&(l+=" mouse-copy"),new Ai({canUseLayerHinting:!n.disableLayerHinting,pixelRatio:e.pixelRatio,editorClassName:l,lineHeight:e.fontInfo.lineHeight,readOnly:n.readOnly,accessibilitySupport:i,multiCursorModifier:n.multiCursorModifier,wordSeparators:n.wordSeparators,autoClosingBrackets:n.autoClosingBrackets,autoIndent:n.autoIndent,useTabStops:n.useTabStops,tabFocusMode:!!n.readOnly||e.tabFocusMode,dragAndDrop:n.dragAndDrop,emptySelectionClipboard:n.emptySelectionClipboard&&e.emptySelectionClipboard,layoutInfo:r,fontInfo:e.fontInfo,viewInfo:n.viewInfo,wrappingInfo:a,contribInfo:n.contribInfo})}}class Ui{static compute(e){const t=0|e.outerWidth,i=0|e.outerHeight,n=e.showGlyphMargin,s=0|e.lineHeight,r=e.showLineNumbers,o=0|e.lineNumbersMinChars,a=0|e.lineNumbersDigitCount,l=0|e.lineDecorationsWidth,h=e.typicalHalfwidthCharacterWidth,d=e.maxDigitWidth,u=0|e.verticalScrollbarWidth,c=e.verticalScrollbarHasArrows,g=0|e.scrollbarArrowSize,m=0|e.horizontalScrollbarHeight,p=e.minimap,f=e.minimapRenderCharacters,_=0|e.minimapMaxColumn,C=e.pixelRatio
let b=0
if(r){const e=Math.max(a,o)
b=Math.round(e*d)}let w=0
n&&(w=s)
const v=0+w,S=v+b,y=S+l,x=t-w-b-l
let L,N,E,k
p?(C>=2?(L=f?Ei.Large:Ei.LargeBlocks,k=2/C):(L=f?Ei.Small:Ei.SmallBlocks,k=1/C),(N=Math.max(0,Math.floor((x-u)*k/(h+k))))/k>_&&(N=Math.floor(_*k)),E=x-N):(N=0,L=Ei.None,E=x)
const I=Math.max(1,Math.floor((E-u)/h)),M=c?g:0
return{width:t,height:i,glyphMarginLeft:0,glyphMarginWidth:w,glyphMarginHeight:i,lineNumbersLeft:v,lineNumbersWidth:b,lineNumbersHeight:i,decorationsLeft:S,decorationsWidth:l,decorationsHeight:i,contentLeft:y,contentWidth:E,contentHeight:i,renderMinimap:L,minimapWidth:N,viewportColumn:I,verticalScrollbarWidth:u,horizontalScrollbarHeight:m,overviewRuler:{top:M,width:u,height:i-2*M,right:0}}}}const Ki={fontFamily:k?"Menlo, Monaco, 'Courier New', monospace":I?"'Droid Sans Mono', 'monospace', monospace, 'Droid Sans Fallback'":"Consolas, 'Courier New', monospace",fontWeight:"normal",fontSize:k?12:14,lineHeight:0,letterSpacing:0},$i={tabSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0},qi={inDiffEditor:!1,wordSeparators:yi,lineNumbersMinChars:5,lineDecorationsWidth:10,readOnly:!1,mouseStyle:"text",disableLayerHinting:!1,automaticLayout:!1,wordWrap:"off",wordWrapColumn:80,wordWrapMinified:!0,wrappingIndent:Ii.Same,wordWrapBreakBeforeCharacters:"([{‘“〈《「『【〔（［｛｢£¥＄￡￥+＋",wordWrapBreakAfterCharacters:" \t})]?|&,;¢°′″‰℃、。｡､￠，．：；？！％・･ゝゞヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻ｧｨｩｪｫｬｭｮｯｰ”〉》」』】〕）］｝｣",wordWrapBreakObtrusiveCharacters:".",autoClosingBrackets:!0,autoIndent:!0,dragAndDrop:!0,emptySelectionClipboard:!0,useTabStops:!0,multiCursorModifier:"altKey",accessibilitySupport:"auto",viewInfo:{extraEditorClassName:"",disableMonospaceOptimizations:!1,rulers:[],ariaLabel:Jt("editorViewAccessibleLabel","Editor content"),renderLineNumbers:!0,renderCustomLineNumbers:null,renderRelativeLineNumbers:!1,selectOnLineNumbers:!0,glyphMargin:!0,revealHorizontalRightPadding:30,roundedSelection:!0,overviewRulerLanes:2,overviewRulerBorder:!0,cursorBlinking:Di.Blink,mouseWheelZoom:!1,cursorStyle:Oi.Line,hideCursorInOverviewRuler:!1,scrollBeyondLastLine:!0,smoothScrolling:!1,stopRenderingLineAfter:1e4,renderWhitespace:"none",renderControlCharacters:!1,fontLigatures:!1,renderIndentGuides:!0,renderLineHighlight:"line",scrollbar:{vertical:hi.Auto,horizontal:hi.Auto,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:10,horizontalSliderSize:10,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,mouseWheelScrollSensitivity:1},minimap:{enabled:!0,showSlider:"mouseover",renderCharacters:!0,maxColumn:120},fixedOverflowWidgets:!1},contribInfo:{selectionClipboard:!0,hover:!0,links:!0,contextmenu:!0,quickSuggestions:{other:!0,comments:!1,strings:!1},quickSuggestionsDelay:10,parameterHints:!0,iconsInSuggestions:!0,formatOnType:!1,formatOnPaste:!1,suggestOnTriggerCharacters:!0,acceptSuggestionOnEnter:"on",acceptSuggestionOnCommitCharacter:!0,snippetSuggestions:"inline",wordBasedSuggestions:!0,suggestFontSize:0,suggestLineHeight:0,selectionHighlight:!0,occurrencesHighlight:!0,codeLens:!0,folding:!0,showFoldingControls:"mouseover",matchBrackets:!0,find:{seedSearchStringFromSelection:!0,autoFindInSelection:!1},colorDecorators:!0,lightbulbEnabled:!0}}
class Gi{constructor(e,t,i){let n=new Uint8Array(e*t)
for(let s=0,r=e*t;s<r;s++)n[s]=i
this._data=n,this._rows=e,this._cols=t}get(e,t){return this._data[e*this._cols+t]}set(e,t,i){this._data[e*this._cols+t]=i}}function ji(e){return e<0?0:e>255?255:0|e}function Yi(e){return e<0?0:e>4294967295?4294967295:0|e}class Zi{constructor(e,t){this.index=e,this.remainder=t}}class Xi{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}getCount(){return this.values.length}insertValues(e,t){e=Yi(e)
const i=this.values,n=this.prefixSum,s=t.length
return 0!==s&&(this.values=new Uint32Array(i.length+s),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e),e+s),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}changeValue(e,t){return e=Yi(e),t=Yi(t),this.values[e]!==t&&(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=Yi(e),t=Yi(t)
const i=this.values,n=this.prefixSum
if(e>=i.length)return!1
let s=i.length-e
return t>=s&&(t=s),0!==t&&(this.values=new Uint32Array(i.length-t),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalValue(){return 0===this.values.length?0:this._getAccumulatedValue(this.values.length-1)}getAccumulatedValue(e){return e<0?0:(e=Yi(e),this._getAccumulatedValue(e))}_getAccumulatedValue(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e]
let t=this.prefixSumValidIndex[0]+1
0===t&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1)
for(let i=t;i<=e;i++)this.prefixSum[i]=this.prefixSum[i-1]+this.values[i]
return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalValue()
let t,i,n,s=0,r=this.values.length-1
for(;s<=r;)if(t=s+(r-s)/2|0,e<(n=(i=this.prefixSum[t])-this.values[t]))r=t-1
else{if(!(e>=i))break
s=t+1}return new Zi(t,e-n)}}class Ji{constructor(e){this._cacheAccumulatedValueStart=0,this._cache=null,this._actual=new Xi(e),this._bustCache()}_bustCache(){this._cacheAccumulatedValueStart=0,this._cache=null}getCount(){return this._actual.getCount()}insertValues(e,t){this._actual.insertValues(e,t)&&this._bustCache()}changeValue(e,t){this._actual.changeValue(e,t)&&this._bustCache()}removeValues(e,t){this._actual.removeValues(e,t)&&this._bustCache()}getTotalValue(){return this._actual.getTotalValue()}getAccumulatedValue(e){return this._actual.getAccumulatedValue(e)}getIndexOf(e){if(e=Math.floor(e),null!==this._cache){let t=e-this._cacheAccumulatedValueStart
if(t>=0&&t<this._cache.length)return this._cache[t]}return this._actual.getIndexOf(e)}warmUpCache(e,t){let i=[]
for(let n=e;n<=t;n++)i[n-e]=this.getIndexOf(n)
this._cache=i,this._cacheAccumulatedValueStart=e}}class Qi{constructor(e){let t=ji(e)
this._defaultValue=t,this._asciiMap=Qi._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){let t=new Uint8Array(256)
for(let i=0;i<256;i++)t[i]=e
return t}set(e,t){let i=ji(t)
e>=0&&e<256?this._asciiMap[e]=i:this._map.set(e,i)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}}class en{constructor(){this._actual=new Qi(0)}add(e){this._actual.set(e,1)}has(e){return 1===this._actual.get(e)}}const tn=function(e){let t={}
return i=>(t.hasOwnProperty(i)||(t[i]=e(i)),t[i])}(e=>new class extends Qi{constructor(e){super(0)
for(let t=0,i=e.length;t<i;t++)this.set(e.charCodeAt(t),2)
this.set(32,1),this.set(9,1)}}(e)),nn=999
class sn{constructor(e,t,i,n){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=n}static _isMultilineRegexSource(e){if(!e||0===e.length)return!1
for(let t=0,i=e.length;t<i;t++){if(92===e.charCodeAt(t)){if(++t>=i)break
const n=e.charCodeAt(t)
if(110===n||114===n)return!0}}return!1}parseSearchRequest(){if(""===this.searchString)return null
let e
e=this.isRegex?sn._isMultilineRegexSource(this.searchString):this.searchString.indexOf("\n")>=0
let t=null
try{t=Ce(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0})}catch(e){return null}if(!t)return null
let i=!this.isRegex&&!e
return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new rn(t,this.wordSeparators?tn(this.wordSeparators):null,i?this.searchString:null)}}class rn{constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}}function on(e,t,i){if(!i)return new g(e,null)
let n=[]
for(let e=0,i=t.length;e<i;e++)n[e]=t[e]
return new g(e,n)}class an{static findMatches(e,t,i,n,s){const r=t.parseSearchRequest()
return r?r.regex.multiline?this._doFindMatchesMultiline(e,i,new hn(r.wordSeparators,r.regex),n,s):this._doFindMatchesLineByLine(e,i,r,n,s):[]}static _getMultilineMatchRange(e,i,n,s,r){let o,a
if("\r\n"===e.getEOL()){let e=0
for(let t=0;t<s;t++){10===n.charCodeAt(t)&&e++}o=i+s+e}else o=i+s
if("\r\n"===e.getEOL()){let e=0
for(let t=0,i=r.length;t<i;t++){10===n.charCodeAt(t+s)&&e++}a=o+r.length+e}else a=o+r.length
const l=e.getPositionAt(o),h=e.getPositionAt(a)
return new t(l.lineNumber,l.column,h.lineNumber,h.column)}static _doFindMatchesMultiline(e,t,i,n,r){const o=e.getOffsetAt(t.getStartPosition()),a=e.getValueInRange(t,s.LF),l=[]
let h,d=0
for(i.reset(0);h=i.next(a);)if(l[d++]=on(this._getMultilineMatchRange(e,o,a,h.index,h[0]),h,n),d>=r)return l
return l}static _doFindMatchesLineByLine(e,t,i,n,s){const r=[]
let o=0
if(t.startLineNumber===t.endLineNumber){const a=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1)
return o=this._findMatchesInLine(i,a,t.startLineNumber,t.startColumn-1,o,r,n,s),r}const a=e.getLineContent(t.startLineNumber).substring(t.startColumn-1)
o=this._findMatchesInLine(i,a,t.startLineNumber,t.startColumn-1,o,r,n,s)
for(let a=t.startLineNumber+1;a<t.endLineNumber&&o<s;a++)o=this._findMatchesInLine(i,e.getLineContent(a),a,0,o,r,n,s)
if(o<s){const a=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1)
o=this._findMatchesInLine(i,a,t.endLineNumber,0,o,r,n,s)}return r}static _findMatchesInLine(e,i,n,s,r,o,a,l){const h=e.wordSeparators
if(!a&&e.simpleSearch){const a=e.simpleSearch,d=a.length,u=i.length
let c=-d
for(;-1!==(c=i.indexOf(a,c+d));)if((!h||ln(h,i,u,c,d))&&(o[r++]=new g(new t(n,c+1+s,n,c+1+d+s),null),r>=l))return r
return r}const d=new hn(e.wordSeparators,e.regex)
let u
d.reset(0)
do{if((u=d.next(i))&&(o[r++]=on(new t(n,u.index+1+s,n,u.index+1+u[0].length+s),u,a),r>=l))return r}while(u)
return r}static findNextMatch(e,t,i,n){const s=t.parseSearchRequest()
if(!s)return null
const r=new hn(s.wordSeparators,s.regex)
return s.regex.multiline?this._doFindNextMatchMultiline(e,i,r,n):this._doFindNextMatchLineByLine(e,i,r,n)}static _doFindNextMatchMultiline(i,n,r,o){const a=new e(n.lineNumber,1),l=i.getOffsetAt(a),h=i.getLineCount(),d=i.getValueInRange(new t(a.lineNumber,a.column,h,i.getLineMaxColumn(h)),s.LF)
r.reset(n.column-1)
let u=r.next(d)
return u?on(this._getMultilineMatchRange(i,l,d,u.index,u[0]),u,o):1!==n.lineNumber||1!==n.column?this._doFindNextMatchMultiline(i,new e(1,1),r,o):null}static _doFindNextMatchLineByLine(e,t,i,n){const s=e.getLineCount(),r=t.lineNumber,o=e.getLineContent(r),a=this._findFirstMatchInLine(i,o,r,t.column,n)
if(a)return a
for(let t=1;t<=s;t++){const o=(r+t-1)%s,a=e.getLineContent(o+1),l=this._findFirstMatchInLine(i,a,o+1,1,n)
if(l)return l}return null}static _findFirstMatchInLine(e,i,n,s,r){e.reset(s-1)
const o=e.next(i)
return o?on(new t(n,o.index+1,n,o.index+1+o[0].length),o,r):null}static findPreviousMatch(e,t,i,n){const s=t.parseSearchRequest()
if(!s)return null
const r=new hn(s.wordSeparators,s.regex)
return s.regex.multiline?this._doFindPreviousMatchMultiline(e,i,r,n):this._doFindPreviousMatchLineByLine(e,i,r,n)}static _doFindPreviousMatchMultiline(i,n,s,r){const o=this._doFindMatchesMultiline(i,new t(1,1,n.lineNumber,n.column),s,r,10*nn)
if(o.length>0)return o[o.length-1]
const a=i.getLineCount()
return n.lineNumber!==a||n.column!==i.getLineMaxColumn(a)?this._doFindPreviousMatchMultiline(i,new e(a,i.getLineMaxColumn(a)),s,r):null}static _doFindPreviousMatchLineByLine(e,t,i,n){const s=e.getLineCount(),r=t.lineNumber,o=e.getLineContent(r).substring(0,t.column-1),a=this._findLastMatchInLine(i,o,r,n)
if(a)return a
for(let t=1;t<=s;t++){const o=(s+r-t-1)%s,a=e.getLineContent(o+1),l=this._findLastMatchInLine(i,a,o+1,n)
if(l)return l}return null}static _findLastMatchInLine(e,i,n,s){let r,o=null
for(e.reset(0);r=e.next(i);)o=on(new t(n,r.index+1,n,r.index+1+r[0].length),r,s)
return o}}function ln(e,t,i,n,s){return function(e,t,i,n,s){if(0===n)return!0
const r=t.charCodeAt(n-1)
if(0!==e.get(r))return!0
if(s>0){const i=t.charCodeAt(n)
if(0!==e.get(i))return!0}return!1}(e,t,0,n,s)&&function(e,t,i,n,s){if(n+s===i)return!0
const r=t.charCodeAt(n+s)
if(0!==e.get(r))return!0
if(s>0){const i=t.charCodeAt(n+s-1)
if(0!==e.get(i))return!0}return!1}(e,t,i,n,s)}class hn{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length
let i
do{if(this._prevMatchStartIndex+this._prevMatchLength===t)return null
if(!(i=this._searchRegex.exec(e)))return null
const n=i.index,s=i[0].length
if(n===this._prevMatchStartIndex&&s===this._prevMatchLength)return null
if(this._prevMatchStartIndex=n,this._prevMatchLength=s,!this._wordSeparators||ln(this._wordSeparators,e,t,n,s))return i}while(i)
return null}}class dn{static fromString(e){let t=0,i=-1
for(;-1!==(i=e.indexOf("\r",i+1));)t++
const n=ze(e),s=!n&&qe(e),r=e.split(/\r\n|\r|\n/)
let o=""
return Qe(r[0])&&(o=Je,r[0]=r[0].substr(1)),{BOM:o,lines:r,length:e.length,containsRTL:n,isBasicASCII:s,totalCRCount:t}}}class un{static _getEOL(e,t){const i=e.lines.length-1
return 0===i?t===o.LF?"\n":"\r\n":e.totalCRCount>i/2?"\r\n":"\n"}static fromRawTextSource(e,t){return{length:e.length,lines:e.lines,BOM:e.BOM,EOL:this._getEOL(e,t),containsRTL:e.containsRTL,isBasicASCII:e.isBasicASCII}}static fromString(e,t){return this.fromRawTextSource(dn.fromString(e),t)}static create(e,t){return"string"==typeof e?this.fromString(e,t):this.fromRawTextSource(e,t)}}const cn={ModelDispose:"modelDispose",ModelTokensChanged:"modelTokensChanged",ModelLanguageChanged:"modelLanguageChanged",ModelOptionsChanged:"modelOptionsChanged",ModelContentChanged:"contentChanged",ModelRawContentChanged2:"rawContentChanged2",ModelDecorationsChanged:"decorationsChanged",ModelLanguageConfigurationChanged:"modelLanguageConfigurationChanged"}
class gn{constructor(){this.changeType=1}}class mn{constructor(e,t){this.changeType=2,this.lineNumber=e,this.detail=t}}class pn{constructor(e,t){this.changeType=3,this.fromLineNumber=e,this.toLineNumber=t}}class fn{constructor(e,t,i){this.changeType=4,this.fromLineNumber=e,this.toLineNumber=t,this.detail=i}}class _n{constructor(){this.changeType=5}}class Cn{constructor(e,t,i,n){this.changes=e,this.versionId=t,this.isUndoing=i,this.isRedoing=n}containsEvent(e){for(let t=0,i=this.changes.length;t<i;t++){if(this.changes[t].changeType===e)return!0}return!1}}const bn=999,wn=1e4
class vn{constructor(e,t){this._eventEmitter=new Dt
const i=vn.resolveCreationData(e,t)
this._isTooLargeForTokenization=i.text.length>vn.MODEL_TOKENIZATION_LIMIT||i.text.lines.length>vn.MANY_MANY_LINES,this._shouldSimplifyMode=this._isTooLargeForTokenization||i.text.length>vn.MODEL_SYNC_LIMIT,this._options=new c(i.options),this._constructLines(i.text),this._setVersionId(1),this._isDisposed=!1,this._isDisposing=!1}static createFromString(e,t=vn.DEFAULT_CREATION_OPTIONS){return new vn(dn.fromString(e),t)}static resolveCreationData(e,t){const i=un.fromRawTextSource(e,t.defaultEOL)
let n
if(t.detectIndentation){const e=jt(i.lines,t.tabSize,t.insertSpaces)
n=new c({tabSize:e.tabSize,insertSpaces:e.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL})}else n=new c({tabSize:t.tabSize,insertSpaces:t.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL})
return{text:i,options:n}}addBulkListener(e){return this._eventEmitter.addBulkListener(e)}_createModelLine(e){return this._isTooLargeForTokenization?new $t(e):new Kt(e)}_assertNotDisposed(){if(this._isDisposed)throw new Error("Model is disposed!")}isTooLargeForHavingARichMode(){return this._shouldSimplifyMode}isTooLargeForTokenization(){return this._isTooLargeForTokenization}getOptions(){return this._assertNotDisposed(),this._options}updateOptions(e){this._assertNotDisposed()
let t=void 0!==e.tabSize?e.tabSize:this._options.tabSize,i=void 0!==e.insertSpaces?e.insertSpaces:this._options.insertSpaces,n=void 0!==e.trimAutoWhitespace?e.trimAutoWhitespace:this._options.trimAutoWhitespace,s=new c({tabSize:t,insertSpaces:i,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:n})
if(this._options.equals(s))return
let r=this._options.createChangeEvent(s)
this._options=s,this._eventEmitter.emit(cn.ModelOptionsChanged,r)}detectIndentation(e,t){this._assertNotDisposed()
let i=jt(this._lines.map(e=>e.text),t,e)
this.updateOptions({insertSpaces:i.insertSpaces,tabSize:i.tabSize})}static _normalizeIndentationFromWhitespace(e,t,i){let n=0
for(let i=0;i<e.length;i++)"\t"===e.charAt(i)?n+=t:n++
let s=""
if(!i){let e=Math.floor(n/t)
n%=t
for(let t=0;t<e;t++)s+="\t"}for(let e=0;e<n;e++)s+=" "
return s}static normalizeIndentation(e,t,i){let n=Le(e)
return-1===n&&(n=e.length),vn._normalizeIndentationFromWhitespace(e.substring(0,n),t,i)+e.substring(n)}normalizeIndentation(e){return this._assertNotDisposed(),vn.normalizeIndentation(e,this._options.tabSize,this._options.insertSpaces)}getOneIndent(){this._assertNotDisposed()
let e=this._options.tabSize
if(this._options.insertSpaces){let t=""
for(let i=0;i<e;i++)t+=" "
return t}return"\t"}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._mightContainRTL}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getOffsetAt(e){this._assertNotDisposed()
let t=this._validatePosition(e.lineNumber,e.column,!1)
return this._lineStarts.getAccumulatedValue(t.lineNumber-2)+t.column-1}getPositionAt(t){this._assertNotDisposed(),t=Math.floor(t),t=Math.max(0,t)
let i=this._lineStarts.getIndexOf(t),n=this._lines[i.index].text.length
return new e(i.index+1,Math.min(i.remainder+1,n+1))}_increaseVersionId(){this._setVersionId(this._versionId+1)}_setVersionId(e){this._versionId=e,this._alternativeVersionId=this._versionId}_overwriteAlternativeVersionId(e){this._alternativeVersionId=e}isDisposed(){return this._isDisposed}dispose(){this._isDisposed=!0,this._lines=null,this._EOL=null,this._BOM=null,this._eventEmitter.dispose()}_emitContentChanged2(e,i,n,s,r,o,a,l,h){const d={changes:[{range:new t(e,i,n,s),rangeLength:r,text:o}],eol:this._EOL,versionId:this.getVersionId(),isUndoing:a,isRedoing:l,isFlush:h}
this._isDisposing||this._eventEmitter.emit(cn.ModelContentChanged,d)}_resetValue(e){this._constructLines(e),this._increaseVersionId()}equals(e){if(this._assertNotDisposed(),this._BOM!==e.BOM)return!1
if(this._EOL!==e.EOL)return!1
if(this._lines.length!==e.lines.length)return!1
for(let t=0,i=this._lines.length;t<i;t++)if(this._lines[t].text!==e.lines[t])return!1
return!0}setValue(e){if(this._assertNotDisposed(),null===e)return
const t=un.fromString(e,this._options.defaultEOL)
this.setValueFromTextSource(t)}setValueFromTextSource(e){if(this._assertNotDisposed(),null!==e){var t=this.getFullModelRange(),i=this.getValueLengthInRange(t),n=this.getLineCount(),s=this.getLineMaxColumn(n)
this._resetValue(e),this._emitModelRawContentChangedEvent(new Cn([new gn],this._versionId,!1,!1)),this._emitContentChanged2(1,1,n,s,i,this.getValue(),!1,!1,!0)}}getValue(e,t=!1){this._assertNotDisposed()
var i=this.getFullModelRange(),n=this.getValueInRange(i,e)
return t?this._BOM+n:n}getValueLength(e,t=!1){this._assertNotDisposed()
var i=this.getFullModelRange(),n=this.getValueLengthInRange(i,e)
return t?this._BOM.length+n:n}getValueInRange(e,t=s.TextDefined){this._assertNotDisposed()
var i=this.validateRange(e)
if(i.isEmpty())return""
if(i.startLineNumber===i.endLineNumber)return this._lines[i.startLineNumber-1].text.substring(i.startColumn-1,i.endColumn-1)
var n=this._getEndOfLine(t),r=i.startLineNumber-1,o=i.endLineNumber-1,a=[]
a.push(this._lines[r].text.substring(i.startColumn-1))
for(var l=r+1;l<o;l++)a.push(this._lines[l].text)
return a.push(this._lines[o].text.substring(0,i.endColumn-1)),a.join(n)}getValueLengthInRange(t,i=s.TextDefined){this._assertNotDisposed()
var n=this.validateRange(t)
if(n.isEmpty())return 0
if(n.startLineNumber===n.endLineNumber)return n.endColumn-n.startColumn
let r=this.getOffsetAt(new e(n.startLineNumber,n.startColumn))
return this.getOffsetAt(new e(n.endLineNumber,n.endColumn))-r}isDominatedByLongLines(){this._assertNotDisposed()
var e,t,i,n=0,s=0,r=this._lines
for(e=0,t=this._lines.length;e<t;e++)(i=r[e].text.length)>=wn?s+=i:n+=i
return s>n}getLineCount(){return this._assertNotDisposed(),this._lines.length}getLineContent(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value "+e+" for `lineNumber`")
return this._lines[e-1].text}getLinesContent(){this._assertNotDisposed()
for(var e=[],t=0,i=this._lines.length;t<i;t++)e[t]=this._lines[t].text
return e}getEOL(){return this._assertNotDisposed(),this._EOL}_onBeforeEOLChange(){}_onAfterEOLChange(){}setEOL(e){this._assertNotDisposed()
const t=e===l.CRLF?"\r\n":"\n"
if(this._EOL===t)return
const i=this.getFullModelRange(),n=this.getValueLengthInRange(i),s=this.getLineCount(),r=this.getLineMaxColumn(s)
this._onBeforeEOLChange(),this._EOL=t,this._constructLineStarts(),this._increaseVersionId(),this._onAfterEOLChange(),this._emitModelRawContentChangedEvent(new Cn([new _n],this._versionId,!1,!1)),this._emitContentChanged2(1,1,s,r,n,this.getValue(),!1,!1,!1)}getLineMinColumn(e){return this._assertNotDisposed(),1}getLineMaxColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value "+e+" for `lineNumber`")
return this._lines[e-1].text.length+1}getLineFirstNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value "+e+" for `lineNumber`")
var t=Le(this._lines[e-1].text)
return-1===t?0:t+1}getLineLastNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value "+e+" for `lineNumber`")
var t=Ee(this._lines[e-1].text)
return-1===t?0:t+2}validateLineNumber(e){return this._assertNotDisposed(),e<1&&(e=1),e>this._lines.length&&(e=this._lines.length),e}_validateRangeRelaxedNoAllocations(e){const i=this._lines.length,n=e.startLineNumber,s=e.startColumn
let r,o
if(n<1)r=1,o=1
else if(n>i)r=i,o=this.getLineMaxColumn(r)
else if(r=0|n,s<=1)o=1
else{const e=this.getLineMaxColumn(r)
o=s>=e?e:0|s}const a=e.endLineNumber,l=e.endColumn
let h,d
if(a<1)h=1,d=1
else if(a>i)h=i,d=this.getLineMaxColumn(h)
else if(h=0|a,l<=1)d=1
else{const e=this.getLineMaxColumn(h)
d=l>=e?e:0|l}return n===r&&s===o&&a===h&&l===d&&e instanceof t&&!(e instanceof At)?e:new t(r,o,h,d)}_validatePosition(t,i,n){const s=Math.floor("number"==typeof t?t:1),r=Math.floor("number"==typeof i?i:1)
if(s<1)return new e(1,1)
if(s>this._lines.length)return new e(this._lines.length,this.getLineMaxColumn(this._lines.length))
if(r<=1)return new e(s,1)
const o=this.getLineMaxColumn(s)
if(r>=o)return new e(s,o)
if(n&&Ve(this._lines[s-1].text.charCodeAt(r-2)))return new e(s,r-1)
return new e(s,r)}validatePosition(e){return this._assertNotDisposed(),this._validatePosition(e.lineNumber,e.column,!0)}validateRange(e){this._assertNotDisposed()
const i=this._validatePosition(e.startLineNumber,e.startColumn,!1),n=this._validatePosition(e.endLineNumber,e.endColumn,!1),s=i.lineNumber,r=i.column,o=n.lineNumber,a=n.column,l=this._lines[s-1].text,h=this._lines[o-1].text,d=r>1?l.charCodeAt(r-2):0,u=a>1&&a<=h.length?h.charCodeAt(a-2):0,c=Ve(d),g=Ve(u)
return c||g?s===o&&r===a?new t(s,r-1,o,a-1):c&&g?new t(s,r-1,o,a+1):c?new t(s,r-1,o,a):new t(s,r,o,a+1):new t(s,r,o,a)}modifyPosition(e,t){return this._assertNotDisposed(),this.getPositionAt(this.getOffsetAt(e)+t)}getFullModelRange(){this._assertNotDisposed()
var e=this.getLineCount()
return new t(1,1,e,this.getLineMaxColumn(e))}_emitModelRawContentChangedEvent(e){this._isDisposing||this._eventEmitter.emit(cn.ModelRawContentChanged2,e)}_constructLines(e){let t=e.lines,i=new Array(t.length)
for(let e=0,n=t.length;e<n;e++)i[e]=this._createModelLine(t[e])
this._BOM=e.BOM,this._mightContainRTL=e.containsRTL,this._mightContainNonBasicASCII=!e.isBasicASCII,this._EOL=e.EOL,this._lines=i,this._constructLineStarts()}_constructLineStarts(){const e=this._EOL.length,t=this._lines.length,i=new Uint32Array(t)
for(let n=0;n<t;n++)i[n]=this._lines[n].text.length+e
this._lineStarts=new Xi(i)}_getEndOfLine(e){switch(e){case s.LF:return"\n"
case s.CRLF:return"\r\n"
case s.TextDefined:return this.getEOL()}throw new Error("Unknown EOL preference")}findMatches(e,i,n,s,r,o,a=bn){let l
return this._assertNotDisposed(),l=t.isIRange(i)?this.validateRange(i):this.getFullModelRange(),an.findMatches(this,new sn(e,n,s,r),l,o,a)}findNextMatch(e,t,i,n,s,r){this._assertNotDisposed()
const o=this.validatePosition(t)
return an.findNextMatch(this,new sn(e,i,n,s),o,r)}findPreviousMatch(e,t,i,n,s,r){this._assertNotDisposed()
const o=this.validatePosition(t)
return an.findPreviousMatch(this,new sn(e,i,n,s),o,r)}}var Sn,yn
vn.MODEL_SYNC_LIMIT=52428800,vn.MODEL_TOKENIZATION_LIMIT=20971520,vn.MANY_MANY_LINES=3e5,vn.DEFAULT_CREATION_OPTIONS={tabSize:$i.tabSize,insertSpaces:$i.insertSpaces,detectIndentation:!1,defaultEOL:o.LF,trimAutoWhitespace:$i.trimAutoWhitespace},(yn=Sn||(Sn={}))[yn.None=0]="None",yn[yn.Indent=1]="Indent",yn[yn.IndentOutdent=2]="IndentOutdent",yn[yn.Outdent=3]="Outdent"
class xn{constructor(e){if(this.open=e.open,this.close=e.close,this._standardTokenMask=0,Array.isArray(e.notIn))for(let t=0,i=e.notIn.length;t<i;t++){switch(e.notIn[t]){case"string":this._standardTokenMask|=2
break
case"comment":this._standardTokenMask|=1
break
case"regex":this._standardTokenMask|=4}}}isOK(e){return 0==(this._standardTokenMask&e)}}class Ln{constructor(e){e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map(e=>new xn(e)):e.brackets?this._autoClosingPairs=e.brackets.map(e=>new xn({open:e[0],close:e[1]})):this._autoClosingPairs=[],this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}shouldAutoClosePair(e,t,i){if(0===t.getTokenCount())return!0
let n=t.findTokenIndexAtOffset(i-2),s=t.getStandardTokenType(n)
for(let t=0;t<this._autoClosingPairs.length;++t){let i=this._autoClosingPairs[t]
if(i.open===e)return i.isOK(s)}return!0}getSurroundingPairs(){return this._surroundingPairs}}function Nn(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n
if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n)
else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o)
return r>3&&o&&Object.defineProperty(t,i,o),o}function En(e,t){return function(i,n){t(i,n,e)}}function kn(e,t=0){return e[e.length-(1+t)]}function In(e,t,i=((e,t)=>e===t)){if(e.length!==t.length)return!1
for(let n=0,s=e.length;n<s;n++)if(!i(e[n],t[n]))return!1
return!0}function Mn(e,t){return function e(t,i){if(t.length<=1)return
const n=t.length/2|0
const s=t.slice(0,n)
const r=t.slice(n)
e(s,i)
e(r,i)
let o=0
let a=0
let l=0
for(;o<s.length&&a<r.length;){let e=i(s[o],r[a])
t[l++]=e<=0?s[o++]:r[a++]}for(;o<s.length;)t[l++]=s[o++]
for(;a<r.length;)t[l++]=r[a++]}(e,t),e}function Dn(e,t){const i=[]
let n
for(const s of Mn(e.slice(0),t))n&&0===t(n[0],s)?n.push(s):(n=[s],i.push(n))
return i}function Tn(e){return!Array.isArray(e)||0===e.length}function On(e,t){if(!t)return e.filter((t,i)=>e.indexOf(t)===i)
const i=Object.create(null)
return e.filter(e=>{const n=t(e)
return!i[n]&&(i[n]=!0,!0)})}function Rn(e,t){for(let i=0;i<e.length;i++){if(t(e[i]))return i}return-1}function An(e,t,i=null){const n=Rn(e,t)
return n<0?i:e[n]}function Pn(e,t){let i="number"==typeof t?e:0
"number"==typeof t?i=e:(i=0,t=e)
const n=[]
if(i<=t)for(let e=i;e<t;e++)n.push(e)
else for(let e=i;e>t;e--)n.push(e)
return n}function Fn(e,t,i){const n=e.slice(0,t),s=e.slice(t)
return n.concat(i,s)}function Wn(e){if(!e||"object"!=typeof e)return e
if(e instanceof RegExp)return e
const t=Array.isArray(e)?[]:{}
return Object.keys(e).forEach(i=>{e[i]&&"object"==typeof e[i]?t[i]=Wn(e[i]):t[i]=e[i]}),t}function Vn(e,t,i=!0){return ot(e)?(ot(t)&&Object.keys(t).forEach(n=>{n in e?i&&(ot(e[n])&&ot(t[n])?Vn(e[n],t[n],i):e[n]=t[n]):e[n]=t[n]}),e):t}function Bn(e,...t){return t.forEach(t=>Object.keys(t).forEach(i=>e[i]=t[i])),e}function Hn(e,t){if(e===t)return!0
if(null===e||void 0===e||null===t||void 0===t)return!1
if(typeof e!=typeof t)return!1
if("object"!=typeof e)return!1
if(Array.isArray(e)!==Array.isArray(t))return!1
let i,n
if(Array.isArray(e)){if(e.length!==t.length)return!1
for(i=0;i<e.length;i++)if(!Hn(e[i],t[i]))return!1}else{const s=[]
for(n in e)s.push(n)
s.sort()
const r=[]
for(n in t)r.push(n)
if(r.sort(),!Hn(s,r))return!1
for(i=0;i<s.length;i++)if(!Hn(e[s[i]],t[s[i]]))return!1}return!0}function zn(e,t=!1){t&&(e=e.map(function(e){return e.toLowerCase()}))
const i=function(e){const t={}
for(let i=0;i<e.length;++i)t[e[i]]=!0
return t}(e)
return t?function(e){return void 0!==i[e.toLowerCase()]&&i.hasOwnProperty(e.toLowerCase())}:function(e){return void 0!==i[e]&&i.hasOwnProperty(e)}}const Un="/",Kn=E?"\\":"/"
function $n(e){const t=~e.lastIndexOf("/")||~e.lastIndexOf("\\")
if(0===t)return"."
if(0==~t)return e[0]
{let i=e.substring(0,~t)
return E&&":"===i[i.length-1]&&(i+=Kn),i}}function qn(e){const t=~e.lastIndexOf("/")||~e.lastIndexOf("\\")
return 0===t?e:~t==e.length-1?qn(e.substring(0,e.length-1)):e.substr(1+~t)}const Gn=/(\/\.\.?\/)|(\/\.\.?)$|^(\.\.?\/)|(\/\/+)|(\\)/,jn=/(\\\.\.?\\)|(\\\.\.?)$|^(\.\.?\\)|(\\\\+)|(\/)/
function Yn(e,t){if(null===e||void 0===e)return e
const i=e.length
if(0===i)return"."
const n=E&&t
if(s=e,n?!jn.test(s):!Gn.test(s))return e
var s
const r=n?"\\":"/",o=function(e,t="/"){if(!e)return""
let i=e.length,n=e.charCodeAt(0)
if(47===n||92===n){if((47===(n=e.charCodeAt(1))||92===n)&&47!==(n=e.charCodeAt(2))&&92!==n){let s=3,r=s
for(;s<i&&(47!==(n=e.charCodeAt(s))&&92!==n);s++);if(n=e.charCodeAt(s+1),r!==s&&47!==n&&92!==n)for(s+=1;s<i;s++)if(47===(n=e.charCodeAt(s))||92===n)return e.slice(0,s+1).replace(/[\\/]/g,t)}return t}if((n>=65&&n<=90||n>=97&&n<=122)&&58===e.charCodeAt(1))return 47===(n=e.charCodeAt(2))||92===n?e.slice(0,2)+t:e.slice(0,2)
let s=e.indexOf("://")
if(-1!==s)for(s+=3;s<i;s++)if(47===(n=e.charCodeAt(s))||92===n)return e.slice(0,s+1)
return""}(e,r)
let a=o.length,l=!1,h=""
for(let t=o.length;t<=i;t++)if(t===i||47===e.charCodeAt(t)||92===e.charCodeAt(t)){if(Zn(e,a,t,"..")){let e=h.lastIndexOf(r),t=h.slice(e+1);(o||t.length>0)&&".."!==t&&(h=-1===e?"":h.slice(0,e),l=!0)}else Zn(e,a,t,".")&&(o||h||t<i-1)&&(l=!0)
if(!l){let i=e.slice(a,t)
""!==h&&h[h.length-1]!==r&&(h+=r),h+=i}a=t+1,l=!1}return o+h}function Zn(e,t,i,n){return t+n.length===i&&e.indexOf(n,t)===t}const Xn=function(){let e=""
for(let t=0;t<arguments.length;t++){let i=arguments[t]
if(t>0){let t=e.charCodeAt(e.length-1)
if(47!==t&&92!==t){let t=i.charCodeAt(0)
47!==t&&92!==t&&(e+=Un)}}e+=i}return Yn(e)}
function Jn(e,t,i){if(e===t)return!0
if(!e||!t)return!1
if(t.length>e.length)return!1
if(i){if(!Ae(e,t))return!1
if(t.length===e.length)return!0
let i=t.length
return t.charAt(t.length-1)===Kn&&i--,e.charAt(i)===Kn}return t.charAt(t.length-1)!==Kn&&(t+=Kn),0===e.indexOf(t)}const Qn="**",es="/",ts="[/\\\\]",is="[^/\\\\]",ns=/\//g
function ss(e){switch(e){case 0:return""
case 1:return`${is}*?`
default:return`(?:${ts}|${is}+${ts}|${ts}${is}+)*?`}}function rs(e,t){if(!e)return[]
let i,n=[],s=!1,r=!1,o=""
for(let a=0;a<e.length;a++){switch(i=e[a]){case t:if(!s&&!r){n.push(o),o=""
continue}break
case"{":s=!0
break
case"}":s=!1
break
case"[":r=!0
break
case"]":r=!1}o+=i}return o&&n.push(o),n}const os=/^\*\*\/\*\.[\w\.-]+$/,as=/^\*\*\/([\w\.-]+)\/?$/,ls=/^{\*\*\/[\*\.]?[\w\.-]+\/?(,\*\*\/[\*\.]?[\w\.-]+\/?)*}$/,hs=/^{\*\*\/[\*\.]?[\w\.-]+(\/(\*\*)?)?(,\*\*\/[\*\.]?[\w\.-]+(\/(\*\*)?)?)*}$/,ds=/^\*\*((\/[\w\.-]+)+)\/?$/,us=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,cs=new te(1e4),gs=function(){return!1},ms=function(){return null}
function ps(e,t){if(!e)return ms
let i
const n=`${i=(i="string"!=typeof e?e.pattern:e).trim()}_${!!t.trimForExclusions}`
let s,r=cs.get(n)
if(r)return fs(r,e)
if(os.test(i)){const e=i.substr(4)
r=function(t,n){return t&&_e(t,e)?i:null}}else r=(s=as.exec(_s(i,t)))?function(e,t){const i=`/${e}`,n=`\\${e}`,s=function(s,r){return s?r?r===e?t:null:s===e||_e(s,i)||_e(s,n)?t:null:null},r=[e]
return s.basenames=r,s.patterns=[t],s.allBasenames=r,s}(s[1],i):(t.trimForExclusions?hs:ls).test(i)?function(e,t){const i=ws(e.slice(1,-1).split(",").map(e=>ps(e,t)).filter(e=>e!==ms),e),n=i.length
if(!n)return ms
if(1===n)return i[0]
const s=function(t,n){for(let s=0,r=i.length;s<r;s++)if(i[s](t,n))return e
return null},r=An(i,e=>!!e.allBasenames)
r&&(s.allBasenames=r.allBasenames)
const o=i.reduce((e,t)=>t.allPaths?e.concat(t.allPaths):e,[])
o.length&&(s.allPaths=o)
return s}(i,t):(s=ds.exec(_s(i,t)))?Cs(s[1].substr(1),i,!0):(s=us.exec(_s(i,t)))?Cs(s[1],i,!1):function(e){try{const t=new RegExp(`^${function e(t){if(!t)return""
let i="",n=rs(t,es)
if(n.every(e=>e===Qn))i=".*"
else{let t=!1
n.forEach((s,r)=>{if(s===Qn)return void(t||(i+=ss(2),t=!0))
let o,a=!1,l="",h=!1,d=""
for(let t=0;t<s.length;t++)if("}"!==(o=s[t])&&a)l+=o
else if("]"!==o&&h){let e
switch(o){case"-":case"^":e=o
break
default:e=ue(o)}d+=e}else switch(o){case"{":a=!0
continue
case"[":h=!0
continue
case"}":let t=`(?:${rs(l,",").map(t=>e(t)).join("|")})`
i+=t,a=!1,l=""
break
case"]":i+="["+d+"]",h=!1,d=""
break
case"?":i+=is
continue
case"*":i+=ss(1)
continue
default:i+=ue(o)}r<n.length-1&&n[r+1]!==Qn&&(i+=ts),t=!1})}return i}(e)}$`)
return function(i,n){return t.lastIndex=0,i&&t.test(i)?e:null}}catch(e){return ms}}(i)
return cs.set(n,r),fs(r,e)}function fs(e,t){return"string"==typeof t?e:function(i,n){return Jn(i,t.base)?e(function(e,t){const i=me(Yn(e),Un),n=me(Yn(t),Un),s=I?i:i.toLowerCase(),r=I?n:n.toLowerCase(),o=s.split(Un),a=r.split(Un)
let l=0,h=Math.min(o.length,a.length)
for(;l<h&&o[l]===a[l];l++);return[...function(e,t,i=[]){for(let n=0;n<e;n++)i[n]=t()
return i}(o.length-l,()=>".."),...n.split(Un).slice(l)].join(Un)}(t.base,i),n):null}}function _s(e,t){return t.trimForExclusions&&_e(e,"/**")?e.substr(0,e.length-2):e}function Cs(e,t,i){const n=Kn!==Un?e.replace(ns,Kn):e,s=Kn+n,r=i?function(e,i){return e&&(e===n||_e(e,s))?t:null}:function(e,i){return e&&e===n?t:null}
return r.allPaths=[(i?"*/":"./")+e],r}function bs(e,t,i){return!(!e||!t)&&function(e,t={}){if(!e)return gs
if("string"==typeof e||function(e){const t=e
return"string"==typeof t.base&&"string"==typeof t.pattern}(e)){const i=ps(e,t)
if(i===ms)return gs
const n=function(e,t){return!!i(e,t)}
return i.allBasenames&&(n.allBasenames=i.allBasenames),i.allPaths&&(n.allPaths=i.allPaths),n}return function(e,t){const i=ws(Object.getOwnPropertyNames(e).map(i=>(function(e,t,i){if(!1===t)return ms
const n=ps(e,i)
if(n===ms)return ms
if("boolean"==typeof t)return n
if(t){const i=t.when
if("string"==typeof i){const t=t=>{let n=i.replace("$(basename)",t.name)
return-1!==t.siblings.indexOf(n)?e:null},s=(e,i,s)=>{if(!n(e,i))return null
const r=s()
return r?bt.is(r)?r.then(t):t(r):null}
return s.requiresSiblings=!0,s}}return n})(i,e[i],t)).filter(e=>e!==ms)),n=i.length
if(!n)return ms
if(!i.some(e=>e.requiresSiblings)){if(1===n)return i[0]
const e=function(e,t,n){for(let n=0,s=i.length;n<s;n++){const s=i[n](e,t)
if(s)return s}return null},t=An(i,e=>!!e.allBasenames)
t&&(e.allBasenames=t.allBasenames)
const s=i.reduce((e,t)=>t.allPaths?e.concat(t.allPaths):e,[])
return s.length&&(e.allPaths=s),e}const s=function(e,t,n){let s,r=!n
function o(i){if(i&&i.length){t||(t=qn(e))
const n=t.substr(0,t.length-function(e){const t=~(e=qn(e)).lastIndexOf(".")
return t?e.substring(~t):""}(e).length)
return{siblings:i,name:n}}}function a(){if(!r){r=!0
const e=n()
s=bt.is(e)?e.then(o):o(e)}return s}for(let n=0,s=i.length;n<s;n++){const s=i[n](e,t,a)
if(s)return s}return null},r=An(i,e=>!!e.allBasenames)
r&&(s.allBasenames=r.allBasenames)
const o=i.reduce((e,t)=>t.allPaths?e.concat(t.allPaths):e,[])
o.length&&(s.allPaths=o)
return s}(e,t)}(e)(t,void 0,i)}function ws(e,t){const i=e.filter(e=>!!e.basenames)
if(i.length<2)return e
const n=i.reduce((e,t)=>e.concat(t.basenames),[])
let s
if(t){s=[]
for(let e=0,i=n.length;e<i;e++)s.push(t)}else s=i.reduce((e,t)=>e.concat(t.patterns),[])
const r=function(e,t){if(!e)return null
if(!t){let i
for(i=e.length;i>0;i--){const t=e.charCodeAt(i-1)
if(47===t||92===t)break}t=e.substr(i)}const i=n.indexOf(t)
return-1!==i?s[i]:null}
r.basenames=n,r.patterns=s,r.allBasenames=n
const o=e.filter(e=>!e.basenames)
return o.push(r),o}function vs(e,t,i){if(Array.isArray(e)){let n=0
for(const s of e){const e=vs(s,t,i)
if(10===e)return e
e>n&&(n=e)}return n}if("string"==typeof e)return"*"===e?5:e===i?10:0
if(e){const{language:n,pattern:s,scheme:r}=e
let o=0
if(r)if(r===t.scheme)o=10
else{if("*"!==r)return 0
o=5}if(n)if(n===i)o=10
else{if("*"!==n)return 0
o=Math.max(o,5)}if(s){if(s!==t.fsPath&&!bs(s,t.fsPath))return 0
o=10}return o}return 0}class Ss{constructor(){this._clock=0,this._entries=[],this._onDidChange=new ci}get onDidChange(){return this._onDidChange.event}register(e,t){let i={selector:e,provider:t,_score:-1,_time:this._clock++}
return this._entries.push(i),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),{dispose:()=>{if(i){let e=this._entries.indexOf(i)
e>=0&&(this._entries.splice(e,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),i=void 0)}}}}has(e){return this.all(e).length>0}all(e){if(!e||e.isTooLargeForHavingARichMode())return[]
this._updateScores(e)
const t=[]
for(let e of this._entries)e._score>0&&t.push(e.provider)
return t}ordered(e){const t=[]
return this._orderedForEach(e,e=>t.push(e.provider)),t}orderedGroups(e){const t=[]
let i,n
return this._orderedForEach(e,e=>{i&&n===e._score?i.push(e.provider):(n=e._score,i=[e.provider],t.push(i))}),t}_orderedForEach(e,t){if(e&&!e.isTooLargeForHavingARichMode()){this._updateScores(e)
for(let e=0;e<this._entries.length;e++){let i=this._entries[e]
i._score>0&&t(i)}}}_updateScores(e){let t={uri:e.uri.toString(),language:e.getLanguageIdentifier().language}
if(!this._lastCandidate||this._lastCandidate.language!==t.language||this._lastCandidate.uri!==t.uri){this._lastCandidate=t
for(let t of this._entries)t._score=vs(t.selector,e.uri,e.getLanguageIdentifier().language)
this._entries.sort(Ss._compareByScoreAndTime)}}static _compareByScoreAndTime(e,t){return e._score<t._score?1:e._score>t._score?-1:e._time<t._time?1:e._time>t._time?-1:0}}class ys{constructor(e,t){this.language=e,this.id=t}}var xs,Ls,Ns,Es,ks,Is;(Ls=xs||(xs={}))[Ls.Invoke=0]="Invoke",Ls[Ls.TriggerCharacter=1]="TriggerCharacter",(Es=Ns||(Ns={}))[Es.Text=0]="Text",Es[Es.Read=1]="Read",Es[Es.Write=2]="Write",(Is=ks||(ks={}))[Is.File=0]="File",Is[Is.Module=1]="Module",Is[Is.Namespace=2]="Namespace",Is[Is.Package=3]="Package",Is[Is.Class=4]="Class",Is[Is.Method=5]="Method",Is[Is.Property=6]="Property",Is[Is.Field=7]="Field",Is[Is.Constructor=8]="Constructor",Is[Is.Enum=9]="Enum",Is[Is.Interface=10]="Interface",Is[Is.Function=11]="Function",Is[Is.Variable=12]="Variable",Is[Is.Constant=13]="Constant",Is[Is.String=14]="String",Is[Is.Number=15]="Number",Is[Is.Boolean=16]="Boolean",Is[Is.Array=17]="Array",Is[Is.Object=18]="Object",Is[Is.Key=19]="Key",Is[Is.Null=20]="Null",Is[Is.EnumMember=21]="EnumMember",Is[Is.Struct=22]="Struct",Is[Is.Event=23]="Event",Is[Is.Operator=24]="Operator",Is[Is.TypeParameter=25]="TypeParameter"
const Ms=function(){const e=Object.create(null)
return e[ks.File]="file",e[ks.Module]="module",e[ks.Namespace]="namespace",e[ks.Package]="package",e[ks.Class]="class",e[ks.Method]="method",e[ks.Property]="property",e[ks.Field]="field",e[ks.Constructor]="constructor",e[ks.Enum]="enum",e[ks.Interface]="interface",e[ks.Function]="function",e[ks.Variable]="variable",e[ks.Constant]="constant",e[ks.String]="string",e[ks.Number]="number",e[ks.Boolean]="boolean",e[ks.Array]="array",e[ks.Object]="object",e[ks.Key]="key",e[ks.Null]="null",e[ks.EnumMember]="enum-member",e[ks.Struct]="struct",e[ks.Event]="event",e[ks.Operator]="operator",e[ks.TypeParameter]="type-parameter",function(t){return e[t]||"property"}}(),Ds=new Ss,Ts=new Ss,Os=new Ss,Rs=new Ss,As=new Ss,Ps=new Ss,Fs=new Ss,Ws=new Ss,Vs=new Ss,Bs=new Ss,Hs=new Ss,zs=new Ss,Us=new Ss,Ks=new Ss,$s=new Ss,qs=new Ss,Gs=new Ss,js=new class{constructor(){this._onDidChange=new ci,this.onDidChange=this._onDidChange.event,this._map=Object.create(null),this._colorMap=null}fire(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._map[e]=t,this.fire([e]),{dispose:()=>{this._map[e]===t&&(delete this._map[e],this.fire([e]))}}}get(e){return this._map[e]||null}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Object.keys(this._map),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultForeground(){return this._colorMap[1]}getDefaultBackground(){return this._colorMap[2]}}
function Ys(e,t){let i=e.getTokenCount(),n=e.findTokenIndexAtOffset(t),s=e.getLanguageId(n),r=n
for(;r+1<i&&e.getLanguageId(r+1)===s;)r++
let o=n
for(;o>0&&e.getLanguageId(o-1)===s;)o--
return new Zs(e,s,o,r+1,e.getTokenStartOffset(o),e.getTokenEndOffset(r))}class Zs{constructor(e,t,i,n,s,r){this._actual=e,this.languageId=t,this._firstTokenIndex=i,this._lastTokenIndex=n,this.firstCharOffset=s,this._lastCharOffset=r}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getTokenStartOffset(e){return this._actual.getTokenStartOffset(e+this._firstTokenIndex)-this.firstCharOffset}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}}function Xs(e){return 0!=(7&e)}class Js{constructor(e,t,i,n,s){this.languageIdentifier=e,this.open=t,this.close=i,this.forwardRegex=n,this.reversedRegex=s}}class Qs{constructor(e,t){this.brackets=t.map(t=>new Js(e,t[0],t[1],tr({open:t[0],close:t[1]}),ir({open:t[0],close:t[1]}))),this.forwardRegex=nr(this.brackets),this.reversedRegex=sr(this.brackets),this.textIsBracket={},this.textIsOpenBracket={}
let i=0
this.brackets.forEach(e=>{this.textIsBracket[e.open.toLowerCase()]=e,this.textIsBracket[e.close.toLowerCase()]=e,this.textIsOpenBracket[e.open.toLowerCase()]=!0,this.textIsOpenBracket[e.close.toLowerCase()]=!1,i=Math.max(i,e.open.length),i=Math.max(i,e.close.length)}),this.maxBracketLength=i}}function er(e,t){let i={}
return n=>{let s=e(n)
return i.hasOwnProperty(s)||(i[s]=t(n)),i[s]}}var tr=er(e=>`${e.open};${e.close}`,e=>rr([e.open,e.close])),ir=er(e=>`${e.open};${e.close}`,e=>rr([or(e.open),or(e.close)])),nr=er(e=>e.map(e=>`${e.open};${e.close}`).join(";"),e=>{let t=[]
return e.forEach(e=>{t.push(e.open),t.push(e.close)}),rr(t)}),sr=er(e=>e.map(e=>`${e.open};${e.close}`).join(";"),e=>{let t=[]
return e.forEach(e=>{t.push(or(e.open)),t.push(or(e.close))}),rr(t)})
function rr(e){return Ce(`(${e.map(ue).join(")|(")})`,!0)}let or=function(){let e=null,t=null
return function(i){return e!==i&&(t=function(e){let t=""
for(let i=e.length-1;i>=0;i--)t+=e.charAt(i)
return t}(e=i)),t}}()
class ar{static _findPrevBracketInText(e,i,n,s){let r=n.match(e)
if(!r)return null
let o=n.length-r.index,a=r[0].length,l=s+o
return new t(i,l-a+1,i,l+1)}static findPrevBracketInToken(e,t,i,n,s){let r=or(i).substring(i.length-s,i.length-n)
return this._findPrevBracketInText(e,t,r,n)}static findNextBracketInText(e,i,n,s){let r=n.match(e)
if(!r)return null
let o=r.index,a=r[0].length,l=s+o
return new t(i,l+1,i,l+1+a)}static findNextBracketInToken(e,t,i,n,s){let r=i.substring(n,s)
return this.findNextBracketInText(e,t,r,n)}}class lr{constructor(e,t,i){i=i||{},this._richEditBrackets=e,this._complexAutoClosePairs=t.filter(e=>e.open.length>1&&!!e.close).map(e=>new xn(e)),i.docComment&&this._complexAutoClosePairs.push(new xn({open:i.docComment.open,close:i.docComment.close}))}getElectricCharacters(){var e=[]
if(this._richEditBrackets)for(let t=0,i=this._richEditBrackets.brackets.length;t<i;t++){let i=this._richEditBrackets.brackets[t],n=i.close.charAt(i.close.length-1)
e.push(n)}for(let t of this._complexAutoClosePairs)e.push(t.open.charAt(t.open.length-1))
return e=e.filter((e,t,i)=>i.indexOf(e)===t)}onElectricCharacter(e,t,i){return this._onElectricAutoClose(e,t,i)||this._onElectricAutoIndent(e,t,i)}_onElectricAutoIndent(e,t,i){if(!this._richEditBrackets||0===this._richEditBrackets.brackets.length)return null
let n=t.findTokenIndexAtOffset(i-1)
if(Xs(t.getStandardTokenType(n)))return null
let s=this._richEditBrackets.reversedRegex,r=t.getLineContent().substring(0,i-1)+e,o=ar.findPrevBracketInToken(s,1,r,0,r.length)
if(!o)return null
let a=r.substring(o.startColumn-1,o.endColumn-1)
if(a=a.toLowerCase(),this._richEditBrackets.textIsOpenBracket[a])return null
let l=r.substring(0,o.startColumn-1)
return/^\s*$/.test(l)?{matchOpenBracket:a}:null}_onElectricAutoClose(e,t,i){if(!this._complexAutoClosePairs.length)return null
let n=t.getLineContent()
for(let s=0,r=this._complexAutoClosePairs.length;s<r;s++){let r=this._complexAutoClosePairs[s]
if(e!==r.open.charAt(r.open.length-1))continue
if(n.substring(n.length-r.open.length+1)+e!==r.open)continue
let o=t.findTokenIndexAtOffset(i-1),a=t.getStandardTokenType(o)
if(r.isOK(a)&&!(n.indexOf(r.close,i-1)>=0))return{appendText:r.close}}return null}}class hr{constructor(e){(e=e||{}).brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=e.brackets.map(e=>({open:e[0],openRegExp:hr._createOpenBracketRegExp(e[0]),close:e[1],closeRegExp:hr._createCloseBracketRegExp(e[1])})),this._regExpRules=e.regExpRules||[],this._indentationRules=e.indentationRules}onEnter(e,t,i){for(let e=0,n=this._regExpRules.length;e<n;e++){let n=this._regExpRules[e]
if(n.beforeText.test(t)){if(!n.afterText)return n.action
if(n.afterText.test(i))return n.action}}if(t.length>0&&i.length>0)for(let e=0,n=this._brackets.length;e<n;e++){let n=this._brackets[e]
if(n.openRegExp.test(t)&&n.closeRegExp.test(i))return{indentAction:Sn.IndentOutdent}}if(t.length>0)for(let e=0,i=this._brackets.length;e<i;e++){if(this._brackets[e].openRegExp.test(t))return{indentAction:Sn.Indent}}return null}static _createOpenBracketRegExp(e){var t=ue(e)
return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",hr._safeRegExp(t)}static _createCloseBracketRegExp(e){var t=ue(e)
return/\B/.test(t.charAt(t.length-1))||(t+="\\b"),t="^\\s*"+t,hr._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(e){return St(e),null}}}class dr{constructor(e){this._indentationRules=e}onType(e){if(this._indentationRules){if(this._indentationRules.unIndentedLinePattern&&this._indentationRules.unIndentedLinePattern.test(e))return null
if(this._indentationRules.decreaseIndentPattern&&this._indentationRules.decreaseIndentPattern.test(e))return Sn.Outdent}return null}containNonWhitespace(e){return Ee(e)>=0}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0
return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}}class ur{constructor(e,t,i){let n=null
t&&(n=t._conf),this._conf=ur._mergeConf(n,i),this._conf.brackets&&(this.brackets=new Qs(e,this._conf.brackets)),this.onEnter=ur._handleOnEnter(this._conf),this.comments=ur._handleComments(this._conf),this.characterPair=new Ln(this._conf),this.electricCharacter=new lr(this.brackets,this.characterPair.getAutoClosingPairs(),this._conf.__electricCharacterSupport),this.wordDefinition=this._conf.wordPattern||xi,this.indentationRules=this._conf.indentationRules,this._conf.indentationRules&&(this.indentRulesSupport=new dr(this._conf.indentationRules)),this.foldingRules=this._conf.folding||{}}static _mergeConf(e,t){return{comments:e?t.comments||e.comments:t.comments,brackets:e?t.brackets||e.brackets:t.brackets,wordPattern:e?t.wordPattern||e.wordPattern:t.wordPattern,indentationRules:e?t.indentationRules||e.indentationRules:t.indentationRules,onEnterRules:e?t.onEnterRules||e.onEnterRules:t.onEnterRules,autoClosingPairs:e?t.autoClosingPairs||e.autoClosingPairs:t.autoClosingPairs,surroundingPairs:e?t.surroundingPairs||e.surroundingPairs:t.surroundingPairs,folding:e?t.folding||e.folding:t.folding,__electricCharacterSupport:e?t.__electricCharacterSupport||e.__electricCharacterSupport:t.__electricCharacterSupport}}static _handleOnEnter(e){let t={},i=!0
return e.brackets&&(i=!1,t.brackets=e.brackets),e.indentationRules&&(i=!1,t.indentationRules=e.indentationRules),e.onEnterRules&&(i=!1,t.regExpRules=e.onEnterRules),i?null:new hr(t)}static _handleComments(e){let t=e.comments
if(!t)return null
let i={}
if(t.lineComment&&(i.lineCommentToken=t.lineComment),t.blockComment){let[e,n]=t.blockComment
i.blockCommentStartToken=e,i.blockCommentEndToken=n}return i}}const cr=new class{constructor(){this._onDidChange=new ci,this.onDidChange=this._onDidChange.event,this._entries=[]}register(e,t){let i=this._getRichEditSupport(e.id),n=new ur(e,i,t)
return this._entries[e.id]=n,this._onDidChange.fire({languageIdentifier:e}),{dispose:()=>{this._entries[e.id]===n&&(this._entries[e.id]=i,this._onDidChange.fire({languageIdentifier:e}))}}}_getRichEditSupport(e){return this._entries[e]||null}getIndentationRules(e){let t=this._entries[e]
return t&&t.indentationRules||null}_getElectricCharacterSupport(e){let t=this._getRichEditSupport(e)
return t&&t.electricCharacter||null}getElectricCharacters(e){let t=this._getElectricCharacterSupport(e)
return t?t.getElectricCharacters():[]}onElectricCharacter(e,t,i){let n=Ys(t,i-1),s=this._getElectricCharacterSupport(n.languageId)
return s?s.onElectricCharacter(e,n,i-n.firstCharOffset):null}getComments(e){let t=this._getRichEditSupport(e)
return t&&t.comments||null}_getCharacterPairSupport(e){let t=this._getRichEditSupport(e)
return t&&t.characterPair||null}getAutoClosingPairs(e){let t=this._getCharacterPairSupport(e)
return t?t.getAutoClosingPairs():[]}getSurroundingPairs(e){let t=this._getCharacterPairSupport(e)
return t?t.getSurroundingPairs():[]}shouldAutoClosePair(e,t,i){let n=Ys(t,i-1),s=this._getCharacterPairSupport(n.languageId)
return!!s&&s.shouldAutoClosePair(e,n,i-n.firstCharOffset)}getWordDefinition(e){let t=this._getRichEditSupport(e)
return Li(t&&t.wordDefinition||null)}getFoldingRules(e){let t=this._getRichEditSupport(e)
return t?t.foldingRules:{}}getIndentRulesSupport(e){let t=this._getRichEditSupport(e)
return t&&t.indentRulesSupport||null}getPrecedingValidLine(e,t,i){let n=e.getLanguageIdAtPosition(t,0)
if(t>1){let s=t-1,r=-1
for(s=t-1;s>=1;s--){if(e.getLanguageIdAtPosition(s,0)!==n)return r
let t=e.getLineContent(s)
if(!i.shouldIgnore(t)&&!/^\s+$/.test(t)&&""!==t)return s
r=s}}return-1}getInheritIndentForLine(e,t,i=!0){let n=this.getIndentRulesSupport(e.getLanguageIdentifier().id)
if(!n)return null
if(t<=1)return{indentation:"",action:null}
let s=this.getPrecedingValidLine(e,t,n)
if(s<0)return null
if(s<1)return{indentation:"",action:null}
let r=e.getLineContent(s)
if(n.shouldIncrease(r)||n.shouldIndentNextLine(r))return{indentation:Ne(r),action:Sn.Indent,line:s}
if(n.shouldDecrease(r))return{indentation:Ne(r),action:null,line:s}
{if(1===s)return{indentation:Ne(e.getLineContent(s)),action:null,line:s}
let t=s-1,r=n.getIndentMetadata(e.getLineContent(t))
if(!(3&r)&&4&r){let i=0
for(let s=t-1;s>0;s--)if(!n.shouldIndentNextLine(e.getLineContent(s))){i=s
break}return{indentation:Ne(e.getLineContent(i+1)),action:null,line:i+1}}if(i)return{indentation:Ne(e.getLineContent(s)),action:null,line:s}
for(let t=s;t>0;t--){let i=e.getLineContent(t)
if(n.shouldIncrease(i))return{indentation:Ne(i),action:Sn.Indent,line:t}
if(n.shouldIndentNextLine(i)){let i=0
for(let s=t-1;s>0;s--)if(!n.shouldIndentNextLine(e.getLineContent(t))){i=s
break}return{indentation:Ne(e.getLineContent(i+1)),action:null,line:i+1}}if(n.shouldDecrease(i))return{indentation:Ne(i),action:null,line:t}}return{indentation:Ne(e.getLineContent(1)),action:null,line:1}}}getGoodIndentForLine(e,t,i,n){let s=this.getIndentRulesSupport(t)
if(!s)return null
let r=this.getInheritIndentForLine(e,i),o=e.getLineContent(i)
if(r){let i=r.line
if(void 0!==i){let r=this._getOnEnterSupport(t),a=null
try{a=r.onEnter("",e.getLineContent(i),"")}catch(e){St(e)}if(a){let t=Ne(e.getLineContent(i))
return a.removeText&&(t=t.substring(0,t.length-a.removeText)),a.indentAction===Sn.Indent||a.indentAction===Sn.IndentOutdent?t=n.shiftIndent(t):a.indentAction===Sn.Outdent&&(t=n.unshiftIndent(t)),s.shouldDecrease(o)&&(t=n.unshiftIndent(t)),a.appendText&&(t+=a.appendText),Ne(t)}}return s.shouldDecrease(o)?r.action===Sn.Indent?r.indentation:n.unshiftIndent(r.indentation):r.action===Sn.Indent?n.shiftIndent(r.indentation):r.indentation}return null}getIndentForEnter(e,t,i,n){e.forceTokenization(t.startLineNumber)
let s,r,o=e.getLineTokens(t.startLineNumber),a=Ys(o,t.startColumn-1),l=a.getLineContent(),h=!1
a.firstCharOffset>0&&o.getLanguageId(0)!==a.languageId?(h=!0,s=l.substr(0,t.startColumn-1-a.firstCharOffset)):s=o.getLineContent().substring(0,t.startColumn-1),r=t.isEmpty()?l.substr(t.startColumn-1-a.firstCharOffset):this.getScopedLineTokens(e,t.endLineNumber,t.endColumn).getLineContent().substr(t.endColumn-1-a.firstCharOffset)
let d=this.getIndentRulesSupport(a.languageId)
if(!d)return null
let u=s,c=Ne(s)
if(!n&&!h){let n=this.getInheritIndentForLine(e,t.startLineNumber)
d.shouldDecrease(s)&&n&&(c=n.indentation,n.action!==Sn.Indent&&(c=i.unshiftIndent(c))),u=c+ge(ge(s," "),"\t")}let g={getLineTokens:t=>e.getLineTokens(t),getLanguageIdentifier:()=>e.getLanguageIdentifier(),getLanguageIdAtPosition:(t,i)=>e.getLanguageIdAtPosition(t,i),getLineContent:i=>i===t.startLineNumber?u:e.getLineContent(i)},m=Ne(o.getLineContent()),p=this.getInheritIndentForLine(g,t.startLineNumber+1)
if(!p){let e=h?m:c
return{beforeEnter:e,afterEnter:e}}let f=h?m:p.indentation
return p.action===Sn.Indent&&(f=i.shiftIndent(f)),d.shouldDecrease(r)&&(f=i.unshiftIndent(f)),{beforeEnter:h?m:c,afterEnter:f}}getIndentActionForType(e,t,i,n){let s=this.getScopedLineTokens(e,t.startLineNumber,t.startColumn),r=this.getIndentRulesSupport(s.languageId)
if(!r)return null
let o,a=s.getLineContent(),l=a.substr(0,t.startColumn-1-s.firstCharOffset)
if(o=t.isEmpty()?a.substr(t.startColumn-1-s.firstCharOffset):this.getScopedLineTokens(e,t.endLineNumber,t.endColumn).getLineContent().substr(t.endColumn-1-s.firstCharOffset),!r.shouldDecrease(l+o)&&r.shouldDecrease(l+i+o)){let i=this.getInheritIndentForLine(e,t.startLineNumber,!1)
if(!i)return null
let s=i.indentation
return i.action!==Sn.Indent&&(s=n.unshiftIndent(s)),s}return null}getIndentMetadata(e,t){let i=this.getIndentRulesSupport(e.getLanguageIdentifier().id)
return i?t<1||t>e.getLineCount()?null:i.getIndentMetadata(e.getLineContent(t)):null}_getOnEnterSupport(e){let t=this._getRichEditSupport(e)
return t&&t.onEnter||null}getRawEnterActionAtPosition(e,i,n){let s=this.getEnterAction(e,new t(i,n,i,n))
return s?s.enterAction:null}getEnterAction(e,t){let i=this.getIndentationAtPosition(e,t.startLineNumber,t.startColumn),n=this.getScopedLineTokens(e,t.startLineNumber,t.startColumn),s=this._getOnEnterSupport(n.languageId)
if(!s)return null
let r,o=n.getLineContent(),a=o.substr(0,t.startColumn-1-n.firstCharOffset)
r=t.isEmpty()?o.substr(t.startColumn-1-n.firstCharOffset):this.getScopedLineTokens(e,t.endLineNumber,t.endColumn).getLineContent().substr(t.endColumn-1-n.firstCharOffset)
let l=t.startLineNumber,h=""
if(l>1&&0===n.firstCharOffset){let t=this.getScopedLineTokens(e,l-1)
t.languageId===n.languageId&&(h=t.getLineContent())}let d=null
try{d=s.onEnter(h,a,r)}catch(e){St(e)}return d?(d.appendText||(d.indentAction===Sn.Indent||d.indentAction===Sn.IndentOutdent?d.appendText="\t":d.appendText=""),d.removeText&&(i=i.substring(0,i.length-d.removeText)),{enterAction:d,indentation:i}):null}getIndentationAtPosition(e,t,i){let n=Ne(e.getLineContent(t))
return n.length>i-1&&(n=n.substring(0,i-1)),n}getScopedLineTokens(e,t,i){return e.forceTokenization(t),Ys(e.getLineTokens(t),isNaN(i)?e.getLineMaxColumn(t)-1:i-1)}getBracketsSupport(e){let t=this._getRichEditSupport(e)
return t&&t.brackets||null}}
class gr{static shouldRecreate(e){return e.layoutInfo||e.wordSeparators||e.emptySelectionClipboard||e.autoClosingBrackets||e.useTabStops||e.lineHeight||e.readOnly}constructor(e,t,i,n){let s=n.editor
this.readOnly=s.readOnly,this.tabSize=i.tabSize,this.insertSpaces=i.insertSpaces,this.oneIndent=t,this.pageSize=Math.floor(s.layoutInfo.height/s.fontInfo.lineHeight)-2,this.lineHeight=s.lineHeight,this.useTabStops=s.useTabStops,this.wordSeparators=s.wordSeparators,this.emptySelectionClipboard=s.emptySelectionClipboard,this.autoClosingBrackets=s.autoClosingBrackets,this.autoIndent=s.autoIndent,this.autoClosingPairsOpen={},this.autoClosingPairsClose={},this.surroundingPairs={},this.electricChars={}
let r=gr._getElectricCharacters(e)
if(r)for(let e=0;e<r.length;e++)this.electricChars[r[e]]=!0
let o=gr._getAutoClosingPairs(e)
if(o)for(let e=0;e<o.length;e++)this.autoClosingPairsOpen[o[e].open]=o[e].close,this.autoClosingPairsClose[o[e].close]=o[e].open
let a=gr._getSurroundingPairs(e)
if(a)for(let e=0;e<a.length;e++)this.surroundingPairs[a[e].open]=a[e].close}normalizeIndentation(e){return vn.normalizeIndentation(e,this.tabSize,this.insertSpaces)}static _getElectricCharacters(e){try{return cr.getElectricCharacters(e.id)}catch(e){return St(e),null}}static _getAutoClosingPairs(e){try{return cr.getAutoClosingPairs(e.id)}catch(e){return St(e),null}}static _getSurroundingPairs(e){try{return cr.getSurroundingPairs(e.id)}catch(e){return St(e),null}}}class mr{constructor(e,t,i,n){this.selectionStart=e,this.selectionStartLeftoverVisibleColumns=t,this.position=i,this.leftoverVisibleColumns=n,this.selection=mr._computeSelection(this.selectionStart,this.position)}equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(i,n,s,r){return i?new mr(this.selectionStart,this.selectionStartLeftoverVisibleColumns,new e(n,s),r):new mr(new t(n,s,n,s),r,new e(n,s),r)}static _computeSelection(e,t){let i,n,s,r
return e.isEmpty()?(i=e.startLineNumber,n=e.startColumn,s=t.lineNumber,r=t.column):t.isBeforeOrEqual(e.getStartPosition())?(i=e.endLineNumber,n=e.endColumn,s=t.lineNumber,r=t.column):(i=e.startLineNumber,n=e.startColumn,s=t.lineNumber,r=t.column),new At(i,n,s,r)}}class pr{constructor(e,t,i){this.model=t,this.viewModel=i,this.config=new gr(this.model.getLanguageIdentifier(),this.model.getOneIndent(),this.model.getOptions(),e)}validateViewPosition(e,t){return this.viewModel.coordinatesConverter.validateViewPosition(e,t)}validateViewRange(e,t){return this.viewModel.coordinatesConverter.validateViewRange(e,t)}convertViewRangeToModelRange(e){return this.viewModel.coordinatesConverter.convertViewRangeToModelRange(e)}convertViewPositionToModelPosition(t,i){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new e(t,i))}convertModelPositionToViewPosition(e){return this.viewModel.coordinatesConverter.convertModelPositionToViewPosition(e)}convertModelRangeToViewRange(e){return this.viewModel.coordinatesConverter.convertModelRangeToViewRange(e)}getCurrentScrollTop(){return this.viewModel.viewLayout.getCurrentScrollTop()}getCompletelyVisibleViewRange(){return this.viewModel.getCompletelyVisibleViewRange()}getCompletelyVisibleModelRange(){const e=this.viewModel.getCompletelyVisibleViewRange()
return this.viewModel.coordinatesConverter.convertViewRangeToModelRange(e)}getCompletelyVisibleViewRangeAtScrollTop(e){return this.viewModel.getCompletelyVisibleViewRangeAtScrollTop(e)}getCompletelyVisibleModelRangeAtScrollTop(e){const t=this.viewModel.getCompletelyVisibleViewRangeAtScrollTop(e)
return this.viewModel.coordinatesConverter.convertViewRangeToModelRange(t)}getVerticalOffsetForViewLine(e){return this.viewModel.viewLayout.getVerticalOffsetForLineNumber(e)}}class fr{static fromModelState(e){return new fr(e,null)}static fromViewState(e){return new fr(null,e)}static fromModelSelection(i){const n=i.selectionStartLineNumber,s=i.selectionStartColumn,r=i.positionLineNumber,o=i.positionColumn,a=new mr(new t(n,s,n,s),0,new e(r,o),0)
return fr.fromModelState(a)}static fromModelSelections(e){let t=[]
for(let i=0,n=e.length;i<n;i++)t[i]=this.fromModelSelection(e[i])
return t}static ensureInEditableRange(e,t){const i=e.model
if(!i.hasEditableRange())return t
const n=i.getEditableRange(),s=e.convertModelRangeToViewRange(n)
let r=[]
for(let e=0,i=t.length;e<i;e++){const i=t[e]
if(i.modelState){const t=fr._ensureInEditableRange(i.modelState,n)
r[e]=t?fr.fromModelState(t):i}else{const t=fr._ensureInEditableRange(i.viewState,s)
r[e]=t?fr.fromViewState(t):i}}return r}static _ensureInEditableRange(t,i){const n=t.position
return n.lineNumber<i.startLineNumber||n.lineNumber===i.startLineNumber&&n.column<i.startColumn?new mr(t.selectionStart,t.selectionStartLeftoverVisibleColumns,new e(i.startLineNumber,i.startColumn),0):n.lineNumber>i.endLineNumber||n.lineNumber===i.endLineNumber&&n.column>i.endColumn?new mr(t.selectionStart,t.selectionStartLeftoverVisibleColumns,new e(i.endLineNumber,i.endColumn),0):null}constructor(e,t){this.modelState=e,this.viewState=t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}}class _r{constructor(e,t,i){this.type=e,this.commands=t,this.shouldPushStackElementBefore=i.shouldPushStackElementBefore,this.shouldPushStackElementAfter=i.shouldPushStackElementAfter}}class Cr{static isLowSurrogate(e,t,i){let n=e.getLineContent(t)
return!(i<0||i>=n.length)&&Be(n.charCodeAt(i))}static isHighSurrogate(e,t,i){let n=e.getLineContent(t)
return!(i<0||i>=n.length)&&Ve(n.charCodeAt(i))}static isInsideSurrogatePair(e,t,i){return this.isHighSurrogate(e,t,i-2)}static visibleColumnFromColumn(e,t,i){let n=e.length
n>t-1&&(n=t-1)
let s=0
for(let t=0;t<n;t++){9===e.charCodeAt(t)?s=this.nextTabStop(s,i):s+=1}return s}static visibleColumnFromColumn2(e,t,i){return this.visibleColumnFromColumn(t.getLineContent(i.lineNumber),i.column,e.tabSize)}static columnFromVisibleColumn(e,t,i){if(t<=0)return 1
const n=e.length
let s=0
for(let r=0;r<n;r++){let n
if((n=9===e.charCodeAt(r)?this.nextTabStop(s,i):s+1)>=t)return n-t<t-s?r+2:r+1
s=n}return n+1}static columnFromVisibleColumn2(e,t,i,n){let s=this.columnFromVisibleColumn(t.getLineContent(i),n,e.tabSize),r=t.getLineMinColumn(i)
if(s<r)return r
let o=t.getLineMaxColumn(i)
return s>o?o:s}static nextTabStop(e,t){return e+t-e%t}static prevTabStop(e,t){return e-1-(e-1)%t}}var br,wr,vr,Sr;(wr=br||(br={}))[wr.NotSet=0]="NotSet",wr[wr.ContentFlush=1]="ContentFlush",wr[wr.RecoverFromMarkers=2]="RecoverFromMarkers",wr[wr.Explicit=3]="Explicit",wr[wr.Paste=4]="Paste",wr[wr.Undo=5]="Undo",wr[wr.Redo=6]="Redo"
class yr{constructor(e,t,i){this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=i}}class xr{static left(e,t,i,n){return n>t.getLineMinColumn(i)?Cr.isLowSurrogate(t,i,n-2)?n-=2:n-=1:i>1&&(i-=1,n=t.getLineMaxColumn(i)),new yr(i,n,0)}static moveLeft(e,t,i,n,s){let r,o
if(i.hasSelection()&&!n)r=i.selection.startLineNumber,o=i.selection.startColumn
else{let n=xr.left(e,t,i.position.lineNumber,i.position.column-(s-1))
r=n.lineNumber,o=n.column}return i.move(n,r,o,0)}static right(e,t,i,n){return n<t.getLineMaxColumn(i)?Cr.isHighSurrogate(t,i,n-1)?n+=2:n+=1:i<t.getLineCount()&&(i+=1,n=t.getLineMinColumn(i)),new yr(i,n,0)}static moveRight(e,t,i,n,s){let r,o
if(i.hasSelection()&&!n)r=i.selection.endLineNumber,o=i.selection.endColumn
else{let n=xr.right(e,t,i.position.lineNumber,i.position.column+(s-1))
r=n.lineNumber,o=n.column}return i.move(n,r,o,0)}static down(e,t,i,n,s,r,o){const a=Cr.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize)+s
i+=r
var l=t.getLineCount()
return i>l?(i=l,o?n=t.getLineMaxColumn(i):(n=Math.min(t.getLineMaxColumn(i),n),Cr.isInsideSurrogatePair(t,i,n)&&(n-=1))):(n=Cr.columnFromVisibleColumn2(e,t,i,a),Cr.isInsideSurrogatePair(t,i,n)&&(n-=1)),s=a-Cr.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize),new yr(i,n,s)}static moveDown(e,t,i,n,s){let r,o
i.hasSelection()&&!n?(r=i.selection.endLineNumber,o=i.selection.endColumn):(r=i.position.lineNumber,o=i.position.column)
let a=xr.down(e,t,r,o,i.leftoverVisibleColumns,s,!0)
return i.move(n,a.lineNumber,a.column,a.leftoverVisibleColumns)}static translateDown(i,n,s){let r=s.selection,o=xr.down(i,n,r.selectionStartLineNumber,r.selectionStartColumn,s.selectionStartLeftoverVisibleColumns,1,!1),a=xr.down(i,n,r.positionLineNumber,r.positionColumn,s.leftoverVisibleColumns,1,!1)
return new mr(new t(o.lineNumber,o.column,o.lineNumber,o.column),o.leftoverVisibleColumns,new e(a.lineNumber,a.column),a.leftoverVisibleColumns)}static up(e,t,i,n,s,r,o){const a=Cr.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize)+s
return(i-=r)<1?(i=1,o?n=t.getLineMinColumn(i):(n=Math.min(t.getLineMaxColumn(i),n),Cr.isInsideSurrogatePair(t,i,n)&&(n-=1))):(n=Cr.columnFromVisibleColumn2(e,t,i,a),Cr.isInsideSurrogatePair(t,i,n)&&(n-=1)),s=a-Cr.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize),new yr(i,n,s)}static moveUp(e,t,i,n,s){let r,o
i.hasSelection()&&!n?(r=i.selection.startLineNumber,o=i.selection.startColumn):(r=i.position.lineNumber,o=i.position.column)
let a=xr.up(e,t,r,o,i.leftoverVisibleColumns,s,!0)
return i.move(n,a.lineNumber,a.column,a.leftoverVisibleColumns)}static translateUp(i,n,s){let r=s.selection,o=xr.up(i,n,r.selectionStartLineNumber,r.selectionStartColumn,s.selectionStartLeftoverVisibleColumns,1,!1),a=xr.up(i,n,r.positionLineNumber,r.positionColumn,s.leftoverVisibleColumns,1,!1)
return new mr(new t(o.lineNumber,o.column,o.lineNumber,o.column),o.leftoverVisibleColumns,new e(a.lineNumber,a.column),a.leftoverVisibleColumns)}static moveToBeginningOfLine(e,t,i,n){let s,r=i.position.lineNumber,o=t.getLineMinColumn(r),a=t.getLineFirstNonWhitespaceColumn(r)||o
return s=i.position.column===a?o:a,i.move(n,r,s,0)}static moveToEndOfLine(e,t,i,n){let s=i.position.lineNumber,r=t.getLineMaxColumn(s)
return i.move(n,s,r,0)}static moveToBeginningOfBuffer(e,t,i,n){return i.move(n,1,1,0)}static moveToEndOfBuffer(e,t,i,n){let s=t.getLineCount(),r=t.getLineMaxColumn(s)
return i.move(n,s,r,0)}}class Lr{static _createWord(e,t,i,n){return{start:i,end:n,wordType:t}}static _findPreviousWordOnLine(e,t,i){let n=t.getLineContent(i.lineNumber)
return this._doFindPreviousWordOnLine(n,e,i)}static _doFindPreviousWordOnLine(e,t,i){let n=0
for(let s=i.column-2;s>=0;s--){let i=e.charCodeAt(s),r=t.get(i)
if(0===r){if(2===n)return this._createWord(e,n,s+1,this._findEndOfWord(e,t,n,s+1))
n=1}else if(2===r){if(1===n)return this._createWord(e,n,s+1,this._findEndOfWord(e,t,n,s+1))
n=2}else if(1===r&&0!==n)return this._createWord(e,n,s+1,this._findEndOfWord(e,t,n,s+1))}return 0!==n?this._createWord(e,n,0,this._findEndOfWord(e,t,n,0)):null}static _findEndOfWord(e,t,i,n){let s=e.length
for(let r=n;r<s;r++){let n=e.charCodeAt(r),s=t.get(n)
if(1===s)return r
if(1===i&&2===s)return r
if(2===i&&0===s)return r}return s}static _findNextWordOnLine(e,t,i){let n=t.getLineContent(i.lineNumber)
return this._doFindNextWordOnLine(n,e,i)}static _doFindNextWordOnLine(e,t,i){let n=0,s=e.length
for(let r=i.column-1;r<s;r++){let i=e.charCodeAt(r),s=t.get(i)
if(0===s){if(2===n)return this._createWord(e,n,this._findStartOfWord(e,t,n,r-1),r)
n=1}else if(2===s){if(1===n)return this._createWord(e,n,this._findStartOfWord(e,t,n,r-1),r)
n=2}else if(1===s&&0!==n)return this._createWord(e,n,this._findStartOfWord(e,t,n,r-1),r)}return 0!==n?this._createWord(e,n,this._findStartOfWord(e,t,n,s-1),s):null}static _findStartOfWord(e,t,i,n){for(let s=n;s>=0;s--){let n=e.charCodeAt(s),r=t.get(n)
if(1===r)return s+1
if(1===i&&2===r)return s+1
if(2===i&&0===r)return s+1}return 0}static moveWordLeft(t,i,n,s){let r=n.lineNumber,o=n.column
1===o&&r>1&&(r-=1,o=i.getLineMaxColumn(r))
let a=Lr._findPreviousWordOnLine(t,i,new e(r,o))
return 0===s?o=a?a.start+1:1:(a&&o<=a.end+1&&(a=Lr._findPreviousWordOnLine(t,i,new e(r,a.start+1))),o=a?a.end+1:1),new e(r,o)}static moveWordRight(t,i,n,s){let r=n.lineNumber,o=n.column
o===i.getLineMaxColumn(r)&&r<i.getLineCount()&&(r+=1,o=1)
let a=Lr._findNextWordOnLine(t,i,new e(r,o))
return 1===s?o=a?a.end+1:i.getLineMaxColumn(r):(a&&o>=a.start+1&&(a=Lr._findNextWordOnLine(t,i,new e(r,a.end+1))),o=a?a.start+1:i.getLineMaxColumn(r)),new e(r,o)}static _deleteWordLeftWhitespace(e,i){const n=e.getLineContent(i.lineNumber),s=i.column-2,r=Ee(n,s)
return r+1<s?new t(i.lineNumber,r+2,i.lineNumber,i.column):null}static deleteWordLeft(i,n,s,r,o){if(!s.isEmpty())return s
const a=new e(s.positionLineNumber,s.positionColumn)
let l=a.lineNumber,h=a.column
if(1===l&&1===h)return null
if(r){let e=this._deleteWordLeftWhitespace(n,a)
if(e)return e}let d=Lr._findPreviousWordOnLine(i,n,a)
return 0===o?d?h=d.start+1:h>1?h=1:(l--,h=n.getLineMaxColumn(l)):(d&&h<=d.end+1&&(d=Lr._findPreviousWordOnLine(i,n,new e(l,d.start+1))),d?h=d.end+1:h>1?h=1:(l--,h=n.getLineMaxColumn(l))),new t(l,h,a.lineNumber,a.column)}static _findFirstNonWhitespaceChar(e,t){let i=e.length
for(let n=t;n<i;n++){let t=e.charAt(n)
if(" "!==t&&"\t"!==t)return n}return i}static _deleteWordRightWhitespace(e,i){const n=e.getLineContent(i.lineNumber),s=i.column-1,r=this._findFirstNonWhitespaceChar(n,s)
return s+1<r?new t(i.lineNumber,i.column,i.lineNumber,r+1):null}static deleteWordRight(i,n,s,r,o){if(!s.isEmpty())return s
const a=new e(s.positionLineNumber,s.positionColumn)
let l=a.lineNumber,h=a.column
const d=n.getLineCount(),u=n.getLineMaxColumn(l)
if(l===d&&h===u)return null
if(r){let e=this._deleteWordRightWhitespace(n,a)
if(e)return e}let c=Lr._findNextWordOnLine(i,n,a)
return 1===o?c?h=c.end+1:h<u||l===d?h=u:(l++,h=(c=Lr._findNextWordOnLine(i,n,new e(l,1)))?c.start+1:n.getLineMaxColumn(l)):(c&&h>=c.start+1&&(c=Lr._findNextWordOnLine(i,n,new e(l,c.end+1))),c?h=c.start+1:h<u||l===d?h=u:(l++,h=(c=Lr._findNextWordOnLine(i,n,new e(l,1)))?c.start+1:n.getLineMaxColumn(l))),new t(l,h,a.lineNumber,a.column)}static word(i,n,s,r,o){const a=tn(i.wordSeparators)
let l,h,d,u,c=Lr._findPreviousWordOnLine(a,n,o),g=c&&1===c.wordType&&c.start<o.column-1&&o.column-1<=c.end,m=Lr._findNextWordOnLine(a,n,o),p=m&&1===m.wordType&&m.start<o.column-1&&o.column-1<=m.end
if(!r)return g?(l=c.start+1,h=c.end+1):p?(l=m.start+1,h=m.end+1):(l=c?c.end+1:1,h=m?m.start+1:n.getLineMaxColumn(o.lineNumber)),new mr(new t(o.lineNumber,l,o.lineNumber,h),0,new e(o.lineNumber,h),0)
g?(d=c.start+1,u=c.end+1):p?(d=m.start+1,u=m.end+1):(d=o.column,u=o.column)
let f,_=o.lineNumber
if(s.selectionStart.containsPosition(o))f=s.selectionStart.endColumn
else if(o.isBeforeOrEqual(s.selectionStart.getStartPosition())){let t=new e(_,f=d)
s.selectionStart.containsPosition(t)&&(f=s.selectionStart.endColumn)}else{let t=new e(_,f=u)
s.selectionStart.containsPosition(t)&&(f=s.selectionStart.startColumn)}return s.move(!0,_,f,0)}}class Nr{static addCursorDown(e,t){let i=[],n=0
for(let s=0,r=t.length;s<r;s++){const r=t[s]
i[n++]=new fr(r.modelState,r.viewState),i[n++]=fr.fromViewState(xr.translateDown(e.config,e.viewModel,r.viewState))}return i}static addCursorUp(e,t){let i=[],n=0
for(let s=0,r=t.length;s<r;s++){const r=t[s]
i[n++]=new fr(r.modelState,r.viewState),i[n++]=fr.fromViewState(xr.translateUp(e.config,e.viewModel,r.viewState))}return i}static moveToBeginningOfLine(e,t,i){let n=[]
for(let s=0,r=t.length;s<r;s++){const r=t[s]
n[s]=this._moveToLineStart(e,r,i)}return n}static _moveToLineStart(e,t,i){const n=t.viewState.position.column,s=n===t.modelState.position.column,r=t.viewState.position.lineNumber,o=e.viewModel.getLineFirstNonWhitespaceColumn(r)
return s||n===o?this._moveToLineStartByModel(e,t,i):this._moveToLineStartByView(e,t,i)}static _moveToLineStartByView(e,t,i){return fr.fromViewState(xr.moveToBeginningOfLine(e.config,e.viewModel,t.viewState,i))}static _moveToLineStartByModel(e,t,i){return fr.fromModelState(xr.moveToBeginningOfLine(e.config,e.model,t.modelState,i))}static moveToEndOfLine(e,t,i){let n=[]
for(let s=0,r=t.length;s<r;s++){const r=t[s]
n[s]=this._moveToLineEnd(e,r,i)}return n}static _moveToLineEnd(e,t,i){const n=t.viewState.position,s=e.viewModel.getLineMaxColumn(n.lineNumber),r=n.column===s,o=t.modelState.position,a=e.model.getLineMaxColumn(o.lineNumber),l=s-n.column==a-o.column
return r||l?this._moveToLineEndByModel(e,t,i):this._moveToLineEndByView(e,t,i)}static _moveToLineEndByView(e,t,i){return fr.fromViewState(xr.moveToEndOfLine(e.config,e.viewModel,t.viewState,i))}static _moveToLineEndByModel(e,t,i){return fr.fromModelState(xr.moveToEndOfLine(e.config,e.model,t.modelState,i))}static expandLineSelection(i,n){let s=[]
for(let r=0,o=n.length;r<o;r++){const o=n[r].viewState.selection,a=o.startLineNumber,l=i.viewModel.getLineCount()
let h,d=o.endLineNumber
d===l?h=i.viewModel.getLineMaxColumn(l):(d++,h=1),s[r]=fr.fromViewState(new mr(new t(a,1,a,1),0,new e(d,h),0))}return s}static moveToBeginningOfBuffer(e,t,i){let n=[]
for(let s=0,r=t.length;s<r;s++){const r=t[s]
n[s]=fr.fromModelState(xr.moveToBeginningOfBuffer(e.config,e.model,r.modelState,i))}return n}static moveToEndOfBuffer(e,t,i){let n=[]
for(let s=0,r=t.length;s<r;s++){const r=t[s]
n[s]=fr.fromModelState(xr.moveToEndOfBuffer(e.config,e.model,r.modelState,i))}return n}static selectAll(i,n){if(i.model.hasEditableRange()){const s=i.model.getEditableRange()
if(!n.modelState.selection.equalsRange(s))return fr.fromModelState(new mr(new t(s.startLineNumber,s.startColumn,s.startLineNumber,s.startColumn),0,new e(s.endLineNumber,s.endColumn),0))}const s=i.model.getLineCount(),r=i.model.getLineMaxColumn(s)
return fr.fromModelState(new mr(new t(1,1,1,1),0,new e(s,r),0))}static line(i,n,s,r,o){const a=i.model.validatePosition(r),l=o?i.validateViewPosition(new e(o.lineNumber,o.column),a):i.convertModelPositionToViewPosition(a)
if(!s||!n.modelState.hasSelection()){const n=i.model.getLineCount()
let s=a.lineNumber+1,r=1
return s>n&&(s=n,r=i.model.getLineMaxColumn(s)),fr.fromModelState(new mr(new t(a.lineNumber,1,s,r),0,new e(s,r),0))}const h=n.modelState.selectionStart.getStartPosition().lineNumber
if(a.lineNumber<h)return fr.fromViewState(n.viewState.move(n.modelState.hasSelection(),l.lineNumber,1,0))
if(a.lineNumber>h){const e=i.viewModel.getLineCount()
let t=l.lineNumber+1,s=1
return t>e&&(t=e,s=i.viewModel.getLineMaxColumn(t)),fr.fromViewState(n.viewState.move(n.modelState.hasSelection(),t,s,0))}{const e=n.modelState.selectionStart.getEndPosition()
return fr.fromModelState(n.modelState.move(n.modelState.hasSelection(),e.lineNumber,e.column,0))}}static word(e,t,i,n){const s=e.model.validatePosition(n)
return fr.fromModelState(Lr.word(e.config,e.model,t.modelState,i,s))}static cancelSelection(i,n){if(!n.modelState.hasSelection())return new fr(n.modelState,n.viewState)
const s=n.viewState.position.lineNumber,r=n.viewState.position.column
return fr.fromViewState(new mr(new t(s,r,s,r),0,new e(s,r),0))}static moveTo(t,i,n,s,r){const o=t.model.validatePosition(s),a=r?t.validateViewPosition(new e(r.lineNumber,r.column),o):t.convertModelPositionToViewPosition(o)
return fr.fromViewState(i.viewState.move(n,a.lineNumber,a.column,0))}static move(e,t,i){const n=i.select,s=i.value
switch(i.direction){case 0:return 4===i.unit?this._moveHalfLineLeft(e,t,n):this._moveLeft(e,t,n,s)
case 1:return 4===i.unit?this._moveHalfLineRight(e,t,n):this._moveRight(e,t,n,s)
case 2:return 2===i.unit?this._moveUpByViewLines(e,t,n,s):this._moveUpByModelLines(e,t,n,s)
case 3:return 2===i.unit?this._moveDownByViewLines(e,t,n,s):this._moveDownByModelLines(e,t,n,s)
case 4:return this._moveToViewMinColumn(e,t,n)
case 5:return this._moveToViewFirstNonWhitespaceColumn(e,t,n)
case 6:return this._moveToViewCenterColumn(e,t,n)
case 7:return this._moveToViewMaxColumn(e,t,n)
case 8:return this._moveToViewLastNonWhitespaceColumn(e,t,n)
case 9:{const i=t[0],r=e.getCompletelyVisibleModelRange(),o=this._firstLineNumberInRange(e.model,r,s),a=e.model.getLineFirstNonWhitespaceColumn(o)
return[this._moveToModelPosition(e,i,n,o,a)]}case 11:{const i=t[0],r=e.getCompletelyVisibleModelRange(),o=this._lastLineNumberInRange(e.model,r,s),a=e.model.getLineFirstNonWhitespaceColumn(o)
return[this._moveToModelPosition(e,i,n,o,a)]}case 10:{const i=t[0],s=e.getCompletelyVisibleModelRange(),r=Math.round((s.startLineNumber+s.endLineNumber)/2),o=e.model.getLineFirstNonWhitespaceColumn(r)
return[this._moveToModelPosition(e,i,n,r,o)]}case 12:{const i=e.getCompletelyVisibleViewRange()
let s=[]
for(let r=0,o=t.length;r<o;r++){const o=t[r]
s[r]=this.findPositionInViewportIfOutside(e,o,i,n)}return s}}return null}static findPositionInViewportIfOutside(e,t,i,n){let s=t.viewState.position.lineNumber
if(i.startLineNumber<=s&&s<=i.endLineNumber-1)return new fr(t.modelState,t.viewState)
{s>i.endLineNumber-1&&(s=i.endLineNumber-1),s<i.startLineNumber&&(s=i.startLineNumber)
const r=e.viewModel.getLineFirstNonWhitespaceColumn(s)
return this._moveToViewPosition(e,t,n,s,r)}}static _firstLineNumberInRange(e,t,i){let n=t.startLineNumber
return t.startColumn!==e.getLineMinColumn(n)&&n++,Math.min(t.endLineNumber,n+i-1)}static _lastLineNumberInRange(e,t,i){let n=t.startLineNumber
return t.startColumn!==e.getLineMinColumn(n)&&n++,Math.max(n,t.endLineNumber-i+1)}static _moveLeft(e,t,i,n){let s=[]
for(let r=0,o=t.length;r<o;r++){const o=t[r]
let a=xr.moveLeft(e.config,e.viewModel,o.viewState,i,n)
if(1===n&&a.position.lineNumber!==o.viewState.position.lineNumber)e.viewModel.coordinatesConverter.convertViewPositionToModelPosition(a.position).lineNumber===o.modelState.position.lineNumber&&(a=xr.moveLeft(e.config,e.viewModel,a,i,1))
s[r]=fr.fromViewState(a)}return s}static _moveHalfLineLeft(e,t,i){let n=[]
for(let s=0,r=t.length;s<r;s++){const r=t[s],o=r.viewState.position.lineNumber,a=Math.round(e.viewModel.getLineContent(o).length/2)
n[s]=fr.fromViewState(xr.moveLeft(e.config,e.viewModel,r.viewState,i,a))}return n}static _moveRight(e,t,i,n){let s=[]
for(let r=0,o=t.length;r<o;r++){const o=t[r]
let a=xr.moveRight(e.config,e.viewModel,o.viewState,i,n)
if(1===n&&a.position.lineNumber!==o.viewState.position.lineNumber)e.viewModel.coordinatesConverter.convertViewPositionToModelPosition(a.position).lineNumber===o.modelState.position.lineNumber&&(a=xr.moveRight(e.config,e.viewModel,a,i,1))
s[r]=fr.fromViewState(a)}return s}static _moveHalfLineRight(e,t,i){let n=[]
for(let s=0,r=t.length;s<r;s++){const r=t[s],o=r.viewState.position.lineNumber,a=Math.round(e.viewModel.getLineContent(o).length/2)
n[s]=fr.fromViewState(xr.moveRight(e.config,e.viewModel,r.viewState,i,a))}return n}static _moveDownByViewLines(e,t,i,n){let s=[]
for(let r=0,o=t.length;r<o;r++){const o=t[r]
s[r]=fr.fromViewState(xr.moveDown(e.config,e.viewModel,o.viewState,i,n))}return s}static _moveDownByModelLines(e,t,i,n){let s=[]
for(let r=0,o=t.length;r<o;r++){const o=t[r]
s[r]=fr.fromModelState(xr.moveDown(e.config,e.model,o.modelState,i,n))}return s}static _moveUpByViewLines(e,t,i,n){let s=[]
for(let r=0,o=t.length;r<o;r++){const o=t[r]
s[r]=fr.fromViewState(xr.moveUp(e.config,e.viewModel,o.viewState,i,n))}return s}static _moveUpByModelLines(e,t,i,n){let s=[]
for(let r=0,o=t.length;r<o;r++){const o=t[r]
s[r]=fr.fromModelState(xr.moveUp(e.config,e.model,o.modelState,i,n))}return s}static _moveToViewPosition(e,t,i,n,s){return fr.fromViewState(t.viewState.move(i,n,s,0))}static _moveToModelPosition(e,t,i,n,s){return fr.fromModelState(t.modelState.move(i,n,s,0))}static _moveToViewMinColumn(e,t,i){let n=[]
for(let s=0,r=t.length;s<r;s++){const r=t[s],o=r.viewState.position.lineNumber,a=e.viewModel.getLineMinColumn(o)
n[s]=this._moveToViewPosition(e,r,i,o,a)}return n}static _moveToViewFirstNonWhitespaceColumn(e,t,i){let n=[]
for(let s=0,r=t.length;s<r;s++){const r=t[s],o=r.viewState.position.lineNumber,a=e.viewModel.getLineFirstNonWhitespaceColumn(o)
n[s]=this._moveToViewPosition(e,r,i,o,a)}return n}static _moveToViewCenterColumn(e,t,i){let n=[]
for(let s=0,r=t.length;s<r;s++){const r=t[s],o=r.viewState.position.lineNumber,a=Math.round((e.viewModel.getLineMaxColumn(o)+e.viewModel.getLineMinColumn(o))/2)
n[s]=this._moveToViewPosition(e,r,i,o,a)}return n}static _moveToViewMaxColumn(e,t,i){let n=[]
for(let s=0,r=t.length;s<r;s++){const r=t[s],o=r.viewState.position.lineNumber,a=e.viewModel.getLineMaxColumn(o)
n[s]=this._moveToViewPosition(e,r,i,o,a)}return n}static _moveToViewLastNonWhitespaceColumn(e,t,i){let n=[]
for(let s=0,r=t.length;s<r;s++){const r=t[s],o=r.viewState.position.lineNumber,a=e.viewModel.getLineLastNonWhitespaceColumn(o)
n[s]=this._moveToViewPosition(e,r,i,o,a)}return n}}!function(e){e.description={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'to': A mandatory logical position value providing where to move the cursor.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'left', 'right', 'up', 'down'\n\t\t\t\t\t\t'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'\n\t\t\t\t\t\t'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter',\n\t\t\t\t\t\t'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'by': Unit to move. Default is computed based on 'to' value.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'line', 'wrappedLine', 'character', 'halfLine'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'value': Number of units to move. Default is '1'.\n\t\t\t\t\t* 'select': If 'true' makes the selection. Default is 'false'.\n\t\t\t\t",constraint:function(e){if(!ot(e))return!1
let t=e
return!(!rt(t.to)||!ht(t.select)&&!lt(t.select)||!ht(t.by)&&!rt(t.by)||!ht(t.value)&&!at(t.value))}}]},e.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},e.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"},e.parse=function(t){if(!t.to)return null
let i
switch(t.to){case e.RawDirection.Left:i=0
break
case e.RawDirection.Right:i=1
break
case e.RawDirection.Up:i=2
break
case e.RawDirection.Down:i=3
break
case e.RawDirection.WrappedLineStart:i=4
break
case e.RawDirection.WrappedLineFirstNonWhitespaceCharacter:i=5
break
case e.RawDirection.WrappedLineColumnCenter:i=6
break
case e.RawDirection.WrappedLineEnd:i=7
break
case e.RawDirection.WrappedLineLastNonWhitespaceCharacter:i=8
break
case e.RawDirection.ViewPortTop:i=9
break
case e.RawDirection.ViewPortBottom:i=11
break
case e.RawDirection.ViewPortCenter:i=10
break
case e.RawDirection.ViewPortIfOutside:i=12
break
default:return null}let n=0
switch(t.by){case e.RawUnit.Line:n=1
break
case e.RawUnit.WrappedLine:n=2
break
case e.RawUnit.Character:n=3
break
case e.RawUnit.HalfLine:n=4}return{direction:i,unit:n,select:!!t.select,value:t.value||1}}}(vr||(vr={})),function(e){e.serviceIds=new Map,e.DI_TARGET="$di$target",e.DI_DEPENDENCIES="$di$dependencies",e.getServiceDependencies=function(t){return t[e.DI_DEPENDENCIES]||[]}}(Sr||(Sr={}))
const Er=Ir("instantiationService")
function kr(e,t,i,n){t[Sr.DI_TARGET]===t?t[Sr.DI_DEPENDENCIES].push({id:e,index:i,optional:n}):(t[Sr.DI_DEPENDENCIES]=[{id:e,index:i,optional:n}],t[Sr.DI_TARGET]=t)}function Ir(e){if(Sr.serviceIds.has(e))return Sr.serviceIds.get(e)
const t=function(e,i,n){if(3!==arguments.length)throw new Error("@IServiceName-decorator can only be used to decorate a parameter")
kr(t,e,n,!1)}
return t.toString=(()=>e),Sr.serviceIds.set(e,t),t}function Mr(e){return function(t,i,n){if(3!==arguments.length)throw new Error("@optional-decorator can only be used to decorate a parameter")
kr(e,t,n,!0)}}const Dr=Ir("commandService"),Tr=new class{constructor(){this._commands=new Map}registerCommand(e,t){if(!e)throw new Error("invalid command")
if("string"==typeof e){if(!t)throw new Error("invalid command")
return this.registerCommand({id:e,handler:t})}if(e.description){const t=[]
for(let i of e.description.args)t.push(i.constraint)
const i=e.handler
e.handler=function(e,...n){return function(e,t){const i=Math.min(e.length,t.length)
for(let n=0;n<i;n++)mt(e[n],t[n])}(n,t),i(e,...n)}}const{id:i}=e
let n=this._commands.get(i)
n||(n=new oi,this._commands.set(i,n))
let s=n.unshift(e)
return{dispose:()=>{s(),this._commands.get(i).isEmpty()&&this._commands.delete(i)}}}getCommand(e){const t=this._commands.get(e)
if(t&&!t.isEmpty())return t.iterator().next().value}getCommands(){const e=Object.create(null)
return this._commands.forEach((t,i)=>{e[i]=this.getCommand(i)}),e}}
class Or{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}}const Rr=new Or,Ar=new Or,Pr=new Or
var Fr
function Wr(e,t){return(e|(65535&t)<<16>>>0)>>>0}function Vr(e,t){if(0===e)return null
const i=(65535&e)>>>0,n=(4294901760&e)>>>16
return 0!==n?new zr(Br(i,t),Br(n,t)):Br(i,t)}function Br(e,t){const i=!!(2048&e),n=!!(256&e)
return new Hr(2===t?n:i,!!(1024&e),!!(512&e),2===t?i:n,255&e)}!function(){function e(e,t,i=t,n=i){Rr.define(e,t),Ar.define(e,i),Pr.define(e,n)}e(0,"unknown"),e(1,"Backspace"),e(2,"Tab"),e(3,"Enter"),e(4,"Shift"),e(5,"Ctrl"),e(6,"Alt"),e(7,"PauseBreak"),e(8,"CapsLock"),e(9,"Escape"),e(10,"Space"),e(11,"PageUp"),e(12,"PageDown"),e(13,"End"),e(14,"Home"),e(15,"LeftArrow","Left"),e(16,"UpArrow","Up"),e(17,"RightArrow","Right"),e(18,"DownArrow","Down"),e(19,"Insert"),e(20,"Delete"),e(21,"0"),e(22,"1"),e(23,"2"),e(24,"3"),e(25,"4"),e(26,"5"),e(27,"6"),e(28,"7"),e(29,"8"),e(30,"9"),e(31,"A"),e(32,"B"),e(33,"C"),e(34,"D"),e(35,"E"),e(36,"F"),e(37,"G"),e(38,"H"),e(39,"I"),e(40,"J"),e(41,"K"),e(42,"L"),e(43,"M"),e(44,"N"),e(45,"O"),e(46,"P"),e(47,"Q"),e(48,"R"),e(49,"S"),e(50,"T"),e(51,"U"),e(52,"V"),e(53,"W"),e(54,"X"),e(55,"Y"),e(56,"Z"),e(57,"Meta"),e(58,"ContextMenu"),e(59,"F1"),e(60,"F2"),e(61,"F3"),e(62,"F4"),e(63,"F5"),e(64,"F6"),e(65,"F7"),e(66,"F8"),e(67,"F9"),e(68,"F10"),e(69,"F11"),e(70,"F12"),e(71,"F13"),e(72,"F14"),e(73,"F15"),e(74,"F16"),e(75,"F17"),e(76,"F18"),e(77,"F19"),e(78,"NumLock"),e(79,"ScrollLock"),e(80,";",";","OEM_1"),e(81,"=","=","OEM_PLUS"),e(82,",",",","OEM_COMMA"),e(83,"-","-","OEM_MINUS"),e(84,".",".","OEM_PERIOD"),e(85,"/","/","OEM_2"),e(86,"`","`","OEM_3"),e(110,"ABNT_C1"),e(111,"ABNT_C2"),e(87,"[","[","OEM_4"),e(88,"\\","\\","OEM_5"),e(89,"]","]","OEM_6"),e(90,"'","'","OEM_7"),e(91,"OEM_8"),e(92,"OEM_102"),e(93,"NumPad0"),e(94,"NumPad1"),e(95,"NumPad2"),e(96,"NumPad3"),e(97,"NumPad4"),e(98,"NumPad5"),e(99,"NumPad6"),e(100,"NumPad7"),e(101,"NumPad8"),e(102,"NumPad9"),e(103,"NumPad_Multiply"),e(104,"NumPad_Add"),e(105,"NumPad_Separator"),e(106,"NumPad_Subtract"),e(107,"NumPad_Decimal"),e(108,"NumPad_Divide")}(),function(e){e.toString=function(e){return Rr.keyCodeToStr(e)},e.fromString=function(e){return Rr.strToKeyCode(e)},e.toUserSettingsUS=function(e){return Ar.keyCodeToStr(e)},e.toUserSettingsGeneral=function(e){return Pr.keyCodeToStr(e)},e.fromUserSettings=function(e){return Ar.strToKeyCode(e)||Pr.strToKeyCode(e)}}(Fr||(Fr={}))
class Hr{constructor(e,t,i,n,s){this.type=1,this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=n,this.keyCode=s}equals(e){return 1===e.type&&(this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode)}isModifierKey(){return 0===this.keyCode||5===this.keyCode||57===this.keyCode||6===this.keyCode||4===this.keyCode}isDuplicateModifierCase(){return this.ctrlKey&&5===this.keyCode||this.shiftKey&&4===this.keyCode||this.altKey&&6===this.keyCode||this.metaKey&&57===this.keyCode}}class zr{constructor(e,t){this.type=2,this.firstPart=e,this.chordPart=t}}class Ur{constructor(e,t,i,n,s,r){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=n,this.keyLabel=s,this.keyAriaLabel=r}}class Kr{}function $r(e,t){if(!e||null===e)throw new Error(t?"Assertion failed ("+t+")":"Assertion Failed")}const qr=new class{constructor(){this.data={}}add(e,t){$r(rt(e)),$r(ot(t)),$r(!this.data.hasOwnProperty(e),"There is already an extension with this id"),this.data[e]=t}knows(e){return this.data.hasOwnProperty(e)}as(e){return this.data[e]||null}}
class Gr{constructor(){this.WEIGHT={editorCore:(e=0)=>0+e,editorContrib:(e=0)=>100+e,workbenchContrib:(e=0)=>200+e,builtinExtension:(e=0)=>300+e,externalExtension:(e=0)=>400+e},this._keybindings=[]}static bindToCurrentPlatform(e){if(1===W){if(e&&e.win)return e.win}else if(2===W){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux
return e}static bindToCurrentPlatform2(e){if(1===W){if(e&&e.win)return e.win}else if(2===W){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux
return e}registerKeybindingRule(e){let t=Gr.bindToCurrentPlatform(e)
t&&t.primary&&this.registerDefaultKeybinding(Vr(t.primary,W),e.id,e.weight,0,e.when),t&&Array.isArray(t.secondary)&&t.secondary.forEach((t,i)=>this.registerDefaultKeybinding(Vr(t,W),e.id,e.weight,-i-1,e.when))}registerKeybindingRule2(e){let t=Gr.bindToCurrentPlatform2(e)
t&&t.primary&&this.registerDefaultKeybinding(t.primary,e.id,e.weight,0,e.when)}registerCommandAndKeybindingRule(e){this.registerKeybindingRule(e),Tr.registerCommand(e)}static _mightProduceChar(e){return e>=21&&e<=30||(e>=31&&e<=56||(80===e||81===e||82===e||83===e||84===e||85===e||86===e||110===e||111===e||87===e||88===e||89===e||90===e||91===e||92===e))}_assertNoCtrlAlt(e,t){e.ctrlKey&&e.altKey&&!e.metaKey&&Gr._mightProduceChar(e.keyCode)&&console.warn("Ctrl+Alt+ keybindings should not be used by default under Windows. Offender: ",e," for ",t)}registerDefaultKeybinding(e,t,i,n,s){1===W&&(2===e.type?this._assertNoCtrlAlt(e.firstPart,t):this._assertNoCtrlAlt(e,t)),this._keybindings.push({keybinding:e,command:t,commandArgs:null,when:s,weight1:i,weight2:n})}getDefaultKeybindings(){let e=this._keybindings.slice(0)
return e.sort(Yr),e}}const jr=new Gr
function Yr(e,t){return e.weight1!==t.weight1?e.weight1-t.weight1:e.command<t.command?-1:e.command>t.command?1:e.weight2-t.weight2}qr.add("platform.keybindingsRegistry",jr)
var Zr=Ir("modelService")
const Xr={PROPERTY_CHANGED:"propertyChanged",SELECTION:"selection",FOCUS:"focus",BLUR:"blur",HIGHLIGHT:"highlight",EXPAND:"expand",COLLAPSE:"collapse",TOGGLE:"toggle",BEFORE_RUN:"beforeRun",RUN:"run",EDIT:"edit",SAVE:"save",CANCEL:"cancel",CHANGE:"change",DISPOSE:"dispose"}
class Jr{constructor(e,t="",i="",n=!0,s){this._onDidChange=new ci,this._id=e,this._label=t,this._cssClass=i,this._enabled=n,this._actionCallback=s}dispose(){this._onDidChange.dispose()}get onDidChange(){return this._onDidChange.event}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}get radio(){return this._radio}set radio(e){this._setRadio(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}_setRadio(e){this._radio!==e&&(this._radio=e,this._onDidChange.fire({radio:e}))}get order(){return this._order}set order(e){this._order=e}run(e,t){return void 0!==this._actionCallback?this._actionCallback(e):bt.as(!0)}}class Qr extends It{run(e,t){return e.enabled?(this.emit(Xr.BEFORE_RUN,{action:e}),this.runAction(e,t).then(t=>{this.emit(Xr.RUN,{action:e,result:t})},t=>{this.emit(Xr.RUN,{action:e,error:t})})):bt.as(null)}runAction(e,t){return bt.as(t?e.run(t):e.run())}}class eo{constructor(e){this._staticArguments=e}appendStaticArguments(e){this._staticArguments.push.apply(this._staticArguments,e)}staticArguments(e){return isNaN(e)?this._staticArguments.slice(0):this._staticArguments[e]}_validate(e){if(!e)throw Et("can not be falsy")}}class to extends eo{constructor(e,...t){super(t),this._ctor=e}get ctor(){return this._ctor}bind(...e){let t=[]
return t=(t=t.concat(this.staticArguments())).concat(e),new to(this._ctor,...t)}}class io{constructor(){this.id=String(io.ID++)}}io.ID=1,io.EditorTitle=new io,io.EditorTitleContext=new io,io.EditorContext=new io,io.ExplorerContext=new io,io.ProblemsPanelContext=new io,io.DebugVariablesContext=new io,io.DebugWatchContext=new io,io.DebugCallStackContext=new io,io.DebugBreakpointsContext=new io,io.DebugConsoleContext=new io,io.SCMTitle=new io,io.SCMSourceControl=new io,io.SCMResourceGroupContext=new io,io.SCMResourceContext=new io,io.SCMChangeContext=new io,io.CommandPalette=new io,io.ViewTitle=new io,io.ViewItemContext=new io,io.TouchBarContext=new io
const no=Ir("menuService"),so=new class{constructor(){this._commands=Object.create(null),this._menuItems=Object.create(null)}addCommand(e){const t=this._commands[e.id]
return this._commands[e.id]=e,void 0!==t}getCommand(e){return this._commands[e]}appendMenuItem({id:e},t){let i=this._menuItems[e]
return i?i.push(t):this._menuItems[e]=i=[t],{dispose(){const e=i.indexOf(t)
e>=0&&i.splice(e,1)}}}getMenuItems({id:e}){const t=this._menuItems[e]||[]
return e===io.CommandPalette.id&&this._appendImplicitItems(t),t}_appendImplicitItems(e){const t=new Set
for(const{command:i,alt:n}of e)t.add(i.id),n&&t.add(n.id)
for(let i in this._commands)t.has(i)||e.push({command:this._commands[i]})}}
let ro=class extends Jr{constructor(e,t,i){super(e,t),this._commandService=i}run(...e){return this._commandService.executeCommand(this.id,...e)}}
ro=Nn([En(2,Dr)],ro)
let oo=class e extends ro{constructor(t,i,n,s){"string"==typeof t.title?super(t.id,t.title,s):super(t.id,t.title.value,s),this._cssClass=t.iconClass,this._enabled=!0,this._options=n||{},this.item=t,this.alt=i?new e(i,void 0,this._options,s):void 0}run(...e){let t=[]
return this._options.arg&&(t=[...t,this._options.arg]),this._options.shouldForwardArgs&&(t=[...t,...e]),super.run(...t)}}
oo=Nn([En(3,Dr)],oo)
const ao=Ir("editorService")
var lo,ho;(ho=lo||(lo={}))[ho.ONE=0]="ONE",ho[ho.TWO=1]="TWO",ho[ho.THREE=2]="THREE"
lo.ONE,lo.TWO,lo.THREE
var uo,co,go,mo,po,fo;(co=uo||(uo={}))[co.LEFT=0]="LEFT",co[co.RIGHT=1]="RIGHT",(mo=go||(go={}))[mo.SHORT=0]="SHORT",mo[mo.MEDIUM=1]="MEDIUM",mo[mo.LONG=2]="LONG",(fo=po||(po={}))[fo.Defined=1]="Defined",fo[fo.Not=2]="Not",fo[fo.Equals=3]="Equals",fo[fo.NotEquals=4]="NotEquals",fo[fo.And=5]="And"
class _o{static has(e){return new bo(e)}static equals(e,t){return new wo(e,t)}static notEquals(e,t){return new vo(e,t)}static not(e){return new So(e)}static and(...e){return new yo(e)}static deserialize(e){if(!e)return null
let t=e.split("&&")
return new yo(t.map(e=>this._deserializeOne(e))).normalize()}static _deserializeOne(e){if((e=e.trim()).indexOf("!=")>=0){let t=e.split("!=")
return new vo(t[0].trim(),this._deserializeValue(t[1]))}if(e.indexOf("==")>=0){let t=e.split("==")
return new wo(t[0].trim(),this._deserializeValue(t[1]))}return/^\!\s*/.test(e)?new So(e.substr(1).trim()):new bo(e)}static _deserializeValue(e){if("true"===(e=e.trim()))return!0
if("false"===e)return!1
let t=/^'([^']*)'$/.exec(e)
return t?t[1].trim():e}}function Co(e,t){let i=e.getType(),n=t.getType()
if(i!==n)return i-n
switch(i){case po.Defined:case po.Not:case po.Equals:case po.NotEquals:return e.cmp(t)
default:throw new Error("Unknown ContextKeyExpr!")}}class bo{constructor(e){this.key=e}getType(){return po.Defined}cmp(e){return this.key<e.key?-1:this.key>e.key?1:0}equals(e){return e instanceof bo&&this.key===e.key}evaluate(e){return!!e.getValue(this.key)}normalize(){return this}serialize(){return this.key}keys(){return[this.key]}}class wo{constructor(e,t){this.key=e,this.value=t}getType(){return po.Equals}cmp(e){return this.key<e.key?-1:this.key>e.key?1:this.value<e.value?-1:this.value>e.value?1:0}equals(e){return e instanceof wo&&(this.key===e.key&&this.value===e.value)}evaluate(e){return e.getValue(this.key)==this.value}normalize(){return"boolean"==typeof this.value?this.value?new bo(this.key):new So(this.key):this}serialize(){return"boolean"==typeof this.value?this.normalize().serialize():this.key+" == '"+this.value+"'"}keys(){return[this.key]}}class vo{constructor(e,t){this.key=e,this.value=t}getType(){return po.NotEquals}cmp(e){return this.key<e.key?-1:this.key>e.key?1:this.value<e.value?-1:this.value>e.value?1:0}equals(e){return e instanceof vo&&(this.key===e.key&&this.value===e.value)}evaluate(e){return e.getValue(this.key)!=this.value}normalize(){return"boolean"==typeof this.value?this.value?new So(this.key):new bo(this.key):this}serialize(){return"boolean"==typeof this.value?this.normalize().serialize():this.key+" != '"+this.value+"'"}keys(){return[this.key]}}class So{constructor(e){this.key=e}getType(){return po.Not}cmp(e){return this.key<e.key?-1:this.key>e.key?1:0}equals(e){return e instanceof So&&this.key===e.key}evaluate(e){return!e.getValue(this.key)}normalize(){return this}serialize(){return"!"+this.key}keys(){return[this.key]}}class yo{constructor(e){this.expr=yo._normalizeArr(e)}getType(){return po.And}equals(e){if(e instanceof yo){if(this.expr.length!==e.expr.length)return!1
for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1
return!0}return!1}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].evaluate(e))return!1
return!0}static _normalizeArr(e){let t=[]
if(e){for(let i=0,n=e.length;i<n;i++){let n=e[i]
n&&((n=n.normalize())&&(n instanceof yo?t=t.concat(n.expr):t.push(n)))}t.sort(Co)}return t}normalize(){return 0===this.expr.length?null:1===this.expr.length?this.expr[0]:this}serialize(){return 0===this.expr.length?"":1===this.expr.length?this.normalize().serialize():this.expr.map(e=>e.serialize()).join(" && ")}keys(){const e=[]
for(let t of this.expr)e.push(...t.keys())
return e}}class xo extends bo{constructor(e,t){super(e),this._defaultValue=t}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return _o.not(this.key)}isEqualTo(e){return _o.equals(this.key,e)}}const Lo=Ir("contextKeyService")
var No,Eo=Ir("codeEditorService")
function ko(e){if(e){let i=e.getControl()
if(i){if(p(i))return{codeEditor:i,diffEditor:null}
if((t=i)&&"function"==typeof t.getEditorType&&t.getEditorType()===m.IDiffEditor)return{codeEditor:null,diffEditor:i}}}var t
return{codeEditor:null,diffEditor:null}}function Io(e){let t=ko(e)
return t.codeEditor||t.diffEditor&&t.diffEditor.getModifiedEditor()||null}class Mo{constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._description=e.description}toCommandAndKeybindingRule(e){const t=this._kbOpts||{primary:0}
let i=t.kbExpr
this.precondition&&(i=i?_o.and(i,this.precondition):this.precondition)
const n="number"==typeof t.weight?t.weight:e
return{id:this.id,handler:(e,t)=>this.runCommand(e,t),weight:n,when:i,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac,description:this._description}}}class Do extends Mo{static bindToContribution(e){return class extends Do{constructor(e){super(e),this._callback=e.handler}runEditorCommand(t,i,n){e(i)&&this._callback(e(i))}}}runCommand(e,t){let i=e.get(Eo).getFocusedCodeEditor()
if(i||(i=function(e){const t=e.get(ao)
return Io(t.getActiveEditor&&t.getActiveEditor())}(e)),i)return i.invokeWithinContext(e=>{if(e.get(Lo).contextMatchesRules(this.precondition))return this.runEditorCommand(e,i,t)})}}class To extends Do{constructor(e){super(e),this.label=e.label,this.alias=e.alias,this.menuOpts=e.menuOpts}toMenuItem(){return this.menuOpts?{command:{id:this.id,title:this.label},when:_o.and(this.precondition,this.menuOpts.when),group:this.menuOpts.group,order:this.menuOpts.order}:null}runEditorCommand(e,t,i){return this.reportTelemetry(e,t),this.run(e,t,i||{})}reportTelemetry(e,t){}}function Oo(e){No.registerEditorAction(new e)}function Ro(e){Ao(new e)}function Ao(e){return No.registerEditorCommand(e),e}function Po(e){Fo.INSTANCE.registerEditorContribution(e)}!function(t){function i(e,t){Tr.registerCommand(e,(e,i)=>t(e,i||{}))}t.registerEditorAction=function(e){Fo.INSTANCE.registerEditorAction(e)},t.getEditorActions=function(){return Fo.INSTANCE.getEditorActions()},t.getEditorCommand=function(e){return Fo.INSTANCE.getEditorCommand(e)},t.getEditorContributions=function(){return Fo.INSTANCE.getEditorContributions()},t.commandWeight=function(e=0){return jr.WEIGHT.editorContrib(e)},t.registerEditorCommand=function(e){Fo.INSTANCE.registerEditorCommand(e)},t.registerLanguageCommand=i,t.registerDefaultLanguageCommand=function(t,n){i(t,function(t,i){const{resource:s,position:r}=i
if(!(s instanceof X))throw Et("resource")
if(!e.isIPosition(r))throw Et("position")
const o=t.get(Zr).getModel(s)
if(!o)throw Et("Can not find open model for "+s)
const a=e.lift(r)
return n(o,a,i)})}}(No||(No={}))
class Fo{constructor(){this.editorContributions=[],this.editorActions=[],this.editorCommands=Object.create(null)}registerEditorContribution(e){this.editorContributions.push(e)}registerEditorAction(e){let t=e.toMenuItem()
t&&so.appendMenuItem(io.EditorContext,t),jr.registerCommandAndKeybindingRule(e.toCommandAndKeybindingRule(jr.WEIGHT.editorContrib())),this.editorActions.push(e)}getEditorContributions(){return this.editorContributions.slice(0)}getEditorActions(){return this.editorActions.slice(0)}registerEditorCommand(e){jr.registerCommandAndKeybindingRule(e.toCommandAndKeybindingRule(jr.WEIGHT.editorContrib())),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}}Fo.INSTANCE=new Fo,qr.add("editor.commonContributions",Fo.INSTANCE)
class Wo{static _columnSelect(i,n,s,r,o,a){let l=Math.abs(o-s)+1,h=s>o,d=r>a,u=r<a,c=[]
for(let o=0;o<l;o++){let l=s+(h?-o:o),g=Cr.columnFromVisibleColumn2(i,n,l,r),m=Cr.columnFromVisibleColumn2(i,n,l,a),p=Cr.visibleColumnFromColumn2(i,n,new e(l,g)),f=Cr.visibleColumnFromColumn2(i,n,new e(l,m))
if(u){if(p>a)continue
if(f<r)continue}if(d){if(f>r)continue
if(p<a)continue}c.push(new mr(new t(l,g,l,g),0,new e(l,m),0))}return{viewStates:c,reversed:h,toLineNumber:o,toVisualColumn:a}}static columnSelect(t,i,n,s,r){const o=new e(n.selectionStartLineNumber,n.selectionStartColumn),a=Cr.visibleColumnFromColumn2(t,i,o)
return Wo._columnSelect(t,i,o.lineNumber,a,s,r)}static columnSelectLeft(e,t,i,n,s){return s>1&&s--,this.columnSelect(e,t,i.selection,n,s)}static columnSelectRight(t,i,n,s,r){let o=0,a=Math.min(n.position.lineNumber,s),l=Math.max(n.position.lineNumber,s)
for(let n=a;n<=l;n++){let s=i.getLineMaxColumn(n),r=Cr.visibleColumnFromColumn2(t,i,new e(n,s))
o=Math.max(o,r)}return r<o&&r++,this.columnSelect(t,i,n.selection,s,r)}static columnSelectUp(e,t,i,n,s,r){return(s-=n?e.pageSize:1)<1&&(s=1),this.columnSelect(e,t,i.selection,s,r)}static columnSelectDown(e,t,i,n,s,r){return(s+=n?e.pageSize:1)>t.getLineCount()&&(s=t.getLineCount()),this.columnSelect(e,t,i.selection,s,r)}}var Vo,Bo;(Bo=Vo||(Vo={})).textFocus=new xo("editorTextFocus",!1),Bo.focus=new xo("editorFocus",!1),Bo.readOnly=new xo("editorReadonly",!1),Bo.writable=Bo.readOnly.toNegated(),Bo.hasNonEmptySelection=new xo("editorHasSelection",!1),Bo.hasOnlyEmptySelection=Bo.hasNonEmptySelection.toNegated(),Bo.hasMultipleSelections=new xo("editorHasMultipleSelections",!1),Bo.hasSingleSelection=Bo.hasMultipleSelections.toNegated(),Bo.tabMovesFocus=new xo("editorTabMovesFocus",!1),Bo.tabDoesNotMoveFocus=Bo.tabMovesFocus.toNegated(),Bo.isInEmbeddedEditor=new xo("isInEmbeddedEditor",void 0),Bo.languageId=new xo("editorLangId",void 0),Bo.hasCompletionItemProvider=new xo("editorHasCompletionItemProvider",void 0),Bo.hasCodeActionsProvider=new xo("editorHasCodeActionsProvider",void 0),Bo.hasCodeLensProvider=new xo("editorHasCodeLensProvider",void 0),Bo.hasDefinitionProvider=new xo("editorHasDefinitionProvider",void 0),Bo.hasImplementationProvider=new xo("editorHasImplementationProvider",void 0),Bo.hasTypeDefinitionProvider=new xo("editorHasTypeDefinitionProvider",void 0),Bo.hasHoverProvider=new xo("editorHasHoverProvider",void 0),Bo.hasDocumentHighlightProvider=new xo("editorHasDocumentHighlightProvider",void 0),Bo.hasDocumentSymbolProvider=new xo("editorHasDocumentSymbolProvider",void 0),Bo.hasReferenceProvider=new xo("editorHasReferenceProvider",void 0),Bo.hasRenameProvider=new xo("editorHasRenameProvider",void 0),Bo.hasDocumentFormattingProvider=new xo("editorHasDocumentFormattingProvider",void 0),Bo.hasDocumentSelectionFormattingProvider=new xo("editorHasDocumentSelectionFormattingProvider",void 0),Bo.hasSignatureHelpProvider=new xo("editorHasSignatureHelpProvider",void 0)
class Ho{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range
return new At(i.endLineNumber,i.endColumn,i.endLineNumber,i.endColumn)}}class zo{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range
return new At(i.startLineNumber,i.startColumn,i.startLineNumber,i.startColumn)}}class Uo{constructor(e,t,i,n,s=!1){this._range=e,this._text=t,this._columnDeltaOffset=n,this._lineNumberDeltaOffset=i,this.insertsAutoWhitespace=s}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let i=t.getInverseEditOperations()[0].range
return new At(i.endLineNumber+this._lineNumberDeltaOffset,i.endColumn+this._columnDeltaOffset,i.endLineNumber+this._lineNumberDeltaOffset,i.endColumn+this._columnDeltaOffset)}}class Ko{constructor(e,t,i){this._range=e,this._text=t,this._initialSelection=i}getEditOperations(e,t){t.addEditOperation(this._range,this._text),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}class $o{static unshiftIndentCount(e,t,i){let n=Cr.visibleColumnFromColumn(e,t,i)
return Cr.prevTabStop(n,i)/i}static shiftIndentCount(e,t,i){let n=Cr.visibleColumnFromColumn(e,t,i)
return Cr.nextTabStop(n,i)/i}constructor(e,t){this._opts=t,this._selection=e,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}_addEditOperation(e,t,i){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,i):e.addEditOperation(t,i)}getEditOperations(e,i){const n=this._selection.startLineNumber
let s=this._selection.endLineNumber
1===this._selection.endColumn&&n!==s&&(s-=1)
const r=this._opts.tabSize,o=this._opts.oneIndent,a=n===s
if(this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(n))&&(this._useLastEditRangeForCursorEndPosition=!0),this._opts.useTabStops){let l=["",o],h=0,d=0
for(let u=n;u<=s;u++,h=d){d=0
let s,c=e.getLineContent(u),g=Le(c)
if((!this._opts.isUnshift||0!==c.length&&0!==g)&&(a||this._opts.isUnshift||0!==c.length)){if(-1===g&&(g=c.length),u>1&&Cr.visibleColumnFromColumn(c,g+1,r)%r!=0&&e.isCheapToTokenize(u-1)){let t=cr.getRawEnterActionAtPosition(e,u-1,e.getLineMaxColumn(u-1))
if(t){if(d=h,t.appendText)for(let e=0,i=t.appendText.length;e<i&&d<r&&32===t.appendText.charCodeAt(e);e++)d++
t.removeText&&(d=Math.max(0,d-t.removeText))
for(let e=0;e<d&&(0!==g&&32===c.charCodeAt(g-1));e++)g--}}if(!this._opts.isUnshift||0!==g){s=this._opts.isUnshift?$o.unshiftIndentCount(c,g+1,r):$o.shiftIndentCount(c,g+1,r)
for(let e=l.length;e<=s;e++)l[e]=l[e-1]+o
this._addEditOperation(i,new t(u,1,u,g+1),l[s]),u===n&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=g+1)}}}}else for(let l=n;l<=s;l++){const s=e.getLineContent(l)
let h=Le(s)
if((!this._opts.isUnshift||0!==s.length&&0!==h)&&((a||this._opts.isUnshift||0!==s.length)&&(-1===h&&(h=s.length),!this._opts.isUnshift||0!==h)))if(this._opts.isUnshift){h=Math.min(h,r)
for(let e=0;e<h;e++){if(9===s.charCodeAt(e)){h=e+1
break}}this._addEditOperation(i,new t(l,1,l,h+1),"")}else this._addEditOperation(i,new t(l,1,l,1),o),l===n&&(this._selectionStartColumnStaysPut=1===this._selection.startColumn)}this._selectionId=i.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){let e=t.getInverseEditOperations()[0]
return new At(e.range.endLineNumber,e.range.endColumn,e.range.endLineNumber,e.range.endColumn)}const i=t.getTrackedSelection(this._selectionId)
if(this._selectionStartColumnStaysPut){let e=this._selection.startColumn
return i.startColumn<=e?i:i.getDirection()===Ot.LTR?new At(i.startLineNumber,e,i.endLineNumber,i.endColumn):new At(i.endLineNumber,i.endColumn,i.startLineNumber,e)}return i}}class qo{constructor(e,t,i){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=i}getEditOperations(e,i){i.addTrackedEditOperation(new t(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),i.addTrackedEditOperation(new t(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(e,t){let i=t.getInverseEditOperations(),n=i[0].range,s=i[1].range
return new At(n.endLineNumber,n.endColumn,s.endLineNumber,s.endColumn-this._charAfterSelection.length)}}class Go{static indent(e,t,i){let n=[]
for(let t=0,s=i.length;t<s;t++)n[t]=new $o(i[t],{isUnshift:!1,tabSize:e.tabSize,oneIndent:e.oneIndent,useTabStops:e.useTabStops})
return n}static outdent(e,t,i){let n=[]
for(let t=0,s=i.length;t<s;t++)n[t]=new $o(i[t],{isUnshift:!0,tabSize:e.tabSize,oneIndent:e.oneIndent,useTabStops:e.useTabStops})
return n}static shiftIndent(e,t,i){i=i||1
let n=$o.shiftIndentCount(t,t.length+i,e.tabSize),s=""
for(let e=0;e<n;e++)s+="\t"
return s}static unshiftIndent(e,t,i){i=i||1
let n=$o.unshiftIndentCount(t,t.length+i,e.tabSize),s=""
for(let e=0;e<n;e++)s+="\t"
return s}static _distributedPaste(e,t,i,n){let s=[]
for(let e=0,t=i.length;e<t;e++)s[e]=new Ho(i[e],n[e])
return new _r(0,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,i,n,s,r){let o=[]
for(let e=0,a=n.length;e<a;e++){const a=n[e]
let l=a.getPosition()
if(r&&s.indexOf("\n")!==s.length-1&&(r=!1),r&&a.startLineNumber!==a.endLineNumber&&(r=!1),r&&a.startColumn===i.getLineMinColumn(a.startLineNumber)&&a.endColumn===i.getLineMaxColumn(a.startLineNumber)&&(r=!1),r){let i=new t(l.lineNumber,1,l.lineNumber,1)
o[e]=new Ho(i,s)}else o[e]=new Ho(a,s)}return new _r(0,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _distributePasteToCursors(e,t,i){if(t)return null
if(1===e.length)return null
for(let t=0;t<e.length;t++)if(e[t].startLineNumber!==e[t].endLineNumber)return null
let n=i.split(/\r\n|\r|\n/)
return n.length!==e.length?null:n}static paste(e,i,n,s,r){const o=this._distributePasteToCursors(n,s,r)
return o?(n=n.sort(t.compareRangesUsingStarts),this._distributedPaste(e,i,n,o)):this._simplePaste(e,i,n,r,s)}static _goodIndentForLine(e,i,n){let s,r,o=cr.getInheritIndentForLine(i,n,!1)
if(o)s=o.action,r=o.indentation
else if(n>1){let e=n-1
for(e=n-1;e>=1;e--){if(Ee(i.getLineContent(e))>=0)break}if(e<1)return null
let o=i.getLineMaxColumn(e),a=cr.getEnterAction(i,new t(e,o,e,o))
a&&(r=a.indentation,(s=a.enterAction)&&(r+=s.appendText))}return s&&(s===Sn.Indent&&(r=Go.shiftIndent(e,r)),s===Sn.Outdent&&(r=Go.unshiftIndent(e,r)),r=e.normalizeIndentation(r)),r||null}static _replaceJumpToNextIndent(e,t,i,n){let s="",r=i.getStartPosition()
if(e.insertSpaces){let i=Cr.visibleColumnFromColumn2(e,t,r),n=e.tabSize,o=n-i%n
for(let e=0;e<o;e++)s+=" "}else s="\t"
return new Ho(i,s,n)}static tab(e,i,n){let s=[]
for(let r=0,o=n.length;r<o;r++){const o=n[r]
if(o.isEmpty()){let n=i.getLineContent(o.startLineNumber)
if(/^\s*$/.test(n)&&i.isCheapToTokenize(o.startLineNumber)){let a=this._goodIndentForLine(e,i,o.startLineNumber)
a=a||"\t"
let l=e.normalizeIndentation(a)
if(!fe(n,l)){s[r]=new Ho(new t(o.startLineNumber,1,o.startLineNumber,n.length+1),l,!0)
continue}}s[r]=this._replaceJumpToNextIndent(e,i,o,!0)}else{if(o.startLineNumber===o.endLineNumber){let t=i.getLineMaxColumn(o.startLineNumber)
if(1!==o.startColumn||o.endColumn!==t){s[r]=this._replaceJumpToNextIndent(e,i,o,!1)
continue}}s[r]=new $o(o,{isUnshift:!1,tabSize:e.tabSize,oneIndent:e.oneIndent,useTabStops:e.useTabStops})}}return s}static replacePreviousChar(e,i,n,s,r,o){let a=[]
for(let e=0,i=s.length;e<i;e++){const i=s[e]
if(!i.isEmpty()){a[e]=null
continue}let n=i.getPosition(),l=Math.max(1,n.column-o),h=new t(n.lineNumber,l,n.lineNumber,n.column)
a[e]=new Ho(h,r)}return new _r(1,a,{shouldPushStackElementBefore:1!==e,shouldPushStackElementAfter:!1})}static _typeCommand(e,t,i){return i?new zo(e,t,!0):new Ho(e,t,!0)}static _enter(e,i,n,s){if(!i.isCheapToTokenize(s.getStartPosition().lineNumber)){let t=Ne(i.getLineContent(s.startLineNumber)).substring(0,s.startColumn-1)
return Go._typeCommand(s,"\n"+e.normalizeIndentation(t),n)}let r=cr.getEnterAction(i,s)
if(r){let t=r.enterAction,i=r.indentation
if(t.indentAction===Sn.None)return Go._typeCommand(s,"\n"+e.normalizeIndentation(i+t.appendText),n)
if(t.indentAction===Sn.Indent)return Go._typeCommand(s,"\n"+e.normalizeIndentation(i+t.appendText),n)
if(t.indentAction===Sn.IndentOutdent){let r=e.normalizeIndentation(i),o=e.normalizeIndentation(i+t.appendText),a="\n"+o+"\n"+r
return n?new zo(s,a,!0):new Uo(s,a,-1,o.length-r.length,!0)}if(t.indentAction===Sn.Outdent){let r=Go.unshiftIndent(e,i)
return Go._typeCommand(s,"\n"+e.normalizeIndentation(r+t.appendText),n)}}if(!e.autoIndent){let t=Ne(i.getLineContent(s.startLineNumber)).substring(0,s.startColumn-1)
return Go._typeCommand(s,"\n"+e.normalizeIndentation(t),n)}let o=cr.getIndentForEnter(i,s,{unshiftIndent:t=>Go.unshiftIndent(e,t),shiftIndent:t=>Go.shiftIndent(e,t),normalizeIndentation:t=>e.normalizeIndentation(t)},e.autoIndent),a=i.getLineContent(s.startLineNumber),l=Ne(a).substring(0,s.startColumn-1)
if(o){let r=Cr.visibleColumnFromColumn2(e,i,s.getEndPosition()),h=s.endColumn,d="\n"
l!==e.normalizeIndentation(o.beforeEnter)&&(d=e.normalizeIndentation(o.beforeEnter)+a.substring(l.length,s.startColumn-1)+"\n",s=new t(s.startLineNumber,1,s.endLineNumber,s.endColumn))
let u=Le(i.getLineContent(s.endLineNumber))
if(s=u>=0?s.setEndPosition(s.endLineNumber,Math.max(s.endColumn,u+1)):s.setEndPosition(s.endLineNumber,i.getLineMaxColumn(s.endLineNumber)),n)return new zo(s,d+e.normalizeIndentation(o.afterEnter),!0)
{let t=0
return h<=u+1&&(e.insertSpaces||(r=Math.ceil(r/e.tabSize)),t=Math.min(r+1-e.normalizeIndentation(o.afterEnter).length-1,0)),new Uo(s,d+e.normalizeIndentation(o.afterEnter),0,t,!0)}}return Go._typeCommand(s,"\n"+e.normalizeIndentation(l),n)}static _isAutoIndentType(e,t,i){if(!e.autoIndent)return!1
for(let e=0,n=i.length;e<n;e++)if(!t.isCheapToTokenize(i[e].getEndPosition().lineNumber))return!1
return!0}static _runAutoIndentType(e,i,n,s){let r=cr.getIndentationAtPosition(i,n.startLineNumber,n.startColumn),o=cr.getIndentActionForType(i,n,s,{shiftIndent:t=>Go.shiftIndent(e,t),unshiftIndent:t=>Go.unshiftIndent(e,t)})
if(null===o)return null
if(o!==e.normalizeIndentation(r)){let r=i.getLineFirstNonWhitespaceColumn(n.startLineNumber)
return 0===r?Go._typeCommand(new t(n.startLineNumber,0,n.endLineNumber,n.endColumn),e.normalizeIndentation(o)+s,!1):Go._typeCommand(new t(n.startLineNumber,0,n.endLineNumber,n.endColumn),e.normalizeIndentation(o)+i.getLineContent(n.startLineNumber).substring(r-1,n.startColumn-1)+s,!1)}return null}static _isAutoClosingCloseCharType(e,t,i,n){if(!e.autoClosingBrackets||!e.autoClosingPairsClose.hasOwnProperty(n))return!1
const s=n===e.autoClosingPairsClose[n]
for(let e=0,r=i.length;e<r;e++){const r=i[e]
if(!r.isEmpty())return!1
const o=r.getPosition(),a=t.getLineContent(o.lineNumber)
if(a.charAt(o.column-1)!==n)return!1
if(s){const e=a.substr(0,o.column-1)
if(this._countNeedlesInHaystack(e,n)%2==0)return!1}}return!0}static _countNeedlesInHaystack(e,t){let i=0,n=-1
for(;-1!==(n=e.indexOf(t,n+1));)i++
return i}static _runAutoClosingCloseCharType(e,i,n,s,r){let o=[]
for(let e=0,i=s.length;e<i;e++){const i=s[e].getPosition(),n=new t(i.lineNumber,i.column,i.lineNumber,i.column+1)
o[e]=new Ho(n,r)}return new _r(1,o,{shouldPushStackElementBefore:1!==e,shouldPushStackElementAfter:!1})}static _isAutoClosingOpenCharType(e,t,i,n){if(!e.autoClosingBrackets||!e.autoClosingPairsOpen.hasOwnProperty(n))return!1
for(let s=0,r=i.length;s<r;s++){const r=i[s]
if(!r.isEmpty())return!1
const o=r.getPosition(),a=t.getLineContent(o.lineNumber)
if(("'"===n||'"'===n)&&o.column>1){const t=tn(e.wordSeparators),i=a.charCodeAt(o.column-2)
if(0===t.get(i))return!1}const l=a.charAt(o.column-1)
if(l){const t=e.autoClosingPairsOpen[n]===n
let i=!1
for(let n in e.autoClosingPairsClose){const s=e.autoClosingPairsOpen[n]===n
if((t||!s)&&l===n){i=!0
break}}if(!i&&!/\s/.test(l))return!1}if(!t.isCheapToTokenize(o.lineNumber))return!1
t.forceTokenization(o.lineNumber)
const h=t.getLineTokens(o.lineNumber)
let d=!1
try{d=cr.shouldAutoClosePair(n,h,o.column)}catch(e){St(e)}if(!d)return!1}return!0}static _runAutoClosingOpenCharType(e,t,i,n,s){let r=[]
for(let e=0,i=n.length;e<i;e++){const i=n[e],o=t.autoClosingPairsOpen[s]
r[e]=new Uo(i,s+o,0,-o.length)}return new _r(1,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static _isSurroundSelectionType(e,t,i,n){if(!e.autoClosingBrackets||!e.surroundingPairs.hasOwnProperty(n))return!1
for(let e=0,n=i.length;e<n;e++){const n=i[e]
if(n.isEmpty())return!1
let s=!0
for(let e=n.startLineNumber;e<=n.endLineNumber;e++){const i=t.getLineContent(e),r=e===n.startLineNumber?n.startColumn-1:0,o=e===n.endLineNumber?n.endColumn-1:i.length,a=i.substring(r,o)
if(/[^ \t]/.test(a)){s=!1
break}}if(s)return!1}return!0}static _runSurroundSelectionType(e,t,i,n,s){let r=[]
for(let e=0,i=n.length;e<i;e++){const i=n[e],o=t.surroundingPairs[s]
r[e]=new qo(i,s,o)}return new _r(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isTypeInterceptorElectricChar(e,t,i){return!(1!==i.length||!t.isCheapToTokenize(i[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,i,n,s,r){if(!i.electricChars.hasOwnProperty(r)||!s.isEmpty())return null
let o=s.getPosition()
n.forceTokenization(o.lineNumber)
let a,l=n.getLineTokens(o.lineNumber)
try{a=cr.onElectricCharacter(r,l,o.column)}catch(e){St(e)}if(!a)return null
if(a.appendText){const e=new Uo(s,r+a.appendText,0,-a.appendText.length)
return new _r(1,[e],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}if(a.matchOpenBracket){let e=(l.getLineContent()+r).lastIndexOf(a.matchOpenBracket)+1,s=n.findMatchingBracketUp(a.matchOpenBracket,{lineNumber:o.lineNumber,column:e})
if(s){if(s.startLineNumber===o.lineNumber)return null
let e=Ne(n.getLineContent(s.startLineNumber)),a=i.normalizeIndentation(e),l=n.getLineContent(o.lineNumber),h=n.getLineFirstNonWhitespaceColumn(o.lineNumber)||o.column,d=a+l.substring(h-1,o.column-1)+r,u=new t(o.lineNumber,1,o.lineNumber,o.column)
const c=new Ho(u,d)
return new _r(1,[c],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}static typeWithInterceptors(e,t,i,n,s){if("\n"===s){let e=[]
for(let s=0,r=n.length;s<r;s++)e[s]=Go._enter(t,i,!1,n[s])
return new _r(1,e,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(this._isAutoIndentType(t,i,n)){let e=[],r=!1
for(let o=0,a=n.length;o<a;o++)if(e[o]=this._runAutoIndentType(t,i,n[o],s),!e[o]){r=!0
break}if(!r)return new _r(1,e,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(this._isAutoClosingCloseCharType(t,i,n,s))return this._runAutoClosingCloseCharType(e,t,i,n,s)
if(this._isAutoClosingOpenCharType(t,i,n,s))return this._runAutoClosingOpenCharType(e,t,i,n,s)
if(this._isSurroundSelectionType(t,i,n,s))return this._runSurroundSelectionType(e,t,i,n,s)
if(this._isTypeInterceptorElectricChar(t,i,n)){const r=this._typeInterceptorElectricChar(e,t,i,n[0],s)
if(r)return r}let r=[]
for(let e=0,t=n.length;e<t;e++)r[e]=new Ho(n[e],s)
let o=1!==e
return" "===s&&(o=!0),new _r(1,r,{shouldPushStackElementBefore:o,shouldPushStackElementAfter:!1})}static typeWithoutInterceptors(e,t,i,n,s){let r=[]
for(let e=0,t=n.length;e<t;e++)r[e]=new Ho(n[e],s)
return new _r(1,r,{shouldPushStackElementBefore:1!==e,shouldPushStackElementAfter:!1})}static lineInsertBefore(e,i,n){let s=[]
for(let r=0,o=n.length;r<o;r++){let o=n[r].positionLineNumber
if(1===o)s[r]=new zo(new t(1,1,1,1),"\n")
else{o--
let n=i.getLineMaxColumn(o)
s[r]=this._enter(e,i,!1,new t(o,n,o,n))}}return s}static lineInsertAfter(e,i,n){let s=[]
for(let r=0,o=n.length;r<o;r++){const o=n[r].positionLineNumber
let a=i.getLineMaxColumn(o)
s[r]=this._enter(e,i,!1,new t(o,a,o,a))}return s}static lineBreakInsert(e,t,i){let n=[]
for(let s=0,r=i.length;s<r;s++)n[s]=this._enter(e,t,!0,i[s])
return n}}class jo{static deleteRight(e,i,n,s){let r=[],o=3!==e
for(let e=0,a=s.length;e<a;e++){const a=s[e]
let l=a
if(l.isEmpty()){let e=a.getPosition(),s=xr.right(i,n,e.lineNumber,e.column)
l=new t(s.lineNumber,s.column,e.lineNumber,e.column)}l.isEmpty()?r[e]=null:(l.startLineNumber!==l.endLineNumber&&(o=!0),r[e]=new Ho(l,""))}return[o,r]}static _isAutoClosingPairDelete(e,t,i){if(!e.autoClosingBrackets)return!1
for(let n=0,s=i.length;n<s;n++){const s=i[n],r=s.getPosition()
if(!s.isEmpty())return!1
const o=t.getLineContent(r.lineNumber),a=o[r.column-2]
if(!e.autoClosingPairsOpen.hasOwnProperty(a))return!1
if(o[r.column-1]!==e.autoClosingPairsOpen[a])return!1}return!0}static _runAutoClosingPairDelete(e,i,n){let s=[]
for(let e=0,i=n.length;e<i;e++){const i=n[e].getPosition(),r=new t(i.lineNumber,i.column-1,i.lineNumber,i.column+1)
s[e]=new Ho(r,"")}return[!0,s]}static deleteLeft(e,i,n,s){if(this._isAutoClosingPairDelete(i,n,s))return this._runAutoClosingPairDelete(i,n,s)
let r=[],o=2!==e
for(let e=0,a=s.length;e<a;e++){const a=s[e]
let l=a
if(l.isEmpty()){let e=a.getPosition()
if(i.useTabStops&&e.column>1){let s=n.getLineContent(e.lineNumber),r=Le(s),o=-1===r?s.length+1:r+1
if(e.column<=o){let s=Cr.visibleColumnFromColumn2(i,n,e),r=Cr.prevTabStop(s,i.tabSize),o=Cr.columnFromVisibleColumn2(i,n,e.lineNumber,r)
l=new t(e.lineNumber,o,e.lineNumber,e.column)}else l=new t(e.lineNumber,e.column-1,e.lineNumber,e.column)}else{let s=xr.left(i,n,e.lineNumber,e.column)
l=new t(s.lineNumber,s.column,e.lineNumber,e.column)}}l.isEmpty()?r[e]=null:(l.startLineNumber!==l.endLineNumber&&(o=!0),r[e]=new Ho(l,""))}return[o,r]}static cut(e,i,n){let s=[]
for(let r=0,o=n.length;r<o;r++){const o=n[r]
if(o.isEmpty())if(e.emptySelectionClipboard){let e,n,a,l,h=o.getPosition()
h.lineNumber<i.getLineCount()?(e=h.lineNumber,n=1,a=h.lineNumber+1,l=1):h.lineNumber>1?(e=h.lineNumber-1,n=i.getLineMaxColumn(h.lineNumber-1),a=h.lineNumber,l=i.getLineMaxColumn(h.lineNumber)):(e=h.lineNumber,n=1,a=h.lineNumber,l=i.getLineMaxColumn(h.lineNumber))
let d=new t(e,n,a,l)
d.isEmpty()?s[r]=null:s[r]=new Ho(d,"")}else s[r]=null
else s[r]=new Ho(o,"")}return new _r(0,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}const Yo=f,Zo=jr.WEIGHT.editorCore()
class Xo extends Do{runEditorCommand(e,t,i){this.runCoreEditorCommand(t._getCursors(),i||{})}}var Jo,Qo,ea,ta,ia,na,sa
!function(e){e.description={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'to': A mandatory direction value.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'up', 'down'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'by': Unit to move. Default is computed based on 'to' value.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'line', 'wrappedLine', 'page', 'halfPage'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'value': Number of units to move. Default is '1'.\n\t\t\t\t\t* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n\t\t\t\t",constraint:function(e){if(!ot(e))return!1
let t=e
return!(!rt(t.to)||!ht(t.by)&&!rt(t.by)||!ht(t.value)&&!at(t.value)||!ht(t.revealCursor)&&!lt(t.revealCursor))}}]},e.RawDirection={Up:"up",Down:"down"},e.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage"},e.parse=function(t){let i,n
switch(t.to){case e.RawDirection.Up:i=1
break
case e.RawDirection.Down:i=2
break
default:return null}switch(t.by){case e.RawUnit.Line:n=1
break
case e.RawUnit.WrappedLine:n=2
break
case e.RawUnit.Page:n=3
break
case e.RawUnit.HalfPage:n=4
break
default:n=2}return{direction:i,unit:n,value:Math.floor(t.value||1),revealCursor:!!t.revealCursor,select:!!t.select}}}(Jo||(Jo={})),(ea=Qo||(Qo={})).description={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'lineNumber': A mandatory line number value.\n\t\t\t\t\t* 'at': Logical position at which line has to be revealed .\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'top', 'center', 'bottom'\n\t\t\t\t\t\t```\n\t\t\t\t",constraint:function(e){if(!ot(e))return!1
let t=e
return!(!at(t.lineNumber)||!ht(t.at)&&!rt(t.at))}}]},ea.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"},function(i){class n extends Xo{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.context.model.pushStackElement(),e.setStates(t.source,br.Explicit,[Nr.moveTo(e.context,e.getPrimaryCursor(),this._inSelectionMode,t.position,t.viewPosition)]),e.reveal(!0,0,0)}}i.MoveTo=Ao(new n({id:"_moveTo",inSelectionMode:!1,precondition:null})),i.MoveToSelect=Ao(new n({id:"_moveToSelect",inSelectionMode:!0,precondition:null}))
class s extends Xo{runCoreEditorCommand(e,t){e.context.model.pushStackElement()
const i=this._getColumnSelectResult(e.context,e.getPrimaryCursor(),e.getColumnSelectData(),t)
e.setStates(t.source,br.Explicit,i.viewStates.map(e=>fr.fromViewState(e))),e.setColumnSelectData({toViewLineNumber:i.toLineNumber,toViewVisualColumn:i.toVisualColumn}),e.reveal(!0,i.reversed?1:2,0)}}i.ColumnSelect=Ao(new class extends s{constructor(){super({id:"columnSelect",precondition:null})}_getColumnSelectResult(t,i,n,s){const r=t.model.validatePosition(s.position)
let o
return o=s.viewPosition?t.validateViewPosition(new e(s.viewPosition.lineNumber,s.viewPosition.column),r):t.convertModelPositionToViewPosition(r),Wo.columnSelect(t.config,t.viewModel,i.viewState.selection,o.lineNumber,s.mouseColumn-1)}}),i.CursorColumnSelectLeft=Ao(new class extends s{constructor(){super({id:"cursorColumnSelectLeft",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(e,t,i,n){return Wo.columnSelectLeft(e.config,e.viewModel,t.viewState,i.toViewLineNumber,i.toViewVisualColumn)}}),i.CursorColumnSelectRight=Ao(new class extends s{constructor(){super({id:"cursorColumnSelectRight",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(e,t,i,n){return Wo.columnSelectRight(e.config,e.viewModel,t.viewState,i.toViewLineNumber,i.toViewVisualColumn)}})
class r extends s{constructor(e){super(e),this._isPaged=e.isPaged}_getColumnSelectResult(e,t,i,n){return Wo.columnSelectUp(e.config,e.viewModel,t.viewState,this._isPaged,i.toViewLineNumber,i.toViewVisualColumn)}}i.CursorColumnSelectUp=Ao(new r({isPaged:!1,id:"cursorColumnSelectUp",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:3600,linux:{primary:0}}})),i.CursorColumnSelectPageUp=Ao(new r({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:3595,linux:{primary:0}}}))
class o extends s{constructor(e){super(e),this._isPaged=e.isPaged}_getColumnSelectResult(e,t,i,n){return Wo.columnSelectDown(e.config,e.viewModel,t.viewState,this._isPaged,i.toViewLineNumber,i.toViewVisualColumn)}}i.CursorColumnSelectDown=Ao(new o({isPaged:!1,id:"cursorColumnSelectDown",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:3602,linux:{primary:0}}})),i.CursorColumnSelectPageDown=Ao(new o({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:3596,linux:{primary:0}}}))
class a extends Xo{constructor(){super({id:"cursorMove",precondition:null,description:vr.description})}runCoreEditorCommand(e,t){const i=vr.parse(t)
i&&this._runCursorMove(e,t.source,i)}_runCursorMove(e,t,i){e.context.model.pushStackElement(),e.setStates(t,br.Explicit,fr.ensureInEditableRange(e.context,Nr.move(e.context,e.getAll(),i))),e.reveal(!0,0,0)}}i.CursorMoveImpl=a,i.CursorMove=Ao(new a)
class l extends Xo{constructor(e){super(e),this._staticArgs=e.args}runCoreEditorCommand(e,t){let n=this._staticArgs;-1===this._staticArgs.value&&(n={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:e.context.config.pageSize}),i.CursorMove._runCursorMove(e,t.source,n)}}i.CursorLeft=Ao(new l({args:{direction:0,unit:0,select:!1,value:1},id:"cursorLeft",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:15,mac:{primary:15,secondary:[288]}}})),i.CursorLeftSelect=Ao(new l({args:{direction:0,unit:0,select:!0,value:1},id:"cursorLeftSelect",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:1039}})),i.CursorRight=Ao(new l({args:{direction:1,unit:0,select:!1,value:1},id:"cursorRight",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:17,mac:{primary:17,secondary:[292]}}})),i.CursorRightSelect=Ao(new l({args:{direction:1,unit:0,select:!0,value:1},id:"cursorRightSelect",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:1041}})),i.CursorUp=Ao(new l({args:{direction:2,unit:2,select:!1,value:1},id:"cursorUp",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:16,mac:{primary:16,secondary:[302]}}})),i.CursorUpSelect=Ao(new l({args:{direction:2,unit:2,select:!0,value:1},id:"cursorUpSelect",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),i.CursorPageUp=Ao(new l({args:{direction:2,unit:2,select:!1,value:-1},id:"cursorPageUp",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:11}})),i.CursorPageUpSelect=Ao(new l({args:{direction:2,unit:2,select:!0,value:-1},id:"cursorPageUpSelect",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:1035}})),i.CursorDown=Ao(new l({args:{direction:3,unit:2,select:!1,value:1},id:"cursorDown",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:18,mac:{primary:18,secondary:[300]}}})),i.CursorDownSelect=Ao(new l({args:{direction:3,unit:2,select:!0,value:1},id:"cursorDownSelect",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),i.CursorPageDown=Ao(new l({args:{direction:3,unit:2,select:!1,value:-1},id:"cursorPageDown",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:12}})),i.CursorPageDownSelect=Ao(new l({args:{direction:3,unit:2,select:!0,value:-1},id:"cursorPageDownSelect",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:1036}})),i.CreateCursor=Ao(new class extends Xo{constructor(){super({id:"createCursor",precondition:null})}runCoreEditorCommand(e,t){const i=e.context
if(i.config.readOnly||i.model.hasEditableRange())return
let n
n=t.wholeLine?Nr.line(i,e.getPrimaryCursor(),!1,t.position,t.viewPosition):Nr.moveTo(i,e.getPrimaryCursor(),!1,t.position,t.viewPosition)
const s=e.getAll()
if(s.length>1){const i=n.modelState?n.modelState.position:null,r=n.viewState?n.viewState.position:null
for(let n=0,o=s.length;n<o;n++){const o=s[n]
if((!i||o.modelState.selection.containsPosition(i))&&(!r||o.viewState.selection.containsPosition(r)))return s.splice(n,1),e.context.model.pushStackElement(),void e.setStates(t.source,br.Explicit,s)}}s.push(n),e.context.model.pushStackElement(),e.setStates(t.source,br.Explicit,s)}}),i.LastCursorMoveToSelect=Ao(new class extends Xo{constructor(){super({id:"_lastCursorMoveToSelect",precondition:null})}runCoreEditorCommand(e,t){const i=e.context
if(i.config.readOnly||i.model.hasEditableRange())return
const n=e.getLastAddedCursorIndex()
let s=e.getAll().slice(0)
s[n]=Nr.moveTo(i,s[n],!0,t.position,t.viewPosition),e.context.model.pushStackElement(),e.setStates(t.source,br.Explicit,s)}})
class h extends Xo{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.context.model.pushStackElement(),e.setStates(t.source,br.Explicit,fr.ensureInEditableRange(e.context,Nr.moveToBeginningOfLine(e.context,e.getAll(),this._inSelectionMode))),e.reveal(!0,0,0)}}i.CursorHome=Ao(new h({inSelectionMode:!1,id:"cursorHome",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),i.CursorHomeSelect=Ao(new h({inSelectionMode:!0,id:"cursorHomeSelect",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}})),i.CursorLineStart=Ao(new class extends Xo{constructor(){super({id:"cursorLineStart",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:0,mac:{primary:287}}})}runCoreEditorCommand(e,t){e.context.model.pushStackElement(),e.setStates(t.source,br.Explicit,fr.ensureInEditableRange(e.context,this._exec(e.context,e.getAll()))),e.reveal(!0,0,0)}_exec(e,t){let i=[]
for(let e=0,n=t.length;e<n;e++){const n=t[e],s=n.modelState.position.lineNumber
i[e]=fr.fromModelState(n.modelState.move(!1,s,1,0))}return i}})
class d extends Xo{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.context.model.pushStackElement(),e.setStates(t.source,br.Explicit,fr.ensureInEditableRange(e.context,Nr.moveToEndOfLine(e.context,e.getAll(),this._inSelectionMode))),e.reveal(!0,0,0)}}i.CursorEnd=Ao(new d({inSelectionMode:!1,id:"cursorEnd",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:13,mac:{primary:13,secondary:[2065]}}})),i.CursorEndSelect=Ao(new d({inSelectionMode:!0,id:"cursorEndSelect",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:1037,mac:{primary:1037,secondary:[3089]}}})),i.CursorLineEnd=Ao(new class extends Xo{constructor(){super({id:"cursorLineEnd",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:0,mac:{primary:291}}})}runCoreEditorCommand(e,t){e.context.model.pushStackElement(),e.setStates(t.source,br.Explicit,fr.ensureInEditableRange(e.context,this._exec(e.context,e.getAll()))),e.reveal(!0,0,0)}_exec(e,t){let i=[]
for(let n=0,s=t.length;n<s;n++){const s=t[n],r=s.modelState.position.lineNumber,o=e.model.getLineMaxColumn(r)
i[n]=fr.fromModelState(s.modelState.move(!1,r,o,0))}return i}})
class u extends Xo{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.context.model.pushStackElement(),e.setStates(t.source,br.Explicit,fr.ensureInEditableRange(e.context,Nr.moveToBeginningOfBuffer(e.context,e.getAll(),this._inSelectionMode))),e.reveal(!0,0,0)}}i.CursorTop=Ao(new u({inSelectionMode:!1,id:"cursorTop",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:2062,mac:{primary:2064}}})),i.CursorTopSelect=Ao(new u({inSelectionMode:!0,id:"cursorTopSelect",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:3086,mac:{primary:3088}}}))
class c extends Xo{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.context.model.pushStackElement(),e.setStates(t.source,br.Explicit,fr.ensureInEditableRange(e.context,Nr.moveToEndOfBuffer(e.context,e.getAll(),this._inSelectionMode))),e.reveal(!0,0,0)}}i.CursorBottom=Ao(new c({inSelectionMode:!1,id:"cursorBottom",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:2061,mac:{primary:2066}}})),i.CursorBottomSelect=Ao(new c({inSelectionMode:!0,id:"cursorBottomSelect",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:3085,mac:{primary:3090}}}))
class g extends Xo{constructor(){super({id:"editorScroll",precondition:null,description:Jo.description})}runCoreEditorCommand(e,t){const i=Jo.parse(t)
i&&this._runEditorScroll(e,t.source,i)}_runEditorScroll(e,t,i){const n=this._computeDesiredScrollTop(e.context,i)
if(i.revealCursor){const s=e.context.getCompletelyVisibleViewRangeAtScrollTop(n)
e.setStates(t,br.Explicit,[Nr.findPositionInViewportIfOutside(e.context,e.getPrimaryCursor(),s,i.select)])}e.scrollTo(n)}_computeDesiredScrollTop(t,i){if(1===i.unit){const n=t.getCompletelyVisibleModelRange()
let s
s=1===i.direction?Math.max(1,n.startLineNumber-i.value):Math.min(t.model.getLineCount(),n.startLineNumber+i.value)
const r=t.convertModelPositionToViewPosition(new e(s,1))
return t.getVerticalOffsetForViewLine(r.lineNumber)}let n
n=3===i.unit?t.config.pageSize*i.value:4===i.unit?Math.round(t.config.pageSize/2)*i.value:i.value
const s=(1===i.direction?-1:1)*n
return t.getCurrentScrollTop()+s*t.config.lineHeight}}i.EditorScrollImpl=g,i.EditorScroll=Ao(new g),i.ScrollLineUp=Ao(new class extends Xo{constructor(){super({id:"scrollLineUp",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(e,t){i.EditorScroll._runEditorScroll(e,t.source,{direction:1,unit:2,value:1,revealCursor:!1,select:!1})}}),i.ScrollPageUp=Ao(new class extends Xo{constructor(){super({id:"scrollPageUp",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(e,t){i.EditorScroll._runEditorScroll(e,t.source,{direction:1,unit:3,value:1,revealCursor:!1,select:!1})}}),i.ScrollLineDown=Ao(new class extends Xo{constructor(){super({id:"scrollLineDown",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(e,t){i.EditorScroll._runEditorScroll(e,t.source,{direction:2,unit:2,value:1,revealCursor:!1,select:!1})}}),i.ScrollPageDown=Ao(new class extends Xo{constructor(){super({id:"scrollPageDown",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(e,t){i.EditorScroll._runEditorScroll(e,t.source,{direction:2,unit:3,value:1,revealCursor:!1,select:!1})}})
class m extends Xo{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.context.model.pushStackElement(),e.setStates(t.source,br.Explicit,[Nr.word(e.context,e.getPrimaryCursor(),this._inSelectionMode,t.position)]),e.reveal(!0,0,0)}}i.WordSelect=Ao(new m({inSelectionMode:!1,id:"_wordSelect",precondition:null})),i.WordSelectDrag=Ao(new m({inSelectionMode:!0,id:"_wordSelectDrag",precondition:null})),i.LastCursorWordSelect=Ao(new class extends Xo{constructor(){super({id:"lastCursorWordSelect",precondition:null})}runCoreEditorCommand(e,t){const i=e.context
if(i.config.readOnly||i.model.hasEditableRange())return
const n=e.getLastAddedCursorIndex()
let s=e.getAll().slice(0),r=s[n]
s[n]=Nr.word(i,r,r.modelState.hasSelection(),t.position),i.model.pushStackElement(),e.setStates(t.source,br.Explicit,s)}})
class p extends Xo{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.context.model.pushStackElement(),e.setStates(t.source,br.Explicit,[Nr.line(e.context,e.getPrimaryCursor(),this._inSelectionMode,t.position,t.viewPosition)]),e.reveal(!1,0,0)}}i.LineSelect=Ao(new p({inSelectionMode:!1,id:"_lineSelect",precondition:null})),i.LineSelectDrag=Ao(new p({inSelectionMode:!0,id:"_lineSelectDrag",precondition:null}))
class f extends Xo{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){const i=e.context
if(i.config.readOnly||i.model.hasEditableRange())return
const n=e.getLastAddedCursorIndex()
let s=e.getAll().slice(0)
s[n]=Nr.line(e.context,s[n],this._inSelectionMode,t.position,t.viewPosition),e.context.model.pushStackElement(),e.setStates(t.source,br.Explicit,s)}}i.LastCursorLineSelect=Ao(new f({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:null})),i.LastCursorLineSelectDrag=Ao(new f({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:null})),i.ExpandLineSelection=Ao(new class extends Xo{constructor(){super({id:"expandLineSelection",precondition:null,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:2087}})}runCoreEditorCommand(e,t){e.context.model.pushStackElement(),e.setStates(t.source,br.Explicit,fr.ensureInEditableRange(e.context,Nr.expandLineSelection(e.context,e.getAll()))),e.reveal(!0,0,0)}}),i.CancelSelection=Ao(new class extends Xo{constructor(){super({id:"cancelSelection",precondition:Vo.hasNonEmptySelection,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(e,t){e.context.model.pushStackElement(),e.setStates(t.source,br.Explicit,[Nr.cancelSelection(e.context,e.getPrimaryCursor())]),e.reveal(!0,0,0)}}),i.RemoveSecondaryCursors=Ao(new class extends Xo{constructor(){super({id:"removeSecondaryCursors",precondition:Vo.hasMultipleSelections,kbOpts:{weight:Zo+1,kbExpr:Vo.textFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(e,t){e.context.model.pushStackElement(),e.setStates(t.source,br.Explicit,[e.getPrimaryCursor()]),e.reveal(!0,0,0)}}),i.RevealLine=Ao(new class extends Xo{constructor(){super({id:"revealLine",precondition:null,description:Qo.description})}runCoreEditorCommand(e,i){const n=i
let s=n.lineNumber+1
s<1&&(s=1)
const r=e.context.model.getLineCount()
s>r&&(s=r)
const o=new t(s,1,s,e.context.model.getLineMaxColumn(s))
let a=0
if(n.at)switch(n.at){case Qo.RawAtArgument.Top:a=3
break
case Qo.RawAtArgument.Center:a=1
break
case Qo.RawAtArgument.Bottom:a=4}const l=e.context.convertModelRangeToViewRange(o)
e.revealRange(!1,l,a,0)}}),i.SelectAll=Ao(new class extends Xo{constructor(){super({id:"selectAll",precondition:null})}runCoreEditorCommand(e,t){e.context.model.pushStackElement(),e.setStates(t.source,br.Explicit,[Nr.selectAll(e.context,e.getPrimaryCursor())])}}),i.SetSelection=Ao(new class extends Xo{constructor(){super({id:"setSelection",precondition:null})}runCoreEditorCommand(e,t){e.context.model.pushStackElement(),e.setStates(t.source,br.Explicit,[fr.fromModelSelection(t.selection)])}})}(ta||(ta={})),(na=ia||(ia={})).LineBreakInsert=Ao(new class extends Do{constructor(){super({id:"lineBreakInsert",precondition:Vo.writable,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:null,mac:{primary:301}}})}runEditorCommand(e,t,i){t.pushUndoStop(),t.executeCommands(this.id,Go.lineBreakInsert(t._getCursorConfiguration(),t.getModel(),t.getSelections()))}}),na.Outdent=Ao(new class extends Do{constructor(){super({id:"outdent",precondition:Vo.writable,kbOpts:{weight:Zo,kbExpr:_o.and(Vo.textFocus,Vo.tabDoesNotMoveFocus),primary:1026}})}runEditorCommand(e,t,i){t.pushUndoStop(),t.executeCommands(this.id,Go.outdent(t._getCursorConfiguration(),t.getModel(),t.getSelections())),t.pushUndoStop()}}),na.Tab=Ao(new class extends Do{constructor(){super({id:"tab",precondition:Vo.writable,kbOpts:{weight:Zo,kbExpr:_o.and(Vo.textFocus,Vo.tabDoesNotMoveFocus),primary:2}})}runEditorCommand(e,t,i){t.pushUndoStop(),t.executeCommands(this.id,Go.tab(t._getCursorConfiguration(),t.getModel(),t.getSelections())),t.pushUndoStop()}}),na.DeleteLeft=Ao(new class extends Do{constructor(){super({id:"deleteLeft",precondition:Vo.writable,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runEditorCommand(e,t,i){const n=t._getCursors(),[s,r]=jo.deleteLeft(n.getPrevEditOperationType(),t._getCursorConfiguration(),t.getModel(),t.getSelections())
s&&t.pushUndoStop(),t.executeCommands(this.id,r),n.setPrevEditOperationType(2)}}),na.DeleteRight=Ao(new class extends Do{constructor(){super({id:"deleteRight",precondition:Vo.writable,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runEditorCommand(e,t,i){const n=t._getCursors(),[s,r]=jo.deleteRight(n.getPrevEditOperationType(),t._getCursorConfiguration(),t.getModel(),t.getSelections())
s&&t.pushUndoStop(),t.executeCommands(this.id,r),n.setPrevEditOperationType(3)}}),function(e){function t(e){return e.get(Eo).getFocusedCodeEditor()}function i(e){jr.registerCommandAndKeybindingRule(e.toCommandAndKeybindingRule(Zo))}class n extends Mo{constructor(e){super(e),this._editorHandler=e.editorHandler,this._inputHandler=e.inputHandler}runCommand(e,i){let n=t(e)
if(n&&n.isFocused())return this._runEditorHandler(n,i)
let s=document.activeElement
if(s&&["input","textarea"].indexOf(s.tagName.toLowerCase())>=0)return void document.execCommand(this._inputHandler)
let r=function(e){const t=e.get(ao)
return Io(t.getActiveEditor&&t.getActiveEditor())}(e)
return r?(r.focus(),this._runEditorHandler(r,i)):void 0}_runEditorHandler(e,t){let i=this._editorHandler
"string"==typeof i?e.trigger("keyboard",i,t):((t=t||{}).source="keyboard",i.runEditorCommand(null,e,t))}}i(new n({editorHandler:ta.SelectAll,inputHandler:"selectAll",id:"editor.action.selectAll",precondition:null,kbOpts:{weight:Zo,kbExpr:null,primary:2079}})),i(new n({editorHandler:Yo.Undo,inputHandler:"undo",id:Yo.Undo,precondition:Vo.writable,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:2104}})),i(new n({editorHandler:Yo.Redo,inputHandler:"redo",id:Yo.Redo,precondition:Vo.writable,kbOpts:{weight:Zo,kbExpr:Vo.textFocus,primary:2103,secondary:[3128],mac:{primary:3128}}}))
class s extends Mo{constructor(e,t){super({id:e,precondition:null}),this._handlerId=t}runCommand(e,i){const n=t(e)
n&&n.trigger("keyboard",this._handlerId,i)}}function r(e){i(new s("default:"+e,e)),i(new s(e,e))}r(Yo.Type),r(Yo.ReplacePreviousChar),r(Yo.CompositionStart),r(Yo.CompositionEnd),r(Yo.Paste),r(Yo.Cut)}(sa||(sa={}))
const ra=Object.freeze(function(e,t){let i=setTimeout(e.bind(t),0)
return{dispose(){clearTimeout(i)}}})
var oa,aa;(aa=oa||(oa={})).None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:ui.None}),aa.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:ra})
class la{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this._emitter=void 0))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?ra:(this._emitter||(this._emitter=new ci),this._emitter.event)}}class ha{get token(){return this._token||(this._token=new la),this._token}cancel(){this._token?this._token instanceof la&&this._token.cancel():this._token=oa.Cancelled}dispose(){this.cancel()}}function da(e){return e&&"function"==typeof e.then}function ua(e){return da(e)?e:bt.as(e)}function ca(e){let t=new ha
return new bt((i,n,s)=>{let r=e(t.token)
r instanceof bt?r.then(i,n,s):da(r)?r.then(i,n):i(r)},()=>{t.cancel()})}class ga extends bt{constructor(e){let t,i,n
super((e,s,r)=>{t=e,i=s,n=r},()=>{i(Nt())}),e.then(t,i,n)}}function ma(e,t){return new bt((i,n,s)=>{e.done(e=>{try{t(e)}catch(e){St(e)}i(e)},e=>{try{t(e)}catch(e){St(e)}n(e)},e=>{s(e)})},()=>{e.cancel()})}function pa(e){const t=[]
return e=e.reverse(),bt.as(null).then(function i(n){void 0!==n&&null!==n&&t.push(n)
const s=e.length?e.pop()():null
return s?s.then(i):bt.as(t)})}class fa extends ni{constructor(){super(),this._token=-1}dispose(){this.cancel(),super.dispose()}cancel(){-1!==this._token&&(A(this._token),this._token=-1)}cancelAndSet(e,t){this.cancel(),this._token=R(()=>{this._token=-1,e()},t)}setIfNotSet(e,t){-1===this._token&&(this._token=R(()=>{this._token=-1,e()},t))}}class _a extends ni{constructor(){super(),this._token=-1}dispose(){this.cancel(),super.dispose()}cancel(){-1!==this._token&&(F(this._token),this._token=-1)}cancelAndSet(e,t){this.cancel(),this._token=P(()=>{e()},t)}}class Ca{constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(A(this.timeoutToken),this.timeoutToken=-1)}setRunner(e){this.runner=e}schedule(e=this.timeout){this.cancel(),this.timeoutToken=R(this.timeoutHandler,e)}isScheduled(){return-1!==this.timeoutToken}onTimeout(){this.timeoutToken=-1,this.runner&&this.runner()}}class ba{constructor(){this._zoomLevel=0,this._lastZoomLevelChangeTime=0,this._onDidChangeZoomLevel=new ci,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event,this._zoomFactor=0,this._onDidChangeFullscreen=new ci,this.onDidChangeFullscreen=this._onDidChangeFullscreen.event,this._accessibilitySupport=0,this._onDidChangeAccessibilitySupport=new ci,this.onDidChangeAccessibilitySupport=this._onDidChangeAccessibilitySupport.event}getZoomLevel(){return this._zoomLevel}getTimeSinceLastZoomLevelChanged(){return Date.now()-this._lastZoomLevelChangeTime}setZoomLevel(e,t){this._zoomLevel!==e&&(this._zoomLevel=e,this._lastZoomLevelChangeTime=t?0:Date.now(),this._onDidChangeZoomLevel.fire(this._zoomLevel))}getZoomFactor(){return this._zoomFactor}setZoomFactor(e){this._zoomFactor=e}getPixelRatio(){let e=document.createElement("canvas").getContext("2d")
return(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)}setFullscreen(e){this._fullscreen!==e&&(this._fullscreen=e,this._onDidChangeFullscreen.fire())}isFullscreen(){return this._fullscreen}setAccessibilitySupport(e){this._accessibilitySupport!==e&&(this._accessibilitySupport=e,this._onDidChangeAccessibilitySupport.fire())}getAccessibilitySupport(){return this._accessibilitySupport}}function wa(){return ba.INSTANCE.getZoomLevel()}function va(e){return ba.INSTANCE.onDidChangeZoomLevel(e)}function Sa(){return ba.INSTANCE.getPixelRatio()}ba.INSTANCE=new ba
const ya=navigator.userAgent,xa=ya.indexOf("Trident")>=0,La=ya.indexOf("Edge/")>=0,Na=xa||La,Ea=(ya.indexOf("Opera"),ya.indexOf("Firefox")>=0),ka=ya.indexOf("AppleWebKit")>=0,Ia=ya.indexOf("Chrome")>=0,Ma=-1===ya.indexOf("Chrome")&&ya.indexOf("Safari")>=0,Da=ya.indexOf("iPad")>=0,Ta=ya.indexOf("Chrome/56.")>=0&&-1===ya.indexOf("Edge/")
let Oa={}
Oa[3]=7,Oa[8]=1,Oa[9]=2,Oa[13]=3,Oa[16]=4,Oa[17]=5,Oa[18]=6,Oa[19]=7,Oa[20]=8,Oa[27]=9,Oa[32]=10,Oa[33]=11,Oa[34]=12,Oa[35]=13,Oa[36]=14,Oa[37]=15,Oa[38]=16,Oa[39]=17,Oa[40]=18,Oa[45]=19,Oa[46]=20,Oa[48]=21,Oa[49]=22,Oa[50]=23,Oa[51]=24,Oa[52]=25,Oa[53]=26,Oa[54]=27,Oa[55]=28,Oa[56]=29,Oa[57]=30,Oa[65]=31,Oa[66]=32,Oa[67]=33,Oa[68]=34,Oa[69]=35,Oa[70]=36,Oa[71]=37,Oa[72]=38,Oa[73]=39,Oa[74]=40,Oa[75]=41,Oa[76]=42,Oa[77]=43,Oa[78]=44,Oa[79]=45,Oa[80]=46,Oa[81]=47,Oa[82]=48,Oa[83]=49,Oa[84]=50,Oa[85]=51,Oa[86]=52,Oa[87]=53,Oa[88]=54,Oa[89]=55,Oa[90]=56,Oa[93]=58,Oa[96]=93,Oa[97]=94,Oa[98]=95,Oa[99]=96,Oa[100]=97,Oa[101]=98,Oa[102]=99,Oa[103]=100,Oa[104]=101,Oa[105]=102,Oa[106]=103,Oa[107]=104,Oa[108]=105,Oa[109]=106,Oa[110]=107,Oa[111]=108,Oa[112]=59,Oa[113]=60,Oa[114]=61,Oa[115]=62,Oa[116]=63,Oa[117]=64,Oa[118]=65,Oa[119]=66,Oa[120]=67,Oa[121]=68,Oa[122]=69,Oa[123]=70,Oa[124]=71,Oa[125]=72,Oa[126]=73,Oa[127]=74,Oa[128]=75,Oa[129]=76,Oa[130]=77,Oa[144]=78,Oa[145]=79,Oa[186]=80,Oa[187]=81,Oa[188]=82,Oa[189]=83,Oa[190]=84,Oa[191]=85,Oa[192]=86,Oa[193]=110,Oa[194]=111,Oa[219]=87,Oa[220]=88,Oa[221]=89,Oa[222]=90,Oa[223]=91,Oa[226]=92,Oa[229]=109,xa?Oa[91]=57:Ea?(Oa[59]=80,Oa[107]=81,Oa[109]=83,k&&(Oa[224]=57)):ka&&(Oa[91]=57,k?Oa[93]=57:Oa[92]=57)
const Ra=k?256:2048,Aa=512,Pa=1024,Fa=k?2048:256
class Wa{constructor(e){let t=e
this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.keyCode=function(e){if(e.charCode){let t=String.fromCharCode(e.charCode).toUpperCase()
return Fr.fromString(t)}return Oa[e.keyCode]||0}(t),this.code=t.code,this.ctrlKey=this.ctrlKey||5===this.keyCode,this.altKey=this.altKey||6===this.keyCode,this.shiftKey=this.shiftKey||4===this.keyCode,this.metaKey=this.metaKey||57===this.keyCode,this._asKeybinding=this._computeKeybinding(),this._asRuntimeKeybinding=this._computeRuntimeKeybinding()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeybinding(){return this._asRuntimeKeybinding}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0
5!==this.keyCode&&4!==this.keyCode&&6!==this.keyCode&&57!==this.keyCode&&(e=this.keyCode)
let t=0
return this.ctrlKey&&(t|=Ra),this.altKey&&(t|=Aa),this.shiftKey&&(t|=Pa),this.metaKey&&(t|=Fa),t|=e}_computeRuntimeKeybinding(){let e=0
return 5!==this.keyCode&&4!==this.keyCode&&6!==this.keyCode&&57!==this.keyCode&&(e=this.keyCode),new Hr(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}}let Va=!1,Ba=null
function Ha(e){if(!e.parent||e.parent===e)return null
try{let t=e.location,i=e.parent.location
if(t.protocol!==i.protocol||t.hostname!==i.hostname||t.port!==i.port)return Va=!0,null}catch(e){return Va=!0,null}return e.parent}function za(e,t){let i,n=e.document.getElementsByTagName("iframe")
for(let e=0,s=n.length;e<s;e++)if((i=n[e]).contentWindow===t)return i
return null}class Ua{static getSameOriginWindowChain(){if(!Ba){Ba=[]
let e,t=window
do{(e=Ha(t))?Ba.push({window:t,iframeElement:za(e,t)}):Ba.push({window:t,iframeElement:null}),t=e}while(t)}return Ba.slice(0)}static hasDifferentOriginAncestor(){return Ba||this.getSameOriginWindowChain(),Va}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0}
let i=0,n=0,s=this.getSameOriginWindowChain()
for(let e=0;e<s.length;e++){let r=s[e]
if(r.window===t)break
if(!r.iframeElement)break
let o=r.iframeElement.getBoundingClientRect()
i+=o.top,n+=o.left}return{top:i,left:n}}}class Ka{constructor(e){this.timestamp=Date.now(),this.browserEvent=e,this.leftButton=0===e.button,this.middleButton=1===e.button,this.rightButton=2===e.button,this.target=e.target,this.detail=e.detail||1,"dblclick"===e.type&&(this.detail=2),this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey,"number"==typeof e.pageX?(this.posx=e.pageX,this.posy=e.pageY):(this.posx=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.posy=e.clientY+document.body.scrollTop+document.documentElement.scrollTop)
let t=Ua.getPositionOfChildWindowRelativeToAncestorWindow(self,e.view)
this.posx-=t.left,this.posy-=t.top}preventDefault(){this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}}class $a extends Ka{constructor(e){super(e),this.dataTransfer=e.dataTransfer}}class qa{constructor(e,t=0,i=0){if(this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=i,this.deltaX=t,e){let t=e,i=e
void 0!==t.wheelDeltaY?this.deltaY=t.wheelDeltaY/120:void 0!==i.VERTICAL_AXIS&&i.axis===i.VERTICAL_AXIS&&(this.deltaY=-i.detail/3),void 0!==t.wheelDeltaX?this.deltaX=Ma&&E?-t.wheelDeltaX/120:t.wheelDeltaX/120:void 0!==i.HORIZONTAL_AXIS&&i.axis===i.HORIZONTAL_AXIS&&(this.deltaX=-e.detail/3),0===this.deltaY&&0===this.deltaX&&e.wheelDelta&&(this.deltaY=e.wheelDelta/120)}}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}}function Ga(e){for(;e.firstChild;)e.removeChild(e.firstChild)}const ja=new class{_findClassName(e,t){let i=e.className
if(!i)return void(this._lastStart=-1)
t=t.trim()
let n=i.length,s=t.length
if(0===s)return void(this._lastStart=-1)
if(n<s)return void(this._lastStart=-1)
if(i===t)return this._lastStart=0,void(this._lastEnd=n)
let r,o=-1
for(;(o=i.indexOf(t,o+1))>=0;){if(r=o+s,(0===o||32===i.charCodeAt(o-1))&&32===i.charCodeAt(r))return this._lastStart=o,void(this._lastEnd=r+1)
if(o>0&&32===i.charCodeAt(o-1)&&r===n)return this._lastStart=o-1,void(this._lastEnd=r)
if(0===o&&r===n)return this._lastStart=0,void(this._lastEnd=r)}this._lastStart=-1}hasClass(e,t){return this._findClassName(e,t),-1!==this._lastStart}addClass(e,t){e.className?(this._findClassName(e,t),-1===this._lastStart&&(e.className=e.className+" "+t)):e.className=t}removeClass(e,t){this._findClassName(e,t),-1!==this._lastStart&&(e.className=e.className.substring(0,this._lastStart)+e.className.substring(this._lastEnd))}toggleClass(e,t,i){this._findClassName(e,t),-1===this._lastStart||void 0!==i&&i||this.removeClass(e,t),-1!==this._lastStart||void 0!==i&&!i||this.addClass(e,t)}},Ya=new class{hasClass(e,t){return t&&e.classList&&e.classList.contains(t)}addClass(e,t){t&&e.classList&&e.classList.add(t)}removeClass(e,t){t&&e.classList&&e.classList.remove(t)}toggleClass(e,t,i){e.classList&&e.classList.toggle(t,i)}},Za=xa?ja:Ya,Xa=Za.hasClass.bind(Za),Ja=Za.addClass.bind(Za),Qa=Za.removeClass.bind(Za),el=Za.toggleClass.bind(Za)
class tl{constructor(e,t,i,n){this._node=e,this._type=t,this._handler=i,this._useCapture=n||!1,this._node.addEventListener(this._type,this._handler,this._useCapture)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._useCapture),this._node=null,this._handler=null)}}function il(e,t,i,n){return new tl(e,t,i,n)}let nl=function(e,t,i,n){let s=i
var r,o
return"click"===t||"mousedown"===t?(o=i,s=function(e){return o(new Ka(e))}):"keydown"!==t&&"keypress"!==t&&"keyup"!==t||(r=i,s=function(e){return r(new Wa(e))}),il(e,t,s,n)}
function sl(e,t){return il(e,"mouseout",i=>{let n=i.relatedTarget||i.toElement
for(;n&&n!==e;)n=n.parentNode
n!==e&&t(i)})}const rl=function(){let e=self.requestAnimationFrame||self.msRequestAnimationFrame||self.webkitRequestAnimationFrame||self.mozRequestAnimationFrame||self.oRequestAnimationFrame,t=self.cancelAnimationFrame||self.cancelRequestAnimationFrame||self.msCancelAnimationFrame||self.msCancelRequestAnimationFrame||self.webkitCancelAnimationFrame||self.webkitCancelRequestAnimationFrame||self.mozCancelAnimationFrame||self.mozCancelRequestAnimationFrame||self.oCancelAnimationFrame||self.oCancelRequestAnimationFrame,i=e||(e=>setTimeout(()=>e((new Date).getTime()),0)),n=t||(e=>{})
return{isNative:!!e,request:e=>i(e),cancel:e=>n(e)}}()
let ol,al
class ll{constructor(e,t){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){St(e)}}static sort(e,t){return t.priority-e.priority}}!function(){let e=[],t=null,i=!1,n=!1,s=()=>{for(i=!1,t=e,e=[],n=!0;t.length>0;){t.sort(ll.sort),t.shift().execute()}n=!1}
al=((t,n=0)=>{let r=new ll(t,n)
return e.push(r),i||(i=!0,rl.request(s)),r}),ol=((e,i)=>{if(n){let n=new ll(e,i)
return t.push(n),n}return al(e,i)})}()
const hl=16,dl=function(e,t){return t}
class ul extends ni{constructor(e,t,i,n=dl,s=hl){super()
let r=null,o=0,a=this._register(new fa),l=()=>{o=(new Date).getTime(),i(r),r=null}
this._register(il(e,t,e=>{r=n(r,e)
let t=(new Date).getTime()-o
t>=s?(a.cancel(),l()):a.setIfNotSet(l,s-t)}))}}function cl(e,t,i,n,s){return new ul(e,t,i,n,s)}function gl(e){return document.defaultView.getComputedStyle(e,null)}const ml=function(e,t){return parseFloat(t)||0}
function pl(e,t,i){let n=gl(e),s="0"
return n&&(s=n.getPropertyValue?n.getPropertyValue(t):n.getAttribute(i)),ml(e,s)}const fl={getBorderLeftWidth:function(e){return pl(e,"border-left-width","borderLeftWidth")},getBorderTopWidth:function(e){return pl(e,"border-top-width","borderTopWidth")},getBorderRightWidth:function(e){return pl(e,"border-right-width","borderRightWidth")},getBorderBottomWidth:function(e){return pl(e,"border-bottom-width","borderBottomWidth")},getPaddingLeft:function(e){return pl(e,"padding-left","paddingLeft")},getPaddingTop:function(e){return pl(e,"padding-top","paddingTop")},getPaddingRight:function(e){return pl(e,"padding-right","paddingRight")},getPaddingBottom:function(e){return pl(e,"padding-bottom","paddingBottom")},getMarginLeft:function(e){return pl(e,"margin-left","marginLeft")},getMarginTop:function(e){return pl(e,"margin-top","marginTop")},getMarginRight:function(e){return pl(e,"margin-right","marginRight")},getMarginBottom:function(e){return pl(e,"margin-bottom","marginBottom")},__commaSentinel:!1}
function _l(e){let t=e.offsetParent,i=e.offsetTop,n=e.offsetLeft
for(;null!==(e=e.parentNode)&&e!==document.body&&e!==document.documentElement;){i-=e.scrollTop
let s=gl(e)
s&&(n-="rtl"!==s.direction?e.scrollLeft:-e.scrollLeft),e===t&&(n+=fl.getBorderLeftWidth(e),i+=fl.getBorderTopWidth(e),i+=e.offsetTop,n+=e.offsetLeft,t=e.offsetParent)}return{left:n,top:i}}function Cl(e){let t=e.getBoundingClientRect()
return{left:t.left+bl.scrollX,top:t.top+bl.scrollY,width:t.width,height:t.height}}const bl=new class{get scrollX(){return"number"==typeof window.scrollX?window.scrollX:document.body.scrollLeft+document.documentElement.scrollLeft}get scrollY(){return"number"==typeof window.scrollY?window.scrollY:document.body.scrollTop+document.documentElement.scrollTop}}
function wl(e){let t=fl.getMarginLeft(e)+fl.getMarginRight(e)
return e.offsetWidth+t}function vl(e){let t=fl.getBorderTopWidth(e)+fl.getBorderBottomWidth(e),i=fl.getPaddingTop(e)+fl.getPaddingBottom(e)
return e.offsetHeight-t-i}function Sl(e){let t=fl.getMarginTop(e)+fl.getMarginBottom(e)
return e.offsetHeight+t}function yl(e,t){for(;e;){if(e===t)return!0
e=e.parentNode}return!1}function xl(e=document.getElementsByTagName("head")[0]){let t=document.createElement("style")
return t.type="text/css",t.media="screen",e.appendChild(t),t}const Ll=xl()
function Nl(e,t=Ll){if(!t)return
let i=(n=t)&&n.sheet&&n.sheet.rules?n.sheet.rules:n&&n.sheet&&n.sheet.cssRules?n.sheet.cssRules:[]
var n
let s=[]
for(let t=0;t<i.length;t++){-1!==i[t].selectorText.indexOf(e)&&s.push(t)}for(let e=s.length-1;e>=0;e--)t.sheet.deleteRule(s[e])}function El(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&1===e.nodeType&&"string"==typeof e.nodeName}const kl={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",UNLOAD:"unload",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:ka?"webkitAnimationStart":"animationstart",ANIMATION_END:ka?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:ka?"webkitAnimationIteration":"animationiteration"},Il={stop:function(e,t){e.preventDefault?e.preventDefault():e.returnValue=!1,t&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)}}
class Ml extends ni{constructor(e){super()
let t=!1,i=!1
this._eventEmitter=this._register(new It)
this._register(il(e,kl.FOCUS,e=>{i=!1,t||(t=!0,this._eventEmitter.emit("focus",{}))},!0)),this._register(il(e,kl.BLUR,e=>{t&&(i=!0,window.setTimeout(()=>{i&&(i=!1,t=!1,this._eventEmitter.emit("blur",{}))},0))},!0))}addFocusListener(e){return this._eventEmitter.addListener("focus",e)}addBlurListener(e){return this._eventEmitter.addListener("blur",e)}}function Dl(e){return new Ml(e)}function Tl(e,...t){return t.forEach(t=>e.appendChild(t)),t[t.length-1]}function Ol(e,t){return e.insertBefore(t,e.firstChild),t}const Rl=/([\w\-]+)?(#([\w\-]+))?((.([\w\-]+))*)/
function Al(e,t,...i){let n=Rl.exec(e)
if(!n)throw new Error("Bad use of emmet")
let s=document.createElement(n[1]||"div")
return n[3]&&(s.id=n[3]),n[4]&&(s.className=n[4].replace(/\./g," ").trim()),Object.keys(t||{}).forEach(e=>{if(/^on\w+$/.test(e))s[e]=t[e]
else if("selected"===e){t[e]&&s.setAttribute(e,"true")}else s.setAttribute(e,t[e])}),i.filter(e=>!!e).forEach(e=>{e instanceof Node?s.appendChild(e):s.appendChild(document.createTextNode(e))}),s}function Pl(...e){for(let t of e)t.style.display=""}function Fl(...e){for(let t of e)t.style.display="none"}function Wl(e){if(e&&e.hasAttribute("tabIndex")){if(document.activeElement===e){let t=function(e,t){for(;e;){if(e instanceof HTMLElement&&e.hasAttribute(t))return e
e=e.parentNode}return null}(e.parentElement,"tabIndex")
t&&t.focus()}e.removeAttribute("tabindex")}}function Vl(e){return Array.prototype.slice.call(document.getElementsByTagName(e),0)}function Bl(e){const t=window.devicePixelRatio*e
return Math.max(1,Math.floor(t))/window.devicePixelRatio}function Hl(e){if(M)window.open(e)
else{let t=window.open()
t&&(t.opener=null,t.location.href=e)}}class zl{constructor(...e){this._entries=new Map
for(let[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e)
return this._entries.set(e,t),i}forEach(e){this._entries.forEach((t,i)=>e(i,t))}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}}class Ul{constructor(i){this.modelState=null,this.viewState=null,this._selTrackedRange=null,this._setState(i,new mr(new t(1,1,1,1),0,new e(1,1),0),new mr(new t(1,1,1,1),0,new e(1,1),0))}dispose(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,d.AlwaysGrowsWhenTypingAtEdges)}asCursorState(){return new fr(this.modelState,this.viewState)}readSelectionFromMarkers(e){const t=e.model._getTrackedRange(this._selTrackedRange)
return this.modelState.selection.getDirection()===Ot.LTR?new At(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn):new At(t.endLineNumber,t.endColumn,t.startLineNumber,t.startColumn)}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,i){this._setState(e,t,i)}_setState(i,n,s){if(n){const e=i.model.validateRange(n.selectionStart),t=n.selectionStart.equalsRange(e)?n.selectionStartLeftoverVisibleColumns:0,s=i.model.validatePosition(n.position),r=n.position.equals(s)?n.leftoverVisibleColumns:0
n=new mr(e,t,s,r)}else{const e=i.model.validateRange(i.convertViewRangeToModelRange(s.selectionStart)),t=i.model.validatePosition(i.convertViewPositionToModelPosition(s.position.lineNumber,s.position.column))
n=new mr(e,s.selectionStartLeftoverVisibleColumns,t,s.leftoverVisibleColumns)}if(s){const e=i.validateViewRange(s.selectionStart,n.selectionStart),t=i.validateViewPosition(s.position,n.position)
s=new mr(e,n.selectionStartLeftoverVisibleColumns,t,n.leftoverVisibleColumns)}else{const r=i.convertModelPositionToViewPosition(new e(n.selectionStart.startLineNumber,n.selectionStart.startColumn)),o=i.convertModelPositionToViewPosition(new e(n.selectionStart.endLineNumber,n.selectionStart.endColumn)),a=new t(r.lineNumber,r.column,o.lineNumber,o.column),l=i.convertModelPositionToViewPosition(n.position)
s=new mr(a,n.selectionStartLeftoverVisibleColumns,l,n.leftoverVisibleColumns)}this.modelState&&this.viewState&&this.modelState.equals(n)&&this.viewState.equals(s)||(this.modelState=n,this.viewState=s,this._selTrackedRange=i.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,d.AlwaysGrowsWhenTypingAtEdges))}}class Kl{constructor(e){this.context=e,this.primaryCursor=new Ul(e),this.secondaryCursors=[],this.lastAddedCursorIndex=0}dispose(){this.primaryCursor.dispose(this.context),this.killSecondaryCursors()}updateContext(e){this.context=e}ensureValidState(){this.primaryCursor.ensureValidState(this.context)
for(let e=0,t=this.secondaryCursors.length;e<t;e++)this.secondaryCursors[e].ensureValidState(this.context)}readSelectionFromMarkers(){let e=[]
e[0]=this.primaryCursor.readSelectionFromMarkers(this.context)
for(let t=0,i=this.secondaryCursors.length;t<i;t++)e[t+1]=this.secondaryCursors[t].readSelectionFromMarkers(this.context)
return e}getAll(){let e=[]
e[0]=this.primaryCursor.asCursorState()
for(let t=0,i=this.secondaryCursors.length;t<i;t++)e[t+1]=this.secondaryCursors[t].asCursorState()
return e}getViewPositions(){let e=[]
e[0]=this.primaryCursor.viewState.position
for(let t=0,i=this.secondaryCursors.length;t<i;t++)e[t+1]=this.secondaryCursors[t].viewState.position
return e}getSelections(){let e=[]
e[0]=this.primaryCursor.modelState.selection
for(let t=0,i=this.secondaryCursors.length;t<i;t++)e[t+1]=this.secondaryCursors[t].modelState.selection
return e}getViewSelections(){let e=[]
e[0]=this.primaryCursor.viewState.selection
for(let t=0,i=this.secondaryCursors.length;t<i;t++)e[t+1]=this.secondaryCursors[t].viewState.selection
return e}setSelections(e){this.setStates(fr.fromModelSelections(e))}getPrimaryCursor(){return this.primaryCursor.asCursorState()}setStates(e){null!==e&&(this.primaryCursor.setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){const t=this.secondaryCursors.length,i=e.length
if(t<i){let e=i-t
for(let t=0;t<e;t++)this._addSecondaryCursor()}else if(t>i){let e=t-i
for(let t=0;t<e;t++)this._removeSecondaryCursor(this.secondaryCursors.length-1)}for(let t=0;t<i;t++)this.secondaryCursors[t].setState(this.context,e[t].modelState,e[t].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.secondaryCursors.push(new Ul(this.context)),this.lastAddedCursorIndex=this.secondaryCursors.length}getLastAddedCursorIndex(){return 0===this.secondaryCursors.length||0===this.lastAddedCursorIndex?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.secondaryCursors[e].dispose(this.context),this.secondaryCursors.splice(e,1)}_getAll(){let e=[]
e[0]=this.primaryCursor
for(let t=0,i=this.secondaryCursors.length;t<i;t++)e[t+1]=this.secondaryCursors[t]
return e}normalize(){if(0===this.secondaryCursors.length)return
let e=this._getAll(),t=[]
for(let i=0,n=e.length;i<n;i++)t.push({index:i,selection:e[i].modelState.selection,viewSelection:e[i].viewState.selection})
t.sort((e,t)=>e.viewSelection.startLineNumber===t.viewSelection.startLineNumber?e.viewSelection.startColumn-t.viewSelection.startColumn:e.viewSelection.startLineNumber-t.viewSelection.startLineNumber)
for(let i=0;i<t.length-1;i++){const n=t[i],s=t[i+1],r=n.viewSelection,o=s.viewSelection
let a
if(a=o.isEmpty()||r.isEmpty()?o.getStartPosition().isBeforeOrEqual(r.getEndPosition()):o.getStartPosition().isBefore(r.getEndPosition())){const r=n.index<s.index?i:i+1,o=n.index<s.index?i+1:i,a=t[o].index,l=t[r].index,h=t[o].selection,d=t[r].selection
if(!h.equalsSelection(d)){const i=h.plusRange(d),n=h.selectionStartLineNumber===h.startLineNumber&&h.selectionStartColumn===h.startColumn,s=d.selectionStartLineNumber===d.startLineNumber&&d.selectionStartColumn===d.startColumn
let o,u
a===this.lastAddedCursorIndex?(o=n,this.lastAddedCursorIndex=l):o=s,u=o?new At(i.startLineNumber,i.startColumn,i.endLineNumber,i.endColumn):new At(i.endLineNumber,i.endColumn,i.startLineNumber,i.startColumn),t[r].selection=u
const c=fr.fromModelSelection(u)
e[l].setState(this.context,c.modelState,c.viewState)}for(let e=0;e<t.length;e++)t[e].index>a&&t[e].index--
e.splice(a,1),t.splice(o,1),this._removeSecondaryCursor(a-1),i--}}}}class $l{constructor(e){this.type=1,this.canUseLayerHinting=e.canUseLayerHinting,this.pixelRatio=e.pixelRatio,this.editorClassName=e.editorClassName,this.lineHeight=e.lineHeight,this.readOnly=e.readOnly,this.accessibilitySupport=e.accessibilitySupport,this.emptySelectionClipboard=e.emptySelectionClipboard,this.layoutInfo=e.layoutInfo,this.fontInfo=e.fontInfo,this.viewInfo=e.viewInfo,this.wrappingInfo=e.wrappingInfo}}class ql{constructor(e,t){this.type=2,this.selections=e,this.isInEditableRange=t}}class Gl{constructor(){this.type=3}}class jl{constructor(){this.type=4}}class Yl{constructor(e){this.type=5,this.isFocused=e}}class Zl{constructor(){this.type=6}}class Xl{constructor(e,t){this.type=7,this.fromLineNumber=e,this.toLineNumber=t}}class Jl{constructor(e,t){this.type=8,this.fromLineNumber=e,this.toLineNumber=t}}class Ql{constructor(e,t){this.type=9,this.fromLineNumber=e,this.toLineNumber=t}}class eh{constructor(e,t,i,n){this.type=10,this.range=e,this.verticalType=t,this.revealHorizontal=i,this.scrollType=n}}class th{constructor(e){this.type=11,this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}}class ih{constructor(e){this.type=12,this.ranges=e}}class nh{constructor(){this.type=15}}class sh{constructor(){this.type=13}}class rh{constructor(){this.type=14}}class oh{constructor(){this.type=16}}class ah extends ni{constructor(){super(),this._listeners=[]}dispose(){this._listeners=[],super.dispose()}_emit(e){const t=this._listeners.slice(0)
for(let i=0,n=t.length;i<n;i++)lh(t[i],e)}addEventListener(e){return this._listeners.push(e),{dispose:()=>{let t=this._listeners
for(let i=0,n=t.length;i<n;i++)if(t[i]===e){t.splice(i,1)
break}}}}}function lh(e,t){try{e(t)}catch(e){St(e)}}class hh{constructor(e,t,i){this.selections=e,this.source=t,this.reason=i}}class dh{constructor(e,t){this.modelVersionId=e.getVersionId(),this.cursorState=t.getAll()}equals(e){if(!e)return!1
if(this.modelVersionId!==e.modelVersionId)return!1
if(this.cursorState.length!==e.cursorState.length)return!1
for(let t=0,i=this.cursorState.length;t<i;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1
return!0}}class uh extends ah{constructor(e,t,i){super(),this._onDidChange=this._register(new ci),this.onDidChange=this._onDidChange.event,this._configuration=e,this._model=t,this._viewModel=i,this.context=new pr(this._configuration,this._model,this._viewModel),this._cursors=new Kl(this.context),this._isHandling=!1,this._isDoingComposition=!1,this._columnSelectData=null,this._prevEditOperationType=0,this._register(this._model.addBulkListener(e=>{if(this._isHandling)return
let t=!1,i=!1
for(let n=0,s=e.length;n<s;n++){const s=e[n]
if(s.type===cn.ModelRawContentChanged2){t=!0
const e=s.data
i=i||e.containsEvent(1)}}t&&this._onModelContentChanged(i)})),this._register(i.addEventListener(e=>{(function(e){for(let t=0,i=e.length;t<i;t++)if(6===e[t].type)return!0
return!1})(e)&&this.setStates("viewModel",br.NotSet,this.getAll())}))
const n=()=>{this.context=new pr(this._configuration,this._model,this._viewModel),this._cursors.updateContext(this.context)}
this._register(t.onDidChangeLanguage(e=>{n()})),this._register(t.onDidChangeLanguageConfiguration(()=>{n()})),this._register(t.onDidChangeOptions(()=>{n()})),this._register(this._configuration.onDidChange(e=>{gr.shouldRecreate(e)&&n()}))}dispose(){this._cursors.dispose(),super.dispose()}getPrimaryCursor(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getAll(){return this._cursors.getAll()}setStates(e,t,i){const n=new dh(this._model,this)
this._cursors.setStates(i),this._cursors.normalize(),this._columnSelectData=null,this._emitStateChangedIfNecessary(e,t,n)}setColumnSelectData(e){this._columnSelectData=e}reveal(e,t,i){this._revealRange(t,0,e,i)}revealRange(e,t,i,n){this.emitCursorRevealRange(t,i,e,n)}scrollTo(e){this._viewModel.viewLayout.setScrollPositionSmooth({scrollTop:e})}saveState(){let e=[]
const t=this._cursors.getSelections()
for(let i=0,n=t.length;i<n;i++){const n=t[i]
e.push({inSelectionMode:!n.isEmpty(),selectionStart:{lineNumber:n.selectionStartLineNumber,column:n.selectionStartColumn},position:{lineNumber:n.positionLineNumber,column:n.positionColumn}})}return e}restoreState(e){let t=[]
for(let i=0,n=e.length;i<n;i++){const n=e[i]
let s=1,r=1
n.position&&n.position.lineNumber&&(s=n.position.lineNumber),n.position&&n.position.column&&(r=n.position.column)
let o=s,a=r
n.selectionStart&&n.selectionStart.lineNumber&&(o=n.selectionStart.lineNumber),n.selectionStart&&n.selectionStart.column&&(a=n.selectionStart.column),t.push({selectionStartLineNumber:o,selectionStartColumn:a,positionLineNumber:s,positionColumn:r})}this.setStates("restoreState",br.NotSet,fr.fromModelSelections(t)),this.reveal(!0,0,1)}_onModelContentChanged(e){if(this._prevEditOperationType=0,e)this._cursors.dispose(),this._cursors=new Kl(this.context),this._emitStateChangedIfNecessary("model",br.ContentFlush,null)
else{const e=this._cursors.readSelectionFromMarkers()
this.setStates("modelChange",br.RecoverFromMarkers,fr.fromModelSelections(e))}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getColumnSelectData(){if(this._columnSelectData)return this._columnSelectData
const e=this._cursors.getPrimaryCursor().viewState.position
return{toViewLineNumber:e.lineNumber,toViewVisualColumn:Cr.visibleColumnFromColumn2(this.context.config,this.context.viewModel,e)}}getSelections(){return this._cursors.getSelections()}getViewSelections(){return this._cursors.getViewSelections()}getPosition(){return this._cursors.getPrimaryCursor().modelState.position}setSelections(e,t){this.setStates(e,br.NotSet,fr.fromModelSelections(t))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_executeEditOperation(e){if(!e)return
if(this._configuration.editor.readOnly)return
e.shouldPushStackElementBefore&&this._model.pushStackElement()
const t=ch.executeCommands(this._model,this._cursors.getSelections(),e.commands)
t&&(this._interpretCommandResult(t),this._prevEditOperationType=e.type),e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){e&&0!==e.length&&(this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize())}_emitStateChangedIfNecessary(e,t,i){const n=new dh(this._model,this)
if(n.equals(i))return!1
let s=!0
this._model.hasEditableRange()&&(this._model.getEditableRange().containsPosition(n.cursorState[0].modelState.position)||(s=!1))
const r=this._cursors.getSelections(),o=this._cursors.getViewSelections()
return this._emit([new ql(o,s)]),i&&i.cursorState.length===n.cursorState.length&&!n.cursorState.some((e,t)=>!e.modelState.equals(i.cursorState[t].modelState))||this._onDidChange.fire(new hh(r,e||"keyboard",t)),!0}_revealRange(e,i,n,s){const r=this._cursors.getViewPositions()
let o=r[0]
if(1===e)for(let e=1;e<r.length;e++)r[e].isBefore(o)&&(o=r[e])
else if(2===e)for(let e=1;e<r.length;e++)o.isBeforeOrEqual(r[e])&&(o=r[e])
else if(r.length>1)return
const a=new t(o.lineNumber,o.column,o.lineNumber,o.column)
this.emitCursorRevealRange(a,i,n,s)}emitCursorRevealRange(e,t,i,n){this._emit([new eh(e,t,i,n)])}trigger(e,t,i){const n=f
if(t===n.CompositionStart)return void(this._isDoingComposition=!0)
if(t===n.CompositionEnd)return void(this._isDoingComposition=!1)
const s=new dh(this._model,this)
let r=br.NotSet
this._cursors.ensureValidState(),this._isHandling=!0
try{switch(t){case n.Type:this._type(e,i.text)
break
case n.ReplacePreviousChar:this._replacePreviousChar(i.text,i.replaceCharCnt)
break
case n.Paste:r=br.Paste,this._paste(i.text,i.pasteOnNewLine)
break
case n.Cut:this._cut()
break
case n.Undo:r=br.Undo,this._interpretCommandResult(this._model.undo())
break
case n.Redo:r=br.Redo,this._interpretCommandResult(this._model.redo())
break
case n.ExecuteCommand:this._externalExecuteCommand(i)
break
case n.ExecuteCommands:this._externalExecuteCommands(i)}}catch(e){St(e)}this._isHandling=!1,this._emitStateChangedIfNecessary(e,r,s)&&this._revealRange(0,0,!0,0)}_type(e,t){if(this._isDoingComposition||"keyboard"!==e)this._executeEditOperation(Go.typeWithoutInterceptors(this._prevEditOperationType,this.context.config,this.context.model,this.getSelections(),t))
else for(let e=0,i=t.length;e<i;e++){let n
Ve(t.charCodeAt(e))&&e+1<i?(n=t.charAt(e)+t.charAt(e+1),e++):n=t.charAt(e),this._executeEditOperation(Go.typeWithInterceptors(this._prevEditOperationType,this.context.config,this.context.model,this.getSelections(),n))}}_replacePreviousChar(e,t){this._executeEditOperation(Go.replacePreviousChar(this._prevEditOperationType,this.context.config,this.context.model,this.getSelections(),e,t))}_paste(e,t){this._executeEditOperation(Go.paste(this.context.config,this.context.model,this.getSelections(),t,e))}_cut(){this._executeEditOperation(jo.cut(this.context.config,this.context.model,this.getSelections()))}_externalExecuteCommand(e){this._cursors.killSecondaryCursors(),this._executeEditOperation(new _r(0,[e],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))}_externalExecuteCommands(e){this._executeEditOperation(new _r(0,e,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))}}class ch{static executeCommands(e,t,i){const n={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},s=this._innerExecuteCommands(n,i)
for(let e=0,t=n.trackedRanges.length;e<t;e++)n.model._setTrackedRange(n.trackedRanges[e],null,e.AlwaysGrowsWhenTypingAtEdges)
return s}static _innerExecuteCommands(e,t){if(this._arrayIsEmpty(t))return null
const i=this._getEditOperations(e,t)
if(0===i.operations.length)return null
const n=i.operations,s=e.model.getEditableRange(),r=s.getStartPosition(),o=s.getEndPosition()
for(let e=0,t=n.length;e<t;e++){const t=n[e].range
if(!r.isBeforeOrEqual(t.getStartPosition())||!t.getEndPosition().isBeforeOrEqual(o))return null}const a=this._getLoserCursorMap(n)
if(a.hasOwnProperty("0"))return console.warn("Ignoring commands"),null
let l=[]
for(let e=0,t=n.length;e<t;e++)a.hasOwnProperty(n[e].identifier.major.toString())||l.push(n[e])
i.hadTrackedEditOperation&&l.length>0&&(l[0]._isTracked=!0)
const h=e.model.pushEditOperations(e.selectionsBefore,l,i=>{let n=[]
for(let t=0;t<e.selectionsBefore.length;t++)n[t]=[]
for(let e=0;e<i.length;e++){const t=i[e]
t.identifier&&n[t.identifier.major].push(t)}const s=(e,t)=>e.identifier.minor-t.identifier.minor
let r=[]
for(let i=0;i<e.selectionsBefore.length;i++)n[i].length>0?(n[i].sort(s),r[i]=t[i].computeCursorState(e.model,{getInverseEditOperations:()=>n[i],getTrackedSelection:t=>{const i=parseInt(t,10),n=e.model._getTrackedRange(e.trackedRanges[i])
return e.trackedRangesDirection[i]===Ot.LTR?new At(n.startLineNumber,n.startColumn,n.endLineNumber,n.endColumn):new At(n.endLineNumber,n.endColumn,n.startLineNumber,n.startColumn)}})):r[i]=e.selectionsBefore[i]
return r})
let d=[]
for(let e in a)a.hasOwnProperty(e)&&d.push(parseInt(e,10))
d.sort((e,t)=>t-e)
for(let e=0;e<d.length;e++)h.splice(d[e],1)
return h}static _arrayIsEmpty(e){for(let t=0,i=e.length;t<i;t++)if(e[t])return!1
return!0}static _getEditOperations(e,t){let i=[],n=!1
for(let s=0,r=t.length;s<r;s++)if(t[s]){const r=this._getEditOperationsFromCommand(e,s,t[s])
i=i.concat(r.operations),n=n||r.hadTrackedEditOperation}return{operations:i,hadTrackedEditOperation:n}}static _getEditOperationsFromCommand(e,t,i){let n=[],s=0
const r=(e,r)=>{e.isEmpty()&&""===r||n.push({identifier:{major:t,minor:s++},range:e,text:r,forceMoveMarkers:!1,isAutoWhitespaceEdit:i.insertsAutoWhitespace})}
let o=!1
const a={addEditOperation:r,addTrackedEditOperation:(e,t)=>{o=!0,r(e,t)},trackSelection:(t,i)=>{let n
if(t.isEmpty())if("boolean"==typeof i)n=i?d.GrowsOnlyWhenTypingBefore:d.GrowsOnlyWhenTypingAfter
else{const i=e.model.getLineMaxColumn(t.startLineNumber)
n=t.startColumn===i?d.GrowsOnlyWhenTypingBefore:d.GrowsOnlyWhenTypingAfter}else n=d.NeverGrowsWhenTypingAtEdges
const s=e.trackedRanges.length,r=e.model._setTrackedRange(null,t,n)
return e.trackedRanges[s]=r,e.trackedRangesDirection[s]=t.getDirection(),s.toString()}}
try{i.getEditOperations(e.model,a)}catch(e){return e.friendlyMessage=Jt("corrupt.commands","Unexpected exception while executing command."),St(e),{operations:[],hadTrackedEditOperation:!1}}return{operations:n,hadTrackedEditOperation:o}}static _getLoserCursorMap(e){(e=e.slice(0)).sort((e,i)=>-t.compareRangesUsingEnds(e.range,i.range))
let i={}
for(let t=1;t<e.length;t++){const n=e[t-1],s=e[t]
if(n.range.getStartPosition().isBefore(s.range.getEndPosition())){let r
i[(r=n.identifier.major>s.identifier.major?n.identifier.major:s.identifier.major).toString()]=!0
for(let i=0;i<e.length;i++)e[i].identifier.major===r&&(e.splice(i,1),i<t&&t--,i--)
t>0&&t--}}return i}}class gh{constructor(e,t,i){this.offset=0|e,this.type=t,this.language=i}toString(){return"("+this.offset+", "+this.type+")"}}class mh{constructor(e,t){this.tokens=e,this.endState=t}}class ph{constructor(e,t){this.tokens=e,this.endState=t}}const fh=new class{clone(){return this}equals(e){return this===e}},_h="vs.editor.nullMode",Ch=new ys(_h,0)
function bh(e,t,i,n){let s=new Uint32Array(2)
return s[0]=n,s[1]=(16384|e<<0|2<<23)>>>0,new ph(s,i)}function wh(e,t){return function(e,t){let i='<div class="monaco-tokenized-source">',n=e.split(/\r\n|\r|\n/),s=t.getInitialState()
for(let e=0,r=n.length;e<r;e++){let r=n[e]
e>0&&(i+="<br/>")
let o=t.tokenize2(r,s,0),a=new Bt(o.tokens,r),l=a.inflate(),h=0
for(let e=0,t=l.length;e<t;e++){const t=l[e]
i+=`<span class="${t.getType()}">${de(r.substring(h,t.endIndex))}</span>`,h=t.endIndex}s=o.endState}return i+="</div>"}(e,function(e){let t=js.get(e)
if(t)return t
return{getInitialState:()=>fh,tokenize:void 0,tokenize2:(e,t,i)=>bh(0,0,t,i)}}(t))}function vh(e,t,i,n,s,r){let o="<div>",a=n,l=0
for(let h=0,d=t.length;h<d;h++){const d=t[h],u=d.endIndex
if(d.endIndex<=n)continue
let c=""
for(;a<u&&a<s;a++){const t=e.charCodeAt(a)
switch(t){case 9:let e=r-(a+l)%r
for(l+=e-1;e>0;)c+="&nbsp;",e--
break
case 60:c+="&lt;"
break
case 62:c+="&gt;"
break
case 38:c+="&amp;"
break
case 0:c+="&#00;"
break
case 65279:case 8232:c+="�"
break
case 13:c+="&#8203"
break
default:c+=String.fromCharCode(t)}}if(o+=`<span style="${d.getInlineStyle(i)}">${c}</span>`,d.endIndex>s||a>=s)break}return o+="</div>"}class Sh{constructor(e,t,i,n){this.top=0|e,this.left=0|t,this.width=0|i,this.height=0|n}}class yh{constructor(e,t){this.tabSize=e,this.data=t}}class xh{constructor(e,t,i,n){this.content=e,this.minColumn=t,this.maxColumn=i,this.tokens=n}}class Lh{constructor(e,t,i,n,s,r,o,a){this.minColumn=e,this.maxColumn=t,this.content=i,this.mightContainRTL=n,this.mightContainNonBasicASCII=s,this.tokens=r,this.inlineDecorations=o,this.tabSize=a}}class Nh{constructor(e,t,i){this.range=e,this.inlineClassName=t,this.insertsBeforeOrAfter=i}}class Eh{constructor(e,t){this.range=e,this.options=t}}class kh{constructor(){this._eventsLen=0,this._events=[],this._eventsLen=0}emit(e){this._events[this._eventsLen++]=e}finalize(){let e=this._events
return this._events=null,e}}class Ih{constructor(e,t,i,n,s){this.editorId=e,this.model=t,this.configuration=i,this._linesCollection=n,this._coordinatesConverter=s,this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=null,this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(i){const n=i.id
let s=this._decorationsCache[n]
if(!s){const r=i.range,o=i.options
let a
if(o.isWholeLine){const i=this._coordinatesConverter.convertModelPositionToViewPosition(new e(r.startLineNumber,1)),n=this._coordinatesConverter.convertModelPositionToViewPosition(new e(r.endLineNumber,this.model.getLineMaxColumn(r.endLineNumber)))
a=new t(i.lineNumber,i.column,n.lineNumber,n.column)}else a=this._coordinatesConverter.convertModelRangeToViewRange(r)
s=new Eh(a,o),this._decorationsCache[n]=s}return s}getDecorationsViewportData(e){var t=!0
return(t=(t=t&&null!==this._cachedModelDecorationsResolver)&&e.equalsRange(this._cachedModelDecorationsResolverViewRange))||(this._cachedModelDecorationsResolver=this._getDecorationsViewportData(e),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}_getDecorationsViewportData(e){const i=this._linesCollection.getDecorationsInRange(e,this.editorId,this.configuration.editor.readOnly),n=e.startLineNumber,s=e.endLineNumber
let r=[],o=0,a=[]
for(let e=n;e<=s;e++)a[e-n]=[]
for(let e=0,l=i.length;e<l;e++){let l=i[e],h=l.options,d=this._getOrCreateViewModelDecoration(l),u=d.range
if(r[o++]=d,h.inlineClassName){let e=new Nh(u,h.inlineClassName,!1),t=Math.max(n,u.startLineNumber),i=Math.min(s,u.endLineNumber)
for(let s=t;s<=i;s++)a[s-n].push(e)}if(h.beforeContentClassName&&n<=u.startLineNumber&&u.startLineNumber<=s){let e=new Nh(new t(u.startLineNumber,u.startColumn,u.startLineNumber,u.startColumn+1),h.beforeContentClassName,!0)
a[u.startLineNumber-n].push(e)}if(h.afterContentClassName&&n<=u.endLineNumber&&u.endLineNumber<=s&&u.endColumn>1){let e=new Nh(new t(u.endLineNumber,u.endColumn-1,u.endLineNumber,u.endColumn),h.afterContentClassName,!0)
a[u.endLineNumber-n].push(e)}}return{decorations:r,inlineDecorations:a}}}class Mh{constructor(e=""){this.value=e}appendText(e){return this.value+=e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&"),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+="\n```",this.value+=e,this.value+="\n",this.value+=t,this.value+="\n```\n",this}}function Dh(e){return Th(e)?!e.value:!Array.isArray(e)||e.every(Dh)}function Th(e){return e instanceof Mh||!(!e||"object"!=typeof e)&&("string"==typeof e.value&&("boolean"==typeof e.isTrusted||void 0===e.isTrusted))}function Oh(e,t){return!e&&!t||!(!e||!t)&&(Array.isArray(e)&&Array.isArray(t)?In(e,t,Rh):!(!Th(e)||!Th(t))&&Rh(e,t))}function Rh(e,t){return e===t||!(!e||!t)&&(e.value===t.value&&e.isTrusted===t.isTrusted)}function Ah(e){return e?e.replace(/\\([\\`*_{}[\]()#+\-.!])/g,"$1"):e}const Ph=O.performance&&"function"==typeof O.performance.now
class Fh{static create(e=!0){return new Fh(e)}constructor(e){this._highResolution=Ph&&e,this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}elapsed(){return-1!==this._stopTime?this._stopTime-this._startTime:this._now()-this._startTime}_now(){return this._highResolution?O.performance.now():(new Date).getTime()}}const Wh=65535,Vh=5e3,Bh=16777215,Hh=4278190080
class zh{constructor(e,t,i){if(e.length!==t.length||e.length>Wh)throw new Error("invalid startIndexes or endIndexes size")
this._startIndexes=e,this._endIndexes=t,this._model=i,this._computeParentIndices()}_computeParentIndices(){let e=[],t=(t,i)=>{let n=e[e.length-1]
return this.getStartLineNumber(n)<=t&&this.getEndLineNumber(n)>=i}
for(let i=0,n=this._startIndexes.length;i<n;i++){let n=this._startIndexes[i],s=this._endIndexes[i]
if(n>Bh||s>Bh)throw new Error("startLineNumber or endLineNumber must not exceed "+Bh)
for(;e.length>0&&!t(n,s);)e.pop()
let r=e.length>0?e[e.length-1]:-1
e.push(i),this._startIndexes[i]=n+((255&r)<<24),this._endIndexes[i]=s+((65280&r)<<16)}}get length(){return this._startIndexes.length}getStartLineNumber(e){return this._startIndexes[e]&Bh}getEndLineNumber(e){return this._endIndexes[e]&Bh}getParentIndex(e){let t=((this._startIndexes[e]&Hh)>>>24)+((this._endIndexes[e]&Hh)>>>16)
return t===Wh?-1:t}getIndent(e){const t=this.getStartLineNumber(e),i=this._model.getOptions().tabSize
return zt(this._model.getLineContent(t),i)}contains(e,t){return this.getStartLineNumber(e)<=t&&this.getEndLineNumber(e)>=t}findIndex(e){let t=0,i=this._startIndexes.length
if(0===i)return-1
for(;t<i;){let n=Math.floor((t+i)/2)
e<this.getStartLineNumber(n)?i=n:t=n+1}return t-1}findRange(e){let t=this.findIndex(e)
if(t>=0){if(this.getEndLineNumber(t)>=e)return t
for(t=this.getParentIndex(t);-1!==t;){if(this.contains(t,e))return t
t=this.getParentIndex(t)}}return-1}}class Uh{constructor(e){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0,this._foldingRegionsLimit=e}insertFirst(e,t,i){if(e>Bh||t>Bh)return
let n=this._length
this._startIndexes[n]=e,this._endIndexes[n]=t,this._length++,i<1e3&&(this._indentOccurrences[i]=(this._indentOccurrences[i]||0)+1)}toIndentRanges(e){if(this._length<=this._foldingRegionsLimit){let t=new Uint32Array(this._length),i=new Uint32Array(this._length)
for(let e=this._length-1,n=0;e>=0;e--,n++)t[n]=this._startIndexes[e],i[n]=this._endIndexes[e]
return new zh(t,i,e)}{let t=0,i=this._indentOccurrences.length
for(let e=0;e<this._indentOccurrences.length;e++){let n=this._indentOccurrences[e]
if(n){if(n+t>this._foldingRegionsLimit){i=e
break}t+=n}}const n=e.getOptions().tabSize
let s=new Uint32Array(t),r=new Uint32Array(t)
for(let t=this._length-1,o=0;t>=0;t--){let a=this._startIndexes[t]
zt(e.getLineContent(a),n)<i&&(s[o]=a,r[o]=this._endIndexes[t],o++)}return new zh(s,r,e)}}}class Kh{constructor(){this._ranges=[]}registerChangedTokens(e){const t=this._ranges,i=t.length,n=i>0?t[i-1]:null
n&&n.toLineNumber===e-1?n.toLineNumber++:t[i]={fromLineNumber:e,toLineNumber:e}}build(){return 0===this._ranges.length?null:{ranges:this._ranges}}}class $h extends vn{constructor(e,t,i){super(e,t),this._languageIdentifier=i||Ch,this._tokenizationListener=js.onDidChange(e=>{-1!==e.changedLanguages.indexOf(this._languageIdentifier.language)&&(this._resetTokenizationState(),this.emitModelTokensChangedEvent({ranges:[{fromLineNumber:1,toLineNumber:this.getLineCount()}]}),this._shouldAutoTokenize()&&this._warmUpTokens())}),this._revalidateTokensTimeout=-1,this._languageRegistryListener=cr.onDidChange(e=>{e.languageIdentifier.id===this._languageIdentifier.id&&(this._resetIndentRanges(),this._emitModelLanguageConfigurationEvent({}))}),this._resetTokenizationState(),this._resetIndentRanges()}dispose(){this._tokenizationListener.dispose(),this._languageRegistryListener.dispose(),this._clearTimers(),this._lastState=null,super.dispose()}_shouldAutoTokenize(){return!1}_resetValue(e){super._resetValue(e),this._resetTokenizationState(),this._resetIndentRanges()}_resetTokenizationState(){this._clearTimers()
for(let e=0;e<this._lines.length;e++)this._lines[e].resetTokenizationState()
if(this._tokenizationSupport=null,this._isTooLargeForTokenization||(this._tokenizationSupport=js.get(this._languageIdentifier.language)),this._tokenizationSupport){let e=null
try{e=this._tokenizationSupport.getInitialState()}catch(e){e.friendlyMessage=$h.MODE_TOKENIZATION_FAILED_MSG,St(e),this._tokenizationSupport=null}e&&this._lines[0].setState(e)}this._lastState=null,this._invalidLineStartIndex=0,this._beginBackgroundTokenization()}_clearTimers(){-1!==this._revalidateTokensTimeout&&(clearTimeout(this._revalidateTokensTimeout),this._revalidateTokensTimeout=-1)}_withModelTokensChangedEventBuilder(e){let t=new Kh,i=e(t)
if(!this._isDisposing){let e=t.build()
e&&this._eventEmitter.emit(cn.ModelTokensChanged,e)}return i}forceTokenization(e){if(e<1||e>this.getLineCount())throw new Error("Illegal value "+e+" for `lineNumber`")
this._withModelTokensChangedEventBuilder(t=>{this._updateTokensUntilLine(t,e)})}isCheapToTokenize(e){return this._invalidLineStartIndex+1>=e}tokenizeIfCheap(e){this.isCheapToTokenize(e)&&this.forceTokenization(e)}getLineTokens(e){if(e<1||e>this.getLineCount())throw new Error("Illegal value "+e+" for `lineNumber`")
return this._getLineTokens(e)}_getLineTokens(e){return this._lines[e-1].getTokens(this._languageIdentifier.id)}getLanguageIdentifier(){return this._languageIdentifier}getModeId(){return this._languageIdentifier.language}setMode(e){if(this._languageIdentifier.id===e.id)return
let t={oldLanguage:this._languageIdentifier.language,newLanguage:e.language}
this._languageIdentifier=e,this._resetTokenizationState(),this._resetIndentRanges(),this.emitModelTokensChangedEvent({ranges:[{fromLineNumber:1,toLineNumber:this.getLineCount()}]}),this._emitModelModeChangedEvent(t),this._emitModelLanguageConfigurationEvent({})}getLanguageIdAtPosition(e,t){if(!this._tokenizationSupport)return this._languageIdentifier.id
let{lineNumber:i,column:n}=this.validatePosition({lineNumber:e,column:t})
return this._getLineTokens(i).findTokenAtOffset(n-1).languageId}_invalidateLine(e){this._lines[e].setIsInvalid(!0),e<this._invalidLineStartIndex&&(this._invalidLineStartIndex<this._lines.length&&this._lines[this._invalidLineStartIndex].setIsInvalid(!0),this._invalidLineStartIndex=e,this._beginBackgroundTokenization())}_beginBackgroundTokenization(){this._shouldAutoTokenize()&&-1===this._revalidateTokensTimeout&&(this._revalidateTokensTimeout=setTimeout(()=>{this._revalidateTokensTimeout=-1,this._revalidateTokensNow()},0))}_warmUpTokens(){var e=Math.min(100,this.getLineCount())
this._revalidateTokensNow(e),this._invalidLineStartIndex<this._lines.length&&this._beginBackgroundTokenization()}_revalidateTokensNow(e=this._invalidLineStartIndex+1e6){this._withModelTokensChangedEventBuilder(t=>{e=Math.min(this._lines.length,e)
for(var i,n=this._invalidLineStartIndex+1,s=0,r=0,o=Fh.create(!1),a=n;a<=e;a++){if((i=o.elapsed())>20){e=a-1
break}if(r=this._lines[a-1].text.length,s>0&&i+i/s*r>20){e=a-1
break}this._updateTokensUntilLine(t,a),s+=r,a=Math.max(a,this._invalidLineStartIndex+1)}i=o.elapsed(),this._invalidLineStartIndex<this._lines.length&&this._beginBackgroundTokenization()})}_updateTokensUntilLine(e,t){if(!this._tokenizationSupport)return void(this._invalidLineStartIndex=this._lines.length)
const i=this._lines.length,n=t-1
for(let t=this._invalidLineStartIndex;t<=n;t++){const n=t+1
let s=null
this._lines[t].text
try{let e=this._lines[t].getState().clone()
s=this._tokenizationSupport.tokenize2(this._lines[t].text,e,0)}catch(e){e.friendlyMessage=$h.MODE_TOKENIZATION_FAILED_MSG,St(e)}if(s||(s=bh(this._languageIdentifier.id,0,this._lines[t].getState(),0)),this._lines[t].setTokens(this._languageIdentifier.id,s.tokens),e.registerChangedTokens(t+1),this._lines[t].setIsInvalid(!1),n<i)if(null!==this._lines[n].getState()&&s.endState.equals(this._lines[n].getState())){let e=t+1
for(;e<i&&!this._lines[e].isInvalid();){if(e+1<i){if(null===this._lines[e+1].getState())break}else if(null===this._lastState)break
e++}this._invalidLineStartIndex=Math.max(this._invalidLineStartIndex,e),t=e-1}else this._lines[n].setState(s.endState)
else this._lastState=s.endState}this._invalidLineStartIndex=Math.max(this._invalidLineStartIndex,n+1)}emitModelTokensChangedEvent(e){this._isDisposing||this._eventEmitter.emit(cn.ModelTokensChanged,e)}_emitModelLanguageConfigurationEvent(e){this._isDisposing||this._eventEmitter.emit(cn.ModelLanguageConfigurationChanged,e)}_emitModelModeChangedEvent(e){this._isDisposing||this._eventEmitter.emit(cn.ModelLanguageChanged,e)}getWordAtPosition(e){this._assertNotDisposed()
let t=this.validatePosition(e),i=this.getLineContent(t.lineNumber)
if(this._invalidLineStartIndex<=t.lineNumber)return Ni(t.column,cr.getWordDefinition(this._languageIdentifier.id),i,0)
let n=this._getLineTokens(t.lineNumber),s=t.column-1,r=n.findTokenAtOffset(s),o=Ni(t.column,cr.getWordDefinition(r.languageId),i.substring(r.startOffset,r.endOffset),r.startOffset)
if(!o&&r.hasPrev&&r.startOffset===s){let e=r.prev()
o=Ni(t.column,cr.getWordDefinition(e.languageId),i.substring(e.startOffset,e.endOffset),e.startOffset)}return o}getWordUntilPosition(e){var t=this.getWordAtPosition(e)
return t?{word:t.word.substr(0,e.column-t.startColumn),startColumn:t.startColumn,endColumn:e.column}:{word:"",startColumn:e.column,endColumn:e.column}}findMatchingBracketUp(e,t){let i=e.toLowerCase(),n=this.validatePosition(t),s=this._getLineTokens(n.lineNumber).findTokenAtOffset(n.column-1),r=cr.getBracketsSupport(s.languageId)
if(!r)return null
let o=r.textIsBracket[i]
return o?this._findMatchingBracketUp(o,n):null}matchBracket(e){return this._matchBracket(this.validatePosition(e))}_matchBracket(e){const t=e.lineNumber
let i=this._getLineTokens(t)
const n=this._lines[t-1].text,s=i.findTokenAtOffset(e.column-1)
if(!s)return null
const r=cr.getBracketsSupport(s.languageId)
if(r&&!Xs(s.tokenType)){let i=Math.max(s.startOffset,e.column-1-r.maxBracketLength)
const o=Math.min(s.endOffset,e.column-1+r.maxBracketLength)
let a=ar.findNextBracketInToken(r.forwardRegex,t,n,e.column-1,o)
if(a&&a.startColumn===e.column){let e=n.substring(a.startColumn-1,a.endColumn-1)
e=e.toLowerCase()
let t=this._matchFoundBracket(a,r.textIsBracket[e],r.textIsOpenBracket[e])
if(t)return t}for(;;){let s=ar.findNextBracketInToken(r.forwardRegex,t,n,i,o)
if(!s)break
if(s.startColumn<=e.column&&e.column<=s.endColumn){let e=n.substring(s.startColumn-1,s.endColumn-1)
e=e.toLowerCase()
let t=this._matchFoundBracket(s,r.textIsBracket[e],r.textIsOpenBracket[e])
if(t)return t}i=s.endColumn-1}}if(s.hasPrev&&s.startOffset===e.column-1){const i=s.prev(),r=cr.getBracketsSupport(i.languageId)
if(r&&!Xs(i.tokenType)){const o=Math.max(i.startOffset,e.column-1-r.maxBracketLength),a=s.startOffset,l=ar.findPrevBracketInToken(r.reversedRegex,t,n,o,a)
if(l&&l.startColumn<=e.column&&e.column<=l.endColumn){let e=n.substring(l.startColumn-1,l.endColumn-1)
e=e.toLowerCase()
let t=this._matchFoundBracket(l,r.textIsBracket[e],r.textIsOpenBracket[e])
if(t)return t}}}return null}_matchFoundBracket(e,t,i){if(i){let i=this._findMatchingBracketDown(t,e.getEndPosition())
if(i)return[e,i]}else{let i=this._findMatchingBracketUp(t,e.getStartPosition())
if(i)return[e,i]}return null}_findMatchingBracketUp(e,t){const i=e.languageIdentifier.id,n=e.reversedRegex
let s=-1
for(let r=t.lineNumber;r>=1;r--){const o=this._getLineTokens(r),a=this._lines[r-1].text
let l,h
for(r===t.lineNumber?(l=o.findTokenAtOffset(t.column-1),h=t.column-1):(l=o.lastToken())&&(h=l.endOffset);l;){if(l.languageId===i&&!Xs(l.tokenType))for(;;){let t=ar.findPrevBracketInToken(n,r,a,l.startOffset,h)
if(!t)break
let i=a.substring(t.startColumn-1,t.endColumn-1)
if((i=i.toLowerCase())===e.open?s++:i===e.close&&s--,0===s)return t
h=t.startColumn-1}(l=l.prev())&&(h=l.endOffset)}}return null}_findMatchingBracketDown(e,t){const i=e.languageIdentifier.id,n=e.forwardRegex
let s=1
for(let r=t.lineNumber,o=this.getLineCount();r<=o;r++){const o=this._getLineTokens(r),a=this._lines[r-1].text
let l,h
for(r===t.lineNumber?(l=o.findTokenAtOffset(t.column-1),h=t.column-1):(l=o.firstToken())&&(h=l.startOffset);l;){if(l.languageId===i&&!Xs(l.tokenType))for(;;){let t=ar.findNextBracketInToken(n,r,a,h,l.endOffset)
if(!t)break
let i=a.substring(t.startColumn-1,t.endColumn-1)
if((i=i.toLowerCase())===e.open?s++:i===e.close&&s--,0===s)return t
h=t.endColumn-1}(l=l.next())&&(h=l.startOffset)}}return null}findPrevBracket(e){const t=this.validatePosition(e)
let i=-1,n=null
for(let e=t.lineNumber;e>=1;e--){const s=this._getLineTokens(e),r=this._lines[e-1].text
let o,a
for(e===t.lineNumber?(o=s.findTokenAtOffset(t.column-1),a=t.column-1):(o=s.lastToken())&&(a=o.endOffset);o;){if(i!==o.languageId&&(i=o.languageId,n=cr.getBracketsSupport(i)),n&&!Xs(o.tokenType)){let t=ar.findPrevBracketInToken(n.reversedRegex,e,r,o.startOffset,a)
if(t)return this._toFoundBracket(n,t)}(o=o.prev())&&(a=o.endOffset)}}return null}findNextBracket(e){const t=this.validatePosition(e)
let i=-1,n=null
for(let e=t.lineNumber,s=this.getLineCount();e<=s;e++){const s=this._getLineTokens(e),r=this._lines[e-1].text
let o,a
for(e===t.lineNumber?(o=s.findTokenAtOffset(t.column-1),a=t.column-1):(o=s.firstToken())&&(a=o.startOffset);o;){if(i!==o.languageId&&(i=o.languageId,n=cr.getBracketsSupport(i)),n&&!Xs(o.tokenType)){let t=ar.findNextBracketInToken(n.forwardRegex,e,r,a,o.endOffset)
if(t)return this._toFoundBracket(n,t)}(o=o.next())&&(a=o.startOffset)}}return null}_toFoundBracket(e,t){if(!t)return null
let i=this.getValueInRange(t)
i=i.toLowerCase()
let n=e.textIsBracket[i]
return n?{range:t,open:n.open,close:n.close,isOpen:e.textIsOpenBracket[i]}:null}_resetIndentRanges(){this._indentRanges=null}_getIndentRanges(){if(!this._indentRanges){let e=cr.getFoldingRules(this._languageIdentifier.id),t=e&&e.offSide,i=e&&e.markers
this._indentRanges=function(e,t,i,n=Vh){const s=e.getOptions().tabSize
let r=new Uh(n),o=void 0
i&&(o=new RegExp(`(${i.start.source})|(?:${i.end.source})`))
let a=[]
a.push({indent:-1,line:e.getLineCount()+1,marker:!1})
for(let i=e.getLineCount();i>0;i--){let n,l=e.getLineContent(i),h=zt(l,s),d=a[a.length-1]
if(-1!==h){if(o&&(n=l.match(o))){if(!n[1]){a.push({indent:-2,line:i,marker:!0})
continue}{let e=a.length-1
for(;e>0&&!a[e].marker;)e--
if(e>0){a.length=e+1,d=a[e],r.insertFirst(i,d.line,h),d.marker=!1,d.indent=h,d.line=i
continue}}}if(d.indent>h){do{a.pop(),d=a[a.length-1]}while(d.indent>h)
let e=d.line-1
e-i>=1&&r.insertFirst(i,e,h)}d.indent===h?d.line=i:a.push({indent:h,line:i,marker:!1})}else t&&!d.marker&&(d.line=i)}return r.toIndentRanges(e)}(this,t,i)}return this._indentRanges}getIndentRanges(){return this._getIndentRanges()}_computeIndentLevel(e){return zt(this._lines[e].text,this._options.tabSize)}getLinesIndentGuides(e,t){this._assertNotDisposed()
const i=this.getLineCount()
if(e<1||e>i)throw new Error("Illegal value "+e+" for `startLineNumber`")
if(t<1||t>i)throw new Error("Illegal value "+t+" for `endLineNumber`")
const n=cr.getFoldingRules(this._languageIdentifier.id),s=n&&n.offSide
let r=new Array(t-e+1),o=-2,a=-1,l=-2,h=-1
for(let n=e;n<=t;n++){let t=n-e
const d=this._computeIndentLevel(n-1)
if(d>=0)o=n-1,a=d,r[t]=Math.ceil(d/this._options.tabSize)
else{if(-2===o){o=-1,a=-1
for(let e=n-2;e>=0;e--){let t=this._computeIndentLevel(e)
if(t>=0){o=e,a=t
break}}}if(-1!==l&&(-2===l||l<n-1)){l=-1,h=-1
for(let e=n;e<i;e++){let t=this._computeIndentLevel(e)
if(t>=0){l=e,h=t
break}}}r[t]=-1===a||-1===h?0:a<h?1+Math.floor(a/this._options.tabSize):a===h?Math.ceil(h/this._options.tabSize):s?Math.ceil(h/this._options.tabSize):1+Math.floor(h/this._options.tabSize)}}return r}}$h.MODE_TOKENIZATION_FAILED_MSG=Jt("mode.tokenizationSupportFailed","The mode has failed while tokenizing the input.")
const qh={EditorInfoDecoration:"infosquiggly",EditorWarningDecoration:"warningsquiggly",EditorErrorDecoration:"errorsquiggly"}
function Gh(e){return(1&e.metadata)>>>0}function jh(e,t){e.metadata=254&e.metadata|t<<0}function Yh(e){return(2&e.metadata)>>>1==1}function Zh(e,t){e.metadata=253&e.metadata|(t?1:0)<<1}function Xh(e){return(4&e.metadata)>>>2==1}function Jh(e,t){e.metadata=251&e.metadata|(t?1:0)<<2}function Qh(e){return(8&e.metadata)>>>3==1}function ed(e,t){e.metadata=247&e.metadata|(t?1:0)<<3}function td(e,t){e.metadata=207&e.metadata|t<<4}class id{constructor(e,t,i){this.metadata=0,this.parent=null,this.left=null,this.right=null,jh(this,1),this.start=t,this.end=i,this.delta=0,this.maxEnd=i,this.id=e,this.ownerId=0,this.options=null,Jh(this,!1),td(this,1),ed(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=null,Zh(this,!1)}reset(e,t,i,n){this.start=t,this.end=i,this.maxEnd=i,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=n}setOptions(e){this.options=e,Jh(this,this.options.className===qh.EditorErrorDecoration||this.options.className===qh.EditorWarningDecoration),td(this,this.options.stickiness),ed(this,!!this.options.overviewRuler.color)}setCachedOffsets(e,t,i){this.cachedVersionId!==i&&(this.range=null),this.cachedVersionId=i,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}}const nd=new id(null,0,0)
nd.parent=nd,nd.left=nd,nd.right=nd,jh(nd,0)
class sd{constructor(){this.root=nd,this.requestNormalizeDelta=!1}intervalSearch(e,t,i,n,s){return this.root===nd?[]:function(e,t,i,n,s,r){let o=e.root,a=0,l=0,h=0,d=0,u=[],c=0
for(;o!==nd;)if(Yh(o))Zh(o.left,!1),Zh(o.right,!1),o===o.parent.right&&(a-=o.parent.delta),o=o.parent
else{if(!Yh(o.left)){if((l=a+o.maxEnd)<t){Zh(o,!0)
continue}if(o.left!==nd){o=o.left
continue}}if((h=a+o.start)>i)Zh(o,!0)
else{if((d=a+o.end)>=t){o.setCachedOffsets(h,d,r)
let e=!0
n&&o.ownerId&&o.ownerId!==n&&(e=!1),s&&Xh(o)&&(e=!1),e&&(u[c++]=o)}Zh(o,!0),o.right===nd||Yh(o.right)||(a+=o.delta,o=o.right)}}return Zh(e.root,!1),u}(this,e,t,i,n,s)}search(e,t,i){return this.root===nd?[]:ad(this,e,t,i)}count(){return this.root===nd?0:function(e){let t=e.root,i=0
for(;t!==nd;)Yh(t)?(Zh(t.left,!1),Zh(t.right,!1),t=t.parent):t.left===nd||Yh(t.left)?(i++,Zh(t,!0),t.right===nd||Yh(t.right)||(t=t.right)):t=t.left
return Zh(e.root,!1),i}(this)}collectNodesFromOwner(e){return function(e,t){let i=e.root,n=[],s=0
for(;i!==nd;)Yh(i)?(Zh(i.left,!1),Zh(i.right,!1),i=i.parent):i.left===nd||Yh(i.left)?(i.ownerId===t&&(n[s++]=i),Zh(i,!0),i.right===nd||Yh(i.right)||(i=i.right)):i=i.left
return Zh(e.root,!1),n}(this,e)}collectNodesPostOrder(){return function(e){let t=e.root,i=[],n=0
for(;t!==nd;)Yh(t)?(Zh(t.left,!1),Zh(t.right,!1),t=t.parent):t.left===nd||Yh(t.left)?t.right===nd||Yh(t.right)?(i[n++]=t,Zh(t,!0)):t=t.right:t=t.left
return Zh(e.root,!1),i}(this)}insert(e){ld(this,e),this._normalizeDeltaIfNecessary()}delete(e){hd(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){const i=e
let n=0
for(;e!==this.root;)e===e.parent.right&&(n+=e.parent.delta),e=e.parent
const s=i.start+n,r=i.end+n
i.setCachedOffsets(s,r,t)}acceptReplace(e,t,i,n){const s=function(e,t,i){let n=e.root,s=0,r=0,o=0,a=0,l=[],h=0
for(;n!==nd;)if(Yh(n))Zh(n.left,!1),Zh(n.right,!1),n===n.parent.right&&(s-=n.parent.delta),n=n.parent
else{if(!Yh(n.left)){if((r=s+n.maxEnd)<t){Zh(n,!0)
continue}if(n.left!==nd){n=n.left
continue}}(o=s+n.start)>i?Zh(n,!0):((a=s+n.end)>=t&&(n.setCachedOffsets(o,a,0),l[h++]=n),Zh(n,!0),n.right===nd||Yh(n.right)||(s+=n.delta,n=n.right))}return Zh(e.root,!1),l}(this,e,e+t)
for(let e=0,t=s.length;e<t;e++){hd(this,s[e])}this._normalizeDeltaIfNecessary(),function(e,t,i,n){let s=e.root,r=0,o=0,a=0
const l=n-(i-t)
for(;s!==nd;)if(Yh(s))Zh(s.left,!1),Zh(s.right,!1),s===s.parent.right&&(r-=s.parent.delta),md(s),s=s.parent
else{if(!Yh(s.left)){if((o=r+s.maxEnd)<t){Zh(s,!0)
continue}if(s.left!==nd){s=s.left
continue}}(a=r+s.start)>i?(s.start+=l,s.end+=l,s.delta+=l,(s.delta<-1073741824||s.delta>1073741824)&&(e.requestNormalizeDelta=!0),Zh(s,!0)):(Zh(s,!0),s.right===nd||Yh(s.right)||(r+=s.delta,s=s.right))}Zh(e.root,!1)}(this,e,e+t,i),this._normalizeDeltaIfNecessary()
for(let r=0,o=s.length;r<o;r++){const o=s[r]
o.start=o.cachedAbsoluteStart,o.end=o.cachedAbsoluteEnd,od(o,e,e+t,i,n),o.maxEnd=o.end,ld(this,o)}this._normalizeDeltaIfNecessary()}assertInvariants(){Cd(0===Gh(nd)),Cd(nd.parent===nd),Cd(nd.left===nd),Cd(nd.right===nd),Cd(0===nd.start),Cd(0===nd.end),Cd(0===nd.delta),Cd(this.root.parent===nd),function(e){if(e.root===nd)return
Cd(0===Gh(e.root)),Cd(_d(e.root.left)===_d(e.root.right)),function e(t,i){if(t===nd)return
let n=t.left
let s=t.right
1===Gh(t)&&(Cd(0===Gh(n)),Cd(0===Gh(s)))
let r=t.end
n!==nd&&(Cd(fd(n.start+i,n.end+i,t.start+i,t.end+i)<=0),r=Math.max(r,n.maxEnd))
s!==nd&&(Cd(fd(t.start+i,t.end+i,s.start+i+t.delta,s.end+i+t.delta)<=0),r=Math.max(r,s.maxEnd+t.delta))
Cd(t.maxEnd===r)
e(n,i)
e(s,i+t.delta)}(e.root,0)}(this)}getAllInOrder(){return ad(this,0,!1,0)}print(){if(this.root===nd)return void console.log("~~ empty")
let e=[]
this._print(this.root,"",0,e),console.log(e.join(""))}_print(e,t,i,n){n.push(`${t}[${1===Gh(e)?"R":"B"},${e.delta}, ${e.start}->${e.end}, ${e.maxEnd}] : {${i+e.start}->${i+e.end}}, maxEnd: ${e.maxEnd+i}\n`),e.left!==nd?this._print(e.left,t+"    ",i,n):n.push(`${t}    NIL\n`),e.right!==nd?this._print(e.right,t+"    ",i+e.delta,n):n.push(`${t}    NIL\n`)}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,function(e){let t=e.root,i=0
for(;t!==nd;)t.left===nd||Yh(t.left)?t.right===nd||Yh(t.right)?(t.start=i+t.start,t.end=i+t.end,t.delta=0,md(t),Zh(t,!0),Zh(t.left,!1),Zh(t.right,!1),t===t.parent.right&&(i-=t.parent.delta),t=t.parent):(i+=t.delta,t=t.right):t=t.left
Zh(e.root,!1)}(this))}}function rd(e,t,i,n){return e<i||!(e>i)&&(1!==n&&(2===n||t))}function od(e,t,i,n,s){const r=(48&e.metadata)>>>4
const o=0===r||2===r,a=1===r||2===r,l=i-t,h=n,d=Math.min(l,h),u=e.start
let c=!1
const g=e.end
let m=!1
{const e=s?1:l>0?2:0
!c&&rd(u,o,t,e)&&(c=!0),!m&&rd(g,a,t,e)&&(m=!0)}if(d>0&&!s){const e=l>h?2:0
!c&&rd(u,o,t+d,e)&&(c=!0),!m&&rd(g,a,t+d,e)&&(m=!0)}{const n=s?1:0
!c&&rd(u,o,i,n)&&(e.start=t+h,c=!0),!m&&rd(g,a,i,n)&&(e.end=t+h,m=!0)}const p=h-l
c||(e.start=Math.max(0,u+p),c=!0),m||(e.end=Math.max(0,g+p),m=!0),e.start>e.end&&(e.end=e.start)}function ad(e,t,i,n){let s=e.root,r=0,o=0,a=0,l=[],h=0
for(;s!==nd;){if(Yh(s)){Zh(s.left,!1),Zh(s.right,!1),s===s.parent.right&&(r-=s.parent.delta),s=s.parent
continue}if(s.left!==nd&&!Yh(s.left)){s=s.left
continue}o=r+s.start,a=r+s.end,s.setCachedOffsets(o,a,n)
let e=!0
t&&s.ownerId&&s.ownerId!==t&&(e=!1),i&&Xh(s)&&(e=!1),e&&(l[h++]=s),Zh(s,!0),s.right===nd||Yh(s.right)||(r+=s.delta,s=s.right)}return Zh(e.root,!1),l}function ld(e,t){if(e.root===nd)return t.parent=nd,t.left=nd,t.right=nd,jh(t,0),e.root=t,e.root
!function(e,t){let i=0,n=e.root
const s=t.start,r=t.end
for(;;){const e=fd(s,r,n.start+i,n.end+i)
if(e<0){if(n.left===nd){t.start-=i,t.end-=i,t.maxEnd-=i,n.left=t
break}n=n.left}else{if(n.right===nd){t.start-=i+n.delta,t.end-=i+n.delta,t.maxEnd-=i+n.delta,n.right=t
break}i+=n.delta,n=n.right}}t.parent=n,t.left=nd,t.right=nd,jh(t,1)}(e,t),pd(t.parent)
let i=t
for(;i!==e.root&&1===Gh(i.parent);)if(i.parent===i.parent.parent.left){const t=i.parent.parent.right
1===Gh(t)?(jh(i.parent,0),jh(t,0),jh(i.parent.parent,1),i=i.parent.parent):(i===i.parent.right&&ud(e,i=i.parent),jh(i.parent,0),jh(i.parent.parent,1),cd(e,i.parent.parent))}else{const t=i.parent.parent.left
1===Gh(t)?(jh(i.parent,0),jh(t,0),jh(i.parent.parent,1),i=i.parent.parent):(i===i.parent.left&&cd(e,i=i.parent),jh(i.parent,0),jh(i.parent.parent,1),ud(e,i.parent.parent))}return jh(e.root,0),t}function hd(e,t){let i,n
if(t.left===nd?(n=t,(i=t.right).delta+=t.delta,(i.delta<-1073741824||i.delta>1073741824)&&(e.requestNormalizeDelta=!0),i.start+=t.delta,i.end+=t.delta):t.right===nd?(i=t.left,n=t):((i=(n=function(e){for(;e.left!==nd;)e=e.left
return e}(t.right)).right).start+=n.delta,i.end+=n.delta,i.delta+=n.delta,(i.delta<-1073741824||i.delta>1073741824)&&(e.requestNormalizeDelta=!0),n.start+=t.delta,n.end+=t.delta,n.delta=t.delta,(n.delta<-1073741824||n.delta>1073741824)&&(e.requestNormalizeDelta=!0)),n===e.root)return e.root=i,jh(i,0),t.detach(),dd(),md(i),void(e.root.parent=nd)
let s,r=1===Gh(n)
if(n===n.parent.left?n.parent.left=i:n.parent.right=i,n===t?i.parent=n.parent:(n.parent===t?i.parent=n:i.parent=n.parent,n.left=t.left,n.right=t.right,n.parent=t.parent,jh(n,Gh(t)),t===e.root?e.root=n:t===t.parent.left?t.parent.left=n:t.parent.right=n,n.left!==nd&&(n.left.parent=n),n.right!==nd&&(n.right.parent=n)),t.detach(),r)return pd(i.parent),n!==t&&(pd(n),pd(n.parent)),void dd()
for(pd(i),pd(i.parent),n!==t&&(pd(n),pd(n.parent));i!==e.root&&0===Gh(i);)i===i.parent.left?(1===Gh(s=i.parent.right)&&(jh(s,0),jh(i.parent,1),ud(e,i.parent),s=i.parent.right),0===Gh(s.left)&&0===Gh(s.right)?(jh(s,1),i=i.parent):(0===Gh(s.right)&&(jh(s.left,0),jh(s,1),cd(e,s),s=i.parent.right),jh(s,Gh(i.parent)),jh(i.parent,0),jh(s.right,0),ud(e,i.parent),i=e.root)):(1===Gh(s=i.parent.left)&&(jh(s,0),jh(i.parent,1),cd(e,i.parent),s=i.parent.left),0===Gh(s.left)&&0===Gh(s.right)?(jh(s,1),i=i.parent):(0===Gh(s.left)&&(jh(s.right,0),jh(s,1),ud(e,s),s=i.parent.left),jh(s,Gh(i.parent)),jh(i.parent,0),jh(s.left,0),cd(e,i.parent),i=e.root))
jh(i,0),dd()}function dd(){nd.parent=nd,nd.delta=0,nd.start=0,nd.end=0}function ud(e,t){const i=t.right
i.delta+=t.delta,(i.delta<-1073741824||i.delta>1073741824)&&(e.requestNormalizeDelta=!0),i.start+=t.delta,i.end+=t.delta,t.right=i.left,i.left!==nd&&(i.left.parent=t),i.parent=t.parent,t.parent===nd?e.root=i:t===t.parent.left?t.parent.left=i:t.parent.right=i,i.left=t,t.parent=i,md(t),md(i)}function cd(e,t){const i=t.left
t.delta-=i.delta,(t.delta<-1073741824||t.delta>1073741824)&&(e.requestNormalizeDelta=!0),t.start-=i.delta,t.end-=i.delta,t.left=i.right,i.right!==nd&&(i.right.parent=t),i.parent=t.parent,t.parent===nd?e.root=i:t===t.parent.right?t.parent.right=i:t.parent.left=i,i.right=t,t.parent=i,md(t),md(i)}function gd(e){let t=e.end
if(e.left!==nd){const i=e.left.maxEnd
i>t&&(t=i)}if(e.right!==nd){const i=e.right.maxEnd+e.delta
i>t&&(t=i)}return t}function md(e){e.maxEnd=gd(e)}function pd(e){for(;e!==nd;){const t=gd(e)
if(e.maxEnd===t)return
e.maxEnd=t,e=e.parent}}function fd(e,t,i,n){return e===i?t-n:e-i}function _d(e){return e===nd?1:(Cd(_d(e.left)===_d(e.right)),(0===Gh(e)?1:0)+_d(e.left))}function Cd(e){if(!e)throw new Error("Assertion violation")}let bd=0
class wd extends $h{constructor(e,t,i){super(e,t,i),this._instanceId=function(){let e=bd++
return(e%=52)<26?String.fromCharCode(97+e):String.fromCharCode(65+e-26)}(),this._lastDecorationId=0,this._currentDecorationsTrackerCnt=0,this._currentDecorationsTrackerDidChange=!1,this._decorations=Object.create(null),this._decorationsTree=new vd}dispose(){this._decorations=null,this._decorationsTree=null,super.dispose()}_resetValue(e){super._resetValue(e),this._decorations=Object.create(null),this._decorationsTree=new vd}_getTrackedRangesCount(){return this._decorationsTree.count()}_acquireDecorationsTracker(){0===this._currentDecorationsTrackerCnt&&(this._currentDecorationsTrackerDidChange=!1),this._currentDecorationsTrackerCnt++}_releaseDecorationsTracker(){this._currentDecorationsTrackerCnt--,0===this._currentDecorationsTrackerCnt&&this._currentDecorationsTrackerDidChange&&this._emitModelDecorationsChangedEvent()}_adjustDecorationsForEdit(e,t,i,n){this._currentDecorationsTrackerDidChange=!0,this._decorationsTree.acceptReplace(e,t,i,n)}_onBeforeEOLChange(){super._onBeforeEOLChange()
const e=this.getVersionId(),t=this._decorationsTree.search(0,!1,!1,e)
this._ensureNodesHaveRanges(t)}_onAfterEOLChange(){super._onAfterEOLChange()
const e=this.getVersionId(),t=this._decorationsTree.collectNodesPostOrder()
for(let i=0,n=t.length;i<n;i++){const n=t[i],s=n.cachedAbsoluteStart-n.start,r=this._lineStarts.getAccumulatedValue(n.range.startLineNumber-2)+n.range.startColumn-1,o=this._lineStarts.getAccumulatedValue(n.range.endLineNumber-2)+n.range.endColumn-1
n.cachedAbsoluteStart=r,n.cachedAbsoluteEnd=o,n.cachedVersionId=e,n.start=r-s,n.end=o-s,md(n)}}changeDecorations(e,t=0){this._assertNotDisposed()
try{return this._eventEmitter.beginDeferredEmit(),this._acquireDecorationsTracker(),this._changeDecorations(t,e)}finally{this._releaseDecorationsTracker(),this._eventEmitter.endDeferredEmit()}}_changeDecorations(e,t){let i={addDecoration:(t,i)=>(this._currentDecorationsTrackerDidChange=!0,this._deltaDecorationsImpl(e,[],[{range:t,options:i}])[0]),changeDecoration:(e,t)=>{this._currentDecorationsTrackerDidChange=!0,this._changeDecorationImpl(e,t)},changeDecorationOptions:(e,t)=>{this._currentDecorationsTrackerDidChange=!0,this._changeDecorationOptionsImpl(e,Ed(t))},removeDecoration:t=>{this._currentDecorationsTrackerDidChange=!0,this._deltaDecorationsImpl(e,[t],[])},deltaDecorations:(t,i)=>0===t.length&&0===i.length?[]:(this._currentDecorationsTrackerDidChange=!0,this._deltaDecorationsImpl(e,t,i))},n=null
try{n=t(i)}catch(e){St(e)}return i.addDecoration=null,i.changeDecoration=null,i.removeDecoration=null,i.deltaDecorations=null,n}deltaDecorations(e,t,i=0){if(this._assertNotDisposed(),e||(e=[]),0===e.length&&0===t.length)return[]
try{return this._eventEmitter.beginDeferredEmit(),this._acquireDecorationsTracker(),this._currentDecorationsTrackerDidChange=!0,this._deltaDecorationsImpl(i,e,t)}finally{this._releaseDecorationsTracker(),this._eventEmitter.endDeferredEmit()}}_getTrackedRange(e){return this.getDecorationRange(e)}_setTrackedRange(e,t,i){const n=e?this._decorations[e]:null
if(!n)return t?this._deltaDecorationsImpl(0,[],[{range:t,options:Nd[i]}])[0]:null
if(!t)return this._decorationsTree.delete(n),delete this._decorations[n.id],null
const s=this._validateRangeRelaxedNoAllocations(t),r=this._lineStarts.getAccumulatedValue(s.startLineNumber-2)+s.startColumn-1,o=this._lineStarts.getAccumulatedValue(s.endLineNumber-2)+s.endColumn-1
return this._decorationsTree.delete(n),n.reset(this.getVersionId(),r,o,s),n.setOptions(Nd[i]),this._decorationsTree.insert(n),n.id}removeAllDecorationsWithOwnerId(e){if(this._isDisposed)return
const t=this._decorationsTree.collectNodesFromOwner(e)
for(let e=0,i=t.length;e<i;e++){const i=t[e]
this._decorationsTree.delete(i),delete this._decorations[i.id]}}getDecorationOptions(e){const t=this._decorations[e]
return t?t.options:null}getDecorationRange(e){const t=this._decorations[e]
if(!t)return null
const i=this.getVersionId()
return t.cachedVersionId!==i&&this._decorationsTree.resolveNode(t,i),null===t.range&&(t.range=this._getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}getLineDecorations(e,t=0,i=!1){return e<1||e>this.getLineCount()?[]:this.getLinesDecorations(e,e,t,i)}getLinesDecorations(e,i,n=0,s=!1){let r=this.getLineCount(),o=Math.min(r,Math.max(1,e)),a=Math.min(r,Math.max(1,i)),l=this.getLineMaxColumn(a)
return this._getDecorationsInRange(new t(o,1,a,l),n,s)}getDecorationsInRange(e,t=0,i=!1){let n=this.validateRange(e)
return this._getDecorationsInRange(n,t,i)}getOverviewRulerDecorations(e=0,t=!1){const i=this.getVersionId(),n=this._decorationsTree.search(e,t,!0,i)
return this._ensureNodesHaveRanges(n)}getAllDecorations(e=0,t=!1){const i=this.getVersionId(),n=this._decorationsTree.search(e,t,!1,i)
return this._ensureNodesHaveRanges(n)}_emitModelDecorationsChangedEvent(){if(!this._isDisposing){let e={}
this._eventEmitter.emit(cn.ModelDecorationsChanged,e)}}_getDecorationsInRange(e,t,i){const n=this._lineStarts.getAccumulatedValue(e.startLineNumber-2)+e.startColumn-1,s=this._lineStarts.getAccumulatedValue(e.endLineNumber-2)+e.endColumn-1,r=this.getVersionId(),o=this._decorationsTree.intervalSearch(n,s,t,i,r)
return this._ensureNodesHaveRanges(o)}_ensureNodesHaveRanges(e){for(let t=0,i=e.length;t<i;t++){const i=e[t]
null===i.range&&(i.range=this._getRangeAt(i.cachedAbsoluteStart,i.cachedAbsoluteEnd))}return e}_getRangeAt(e,i){const n=this._lineStarts.getIndexOf(e),s=this._lines[n.index].text.length,r=Math.min(n.remainder+1,s+1),o=this._lineStarts.getIndexOf(i),a=this._lines[o.index].text.length,l=Math.min(o.remainder+1,a+1)
return new t(n.index+1,r,o.index+1,l)}_changeDecorationImpl(e,t){const i=this._decorations[e]
if(!i)return
const n=this._validateRangeRelaxedNoAllocations(t),s=this._lineStarts.getAccumulatedValue(n.startLineNumber-2)+n.startColumn-1,r=this._lineStarts.getAccumulatedValue(n.endLineNumber-2)+n.endColumn-1
this._decorationsTree.delete(i),i.reset(this.getVersionId(),s,r,n),this._decorationsTree.insert(i)}_changeDecorationOptionsImpl(e,t){const i=this._decorations[e]
i&&(!!i.options.overviewRuler.color!==!!t.overviewRuler.color?(this._decorationsTree.delete(i),i.setOptions(t),this._decorationsTree.insert(i)):i.setOptions(t))}_deltaDecorationsImpl(e,t,i){const n=this.getVersionId(),s=t.length
let r=0
const o=i.length
let a=0,l=new Array(o)
for(;r<s||a<o;){let h=null
if(r<s){do{h=this._decorations[t[r++]]}while(!h&&r<s)
h&&this._decorationsTree.delete(h)}if(a<o){if(!h){const e=++this._lastDecorationId,t=`${this._instanceId};${e}`
h=new id(t,0,0),this._decorations[t]=h}const t=i[a],s=this._validateRangeRelaxedNoAllocations(t.range),r=Ed(t.options),o=this._lineStarts.getAccumulatedValue(s.startLineNumber-2)+s.startColumn-1,d=this._lineStarts.getAccumulatedValue(s.endLineNumber-2)+s.endColumn-1
h.ownerId=e,h.reset(n,o,d,s),h.setOptions(r),this._decorationsTree.insert(h),l[a]=h.id,a++}else h&&delete this._decorations[h.id]}return l}}class vd{constructor(){this._decorationsTree0=new sd,this._decorationsTree1=new sd}intervalSearch(e,t,i,n,s){const r=this._decorationsTree0.intervalSearch(e,t,i,n,s),o=this._decorationsTree1.intervalSearch(e,t,i,n,s)
return r.concat(o)}search(e,t,i,n){if(i)return this._decorationsTree1.search(e,t,n)
{const i=this._decorationsTree0.search(e,t,n),s=this._decorationsTree1.search(e,t,n)
return i.concat(s)}}count(){return this._decorationsTree0.count()+this._decorationsTree1.count()}collectNodesFromOwner(e){const t=this._decorationsTree0.collectNodesFromOwner(e),i=this._decorationsTree1.collectNodesFromOwner(e)
return t.concat(i)}collectNodesPostOrder(){const e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder()
return e.concat(t)}insert(e){Qh(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){Qh(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}resolveNode(e,t){Qh(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,i,n){this._decorationsTree0.acceptReplace(e,t,i,n),this._decorationsTree1.acceptReplace(e,t,i,n)}}function Sd(e){return e.replace(/[^a-z0-9\-]/gi," ")}class yd{constructor(e){this.color=ae,this.darkColor=ae,this.hcColor=ae,this.position=i.Center,this._resolvedColor=null,e&&e.color&&(this.color=e.color),e&&e.darkColor&&(this.darkColor=e.darkColor,this.hcColor=e.darkColor),e&&e.hcColor&&(this.hcColor=e.hcColor),e&&e.hasOwnProperty("position")&&(this.position=e.position)}equals(e){return this.color===e.color&&this.darkColor===e.darkColor&&this.hcColor===e.hcColor&&this.position===e.position}}let xd=0
class Ld{static register(e){return new Ld(++xd,e)}static createDynamic(e){return new Ld(0,e)}constructor(e,t){this.staticId=e,this.stickiness=t.stickiness||d.AlwaysGrowsWhenTypingAtEdges,this.className=t.className?Sd(t.className):ae,this.hoverMessage=t.hoverMessage||[],this.glyphMarginHoverMessage=t.glyphMarginHoverMessage||[],this.isWholeLine=t.isWholeLine||!1,this.showIfCollapsed=t.showIfCollapsed||!1,this.overviewRuler=new yd(t.overviewRuler),this.glyphMarginClassName=t.glyphMarginClassName?Sd(t.glyphMarginClassName):ae,this.linesDecorationsClassName=t.linesDecorationsClassName?Sd(t.linesDecorationsClassName):ae,this.marginClassName=t.marginClassName?Sd(t.marginClassName):ae,this.inlineClassName=t.inlineClassName?Sd(t.inlineClassName):ae,this.beforeContentClassName=t.beforeContentClassName?Sd(t.beforeContentClassName):ae,this.afterContentClassName=t.afterContentClassName?Sd(t.afterContentClassName):ae}equals(e){return this.staticId>0||e.staticId>0?this.staticId===e.staticId:this.stickiness===e.stickiness&&this.className===e.className&&this.isWholeLine===e.isWholeLine&&this.showIfCollapsed===e.showIfCollapsed&&this.glyphMarginClassName===e.glyphMarginClassName&&this.linesDecorationsClassName===e.linesDecorationsClassName&&this.marginClassName===e.marginClassName&&this.inlineClassName===e.inlineClassName&&this.beforeContentClassName===e.beforeContentClassName&&this.afterContentClassName===e.afterContentClassName&&Oh(this.hoverMessage,e.hoverMessage)&&Oh(this.glyphMarginHoverMessage,e.glyphMarginHoverMessage)&&this.overviewRuler.equals(e.overviewRuler)}}Ld.EMPTY=Ld.register({})
const Nd=[Ld.register({stickiness:d.AlwaysGrowsWhenTypingAtEdges}),Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges}),Ld.register({stickiness:d.GrowsOnlyWhenTypingBefore}),Ld.register({stickiness:d.GrowsOnlyWhenTypingAfter})]
function Ed(e){return e instanceof Ld?e:Ld.createDynamic(e)}function kd(e,t){const i=Math.pow(10,t)
return Math.round(e*i)/i}class Id{constructor(e,t,i,n=1){this.r=0|Math.min(255,Math.max(0,e)),this.g=0|Math.min(255,Math.max(0,t)),this.b=0|Math.min(255,Math.max(0,i)),this.a=kd(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}}class Md{constructor(e,t,i,n){this.h=0|Math.max(Math.min(360,e),0),this.s=kd(Math.max(Math.min(1,t),0),3),this.l=kd(Math.max(Math.min(1,i),0),3),this.a=kd(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,n=e.b/255,s=e.a,r=Math.max(t,i,n),o=Math.min(t,i,n)
let a=0,l=0
const h=(o+r)/2,d=r-o
if(d>0){switch(l=Math.min(h<=.5?d/(2*h):d/(2-2*h),1),r){case t:a=(i-n)/d+(i<n?6:0)
break
case i:a=(n-t)/d+2
break
case n:a=(t-i)/d+4}a*=60,a=Math.round(a)}return new Md(a,l,h,s)}static _hue2rgb(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}static toRGBA(e){const t=e.h/360,{s:i,l:n,a:s}=e
let r,o,a
if(0===i)r=o=a=n
else{const e=n<.5?n*(1+i):n+i-n*i,s=2*n-e
r=Md._hue2rgb(s,e,t+1/3),o=Md._hue2rgb(s,e,t),a=Md._hue2rgb(s,e,t-1/3)}return new Id(Math.round(255*r),Math.round(255*o),Math.round(255*a),s)}}class Dd{constructor(e,t,i,n){this.h=0|Math.max(Math.min(360,e),0),this.s=kd(Math.max(Math.min(1,t),0),3),this.v=kd(Math.max(Math.min(1,i),0),3),this.a=kd(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,n=e.b/255,s=Math.max(t,i,n),r=s-Math.min(t,i,n)
let o
return new Dd(60*(o=0===r?0:s===t?((i-n)/r%6+6)%6:s===i?(n-t)/r+2:(t-i)/r+4),0===s?0:r/s,s,e.a)}static toRGBA(e){const{h:t,s:i,v:n,a:s}=e,r=n*i,o=r*(1-Math.abs(t/60%2-1)),a=n-r
let[l,h,d]=[0,0,0]
return t<60?(l=r,h=o):t<120?(l=o,h=r):t<180?(h=r,d=o):t<240?(h=o,d=r):t<300?(l=o,d=r):t<360&&(l=r,d=o),l=Math.round(255*(l+a)),h=Math.round(255*(h+a)),d=Math.round(255*(d+a)),new Id(l,h,d,s)}}class Td{constructor(e){if(!e)throw new Error("Color needs a value")
if(e instanceof Id)this.rgba=e
else if(e instanceof Md)this._hsla=e,this.rgba=Md.toRGBA(e)
else{if(!(e instanceof Dd))throw new Error("Invalid color ctor argument")
this._hsva=e,this.rgba=Dd.toRGBA(e)}}static fromHex(e){return Td.Format.CSS.parseHex(e)||Td.red}get hsla(){return this._hsla?this._hsla:Md.fromRGBA(this.rgba)}get hsva(){return this._hsva?this._hsva:Dd.fromRGBA(this.rgba)}equals(e){return!!e&&Id.equals(this.rgba,e.rgba)&&Md.equals(this.hsla,e.hsla)&&Dd.equals(this.hsva,e.hsva)}getRelativeLuminance(){return kd(.2126*Td._relativeLuminanceForComponent(this.rgba.r)+.7152*Td._relativeLuminanceForComponent(this.rgba.g)+.0722*Td._relativeLuminanceForComponent(this.rgba.b),4)}static _relativeLuminanceForComponent(e){const t=e/255
return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}getContrastRatio(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance()
return t>i?(t+.05)/(i+.05):(i+.05)/(t+.05)}isDarker(){return(299*this.rgba.r+587*this.rgba.g+114*this.rgba.b)/1e3<128}isLighter(){return(299*this.rgba.r+587*this.rgba.g+114*this.rgba.b)/1e3>=128}isLighterThan(e){return this.getRelativeLuminance()>e.getRelativeLuminance()}isDarkerThan(e){return this.getRelativeLuminance()<e.getRelativeLuminance()}lighten(e){return new Td(new Md(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new Td(new Md(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){const{r:t,g:i,b:n,a:s}=this.rgba
return new Td(new Id(t,i,n,s*e))}isTransparent(){return 0===this.rgba.a}isOpaque(){return 1===this.rgba.a}opposite(){return new Td(new Id(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}blend(e){const t=e.rgba,i=this.rgba.a,n=t.a
let s=i+n*(1-i)
if(s<1e-6)return Td.transparent
const r=this.rgba.r*i/s+t.r*n*(1-i)/s,o=this.rgba.g*i/s+t.g*n*(1-i)/s,a=this.rgba.b*i/s+t.b*n*(1-i)/s
return new Td(new Id(r,o,a,s))}toString(){return Td.Format.CSS.format(this)}static getLighterColor(e,t,i){if(e.isLighterThan(t))return e
i=i||.5
const n=e.getRelativeLuminance(),s=t.getRelativeLuminance()
return i=i*(s-n)/s,e.lighten(i)}static getDarkerColor(e,t,i){if(e.isDarkerThan(t))return e
i=i||.5
const n=e.getRelativeLuminance()
return i=i*(n-t.getRelativeLuminance())/n,e.darken(i)}}Td.white=new Td(new Id(255,255,255,1)),Td.black=new Td(new Id(0,0,0,1)),Td.red=new Td(new Id(255,0,0,1)),Td.blue=new Td(new Id(0,0,255,1)),Td.green=new Td(new Id(0,255,0,1)),Td.cyan=new Td(new Id(0,255,255,1)),Td.lightgrey=new Td(new Id(211,211,211,1)),Td.transparent=new Td(new Id(0,0,0,0)),function(e){let t
!function(t){let i
!function(t){function i(e){const t=e.toString(16)
return 2!==t.length?"0"+t:t}function n(e){switch(e){case 48:return 0
case 49:return 1
case 50:return 2
case 51:return 3
case 52:return 4
case 53:return 5
case 54:return 6
case 55:return 7
case 56:return 8
case 57:return 9
case 97:case 65:return 10
case 98:case 66:return 11
case 99:case 67:return 12
case 100:case 68:return 13
case 101:case 69:return 14
case 102:case 70:return 15}return 0}t.formatRGB=function(t){return 1===t.rgba.a?`rgb(${t.rgba.r}, ${t.rgba.g}, ${t.rgba.b})`:e.Format.CSS.formatRGBA(t)},t.formatRGBA=function(e){return`rgba(${e.rgba.r}, ${e.rgba.g}, ${e.rgba.b}, ${+e.rgba.a.toFixed(2)})`},t.formatHSL=function(t){return 1===t.hsla.a?`hsl(${t.hsla.h}, ${(100*t.hsla.s).toFixed(2)}%, ${(100*t.hsla.l).toFixed(2)}%)`:e.Format.CSS.formatHSLA(t)},t.formatHSLA=function(e){return`hsla(${e.hsla.h}, ${(100*e.hsla.s).toFixed(2)}%, ${(100*e.hsla.l).toFixed(2)}%, ${e.hsla.a.toFixed(2)})`},t.formatHex=function(e){return`#${i(e.rgba.r)}${i(e.rgba.g)}${i(e.rgba.b)}`},t.formatHexA=function(t,n=!1){return n&&1===t.rgba.a?e.Format.CSS.formatHex(t):`#${i(t.rgba.r)}${i(t.rgba.g)}${i(t.rgba.b)}${i(Math.round(255*t.rgba.a))}`},t.format=function(t){return t?t.isOpaque()?e.Format.CSS.formatHex(t):e.Format.CSS.formatRGBA(t):null},t.parseHex=function(t){if(!t)return null
const i=t.length
if(0===i)return null
if(35!==t.charCodeAt(0))return null
if(7===i){const i=16*n(t.charCodeAt(1))+n(t.charCodeAt(2)),s=16*n(t.charCodeAt(3))+n(t.charCodeAt(4)),r=16*n(t.charCodeAt(5))+n(t.charCodeAt(6))
return new e(new Id(i,s,r,1))}if(9===i){const i=16*n(t.charCodeAt(1))+n(t.charCodeAt(2)),s=16*n(t.charCodeAt(3))+n(t.charCodeAt(4)),r=16*n(t.charCodeAt(5))+n(t.charCodeAt(6)),o=16*n(t.charCodeAt(7))+n(t.charCodeAt(8))
return new e(new Id(i,s,r,o/255))}if(4===i){const i=n(t.charCodeAt(1)),s=n(t.charCodeAt(2)),r=n(t.charCodeAt(3))
return new e(new Id(16*i+i,16*s+s,16*r+r))}if(5===i){const i=n(t.charCodeAt(1)),s=n(t.charCodeAt(2)),r=n(t.charCodeAt(3)),o=n(t.charCodeAt(4))
return new e(new Id(16*i+i,16*s+s,16*r+r,(16*o+o)/255))}return null}}(i=t.CSS||(t.CSS={}))}(t=e.Format||(e.Format={}))}(Td||(Td={}))
class Od{constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}}class Rd{constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){let i=this._lines.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),n=this._lines.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn)
return new t(i.lineNumber,i.column,n.lineNumber,n.column)}convertViewSelectionToModelSelection(e){let t=this._lines.convertViewPositionToModelPosition(e.selectionStartLineNumber,e.selectionStartColumn),i=this._lines.convertViewPositionToModelPosition(e.positionLineNumber,e.positionColumn)
return new At(t.lineNumber,t.column,i.lineNumber,i.column)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,i){var n=this._lines.validateViewPosition(e.startLineNumber,e.startColumn,i.getStartPosition()),s=this._lines.validateViewPosition(e.endLineNumber,e.endColumn,i.getEndPosition())
return new t(n.lineNumber,n.column,s.lineNumber,s.column)}convertModelPositionToViewPosition(e){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column)}convertModelRangeToViewRange(e){let i=this._lines.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn),n=this._lines.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn)
return new t(i.lineNumber,i.column,n.lineNumber,n.column)}convertModelSelectionToViewSelection(e){let t=this._lines.convertModelPositionToViewPosition(e.selectionStartLineNumber,e.selectionStartColumn),i=this._lines.convertModelPositionToViewPosition(e.positionLineNumber,e.positionColumn)
return new At(t.lineNumber,t.column,i.lineNumber,i.column)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}}class Ad{constructor(e,t,i,n,s,r){this.model=e,this._validModelVersionId=-1,this.tabSize=i,this.wrappingColumn=n,this.columnsForFullWidthChar=s,this.wrappingIndent=r,this.linePositionMapperFactory=t,this._constructLines(!0)}dispose(){this.hiddenAreasIds=this.model.deltaDecorations(this.hiddenAreasIds,[])}createCoordinatesConverter(){return new Rd(this)}_ensureValidState(){if(this.model.getVersionId()!==this._validModelVersionId)throw new Error("SplitLinesCollection: attempt to access a 'newer' model")}_constructLines(e){this.lines=[],e&&(this.hiddenAreasIds=[])
let i=this.model.getLinesContent(),n=i.length,s=new Uint32Array(n),r=this.hiddenAreasIds.map(e=>this.model.getDecorationRange(e)).sort(t.compareRangesUsingStarts),o=1,a=0,l=-1,h=l+1<r.length?a+1:n+2
for(let e=0;e<n;e++){let t=e+1
t===h&&(o=r[++l].startLineNumber,a=r[l].endLineNumber,h=l+1<r.length?a+1:n+2)
let d=t>=o&&t<=a,u=Vd(this.linePositionMapperFactory,i[e],this.tabSize,this.wrappingColumn,this.columnsForFullWidthChar,this.wrappingIndent,!d)
s[e]=u.getViewLineCount(),this.lines[e]=u}this._validModelVersionId=this.model.getVersionId(),this.prefixSumComputer=new Ji(s)}getHiddenAreas(){return this.hiddenAreasIds.map(e=>this.model.getDecorationRange(e)).sort(t.compareRangesUsingStarts)}_reduceRanges(e){if(0===e.length)return[]
let i=e.map(e=>this.model.validateRange(e)).sort(t.compareRangesUsingStarts),n=[],s=i[0].startLineNumber,r=i[0].endLineNumber
for(let e=1,o=i.length;e<o;e++){let o=i[e]
o.startLineNumber>r+1?(n.push(new t(s,1,r,1)),s=o.startLineNumber,r=o.endLineNumber):o.endLineNumber>r&&(r=o.endLineNumber)}return n.push(new t(s,1,r,1)),n}setHiddenAreas(e){let i=this._reduceRanges(e),n=this.hiddenAreasIds.map(e=>this.model.getDecorationRange(e)).sort(t.compareRangesUsingStarts)
if(i.length===n.length){let e=!1
for(let t=0;t<i.length;t++)if(!i[t].equalsRange(n[t])){e=!0
break}if(!e)return!1}let s=[]
for(let e=0;e<i.length;e++)s.push({range:i[e],options:Ld.EMPTY})
this.hiddenAreasIds=this.model.deltaDecorations(this.hiddenAreasIds,s)
let r=i,o=1,a=0,l=-1,h=l+1<r.length?a+1:this.lines.length+2
for(let e=0;e<this.lines.length;e++){let t=e+1
t===h&&(o=r[++l].startLineNumber,a=r[l].endLineNumber,h=l+1<r.length?a+1:this.lines.length+2)
let i=!1
if(t>=o&&t<=a?this.lines[e].isVisible()&&(this.lines[e]=this.lines[e].setVisible(!1),i=!0):this.lines[e].isVisible()||(this.lines[e]=this.lines[e].setVisible(!0),i=!0),i){let t=this.lines[e].getViewLineCount()
this.prefixSumComputer.changeValue(e,t)}}return!0}modelPositionIsVisible(e,t){return!(e<1||e>this.lines.length)&&this.lines[e-1].isVisible()}setTabSize(e){return this.tabSize!==e&&(this.tabSize=e,this._constructLines(!1),!0)}setWrappingSettings(e,t,i){return(this.wrappingIndent!==e||this.wrappingColumn!==t||this.columnsForFullWidthChar!==i)&&(this.wrappingIndent=e,this.wrappingColumn=t,this.columnsForFullWidthChar=i,this._constructLines(!1),!0)}onModelFlushed(){this._constructLines(!0)}onModelLinesDeleted(e,t,i){if(e<=this._validModelVersionId)return null
let n=1===t?1:this.prefixSumComputer.getAccumulatedValue(t-2)+1,s=this.prefixSumComputer.getAccumulatedValue(i-1)
return this.lines.splice(t-1,i-t+1),this.prefixSumComputer.removeValues(t-1,i-t+1),new Jl(n,s)}onModelLinesInserted(t,i,n,s){if(t<=this._validModelVersionId)return null
let r=this.getHiddenAreas(),o=!1,a=new e(i,1)
for(let e=0;e<r.length;e++)if(r[e].containsPosition(a)){o=!0
break}let l=1===i?1:this.prefixSumComputer.getAccumulatedValue(i-2)+1,h=0,d=[],u=new Uint32Array(s.length)
for(let e=0,t=s.length;e<t;e++){let t=Vd(this.linePositionMapperFactory,s[e],this.tabSize,this.wrappingColumn,this.columnsForFullWidthChar,this.wrappingIndent,!o)
d.push(t)
let i=t.getViewLineCount()
h+=i,u[e]=i}return this.lines=this.lines.slice(0,i-1).concat(d).concat(this.lines.slice(i-1)),this.prefixSumComputer.insertValues(i-1,u),new Ql(l,l+h-1)}onModelLineChanged(e,t,i){if(e<=this._validModelVersionId)return[!1,null,null,null]
let n=t-1,s=this.lines[n].getViewLineCount(),r=this.lines[n].isVisible(),o=Vd(this.linePositionMapperFactory,i,this.tabSize,this.wrappingColumn,this.columnsForFullWidthChar,this.wrappingIndent,r)
this.lines[n]=o
let a=this.lines[n].getViewLineCount(),l=!1,h=0,d=-1,u=0,c=-1,g=0,m=-1
return s>a?(m=(g=(d=(h=1===t?1:this.prefixSumComputer.getAccumulatedValue(t-2)+1)+a-1)+1)+(s-a)-1,l=!0):s<a?(c=(u=(d=(h=1===t?1:this.prefixSumComputer.getAccumulatedValue(t-2)+1)+s-1)+1)+(a-s)-1,l=!0):d=(h=1===t?1:this.prefixSumComputer.getAccumulatedValue(t-2)+1)+a-1,this.prefixSumComputer.changeValue(n,a),[l,h<=d?new Xl(h,d):null,u<=c?new Ql(u,c):null,g<=m?new Jl(g,m):null]}acceptVersionId(e){this._validModelVersionId=e}getViewLineCount(){return this._ensureValidState(),this.prefixSumComputer.getTotalValue()}_toValidViewLineNumber(e){if(e<1)return 1
let t=this.getViewLineCount()
return e>t?t:e}warmUpLookupCache(e,t){this.prefixSumComputer.warmUpCache(e-1,t-1)}getViewLinesIndentGuides(t,i){this._ensureValidState(),t=this._toValidViewLineNumber(t),i=this._toValidViewLineNumber(i)
const n=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),s=this.convertViewPositionToModelPosition(i,this.getViewLineMaxColumn(i))
let r=[],o=[]
const a=n.lineNumber-1,l=s.lineNumber-1
let h=null
for(let t=a;t<=l;t++){const i=this.lines[t]
if(i.isVisible()){let s=0
if(t===a){let e=i.getViewLineNumberOfModelPosition(0,n.column)
s=i.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(t+1))-e+1}else{let e=i.getViewLineNumberOfModelPosition(0,1)
s=i.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(t+1))-e+1}o.push(s),null===h&&(h=new e(t+1,0))}else null!==h&&(r=r.concat(this.model.getLinesIndentGuides(h.lineNumber,t)),h=null)}null!==h&&(r=r.concat(this.model.getLinesIndentGuides(h.lineNumber,s.lineNumber)),h=null)
const d=i-t+1
let u=new Array(d),c=0
for(let e=0,t=r.length;e<t;e++){let t=r[e],i=Math.min(d-c,o[e])
for(let e=0;e<i;e++)u[c++]=t}return u}getViewLineContent(e){this._ensureValidState(),e=this._toValidViewLineNumber(e)
let t=this.prefixSumComputer.getIndexOf(e-1),i=t.index,n=t.remainder
return this.lines[i].getViewLineContent(this.model,i+1,n)}getViewLineMinColumn(e){this._ensureValidState(),e=this._toValidViewLineNumber(e)
let t=this.prefixSumComputer.getIndexOf(e-1),i=t.index,n=t.remainder
return this.lines[i].getViewLineMinColumn(this.model,i+1,n)}getViewLineMaxColumn(e){this._ensureValidState(),e=this._toValidViewLineNumber(e)
let t=this.prefixSumComputer.getIndexOf(e-1),i=t.index,n=t.remainder
return this.lines[i].getViewLineMaxColumn(this.model,i+1,n)}getViewLineData(e){this._ensureValidState(),e=this._toValidViewLineNumber(e)
let t=this.prefixSumComputer.getIndexOf(e-1),i=t.index,n=t.remainder
return this.lines[i].getViewLineData(this.model,i+1,n)}getViewLinesData(e,t,i){this._ensureValidState(),e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t)
let n=this.prefixSumComputer.getIndexOf(e-1),s=e,r=n.index,o=n.remainder,a=[]
for(let n=r,l=this.model.getLineCount();n<l;n++){let l=this.lines[n]
if(!l.isVisible())continue
let h=n===r?o:0,d=l.getViewLineCount()-h,u=!1
s+d>t&&(u=!0,d=t-s+1)
let c=h+d
if(l.getViewLinesData(this.model,n+1,h,c,s-e,i,a),s+=d,u)break}return a}validateViewPosition(t,i,n){this._ensureValidState(),t=this._toValidViewLineNumber(t)
let s=this.prefixSumComputer.getIndexOf(t-1),r=s.index,o=s.remainder,a=this.lines[r],l=a.getViewLineMinColumn(this.model,r+1,o),h=a.getViewLineMaxColumn(this.model,r+1,o)
i<l&&(i=l),i>h&&(i=h)
let d=a.getModelColumnOfViewPosition(o,i)
return this.model.validatePosition(new e(r+1,d)).equals(n)?new e(t,i):this.convertModelPositionToViewPosition(n.lineNumber,n.column)}convertViewPositionToModelPosition(t,i){this._ensureValidState(),t=this._toValidViewLineNumber(t)
let n=this.prefixSumComputer.getIndexOf(t-1),s=n.index,r=n.remainder,o=this.lines[s].getModelColumnOfViewPosition(r,i)
return this.model.validatePosition(new e(s+1,o))}convertModelPositionToViewPosition(t,i){this._ensureValidState()
let n=this.model.validatePosition(new e(t,i)),s=n.lineNumber,r=n.column,o=s-1,a=!1
for(;o>0&&!this.lines[o].isVisible();)o--,a=!0
if(0===o&&!this.lines[o].isVisible())return new e(1,1)
let l,h=1+(0===o?0:this.prefixSumComputer.getAccumulatedValue(o-1))
return l=a?this.lines[o].getViewPositionOfModelPosition(h,this.model.getLineMaxColumn(o+1)):this.lines[s-1].getViewPositionOfModelPosition(h,r)}_getViewLineNumberForModelPosition(e,t){let i=e-1
if(this.lines[i].isVisible()){const e=1+(0===i?0:this.prefixSumComputer.getAccumulatedValue(i-1))
return this.lines[i].getViewLineNumberOfModelPosition(e,t)}for(;i>0&&!this.lines[i].isVisible();)i--
if(0===i&&!this.lines[i].isVisible())return 1
const n=1+(0===i?0:this.prefixSumComputer.getAccumulatedValue(i-1))
return this.lines[i].getViewLineNumberOfModelPosition(n,this.model.getLineMaxColumn(i+1))}getAllOverviewRulerDecorations(e,t,i){const n=this.model.getOverviewRulerDecorations(e,t),s=new zd
for(let e=0,t=n.length;e<t;e++){const t=n[e],r=t.options.overviewRuler,o=r.position
if(0===o)continue
const a=Ud(r,i),l=this._getViewLineNumberForModelPosition(t.range.startLineNumber,t.range.startColumn),h=this._getViewLineNumberForModelPosition(t.range.endLineNumber,t.range.endColumn)
s.accept(a,l,h,o)}return s.result}getDecorationsInRange(i,n,s){const r=this.convertViewPositionToModelPosition(i.startLineNumber,i.startColumn),o=this.convertViewPositionToModelPosition(i.endLineNumber,i.endColumn)
if(o.lineNumber-r.lineNumber<=i.endLineNumber-i.startLineNumber)return this.model.getDecorationsInRange(new t(r.lineNumber,r.column,o.lineNumber,o.column),n,s)
let a=[]
const l=r.lineNumber-1,h=o.lineNumber-1
let d=null
for(let i=l;i<=h;i++){if(this.lines[i].isVisible())null===d&&(d=new e(i+1,i===l?r.column:1))
else if(null!==d){const e=this.model.getLineMaxColumn(i)
a=a.concat(this.model.getDecorationsInRange(new t(d.lineNumber,d.column,i,e),n,s)),d=null}}return null!==d&&(a=a.concat(this.model.getDecorationsInRange(new t(d.lineNumber,d.column,o.lineNumber,o.column),n,s)),d=null),a}}class Pd{constructor(){}isVisible(){return!0}setVisible(e){return e?this:Fd.INSTANCE}getViewLineCount(){return 1}getViewLineContent(e,t,i){return e.getLineContent(t)}getViewLineMinColumn(e,t,i){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,i){return e.getLineMaxColumn(t)}getViewLineData(e,t,i){let n=e.getLineTokens(t),s=n.getLineContent()
return new xh(s,1,s.length+1,n.inflate())}getViewLinesData(e,t,i,n,s,r,o){r[s]?o[s]=this.getViewLineData(e,t,0):o[s]=null}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(t,i){return new e(t,i)}getViewLineNumberOfModelPosition(e,t){return e}}Pd.INSTANCE=new Pd
class Fd{constructor(){}isVisible(){return!1}setVisible(e){return e?Pd.INSTANCE:this}getViewLineCount(){return 0}getViewLineContent(e,t,i){throw new Error("Not supported")}getViewLineMinColumn(e,t,i){throw new Error("Not supported")}getViewLineMaxColumn(e,t,i){throw new Error("Not supported")}getViewLineData(e,t,i){throw new Error("Not supported")}getViewLinesData(e,t,i,n,s,r,o){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}}Fd.INSTANCE=new Fd
class Wd{constructor(e,t){this.positionMapper=e,this.wrappedIndent=this.positionMapper.getWrappedLinesIndent(),this.wrappedIndentLength=this.wrappedIndent.length,this.outputLineCount=this.positionMapper.getOutputLineCount(),this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getViewLineCount(){return this._isVisible?this.outputLineCount:0}getInputStartOffsetOfOutputLineIndex(e){return this.positionMapper.getInputOffsetOfOutputPosition(e,0)}getInputEndOffsetOfOutputLineIndex(e,t,i){return i+1===this.outputLineCount?e.getLineMaxColumn(t)-1:this.positionMapper.getInputOffsetOfOutputPosition(i+1,0)}getViewLineContent(e,t,i){if(!this._isVisible)throw new Error("Not supported")
let n=this.getInputStartOffsetOfOutputLineIndex(i),s=this.getInputEndOffsetOfOutputLineIndex(e,t,i),r=e.getLineContent(t).substring(n,s)
return i>0&&(r=this.wrappedIndent+r),r}getViewLineMinColumn(e,t,i){if(!this._isVisible)throw new Error("Not supported")
return i>0?this.wrappedIndentLength+1:1}getViewLineMaxColumn(e,t,i){if(!this._isVisible)throw new Error("Not supported")
return this.getViewLineContent(e,t,i).length+1}getViewLineData(e,t,i){if(!this._isVisible)throw new Error("Not supported")
let n=this.getInputStartOffsetOfOutputLineIndex(i),s=this.getInputEndOffsetOfOutputLineIndex(e,t,i),r=e.getLineContent(t).substring(n,s)
i>0&&(r=this.wrappedIndent+r)
let o=i>0?this.wrappedIndentLength+1:1,a=r.length+1,l=0
i>0&&(l=this.wrappedIndentLength)
let h=e.getLineTokens(t)
return new xh(r,o,a,h.sliceAndInflate(n,s,l))}getViewLinesData(e,t,i,n,s,r,o){if(!this._isVisible)throw new Error("Not supported")
for(let a=i;a<n;a++){let n=s+a-i
r[n]?o[n]=this.getViewLineData(e,t,a):o[n]=null}}getModelColumnOfViewPosition(e,t){if(!this._isVisible)throw new Error("Not supported")
let i=t-1
return e>0&&(i<this.wrappedIndentLength?i=0:i-=this.wrappedIndentLength),this.positionMapper.getInputOffsetOfOutputPosition(e,i)+1}getViewPositionOfModelPosition(t,i){if(!this._isVisible)throw new Error("Not supported")
let n=this.positionMapper.getOutputPositionOfInputOffset(i-1),s=n.outputLineIndex,r=n.outputOffset+1
return s>0&&(r+=this.wrappedIndentLength),new e(t+s,r)}getViewLineNumberOfModelPosition(e,t){if(!this._isVisible)throw new Error("Not supported")
return e+this.positionMapper.getOutputPositionOfInputOffset(t-1).outputLineIndex}}function Vd(e,t,i,n,s,r,o){let a=e.createLineMapping(t,i,n,s,r)
return null===a?o?Pd.INSTANCE:Fd.INSTANCE:new Wd(a,o)}class Bd{constructor(e){this._lines=e}_validPosition(e){return this._lines.model.validatePosition(e)}_validRange(e){return this._lines.model.validateRange(e)}_validSelection(t){let i=this._validPosition(new e(t.selectionStartLineNumber,t.selectionStartColumn)),n=this._validPosition(new e(t.positionLineNumber,t.positionColumn))
return new At(i.lineNumber,i.column,n.lineNumber,n.column)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}convertViewSelectionToModelSelection(e){return this._validSelection(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}convertModelSelectionToViewSelection(e){return this._validSelection(e)}modelPositionIsVisible(e){const t=this._lines.model.getLineCount()
return!(e.lineNumber<1||e.lineNumber>t)}}class Hd{constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new Bd(this)}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,i){return!1}onModelFlushed(){}onModelLinesDeleted(e,t,i){return new Jl(t,i)}onModelLinesInserted(e,t,i,n){return new Ql(t,i)}onModelLineChanged(e,t,i){return[!1,new Xl(t,t),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}warmUpLookupCache(e,t){}getViewLinesIndentGuides(e,t){const i=t-e+1
let n=new Array(i)
for(let e=0;e<i;e++)n[e]=0
return n}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){let t=this.model.getLineTokens(e),i=t.getLineContent()
return new xh(i,1,i.length+1,t.inflate())}getViewLinesData(e,t,i){const n=this.model.getLineCount()
e=Math.min(Math.max(1,e),n),t=Math.min(Math.max(1,t),n)
let s=[]
for(let n=e;n<=t;n++){let t=n-e
i[t]||(s[t]=null),s[t]=this.getViewLineData(n)}return s}getAllOverviewRulerDecorations(e,t,i){const n=this.model.getOverviewRulerDecorations(e,t),s=new zd
for(let e=0,t=n.length;e<t;e++){const t=n[e],r=t.options.overviewRuler,o=r.position
if(0===o)continue
const a=Ud(r,i),l=t.range.startLineNumber,h=t.range.endLineNumber
s.accept(a,l,h,o)}return s.result}getDecorationsInRange(e,t,i){return this.model.getDecorationsInRange(e,t,i)}}class zd{constructor(){this.result=Object.create(null)}accept(e,t,i,n){let s=this.result[e]
if(s){const e=s[s.length-3],r=s[s.length-1]
if(e===n&&r+1>=t)return void(i>r&&(s[s.length-1]=i))
s.push(n,t,i)}else this.result[e]=[n,t,i]}}function Ud(e,t){if(!e._resolvedColor){const i=t.type,n="dark"===i?e.darkColor:"light"===i?e.color:e.hcColor
e._resolvedColor=function(e,t){if("string"==typeof e)return e
let i=e?t.getColor(e.id):null
i||(i=Td.transparent)
return i.toString()}(n,t)}return e._resolvedColor}class Kd{constructor(e,t,i,n){this.r=Kd._clampInt_0_255(e),this.g=Kd._clampInt_0_255(t),this.b=Kd._clampInt_0_255(i),this.a=Kd._clampInt_0_255(n)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}static _clampInt_0_255(e){return e<0?0:e>255?255:0|e}}class $d{constructor(){this._onDidChange=new ci,this.onDidChange=this._onDidChange.event,this._updateColorMap(),js.onDidChange(e=>{e.changedColorMap&&this._updateColorMap()})}static getInstance(){return this._INSTANCE||(this._INSTANCE=new $d),this._INSTANCE}_updateColorMap(){const e=js.getColorMap()
if(!e)return this._colors=[null],void(this._backgroundIsLight=!0)
this._colors=[null]
for(let t=1;t<e.length;t++){const i=e[t].rgba
this._colors[t]=new Kd(i.r,i.g,i.b,Math.round(255*i.a))}let t=e[2].getRelativeLuminance()
this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}}$d._INSTANCE=null
class qd{constructor(e,t){if(760!==e.length)throw new Error("Invalid x2CharData")
if(190!==t.length)throw new Error("Invalid x1CharData")
this.x2charData=e,this.x1charData=t,this.x2charDataLight=qd.soften(e,.8),this.x1charDataLight=qd.soften(t,50/60)}static soften(e,t){let i=new Uint8ClampedArray(e.length)
for(let n=0,s=e.length;n<s;n++)i[n]=e[n]*t
return i}static _getChIndex(e){return(e-=32)<0&&(e+=95),e%95}x2RenderChar(e,t,i,n,s,r,o){if(t+2>e.width||i+4>e.height)return void console.warn("bad render request outside image data")
const a=o?this.x2charDataLight:this.x2charData,l=qd._getChIndex(n),h=4*e.width,d=r.r,u=r.g,c=r.b,g=s.r-d,m=s.g-u,p=s.b-c,f=e.data,_=4*l*2
let C=i*h+4*t
{const e=a[_]/255
f[C+0]=d+g*e,f[C+1]=u+m*e,f[C+2]=c+p*e}{const e=a[_+1]/255
f[C+4]=d+g*e,f[C+5]=u+m*e,f[C+6]=c+p*e}C+=h
{const e=a[_+2]/255
f[C+0]=d+g*e,f[C+1]=u+m*e,f[C+2]=c+p*e}{const e=a[_+3]/255
f[C+4]=d+g*e,f[C+5]=u+m*e,f[C+6]=c+p*e}C+=h
{const e=a[_+4]/255
f[C+0]=d+g*e,f[C+1]=u+m*e,f[C+2]=c+p*e}{const e=a[_+5]/255
f[C+4]=d+g*e,f[C+5]=u+m*e,f[C+6]=c+p*e}C+=h
{const e=a[_+6]/255
f[C+0]=d+g*e,f[C+1]=u+m*e,f[C+2]=c+p*e}{const e=a[_+7]/255
f[C+4]=d+g*e,f[C+5]=u+m*e,f[C+6]=c+p*e}}x1RenderChar(e,t,i,n,s,r,o){if(t+1>e.width||i+2>e.height)return void console.warn("bad render request outside image data")
const a=o?this.x1charDataLight:this.x1charData,l=qd._getChIndex(n),h=4*e.width,d=r.r,u=r.g,c=r.b,g=s.r-d,m=s.g-u,p=s.b-c,f=e.data,_=2*l*1
let C=i*h+4*t
{const e=a[_]/255
f[C+0]=d+g*e,f[C+1]=u+m*e,f[C+2]=c+p*e}C+=h
{const e=a[_+1]/255
f[C+0]=d+g*e,f[C+1]=u+m*e,f[C+2]=c+p*e}}x2BlockRenderChar(e,t,i,n,s,r){if(t+2>e.width||i+4>e.height)return void console.warn("bad render request outside image data")
const o=4*e.width,a=s.r,l=s.g,h=s.b,d=a+.5*(n.r-a),u=l+.5*(n.g-l),c=h+.5*(n.b-h),g=e.data
let m=i*o+4*t
g[m+0]=d,g[m+1]=u,g[m+2]=c,g[m+4]=d,g[m+5]=u,g[m+6]=c,g[(m+=o)+0]=d,g[m+1]=u,g[m+2]=c,g[m+4]=d,g[m+5]=u,g[m+6]=c,g[(m+=o)+0]=d,g[m+1]=u,g[m+2]=c,g[m+4]=d,g[m+5]=u,g[m+6]=c,g[(m+=o)+0]=d,g[m+1]=u,g[m+2]=c,g[m+4]=d,g[m+5]=u,g[m+6]=c}x1BlockRenderChar(e,t,i,n,s,r){if(t+1>e.width||i+2>e.height)return void console.warn("bad render request outside image data")
const o=4*e.width,a=s.r,l=s.g,h=s.b,d=a+.5*(n.r-a),u=l+.5*(n.g-l),c=h+.5*(n.b-h),g=e.data
let m=i*o+4*t
g[m+0]=d,g[m+1]=u,g[m+2]=c,g[(m+=o)+0]=d,g[m+1]=u,g[m+2]=c}}class Gd extends Qi{constructor(e,t,i){super(0)
for(let t=0;t<e.length;t++)this.set(e.charCodeAt(t),1)
for(let e=0;e<t.length;e++)this.set(t.charCodeAt(e),2)
for(let e=0;e<i.length;e++)this.set(i.charCodeAt(e),3)}get(e){return e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?4:super.get(e)}}class jd{constructor(e,t,i){this.classifier=new Gd(e,t,i)}static nextVisibleColumn(e,t,i,n){return e=+e,t=+t,n=+n,i?e+(t-e%t):e+n}createLineMapping(e,t,i,n,s){if(-1===i)return null
t=+t,i=+i,n=+n
let r=0,o="",a=-1
if((s=+s)!==Ii.None&&-1!==(a=Le(e))){o=e.substring(0,a)
for(let i=0;i<a;i++)r=jd.nextVisibleColumn(r,t,9===e.charCodeAt(i),1)
s===Ii.Indent&&(o+="\t",r=jd.nextVisibleColumn(r,t,!0,1)),r+n>i&&(o="",r=0)}let l=this.classifier,h=0,d=[],u=0,c=0,g=-1,m=0,p=-1,f=0,_=e.length
for(let o=0;o<_;o++){let C=e.charCodeAt(o),b=9===C,w=l.get(C)
if(1===w&&(g=o,m=r),4===w&&o>0){let t=e.charCodeAt(o-1)
1!==l.get(t)&&(g=o,m=r)}let v,S,y=1
if(je(C)&&(y=n),(c=jd.nextVisibleColumn(c,t,b,y))>i&&0!==o)-1!==g&&m<=i?(v=g,S=m):-1!==p&&f<=i?(v=p,S=f):(v=o,S=r),d[u++]=v-h,h=v,c=jd.nextVisibleColumn(S,t,b,y),g=-1,m=0,p=-1,f=0
if(-1!==g&&(m=jd.nextVisibleColumn(m,t,b,y)),-1!==p&&(f=jd.nextVisibleColumn(f,t,b,y)),2===w&&(s===Ii.None||o>=a)&&(g=o+1,m=r),4===w&&o<_-1){let t=e.charCodeAt(o+1)
2!==l.get(t)&&(g=o+1,m=r)}3===w&&(p=o+1,f=r)}return 0===u?null:(d[u++]=_-h,new Yd(new Xi(function(e){let t=e.length,i=new Uint32Array(t)
for(let n=0;n<t;n++)i[n]=Yi(e[n])
return i}(d)),o))}}class Yd{constructor(e,t){this._prefixSums=e,this._wrappedLinesIndent=t}getOutputLineCount(){return this._prefixSums.getCount()}getWrappedLinesIndent(){return this._wrappedLinesIndent}getInputOffsetOfOutputPosition(e,t){return 0===e?t:this._prefixSums.getAccumulatedValue(e-1)+t}getOutputPositionOfInputOffset(e){let t=this._prefixSums.getIndexOf(e)
return new Od(t.index,t.remainder)}}class Zd{constructor(){this._heights=[],this._ids=[],this._afterLineNumbers=[],this._ordinals=[],this._prefixSum=[],this._prefixSumValidIndex=-1,this._whitespaceId2Index={},this._lastWhitespaceId=0}static findInsertionIndex(e,t,i,n){let s=0,r=e.length
for(;s<r;){let o=s+r>>>1
t===e[o]?n<i[o]?r=o:s=o+1:t<e[o]?r=o:s=o+1}return s}insertWhitespace(e,t,i){e|=0,t|=0,i|=0
let n=++this._lastWhitespaceId,s=Zd.findInsertionIndex(this._afterLineNumbers,e,this._ordinals,t)
return this._insertWhitespaceAtIndex(n,s,e,t,i),n}_insertWhitespaceAtIndex(e,t,i,n,s){e|=0,t|=0,i|=0,n|=0,s|=0,this._heights.splice(t,0,s),this._ids.splice(t,0,e),this._afterLineNumbers.splice(t,0,i),this._ordinals.splice(t,0,n),this._prefixSum.splice(t,0,0)
let r=Object.keys(this._whitespaceId2Index)
for(let e=0,i=r.length;e<i;e++){let i=r[e],n=this._whitespaceId2Index[i]
n>=t&&(this._whitespaceId2Index[i]=n+1)}this._whitespaceId2Index[e.toString()]=t,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}changeWhitespace(e,t,i){e|=0,t|=0,i|=0
let n=!1
return n=this.changeWhitespaceHeight(e,i)||n,n=this.changeWhitespaceAfterLineNumber(e,t)||n}changeWhitespaceHeight(e,t){t|=0
let i=(e|=0).toString()
if(this._whitespaceId2Index.hasOwnProperty(i)){let e=this._whitespaceId2Index[i]
if(this._heights[e]!==t)return this._heights[e]=t,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1),!0}return!1}changeWhitespaceAfterLineNumber(e,t){t|=0
let i=(e|=0).toString()
if(this._whitespaceId2Index.hasOwnProperty(i)){let n=this._whitespaceId2Index[i]
if(this._afterLineNumbers[n]!==t){let i=this._ordinals[n],s=this._heights[n]
this.removeWhitespace(e)
let r=Zd.findInsertionIndex(this._afterLineNumbers,t,this._ordinals,i)
return this._insertWhitespaceAtIndex(e,r,t,i,s),!0}}return!1}removeWhitespace(e){let t=(e|=0).toString()
if(this._whitespaceId2Index.hasOwnProperty(t)){let e=this._whitespaceId2Index[t]
return delete this._whitespaceId2Index[t],this._removeWhitespaceAtIndex(e),!0}return!1}_removeWhitespaceAtIndex(e){e|=0,this._heights.splice(e,1),this._ids.splice(e,1),this._afterLineNumbers.splice(e,1),this._ordinals.splice(e,1),this._prefixSum.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)
let t=Object.keys(this._whitespaceId2Index)
for(let i=0,n=t.length;i<n;i++){let n=t[i],s=this._whitespaceId2Index[n]
s>=e&&(this._whitespaceId2Index[n]=s-1)}}onLinesDeleted(e,t){e|=0,t|=0
for(let i=0,n=this._afterLineNumbers.length;i<n;i++){let n=this._afterLineNumbers[i]
e<=n&&n<=t?this._afterLineNumbers[i]=e-1:n>t&&(this._afterLineNumbers[i]-=t-e+1)}}onLinesInserted(e,t){e|=0,t|=0
for(let i=0,n=this._afterLineNumbers.length;i<n;i++){e<=this._afterLineNumbers[i]&&(this._afterLineNumbers[i]+=t-e+1)}}getTotalHeight(){return 0===this._heights.length?0:this.getAccumulatedHeight(this._heights.length-1)}getAccumulatedHeight(e){e|=0
let t=Math.max(0,this._prefixSumValidIndex+1)
0===t&&(this._prefixSum[0]=this._heights[0],t++)
for(let i=t;i<=e;i++)this._prefixSum[i]=this._prefixSum[i-1]+this._heights[i]
return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._prefixSum[e]}getAccumulatedHeightBeforeLineNumber(e){e|=0
let t=this._findLastWhitespaceBeforeLineNumber(e)
return-1===t?0:this.getAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e|=0
let t=this._afterLineNumbers,i=0,n=t.length-1
for(;i<=n;){let s=i+((n-i|0)/2|0)|0
if(t[s]<e){if(s+1>=t.length||t[s+1]>=e)return s
i=s+1|0}else n=s-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e|=0
let t=this._findLastWhitespaceBeforeLineNumber(e)+1
return t<this._heights.length?t:-1}getFirstWhitespaceIndexAfterLineNumber(e){return e|=0,this._findFirstWhitespaceAfterLineNumber(e)}getCount(){return this._heights.length}getAfterLineNumberForWhitespaceIndex(e){return e|=0,this._afterLineNumbers[e]}getIdForWhitespaceIndex(e){return e|=0,this._ids[e]}getHeightForWhitespaceIndex(e){return e|=0,this._heights[e]}getWhitespaces(e){e|=0
let t=[]
for(let i=0;i<this._heights.length;i++)t.push({id:this._ids[i],afterLineNumber:this._afterLineNumbers[i],heightInLines:this._heights[i]/e})
return t}}class Xd{constructor(e,t){this._lineCount=e,this._lineHeight=t,this._whitespaces=new Zd}setLineHeight(e){this._lineHeight=e}onFlushed(e){this._lineCount=e}insertWhitespace(e,t,i){return this._whitespaces.insertWhitespace(e,t,i)}changeWhitespace(e,t,i){return this._whitespaces.changeWhitespace(e,t,i)}removeWhitespace(e){return this._whitespaces.removeWhitespace(e)}onLinesDeleted(e,t){this._lineCount-=t-e+1,this._whitespaces.onLinesDeleted(e,t)}onLinesInserted(e,t){this._lineCount+=t-e+1,this._whitespaces.onLinesInserted(e,t)}getLinesTotalHeight(){return this._lineHeight*this._lineCount+this._whitespaces.getTotalHeight()}getVerticalOffsetForLineNumber(e){let t
return(t=(e|=0)>1?this._lineHeight*(e-1):0)+this._whitespaces.getAccumulatedHeightBeforeLineNumber(e)}getWhitespaceAccumulatedHeightBeforeLineNumber(e){return this._whitespaces.getAccumulatedHeightBeforeLineNumber(e)}hasWhitespace(){return this._whitespaces.getCount()>0}isAfterLines(e){return e>this.getLinesTotalHeight()}getLineNumberAtOrAfterVerticalOffset(e){if((e|=0)<0)return 1
const t=0|this._lineCount,i=this._lineHeight
let n=1,s=t
for(;n<s;){let t=(n+s)/2|0,r=0|this.getVerticalOffsetForLineNumber(t)
if(e>=r+i)n=t+1
else{if(e>=r)return t
s=t}}return n>t?t:n}getLinesViewportData(e,t){e|=0,t|=0
const i=this._lineHeight,n=0|this.getLineNumberAtOrAfterVerticalOffset(e),s=0|this.getVerticalOffsetForLineNumber(n)
let r=0|this._lineCount,o=0|this._whitespaces.getFirstWhitespaceIndexAfterLineNumber(n)
const a=0|this._whitespaces.getCount()
let l,h;-1===o?(o=a,h=r+1,l=0):(h=0|this._whitespaces.getAfterLineNumberForWhitespaceIndex(o),l=0|this._whitespaces.getHeightForWhitespaceIndex(o))
let d=s,u=d
let c=0
s>=5e5&&(c=5e5*Math.floor(s/5e5),u-=c=Math.floor(c/i)*i)
let g=[]
const m=e+(t-e)/2
let p=-1
for(let e=n;e<=r;e++){if(-1===p){(d<=m&&m<d+i||d>m)&&(p=e)}for(d+=i,g[e-n]=u,u+=i;h===e;)u+=l,d+=l,++o>=a?h=r+1:(h=0|this._whitespaces.getAfterLineNumberForWhitespaceIndex(o),l=0|this._whitespaces.getHeightForWhitespaceIndex(o))
if(d>=t){r=e
break}}-1===p&&(p=r)
const f=0|this.getVerticalOffsetForLineNumber(r)
let _=n,C=r
return _<C&&s<e&&_++,_<C&&f+i>t&&C--,{bigNumbersDelta:c,startLineNumber:n,endLineNumber:r,relativeVerticalOffset:g,centeredLineNumber:p,completelyVisibleStartLineNumber:_,completelyVisibleEndLineNumber:C}}getVerticalOffsetForWhitespaceIndex(e){e|=0
let t,i,n=this._whitespaces.getAfterLineNumberForWhitespaceIndex(e)
return(t=n>=1?this._lineHeight*n:0)+(i=e>0?this._whitespaces.getAccumulatedHeight(e-1):0)}getWhitespaceIndexAtOrAfterVerticallOffset(e){e|=0
let t,i,n,s=0,r=this._whitespaces.getCount()-1
if(r<0)return-1
if(e>=this.getVerticalOffsetForWhitespaceIndex(r)+this._whitespaces.getHeightForWhitespaceIndex(r))return-1
for(;s<r;)if(t=Math.floor((s+r)/2),e>=(i=this.getVerticalOffsetForWhitespaceIndex(t))+(n=this._whitespaces.getHeightForWhitespaceIndex(t)))s=t+1
else{if(e>=i)return t
r=t}return s}getWhitespaceAtVerticalOffset(e){e|=0
let t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e)
if(t<0)return null
if(t>=this._whitespaces.getCount())return null
let i=this.getVerticalOffsetForWhitespaceIndex(t)
if(i>e)return null
let n=this._whitespaces.getHeightForWhitespaceIndex(t)
return{id:this._whitespaces.getIdForWhitespaceIndex(t),afterLineNumber:this._whitespaces.getAfterLineNumberForWhitespaceIndex(t),verticalOffset:i,height:n}}getWhitespaceViewportData(e,t){e|=0,t|=0
let i=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),n=this._whitespaces.getCount()-1
if(i<0)return[]
let s=[]
for(let e=i;e<=n;e++){let i=this.getVerticalOffsetForWhitespaceIndex(e),n=this._whitespaces.getHeightForWhitespaceIndex(e)
if(i>=t)break
s.push({id:this._whitespaces.getIdForWhitespaceIndex(e),afterLineNumber:this._whitespaces.getAfterLineNumberForWhitespaceIndex(e),verticalOffset:i,height:n})}return s}getWhitespaces(){return this._whitespaces.getWhitespaces(this._lineHeight)}}const Jd=125
class Qd extends ni{constructor(e,t,i){super(),this._configuration=e,this._linesLayout=new Xd(t,this._configuration.editor.lineHeight),this.scrollable=this._register(new bi(0,i)),this._configureSmoothScrollDuration(),this.scrollable.setScrollDimensions({width:e.editor.layoutInfo.contentWidth,height:e.editor.layoutInfo.contentHeight}),this.onDidScroll=this.scrollable.onScroll,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this.scrollable}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this.scrollable.setSmoothScrollDuration(this._configuration.editor.viewInfo.smoothScrolling?Jd:0)}onConfigurationChanged(e){e.lineHeight&&this._linesLayout.setLineHeight(this._configuration.editor.lineHeight),e.layoutInfo&&this.scrollable.setScrollDimensions({width:this._configuration.editor.layoutInfo.contentWidth,height:this._configuration.editor.layoutInfo.contentHeight}),e.viewInfo&&this._configureSmoothScrollDuration(),this._updateHeight()}onFlushed(e){this._linesLayout.onFlushed(e),this._updateHeight()}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t),this._updateHeight()}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t),this._updateHeight()}_getHorizontalScrollbarHeight(e){return this._configuration.editor.viewInfo.scrollbar.horizontal===hi.Hidden?0:e.width>=e.scrollWidth?0:this._configuration.editor.viewInfo.scrollbar.horizontalScrollbarSize}_getTotalHeight(){const e=this.scrollable.getScrollDimensions()
let t=this._linesLayout.getLinesTotalHeight()
return this._configuration.editor.viewInfo.scrollBeyondLastLine?t+=e.height-this._configuration.editor.lineHeight:t+=this._getHorizontalScrollbarHeight(e),Math.max(e.height,t)}_updateHeight(){this.scrollable.setScrollDimensions({scrollHeight:this._getTotalHeight()})}getCurrentViewport(){const e=this.scrollable.getScrollDimensions(),t=this.scrollable.getCurrentScrollPosition()
return new Sh(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){const e=this.scrollable.getScrollDimensions(),t=this.scrollable.getFutureScrollPosition()
return new Sh(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeScrollWidth(e,t){return this._configuration.editor.wrappingInfo.isViewportWrapping?Math.max(e,t):Math.max(e+Qd.LINES_HORIZONTAL_EXTRA_PX,t)}onMaxLineWidthChanged(e){let t=this._computeScrollWidth(e,this.getCurrentViewport().width)
this.scrollable.setScrollDimensions({scrollWidth:t}),this._updateHeight()}saveState(){const e=this.scrollable.getFutureScrollPosition()
let t=e.scrollTop,i=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t)
return{scrollTop:t,scrollTopWithoutViewZones:t-this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(i),scrollLeft:e.scrollLeft}}restoreState(e){let t=e.scrollTop
"number"!=typeof e.scrollTopWithoutViewZones||this._linesLayout.hasWhitespace()||(t=e.scrollTopWithoutViewZones),this.scrollable.setScrollPositionNow({scrollLeft:e.scrollLeft,scrollTop:t})}addWhitespace(e,t,i){return this._linesLayout.insertWhitespace(e,t,i)}changeWhitespace(e,t,i){return this._linesLayout.changeWhitespace(e,t,i)}removeWhitespace(e){return this._linesLayout.removeWhitespace(e)}getVerticalOffsetForLineNumber(e){return this._linesLayout.getVerticalOffsetForLineNumber(e)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){const e=this.getCurrentViewport()
return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){const t=this.scrollable.getScrollDimensions()
return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){const e=this.getCurrentViewport()
return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getScrollWidth(){return this.scrollable.getScrollDimensions().scrollWidth}getScrollHeight(){return this.scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this.scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this.scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this.scrollable.validateScrollPosition(e)}setScrollPositionNow(e){this.scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this.scrollable.setScrollPositionSmooth(e)}deltaScrollNow(e,t){const i=this.scrollable.getCurrentScrollPosition()
this.scrollable.setScrollPositionNow({scrollLeft:i.scrollLeft+e,scrollTop:i.scrollTop+t})}}Qd.LINES_HORIZONTAL_EXTRA_PX=30
const eu=!0
class tu extends ah{constructor(e,t,i,n){if(super(),this.editorId=e,this.configuration=t,this.model=i,eu&&this.model.isTooLargeForTokenization())this.lines=new Hd(this.model)
else{const e=this.configuration.editor
let t=new jd(e.wrappingInfo.wordWrapBreakBeforeCharacters,e.wrappingInfo.wordWrapBreakAfterCharacters,e.wrappingInfo.wordWrapBreakObtrusiveCharacters)
this.lines=new Ad(this.model,t,this.model.getOptions().tabSize,e.wrappingInfo.wrappingColumn,e.fontInfo.typicalFullwidthCharacterWidth/e.fontInfo.typicalHalfwidthCharacterWidth,e.wrappingInfo.wrappingIndent)}this.coordinatesConverter=this.lines.createCoordinatesConverter(),this.viewLayout=this._register(new Qd(this.configuration,this.getLineCount(),n)),this._register(this.viewLayout.onDidScroll(e=>{this._emit([new th(e)])})),this._isDisposing=!1,this._centeredViewLine=-1,this.decorations=new Ih(this.editorId,this.model,this.configuration,this.lines,this.coordinatesConverter),this._register(this.model.addBulkListener(e=>{if(this._isDisposing)return
let t=new kh
this._onModelEvents(t,e),this._emit(t.finalize())})),this._register(this.configuration.onDidChange(e=>{const t=new kh
this._onConfigurationChanged(t,e),this._emit(t.finalize())})),this._register($d.getInstance().onDidChange(()=>{this._emit([new sh])}))}dispose(){this._isDisposing=!0,this.decorations.dispose(),this.lines.dispose(),super.dispose()}_onConfigurationChanged(e,t){const i=this.getCenteredRangeInViewport()
let n=!1
const s=this.configuration.editor
if(this.lines.setWrappingSettings(s.wrappingInfo.wrappingIndent,s.wrappingInfo.wrappingColumn,s.fontInfo.typicalFullwidthCharacterWidth/s.fontInfo.typicalHalfwidthCharacterWidth)&&(e.emit(new jl),e.emit(new Zl),e.emit(new Gl),this.decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),0!==this.viewLayout.getCurrentScrollTop()&&(n=!0)),t.readOnly&&(this.decorations.reset(),e.emit(new Gl)),e.emit(new $l(t)),this.viewLayout.onConfigurationChanged(t),n&&i){const t=this.coordinatesConverter.convertModelRangeToViewRange(i)
e.emit(new eh(t,1,!1,1))}}_onModelEvents(t,i){for(let e=0,t=i.length;e<t;e++){if(i[e].type===cn.ModelRawContentChanged2){this._centeredViewLine=-1,this.configuration.setMaxLineNumber(this.model.getLineCount())
break}}let n=!1,s=!1
for(let r=0,o=i.length;r<o;r++){const o=i[r],a=o.type,l=o.data
switch(a){case cn.ModelRawContentChanged2:{const e=l,i=e.changes,r=e.versionId
for(let e=0,o=i.length;e<o;e++){const o=i[e]
switch(o.changeType){case 1:this.lines.onModelFlushed(),t.emit(new jl),this.decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),n=!0
break
case 3:{const e=this.lines.onModelLinesDeleted(r,o.fromLineNumber,o.toLineNumber)
null!==e&&(t.emit(e),this.viewLayout.onLinesDeleted(e.fromLineNumber,e.toLineNumber)),n=!0
break}case 4:{const e=this.lines.onModelLinesInserted(r,o.fromLineNumber,o.toLineNumber,o.detail.split("\n"))
null!==e&&(t.emit(e),this.viewLayout.onLinesInserted(e.fromLineNumber,e.toLineNumber)),n=!0
break}case 2:{const[e,i,n,a]=this.lines.onModelLineChanged(r,o.lineNumber,o.detail)
s=e,i&&t.emit(i),n&&(t.emit(n),this.viewLayout.onLinesInserted(n.fromLineNumber,n.toLineNumber)),a&&(t.emit(a),this.viewLayout.onLinesDeleted(a.fromLineNumber,a.toLineNumber))
break}}}this.lines.acceptVersionId(r)
break}case cn.ModelTokensChanged:{const i=l
let n=[]
for(let t=0,s=i.ranges.length;t<s;t++){const s=i.ranges[t],r=this.coordinatesConverter.convertModelPositionToViewPosition(new e(s.fromLineNumber,1)).lineNumber,o=this.coordinatesConverter.convertModelPositionToViewPosition(new e(s.toLineNumber,this.model.getLineMaxColumn(s.toLineNumber))).lineNumber
n[t]={fromLineNumber:r,toLineNumber:o}}t.emit(new ih(n))
break}case cn.ModelLanguageChanged:break
case cn.ModelLanguageConfigurationChanged:t.emit(new oh)
break
case cn.ModelContentChanged:break
case cn.ModelOptionsChanged:this.lines.setTabSize(this.model.getOptions().tabSize)&&(t.emit(new jl),t.emit(new Zl),t.emit(new Gl),this.decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()))
break
case cn.ModelDecorationsChanged:this.decorations.onModelDecorationsChanged(),t.emit(new Gl)
break
case cn.ModelDispose:break
default:console.info("View received unknown event: "),console.info(a,l)}}!n&&s&&(t.emit(new Zl),t.emit(new Gl),this.decorations.onLineMappingChanged())}setHiddenAreas(e){let t=new kh
this.lines.setHiddenAreas(e)&&(t.emit(new jl),t.emit(new Zl),t.emit(new Gl),this.decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())),this._emit(t.finalize())}getCenteredRangeInViewport(){if(-1===this._centeredViewLine)return null
let e=this._centeredViewLine,i=new t(e,this.getLineMinColumn(e),e,this.getLineMaxColumn(e))
return this.coordinatesConverter.convertViewRangeToModelRange(i)}getCompletelyVisibleViewRange(){const e=this.viewLayout.getLinesViewportData(),i=e.completelyVisibleStartLineNumber,n=e.completelyVisibleEndLineNumber
return new t(i,this.getLineMinColumn(i),n,this.getLineMaxColumn(n))}getCompletelyVisibleViewRangeAtScrollTop(e){const i=this.viewLayout.getLinesViewportDataAtScrollTop(e),n=i.completelyVisibleStartLineNumber,s=i.completelyVisibleEndLineNumber
return new t(n,this.getLineMinColumn(n),s,this.getLineMaxColumn(s))}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this.lines.getViewLineCount()}setViewport(e,t,i){this._centeredViewLine=i,this.lines.warmUpLookupCache(e,t)}getLinesIndentGuides(e,t){return this.lines.getViewLinesIndentGuides(e,t)}getLineContent(e){return this.lines.getViewLineContent(e)}getLineMinColumn(e){return this.lines.getViewLineMinColumn(e)}getLineMaxColumn(e){return this.lines.getViewLineMaxColumn(e)}getLineFirstNonWhitespaceColumn(e){var t=Le(this.getLineContent(e))
return-1===t?0:t+1}getLineLastNonWhitespaceColumn(e){var t=Ee(this.getLineContent(e))
return-1===t?0:t+2}getDecorationsInViewport(e){return this.decorations.getDecorationsViewportData(e).decorations}getViewLineRenderingData(e,t){let i=this.model.mightContainRTL(),n=this.model.mightContainNonBasicASCII(),s=this.getTabSize(),r=this.lines.getViewLineData(t),o=this.decorations.getDecorationsViewportData(e).inlineDecorations[t-e.startLineNumber]
return new Lh(r.minColumn,r.maxColumn,r.content,i,n,r.tokens,o,s)}getMinimapLinesRenderingData(e,t,i){let n=this.lines.getViewLinesData(e,t,i)
return new yh(this.getTabSize(),n)}getAllOverviewRulerDecorations(e){return this.lines.getAllOverviewRulerDecorations(this.editorId,this.configuration.editor.readOnly,e)}invalidateOverviewRulerColorCache(){const e=this.model.getOverviewRulerDecorations()
for(let t=0,i=e.length;t<i;t++){e[t].options.overviewRuler._resolvedColor=null}}getValueInRange(e,t){var i=this.coordinatesConverter.convertViewRangeToModelRange(e)
return this.model.getValueInRange(i,t)}getModelLineMaxColumn(e){return this.model.getLineMaxColumn(e)}validateModelPosition(e){return this.model.validatePosition(e)}deduceModelPositionRelativeToViewPosition(e,t,i){const n=this.coordinatesConverter.convertViewPositionToModelPosition(e)
2===this.model.getEOL().length&&(t<0?t-=i:t+=i)
const s=this.model.getOffsetAt(n)+t
return this.model.getPositionAt(s)}getPlainTextToCopy(i,n){const r=this.model.getEOL();(i=i.slice(0)).sort(t.compareRangesUsingStarts)
const o=i.filter(e=>!e.isEmpty())
if(0===o.length){if(!n)return""
const t=i.map(t=>{const i=new e(t.startLineNumber,1)
return this.coordinatesConverter.convertViewPositionToModelPosition(i).lineNumber})
let s=""
for(let e=0;e<t.length;e++)e>0&&t[e-1]===t[e]||(s+=this.model.getLineContent(t[e])+r)
return s}let a=[]
for(let e=0;e<o.length;e++)a.push(this.getValueInRange(o[e],s.TextDefined))
return a.join(r)}getHTMLToCopy(e,i){if(1===this.model.getLanguageIdentifier().id)return null
if(1!==e.length)return null
let n=this.coordinatesConverter.convertViewRangeToModelRange(e[0])
if(n.isEmpty()){if(!i)return null
let e=n.startLineNumber
n=new t(e,this.model.getLineMinColumn(e),e,this.model.getLineMaxColumn(e))}const s=this.configuration.editor.fontInfo,r=this._getColorMap()
return'<div style="'+`color: ${r[1]};`+`background-color: ${r[2]};`+`font-family: ${s.fontFamily};`+`font-weight: ${s.fontWeight};`+`font-size: ${s.fontSize}px;`+`line-height: ${s.lineHeight}px;`+'white-space: pre;">'+this._getHTMLToCopy(n,r)+"</div>"}_getHTMLToCopy(e,t){const i=e.startLineNumber,n=e.startColumn,s=e.endLineNumber,r=e.endColumn,o=this.getTabSize()
let a=""
for(let e=i;e<=s;e++){const l=this.model.getLineTokens(e),h=l.getLineContent(),d=e===i?n-1:0,u=e===s?r-1:h.length
a+=""===h?"<br>":vh(h,l.inflate(),t,d,u,o)}return a}_getColorMap(){let e=js.getColorMap(),t=[null]
for(let i=1,n=e.length;i<n;i++)t[i]=Td.Format.CSS.formatHex(e[i])
return t}}function iu(e,t=0){switch(typeof e){case"object":return null===e?nu(349,t):Array.isArray(e)?(s=e,r=nu(104579,r=t),s.reduce((e,t)=>iu(t,e),r)):(i=e,n=nu(181387,n=t),Object.keys(i).sort().reduce((e,t)=>(e=su(t,e),iu(i[t],e)),n))
case"string":return su(e,t)
case"boolean":return nu(e?433:863,t)
case"number":return nu(e,t)
case"undefined":return nu(e,937)
default:return nu(e,617)}var i,n,s,r}function nu(e,t){return(t<<5)-t+e|0}function su(e,t){t=nu(149417,t)
for(let i=0,n=e.length;i<n;i++)t=nu(e.charCodeAt(i),t)
return t}var ru,ou;(ou=ru||(ru={})).inMemory="inmemory",ou.vscode="vscode",ou.internal="private",ou.walkThrough="walkThrough",ou.walkThroughSnippet="walkThroughSnippet",ou.http="http",ou.https="https",ou.file="file",ou.mailto="mailto",ou.untitled="untitled"
class au extends ni{constructor(e,t){super(),this._editor=e,this._langId=Vo.languageId.bindTo(t),this._hasCompletionItemProvider=Vo.hasCompletionItemProvider.bindTo(t),this._hasCodeActionsProvider=Vo.hasCodeActionsProvider.bindTo(t),this._hasCodeLensProvider=Vo.hasCodeLensProvider.bindTo(t),this._hasDefinitionProvider=Vo.hasDefinitionProvider.bindTo(t),this._hasImplementationProvider=Vo.hasImplementationProvider.bindTo(t),this._hasTypeDefinitionProvider=Vo.hasTypeDefinitionProvider.bindTo(t),this._hasHoverProvider=Vo.hasHoverProvider.bindTo(t),this._hasDocumentHighlightProvider=Vo.hasDocumentHighlightProvider.bindTo(t),this._hasDocumentSymbolProvider=Vo.hasDocumentSymbolProvider.bindTo(t),this._hasReferenceProvider=Vo.hasReferenceProvider.bindTo(t),this._hasRenameProvider=Vo.hasRenameProvider.bindTo(t),this._hasDocumentFormattingProvider=Vo.hasDocumentFormattingProvider.bindTo(t),this._hasDocumentSelectionFormattingProvider=Vo.hasDocumentSelectionFormattingProvider.bindTo(t),this._hasSignatureHelpProvider=Vo.hasSignatureHelpProvider.bindTo(t),this._isInWalkThrough=Vo.isInEmbeddedEditor.bindTo(t)
const i=()=>this._update()
this._register(e.onDidChangeModel(i)),this._register(e.onDidChangeModelLanguage(i)),this._register(Os.onDidChange(i)),this._register(zs.onDidChange(i)),this._register(Hs.onDidChange(i)),this._register(Ws.onDidChange(i)),this._register(Vs.onDidChange(i)),this._register(Bs.onDidChange(i)),this._register(As.onDidChange(i)),this._register(Fs.onDidChange(i)),this._register(Ps.onDidChange(i)),this._register(Ds.onDidChange(i)),this._register(Ts.onDidChange(i)),this._register(Us.onDidChange(i)),this._register(Ks.onDidChange(i)),this._register(Rs.onDidChange(i)),i()}dispose(){super.dispose()}reset(){this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInWalkThrough.reset()}_update(){const e=this._editor.getModel()
e?(this._langId.set(e.getLanguageIdentifier().language),this._hasCompletionItemProvider.set(Os.has(e)),this._hasCodeActionsProvider.set(zs.has(e)),this._hasCodeLensProvider.set(Hs.has(e)),this._hasDefinitionProvider.set(Ws.has(e)),this._hasImplementationProvider.set(Vs.has(e)),this._hasTypeDefinitionProvider.set(Bs.has(e)),this._hasHoverProvider.set(As.has(e)),this._hasDocumentHighlightProvider.set(Fs.has(e)),this._hasDocumentSymbolProvider.set(Ps.has(e)),this._hasReferenceProvider.set(Ds.has(e)),this._hasRenameProvider.set(Ts.has(e)),this._hasSignatureHelpProvider.set(Rs.has(e)),this._hasDocumentFormattingProvider.set(Us.has(e)||Ks.has(e)),this._hasDocumentSelectionFormattingProvider.set(Ks.has(e)),this._isInWalkThrough.set(e.uri.scheme===ru.walkThroughSnippet)):this.reset()}}let lu=0
class hu extends ni{constructor(e,t){super(),this._editor=e,this._editorId=t.createKey("editorId",e.getId()),this._editorFocus=Vo.focus.bindTo(t),this._editorTextFocus=Vo.textFocus.bindTo(t),this._editorTabMovesFocus=Vo.tabMovesFocus.bindTo(t),this._editorReadonly=Vo.readOnly.bindTo(t),this._hasMultipleSelections=Vo.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=Vo.hasNonEmptySelection.bindTo(t),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditor(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditor(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus()}_updateFromConfig(){let e=this._editor.getConfiguration()
this._editorTabMovesFocus.set(e.tabFocusMode),this._editorReadonly.set(e.readOnly)}_updateFromSelection(){let e=this._editor.getSelections()
e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some(e=>!e.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()),this._editorTextFocus.set(this._editor.isFocused())}}const du="base.contributions.json"
const uu=new class{constructor(){this._onDidChangeSchema=new ci,this.onDidChangeSchema=this._onDidChangeSchema.event,this.schemasById={}}registerSchema(e,t){var i
this.schemasById[(i=e,i.length>0&&"#"===i.charAt(i.length-1)?i.substring(0,i.length-1):i)]=t,this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}}
qr.add(du,uu)
const cu={Configuration:"base.contributions.configuration"}
var gu,mu;(mu=gu||(gu={}))[mu.WINDOW=1]="WINDOW",mu[mu.RESOURCE=2]="RESOURCE"
const pu={properties:{},patternProperties:{},additionalProperties:!1,errorMessage:"Unknown configuration setting"},fu={properties:{},patternProperties:{},additionalProperties:!1,errorMessage:"Unknown configuration setting"},_u="vscode://schemas/settings/editor",Cu=qr.as(du)
const bu="override",wu="\\[.*\\]$",vu="\\[(${0})\\]$",Su=new RegExp(wu)
function yu(e){switch(Array.isArray(e)?e[0]:e){case"boolean":return!1
case"integer":case"number":return 0
case"string":return""
case"array":return[]
case"object":return{}
default:return null}}const xu=new class{constructor(){this.overrideIdentifiers=[],this._onDidRegisterConfiguration=new ci,this.onDidRegisterConfiguration=this._onDidRegisterConfiguration.event,this.configurationContributors=[],this.editorConfigurationSchema={properties:{},patternProperties:{},additionalProperties:!1,errorMessage:"Unknown editor configuration setting"},this.configurationProperties={},this.computeOverridePropertyPattern(),Cu.registerSchema(_u,this.editorConfigurationSchema)}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){const i=[]
e.forEach(e=>{i.push(...this.validateAndRegisterProperties(e,t)),this.configurationContributors.push(e),this.registerJSONConfiguration(e),this.updateSchemaForOverrideSettingsConfiguration(e)}),this._onDidRegisterConfiguration.fire(i)}notifyConfigurationSchemaUpdated(e){Cu.registerSchema(_u,this.editorConfigurationSchema)}registerOverrideIdentifiers(e){this.overrideIdentifiers.push(...e),this.updateOverridePropertyPatternKey()}registerDefaultConfigurations(e){const t={id:"defaultOverrides",title:Jt("defaultConfigurations.title","Default Configuration Overrides"),properties:{}}
for(const i of e)for(const e in i.defaults){const n=i.defaults[e]
Su.test(e)&&"object"==typeof n&&(t.properties[e]={type:"object",default:n,description:Jt("overrideSettings.description","Configure editor settings to be overridden for {0} language.",e),$ref:_u})}Object.keys(t.properties).length&&this.registerConfiguration(t,!1)}validateAndRegisterProperties(e,t=!0,i=gu.WINDOW,n=!1){i=void 0!==e.scope&&null!==e.scope?e.scope:i,n=e.overridable||n
let s=[],r=e.properties
if(r)for(let e in r){let o
if(t&&(o=Lu(e))){console.warn(o),delete r[e]
continue}let a=r[e]
ht(a.default)&&(a.default=yu(a.type)),n&&(a.overridable=!0),void 0===a.scope&&(a.scope=i),this.configurationProperties[e]=r[e],s.push(e)}let o=e.allOf
if(o)for(let e of o)s.push(...this.validateAndRegisterProperties(e,t,i,n))
return s}validateProperty(e){return!Su.test(e)&&void 0!==this.getConfigurationProperties()[e]}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}registerJSONConfiguration(e){!function e(t){let i=t.properties
if(i)for(let e in i)pu.properties[e]=i[e],fu.properties[e]=Wn(i[e]),i[e].scope!==gu.RESOURCE&&(fu.properties[e].doNotSuggest=!0)
let n=t.allOf
n&&n.forEach(e)}(e)}updateSchemaForOverrideSettingsConfiguration(e){e.id!==bu&&(this.update(e),Cu.registerSchema(_u,this.editorConfigurationSchema))}updateOverridePropertyPatternKey(){let e=pu.patternProperties[this.overridePropertyPattern]
e||(e={type:"object",description:Jt("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:"Unknown Identifier. Use language identifiers",$ref:_u}),delete pu.patternProperties[this.overridePropertyPattern],this.computeOverridePropertyPattern(),pu.patternProperties[this.overridePropertyPattern]=e,fu.patternProperties[this.overridePropertyPattern]=e}update(e){let t=e.properties
if(t)for(let e in t)t[e].overridable&&(this.editorConfigurationSchema.properties[e]=this.getConfigurationProperties()[e])
let i=e.allOf
i&&i.forEach(e=>this.update(e))}computeOverridePropertyPattern(){this.overridePropertyPattern=this.overrideIdentifiers.length?vu.replace("${0}",this.overrideIdentifiers.map(e=>Ce(e,!1).source).join("|")):wu}}
function Lu(e){return Su.test(e)?Jt("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",e):void 0!==xu.getConfigurationProperties()[e]?Jt("config.property.duplicate","Cannot register '{0}'. This property is already registered.",e):null}qr.add(cu.Configuration,xu)
const Nu=new class{constructor(){this._zoomLevel=0,this._onDidChangeZoomLevel=new ci,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event}getZoomLevel(){return this._zoomLevel}setZoomLevel(e){e=Math.min(Math.max(-9,e),9),this._zoomLevel!==e&&(this._zoomLevel=e,this._onDidChangeZoomLevel.fire(this._zoomLevel))}},Eu=k?1.5:1.35
function ku(e,t){if("number"==typeof e)return e
let i=parseFloat(e)
return isNaN(i)?t:i}function Iu(e,t,i){return e<t?t:e>i?i:e}function Mu(e,t){return"string"!=typeof e?t:e}class Du{static createFromRawSettings(e,t){let i=Mu(e.fontFamily,Ki.fontFamily),n=Mu(e.fontWeight,Ki.fontWeight),s=ku(e.fontSize,Ki.fontSize)
0===(s=Iu(s,0,100))?s=Ki.fontSize:s<8&&(s=8)
let r=function(e,t){if("number"==typeof e)return Math.round(e)
let i=parseInt(e)
return isNaN(i)?t:i}(e.lineHeight,0)
0===(r=Iu(r,0,150))?r=Math.round(Eu*s):r<8&&(r=8)
let o=ku(e.letterSpacing,0)
o=Iu(o,-20,20)
let a=1+.1*Nu.getZoomLevel()
return new Du({zoomLevel:t,fontFamily:i,fontWeight:n,fontSize:s*=a,lineHeight:r*=a,letterSpacing:o})}constructor(e){this.zoomLevel=e.zoomLevel,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.lineHeight=0|e.lineHeight,this.letterSpacing=e.letterSpacing}getId(){return this.zoomLevel+"-"+this.fontFamily+"-"+this.fontWeight+"-"+this.fontSize+"-"+this.lineHeight+"-"+this.letterSpacing}}class Tu extends Du{constructor(e,t){super(e),this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.spaceWidth=e.spaceWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.spaceWidth===e.spaceWidth&&this.maxDigitWidth===e.maxDigitWidth}}const Ou=qi,Ru=Ki,Au=$i,Pu=new class{constructor(){this._tabFocus=!1,this._onDidChangeTabFocus=new ci,this.onDidChangeTabFocus=this._onDidChangeTabFocus.event}getTabFocusMode(){return this._tabFocus}setTabFocusMode(e){this._tabFocus!==e&&(this._tabFocus=e,this._onDidChangeTabFocus.fire(this._tabFocus))}}
class Fu extends ni{constructor(e){super(),this._onDidChange=this._register(new ci),this.onDidChange=this._onDidChange.event,this._rawOptions=Vn({},e||{}),this._rawOptions.scrollbar=Vn({},this._rawOptions.scrollbar||{}),this._rawOptions.minimap=Vn({},this._rawOptions.minimap||{}),this._rawOptions.find=Vn({},this._rawOptions.find||{}),this._validatedOptions=Hi.validate(this._rawOptions,Ou),this.editor=null,this._isDominatedByLongLines=!1,this._lineNumbersDigitCount=1,this._register(Nu.onDidChangeZoomLevel(e=>this._recomputeOptions())),this._register(Pu.onDidChangeTabFocus(e=>this._recomputeOptions()))}dispose(){super.dispose()}_recomputeOptions(){const e=this.editor,t=this._computeInternalOptions()
e&&e.equals(t)||(this.editor=t,e&&this._onDidChange.fire(e.createChangeEvent(t)))}getRawOptions(){return this._rawOptions}_computeInternalOptions(){const e=this._validatedOptions,t=this._getEnvConfiguration(),i=Du.createFromRawSettings(this._rawOptions,t.zoomLevel),n={outerWidth:t.outerWidth,outerHeight:t.outerHeight,fontInfo:this.readConfiguration(i),extraEditorClassName:t.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:t.emptySelectionClipboard,pixelRatio:t.pixelRatio,tabFocusMode:Pu.getTabFocusMode(),accessibilitySupport:t.accessibilitySupport}
return zi.createInternalEditorOptions(n,e)}updateOptions(e){this._rawOptions=Vn(this._rawOptions,e||{}),this._validatedOptions=Hi.validate(this._rawOptions,Ou),this._recomputeOptions()}setIsDominatedByLongLines(e){this._isDominatedByLongLines=e,this._recomputeOptions()}setMaxLineNumber(e){let t=Fu._digitCount(e)
this._lineNumbersDigitCount!==t&&(this._lineNumbersDigitCount=t,this._recomputeOptions())}static _digitCount(e){for(var t=0;e;)e=Math.floor(e/10),t++
return t||1}}const Wu=qr.as(cu.Configuration),Vu={id:"editor",order:5,type:"object",title:Jt("editorConfigurationTitle","Editor"),overridable:!0,scope:gu.RESOURCE,properties:{"editor.fontFamily":{type:"string",default:Ru.fontFamily,description:Jt("fontFamily","Controls the font family.")},"editor.fontWeight":{type:"string",enum:["normal","bold","100","200","300","400","500","600","700","800","900"],default:Ru.fontWeight,description:Jt("fontWeight","Controls the font weight.")},"editor.fontSize":{type:"number",default:Ru.fontSize,description:Jt("fontSize","Controls the font size in pixels.")},"editor.lineHeight":{type:"number",default:Ru.lineHeight,description:Jt("lineHeight","Controls the line height. Use 0 to compute the lineHeight from the fontSize.")},"editor.letterSpacing":{type:"number",default:Ru.letterSpacing,description:Jt("letterSpacing","Controls the letter spacing in pixels.")},"editor.lineNumbers":{type:"string",enum:["off","on","relative"],default:"on",description:Jt("lineNumbers","Controls the display of line numbers. Possible values are 'on', 'off', and 'relative'. 'relative' shows the line count from the current cursor position.")},"editor.rulers":{type:"array",items:{type:"number"},default:Ou.viewInfo.rulers,description:Jt("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty")},"editor.wordSeparators":{type:"string",default:Ou.wordSeparators,description:Jt("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations")},"editor.tabSize":{type:"number",default:Au.tabSize,minimum:1,description:Jt("tabSize","The number of spaces a tab is equal to. This setting is overriden based on the file contents when `editor.detectIndentation` is on."),errorMessage:Jt("tabSize.errorMessage","Expected 'number'. Note that the value \"auto\" has been replaced by the `editor.detectIndentation` setting.")},"editor.insertSpaces":{type:"boolean",default:Au.insertSpaces,description:Jt("insertSpaces","Insert spaces when pressing Tab. This setting is overriden based on the file contents when `editor.detectIndentation` is on."),errorMessage:Jt("insertSpaces.errorMessage","Expected 'boolean'. Note that the value \"auto\" has been replaced by the `editor.detectIndentation` setting.")},"editor.detectIndentation":{type:"boolean",default:Au.detectIndentation,description:Jt("detectIndentation","When opening a file, `editor.tabSize` and `editor.insertSpaces` will be detected based on the file contents.")},"editor.roundedSelection":{type:"boolean",default:Ou.viewInfo.roundedSelection,description:Jt("roundedSelection","Controls if selections have rounded corners")},"editor.scrollBeyondLastLine":{type:"boolean",default:Ou.viewInfo.scrollBeyondLastLine,description:Jt("scrollBeyondLastLine","Controls if the editor will scroll beyond the last line")},"editor.smoothScrolling":{type:"boolean",default:Ou.viewInfo.smoothScrolling,description:Jt("smoothScrolling","Controls if the editor will scroll using an animation")},"editor.minimap.enabled":{type:"boolean",default:Ou.viewInfo.minimap.enabled,description:Jt("minimap.enabled","Controls if the minimap is shown")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:Ou.viewInfo.minimap.showSlider,description:Jt("minimap.showSlider","Controls whether the minimap slider is automatically hidden. Possible values are 'always' and 'mouseover'")},"editor.minimap.renderCharacters":{type:"boolean",default:Ou.viewInfo.minimap.renderCharacters,description:Jt("minimap.renderCharacters","Render the actual characters on a line (as opposed to color blocks)")},"editor.minimap.maxColumn":{type:"number",default:Ou.viewInfo.minimap.maxColumn,description:Jt("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns")},"editor.find.seedSearchStringFromSelection":{type:"boolean",default:Ou.contribInfo.find.seedSearchStringFromSelection,description:Jt("find.seedSearchStringFromSelection","Controls if we seed the search string in Find Widget from editor selection")},"editor.find.autoFindInSelection":{type:"boolean",default:Ou.contribInfo.find.autoFindInSelection,description:Jt("find.autoFindInSelection","Controls if Find in Selection flag is turned on when multiple characters or lines of text are selected in the editor")},"editor.wordWrap":{type:"string",enum:["off","on","wordWrapColumn","bounded"],enumDescriptions:[Jt("wordWrap.off","Lines will never wrap."),Jt("wordWrap.on","Lines will wrap at the viewport width."),Jt({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `editor.wordWrapColumn`."),Jt({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `editor.wordWrapColumn`.")],default:Ou.wordWrap,description:Jt({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap. Can be:\n - 'off' (disable wrapping),\n - 'on' (viewport wrapping),\n - 'wordWrapColumn' (wrap at `editor.wordWrapColumn`) or\n - 'bounded' (wrap at minimum of viewport and `editor.wordWrapColumn`).")},"editor.wordWrapColumn":{type:"integer",default:Ou.wordWrapColumn,minimum:1,description:Jt({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `editor.wordWrap` is 'wordWrapColumn' or 'bounded'.")},"editor.wrappingIndent":{type:"string",enum:["none","same","indent"],default:"same",description:Jt("wrappingIndent","Controls the indentation of wrapped lines. Can be one of 'none', 'same' or 'indent'.")},"editor.mouseWheelScrollSensitivity":{type:"number",default:Ou.viewInfo.scrollbar.mouseWheelScrollSensitivity,description:Jt("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events")},"editor.multiCursorModifier":{type:"string",enum:["ctrlCmd","alt"],enumDescriptions:[Jt("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on OSX."),Jt("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on OSX.")],default:"alt",description:Jt({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. `ctrlCmd` maps to `Control` on Windows and Linux and to `Command` on OSX. The Go To Definition and Open Link mouse gestures will adapt such that they do not conflict with the multicursor modifier.")},"editor.quickSuggestions":{anyOf:[{type:"boolean"},{type:"object",properties:{strings:{type:"boolean",default:!1,description:Jt("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{type:"boolean",default:!1,description:Jt("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{type:"boolean",default:!0,description:Jt("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}}}],default:Ou.contribInfo.quickSuggestions,description:Jt("quickSuggestions","Controls if suggestions should automatically show up while typing")},"editor.quickSuggestionsDelay":{type:"integer",default:Ou.contribInfo.quickSuggestionsDelay,minimum:0,description:Jt("quickSuggestionsDelay","Controls the delay in ms after which quick suggestions will show up")},"editor.parameterHints":{type:"boolean",default:Ou.contribInfo.parameterHints,description:Jt("parameterHints","Enables pop-up that shows parameter documentation and type information as you type")},"editor.autoClosingBrackets":{type:"boolean",default:Ou.autoClosingBrackets,description:Jt("autoClosingBrackets","Controls if the editor should automatically close brackets after opening them")},"editor.formatOnType":{type:"boolean",default:Ou.contribInfo.formatOnType,description:Jt("formatOnType","Controls if the editor should automatically format the line after typing")},"editor.formatOnPaste":{type:"boolean",default:Ou.contribInfo.formatOnPaste,description:Jt("formatOnPaste","Controls if the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")},"editor.autoIndent":{type:"boolean",default:Ou.autoIndent,description:Jt("autoIndent","Controls if the editor should automatically adjust the indentation when users type, paste or move lines. Indentation rules of the language must be available.")},"editor.suggestOnTriggerCharacters":{type:"boolean",default:Ou.contribInfo.suggestOnTriggerCharacters,description:Jt("suggestOnTriggerCharacters","Controls if suggestions should automatically show up when typing trigger characters")},"editor.acceptSuggestionOnEnter":{type:"string",enum:["on","smart","off"],default:Ou.contribInfo.acceptSuggestionOnEnter,description:Jt("acceptSuggestionOnEnter","Controls if suggestions should be accepted on 'Enter' - in addition to 'Tab'. Helps to avoid ambiguity between inserting new lines or accepting suggestions. The value 'smart' means only accept a suggestion with Enter when it makes a textual change")},"editor.acceptSuggestionOnCommitCharacter":{type:"boolean",default:Ou.contribInfo.acceptSuggestionOnCommitCharacter,description:Jt("acceptSuggestionOnCommitCharacter","Controls if suggestions should be accepted on commit characters. For instance in JavaScript the semi-colon (';') can be a commit character that accepts a suggestion and types that character.")},"editor.snippetSuggestions":{type:"string",enum:["top","bottom","inline","none"],enumDescriptions:[Jt("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),Jt("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),Jt("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),Jt("snippetSuggestions.none","Do not show snippet suggestions.")],default:Ou.contribInfo.snippetSuggestions,description:Jt("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")},"editor.emptySelectionClipboard":{type:"boolean",default:Ou.emptySelectionClipboard,description:Jt("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")},"editor.wordBasedSuggestions":{type:"boolean",default:Ou.contribInfo.wordBasedSuggestions,description:Jt("wordBasedSuggestions","Controls whether completions should be computed based on words in the document.")},"editor.suggestFontSize":{type:"integer",default:0,minimum:0,description:Jt("suggestFontSize","Font size for the suggest widget")},"editor.suggestLineHeight":{type:"integer",default:0,minimum:0,description:Jt("suggestLineHeight","Line height for the suggest widget")},"editor.selectionHighlight":{type:"boolean",default:Ou.contribInfo.selectionHighlight,description:Jt("selectionHighlight","Controls whether the editor should highlight similar matches to the selection")},"editor.occurrencesHighlight":{type:"boolean",default:Ou.contribInfo.occurrencesHighlight,description:Jt("occurrencesHighlight","Controls whether the editor should highlight semantic symbol occurrences")},"editor.overviewRulerLanes":{type:"integer",default:3,description:Jt("overviewRulerLanes","Controls the number of decorations that can show up at the same position in the overview ruler")},"editor.overviewRulerBorder":{type:"boolean",default:Ou.viewInfo.overviewRulerBorder,description:Jt("overviewRulerBorder","Controls if a border should be drawn around the overview ruler.")},"editor.cursorBlinking":{type:"string",enum:["blink","smooth","phase","expand","solid"],default:function(e){if(e===Di.Blink)return"blink"
if(e===Di.Expand)return"expand"
if(e===Di.Phase)return"phase"
if(e===Di.Smooth)return"smooth"
if(e===Di.Solid)return"solid"
throw new Error("blinkingStyleToString: Unknown blinkingStyle")}(Ou.viewInfo.cursorBlinking),description:Jt("cursorBlinking","Control the cursor animation style, possible values are 'blink', 'smooth', 'phase', 'expand' and 'solid'")},"editor.mouseWheelZoom":{type:"boolean",default:Ou.viewInfo.mouseWheelZoom,description:Jt("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding Ctrl")},"editor.cursorStyle":{type:"string",enum:["block","block-outline","line","line-thin","underline","underline-thin"],default:function(e){if(e===Oi.Line)return"line"
if(e===Oi.Block)return"block"
if(e===Oi.Underline)return"underline"
if(e===Oi.LineThin)return"line-thin"
if(e===Oi.BlockOutline)return"block-outline"
if(e===Oi.UnderlineThin)return"underline-thin"
throw new Error("cursorStyleToString: Unknown cursorStyle")}(Ou.viewInfo.cursorStyle),description:Jt("cursorStyle","Controls the cursor style, accepted values are 'block', 'block-outline', 'line', 'line-thin', 'underline' and 'underline-thin'")},"editor.fontLigatures":{type:"boolean",default:Ou.viewInfo.fontLigatures,description:Jt("fontLigatures","Enables font ligatures")},"editor.hideCursorInOverviewRuler":{type:"boolean",default:Ou.viewInfo.hideCursorInOverviewRuler,description:Jt("hideCursorInOverviewRuler","Controls if the cursor should be hidden in the overview ruler.")},"editor.renderWhitespace":{type:"string",enum:["none","boundary","all"],default:Ou.viewInfo.renderWhitespace,description:Jt("renderWhitespace","Controls how the editor should render whitespace characters, possibilities are 'none', 'boundary', and 'all'. The 'boundary' option does not render single spaces between words.")},"editor.renderControlCharacters":{type:"boolean",default:Ou.viewInfo.renderControlCharacters,description:Jt("renderControlCharacters","Controls whether the editor should render control characters")},"editor.renderIndentGuides":{type:"boolean",default:Ou.viewInfo.renderIndentGuides,description:Jt("renderIndentGuides","Controls whether the editor should render indent guides")},"editor.renderLineHighlight":{type:"string",enum:["none","gutter","line","all"],default:Ou.viewInfo.renderLineHighlight,description:Jt("renderLineHighlight","Controls how the editor should render the current line highlight, possibilities are 'none', 'gutter', 'line', and 'all'.")},"editor.codeLens":{type:"boolean",default:Ou.contribInfo.codeLens,description:Jt("codeLens","Controls if the editor shows code lenses")},"editor.folding":{type:"boolean",default:Ou.contribInfo.folding,description:Jt("folding","Controls whether the editor has code folding enabled")},"editor.showFoldingControls":{type:"string",enum:["always","mouseover"],default:Ou.contribInfo.showFoldingControls,description:Jt("showFoldingControls","Controls whether the fold controls on the gutter are automatically hidden.")},"editor.matchBrackets":{type:"boolean",default:Ou.contribInfo.matchBrackets,description:Jt("matchBrackets","Highlight matching brackets when one of them is selected.")},"editor.glyphMargin":{type:"boolean",default:Ou.viewInfo.glyphMargin,description:Jt("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")},"editor.useTabStops":{type:"boolean",default:Ou.useTabStops,description:Jt("useTabStops","Inserting and deleting whitespace follows tab stops")},"editor.trimAutoWhitespace":{type:"boolean",default:Au.trimAutoWhitespace,description:Jt("trimAutoWhitespace","Remove trailing auto inserted whitespace")},"editor.stablePeek":{type:"boolean",default:!1,description:Jt("stablePeek","Keep peek editors open even when double clicking their content or when hitting Escape.")},"editor.dragAndDrop":{type:"boolean",default:Ou.dragAndDrop,description:Jt("dragAndDrop","Controls if the editor should allow to move selections via drag and drop.")},"editor.accessibilitySupport":{type:"string",enum:["auto","on","off"],enumDescriptions:[Jt("accessibilitySupport.auto","The editor will use platform APIs to detect when a Screen Reader is attached."),Jt("accessibilitySupport.on","The editor will be permanently optimized for usage with a Screen Reader."),Jt("accessibilitySupport.off","The editor will never be optimized for usage with a Screen Reader.")],default:Ou.accessibilitySupport,description:Jt("accessibilitySupport","Controls whether the editor should run in a mode where it is optimized for screen readers.")},"editor.links":{type:"boolean",default:Ou.contribInfo.links,description:Jt("links","Controls whether the editor should detect links and make them clickable")},"editor.colorDecorators":{type:"boolean",default:Ou.contribInfo.colorDecorators,description:Jt("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")},"editor.lightbulb.enabled":{type:"boolean",default:Ou.contribInfo.lightbulbEnabled,description:Jt("codeActions","Enables the code action lightbulb")},"diffEditor.renderSideBySide":{type:"boolean",default:!0,description:Jt("sideBySide","Controls if the diff editor shows the diff side by side or inline")},"diffEditor.ignoreTrimWhitespace":{type:"boolean",default:!0,description:Jt("ignoreTrimWhitespace","Controls if the diff editor shows changes in leading or trailing whitespace as diffs")},"diffEditor.renderIndicators":{type:"boolean",default:!0,description:Jt("renderIndicators","Controls if the diff editor shows +/- indicators for added/removed changes")}}}
I&&(Vu.properties["editor.selectionClipboard"]={type:"boolean",default:Ou.contribInfo.selectionClipboard,description:Jt("selectionClipboard","Controls if the Linux primary clipboard should be supported.")}),Wu.registerConfiguration(Vu)
class Bu extends ni{constructor(e,t){super(),this.referenceDomElement=e,this.changeCallback=t,this.measureReferenceDomElementToken=-1,this.width=-1,this.height=-1,this.measureReferenceDomElement(!1)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this.width}getHeight(){return this.height}startObserving(){-1===this.measureReferenceDomElementToken&&(this.measureReferenceDomElementToken=setInterval(()=>this.measureReferenceDomElement(!0),100))}stopObserving(){-1!==this.measureReferenceDomElementToken&&(clearInterval(this.measureReferenceDomElementToken),this.measureReferenceDomElementToken=-1)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let i=0,n=0
t?(i=t.width,n=t.height):this.referenceDomElement&&(i=this.referenceDomElement.clientWidth,n=this.referenceDomElement.clientHeight),i=Math.max(5,i),n=Math.max(5,n),this.width===i&&this.height===n||(this.width=i,this.height=n,e&&this.changeCallback())}}class Hu{constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}}const zu=Ir("storageService")
var Uu,Ku;(Ku=Uu||(Uu={}))[Ku.GLOBAL=0]="GLOBAL",Ku[Ku.WORKSPACE=1]="WORKSPACE"
const $u={_serviceBrand:void 0,store(){},remove(){},get:(e,t,i)=>i,getInteger:(e,t,i)=>i,getBoolean:(e,t,i)=>i}
class qu{constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){let t=e.getId()
return!!this._values[t]}get(e){let t=e.getId()
return this._values[t]}put(e,t){let i=e.getId()
this._keys[i]=e,this._values[i]=t}remove(e){let t=e.getId()
delete this._keys[t],delete this._values[t]}getKeys(){return Object.keys(this._keys).map(e=>this._keys[e])}getValues(){return Object.keys(this._keys).map(e=>this._values[e])}}class Gu extends ni{constructor(){super(),this._onDidChange=this._register(new ci),this.onDidChange=this._onDidChange.event,this._cache=new qu,this._evictUntrustedReadingsTimeout=-1}dispose(){-1!==this._evictUntrustedReadingsTimeout&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}_writeToCache(e,t){this._cache.put(e,t),t.isTrusted||-1!==this._evictUntrustedReadingsTimeout||(this._evictUntrustedReadingsTimeout=setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings()},5e3))}_evictUntrustedReadings(){let e=this._cache.getValues(),t=!1
for(let i=0,n=e.length;i<n;i++){let n=e[i]
n.isTrusted||(t=!0,this._cache.remove(n))}t&&this._onDidChange.fire()}saveFontInfo(){return this._cache.getValues().filter(e=>e.isTrusted)}restoreFontInfo(e){for(let t=0,i=e.length;t<i;t++){let i=new Tu(e[t],!1)
this._writeToCache(i,i)}}readConfiguration(e){if(!this._cache.has(e)){let t=Gu._actualReadConfiguration(e);(t.typicalHalfwidthCharacterWidth<=2||t.typicalFullwidthCharacterWidth<=2||t.spaceWidth<=2||t.maxDigitWidth<=2)&&(t=new Tu({zoomLevel:wa(),fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:t.isMonospace,typicalHalfwidthCharacterWidth:Math.max(t.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(t.typicalFullwidthCharacterWidth,5),spaceWidth:Math.max(t.spaceWidth,5),maxDigitWidth:Math.max(t.maxDigitWidth,5)},!1)),this._writeToCache(e,t)}return this._cache.get(e)}static createRequest(e,t,i,n){let s=new Hu(e,t)
return i.push(s),n&&n.push(s),s}static _actualReadConfiguration(e){const t=.6*e.fontSize,i=e.fontSize,n=ba.INSTANCE.getTimeSinceLastZoomLevelChanged()>2e3
return new Tu({zoomLevel:wa(),fontFamily:e.fontFamily,fontWeight:e.fontWeight,fontSize:e.fontSize,lineHeight:e.lineHeight,letterSpacing:e.letterSpacing,isMonospace:!0,typicalHalfwidthCharacterWidth:t,typicalFullwidthCharacterWidth:i,spaceWidth:t,maxDigitWidth:t},n)}}Gu.INSTANCE=new Gu
class ju extends Fu{static applyFontInfoSlow(e,t){e.style.fontFamily=t.fontFamily,e.style.fontWeight=t.fontWeight,e.style.fontSize=t.fontSize+"px",e.style.lineHeight=t.lineHeight+"px",e.style.letterSpacing=t.letterSpacing+"px"}static applyFontInfo(e,t){e.setFontFamily(t.fontFamily),e.setFontWeight(t.fontWeight),e.setFontSize(t.fontSize),e.setLineHeight(t.lineHeight),e.setLetterSpacing(t.letterSpacing)}constructor(e,t=null){var i
super(e),this._elementSizeObserver=this._register(new Bu(t,()=>this._onReferenceDomElementSizeChanged())),this._register(Gu.INSTANCE.onDidChange(()=>this._onCSSBasedConfigurationChanged())),this._validatedOptions.automaticLayout&&this._elementSizeObserver.startObserving(),this._register(va(e=>this._recomputeOptions())),this._register((i=(()=>this._recomputeOptions()),ba.INSTANCE.onDidChangeAccessibilitySupport(i))),this._recomputeOptions()}_onReferenceDomElementSizeChanged(){this._recomputeOptions()}_onCSSBasedConfigurationChanged(){this._recomputeOptions()}observeReferenceElement(e){this._elementSizeObserver.observe(e)}dispose(){super.dispose()}_getExtraEditorClassName(){let e=""
return xa?e+="ie ":Ea?e+="ff ":La&&(e+="edge "),k&&(e+="mac "),e}_getEnvConfiguration(){return{extraEditorClassName:this._getExtraEditorClassName(),outerWidth:this._elementSizeObserver.getWidth(),outerHeight:this._elementSizeObserver.getHeight(),emptySelectionClipboard:ka,pixelRatio:Sa(),zoomLevel:wa(),accessibilitySupport:ba.INSTANCE.getAccessibilitySupport()}}readConfiguration(e){return Gu.INSTANCE.readConfiguration(e)}}class Yu{constructor(e){this.domNode=e,this._maxWidth=-1,this._width=-1,this._height=-1,this._top=-1,this._left=-1,this._bottom=-1,this._right=-1,this._fontFamily="",this._fontWeight="",this._fontSize=-1,this._lineHeight=-1,this._letterSpacing=-100,this._className="",this._display="",this._position="",this._visibility="",this._layerHint=!1}setMaxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.domNode.style.maxWidth=this._maxWidth+"px")}setWidth(e){this._width!==e&&(this._width=e,this.domNode.style.width=this._width+"px")}unsetWidth(){-1!==this._width&&(this._width=-1,this.domNode.style.width="")}setHeight(e){this._height!==e&&(this._height=e,this.domNode.style.height=this._height+"px")}unsetHeight(){-1!==this._height&&(this._height=-1,this.domNode.style.height="")}setTop(e){this._top!==e&&(this._top=e,this.domNode.style.top=this._top+"px")}unsetTop(){-1!==this._top&&(this._top=-1,this.domNode.style.top="")}setLeft(e){this._left!==e&&(this._left=e,this.domNode.style.left=this._left+"px")}setBottom(e){this._bottom!==e&&(this._bottom=e,this.domNode.style.bottom=this._bottom+"px")}setRight(e){this._right!==e&&(this._right=e,this.domNode.style.right=this._right+"px")}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){this._fontSize!==e&&(this._fontSize=e,this.domNode.style.fontSize=this._fontSize+"px")}setLineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.domNode.style.lineHeight=this._lineHeight+"px")}setLetterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.domNode.style.letterSpacing=this._letterSpacing+"px")}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){el(this.domNode,e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.willChange=this._layerHint?"transform":"auto")}setAttribute(e,t){this.domNode.setAttribute(e,t)}getAttribute(e){return this.domNode.getAttribute(e)}removeAttribute(e){this.domNode.removeAttribute(e)}hasAttribute(e){return this.domNode.hasAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}}function Zu(e){return new Yu(e)}class Xu extends ni{constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}onThemeChanged(e){return!1}handleEvents(e){let t=!1
for(let i=0,n=e.length;i<n;i++){let n=e[i]
switch(n.type){case 1:this.onConfigurationChanged(n)&&(t=!0)
break
case 2:this.onCursorStateChanged(n)&&(t=!0)
break
case 3:this.onDecorationsChanged(n)&&(t=!0)
break
case 4:this.onFlushed(n)&&(t=!0)
break
case 5:this.onFocusChanged(n)&&(t=!0)
break
case 16:this.onLanguageConfigurationChanged(n)&&(t=!0)
break
case 6:this.onLineMappingChanged(n)&&(t=!0)
break
case 7:this.onLinesChanged(n)&&(t=!0)
break
case 8:this.onLinesDeleted(n)&&(t=!0)
break
case 9:this.onLinesInserted(n)&&(t=!0)
break
case 10:this.onRevealRangeRequest(n)&&(t=!0)
break
case 11:this.onScrollChanged(n)&&(t=!0)
break
case 12:this.onTokensChanged(n)&&(t=!0)
break
case 13:this.onTokensColorsChanged(n)&&(t=!0)
break
case 14:this.onZonesChanged(n)&&(t=!0)
break
case 15:this.onThemeChanged(n)&&(t=!0)
break
default:console.info("View received unknown event: "),console.info(n)}}t&&(this._shouldRender=!0)}}class Ju{constructor(e,t,i,n,s){this.value=e,this.selectionStart=t,this.selectionEnd=i,this.selectionStartPosition=n,this.selectionEndPosition=s}equals(t){return t instanceof Ju&&(this.value===t.value&&this.selectionStart===t.selectionStart&&this.selectionEnd===t.selectionEnd&&e.equals(this.selectionStartPosition,t.selectionStartPosition)&&e.equals(this.selectionEndPosition,t.selectionEndPosition))}toString(){return"[ <"+this.value+">, selectionStart: "+this.selectionStart+", selectionEnd: "+this.selectionEnd+"]"}readFromTextArea(e){return new Ju(e.getValue(),e.getSelectionStart(),e.getSelectionEnd(),null,null)}collapseSelection(){return new Ju(this.value,this.value.length,this.value.length,null,null)}writeToTextArea(e,t,i){t.setValue(e,this.value),i&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){if(e<=this.selectionStart){const t=this.value.substring(e,this.selectionStart)
return this._finishDeduceEditorPosition(this.selectionStartPosition,t,-1)}if(e>=this.selectionEnd){const t=this.value.substring(this.selectionEnd,e)
return this._finishDeduceEditorPosition(this.selectionEndPosition,t,1)}const t=this.value.substring(this.selectionStart,e)
if(-1===t.indexOf(String.fromCharCode(8230)))return this._finishDeduceEditorPosition(this.selectionStartPosition,t,1)
const i=this.value.substring(e,this.selectionEnd)
return this._finishDeduceEditorPosition(this.selectionEndPosition,i,-1)}_finishDeduceEditorPosition(e,t,i){let n=0,s=-1
for(;-1!==(s=t.indexOf("\n",s+1));)n++
return[e,i*t.length,n]}static selectedText(e){return new Ju(e,0,e.length,null,null)}static deduceInput(e,t,i){if(!e)return{text:"",replaceCharCnt:0}
let n=e.value,s=e.selectionStart,r=e.selectionEnd,o=t.value,a=t.selectionStart,l=t.selectionEnd
const h=Fe(n.substring(r),o.substring(l))
o=o.substring(0,o.length-h)
const d=(n=n.substring(0,n.length-h)).substring(0,s),u=Pe(d,o.substring(0,a))
if(o=o.substring(u),n=n.substring(u),a-=u,s-=u,l-=u,r-=u,i&&a===l&&n.length>0){let e=null
if(a===o.length?fe(o,n)&&(e=o.substring(n.length)):_e(o,n)&&(e=o.substring(0,o.length-n.length)),null!==e&&e.length>0&&(/\uFE0F/.test(e)||Ke(e)))return{text:e,replaceCharCnt:0}}if(a===l){if(n===o&&0===s&&r===n.length&&a===o.length&&-1===o.indexOf("\n")&&Ge(o))return{text:"",replaceCharCnt:0}
return{text:o,replaceCharCnt:d.length-u}}return{text:o,replaceCharCnt:r-s}}}Ju.EMPTY=new Ju("",0,0,null,null)
class Qu{static _getPageOfLine(e){return Math.floor((e-1)/Qu._LINES_PER_PAGE)}static _getRangeForPage(e){let i=e*Qu._LINES_PER_PAGE,n=i+1,s=i+Qu._LINES_PER_PAGE
return new t(n,1,s+1,1)}static fromEditorSelection(i,n,r,o){let a=Qu._getPageOfLine(r.startLineNumber),l=Qu._getRangeForPage(a),h=Qu._getPageOfLine(r.endLineNumber),d=Qu._getRangeForPage(h),u=l.intersectRanges(new t(1,1,r.startLineNumber,r.startColumn)),c=n.getValueInRange(u,s.LF),g=n.getLineCount(),m=n.getLineMaxColumn(g),p=d.intersectRanges(new t(r.endLineNumber,r.endColumn,g,m)),f=n.getValueInRange(p,s.LF),_=null
if(a===h||a+1===h)_=n.getValueInRange(r,s.LF)
else{let e=l.intersectRanges(r),t=d.intersectRanges(r)
_=n.getValueInRange(e,s.LF)+String.fromCharCode(8230)+n.getValueInRange(t,s.LF)}if(o){const e=500
c.length>e&&(c=c.substring(c.length-e,c.length)),f.length>e&&(f=f.substring(0,e)),_.length>2*e&&(_=_.substring(0,e)+String.fromCharCode(8230)+_.substring(_.length-e,_.length))}return new Ju(c+_+f,c.length,c.length+_.length,new e(r.startLineNumber,r.startColumn),new e(r.endLineNumber,r.endColumn))}}Qu._LINES_PER_PAGE=10
const ec={forceCopyWithSyntaxHighlighting:!1}
class tc extends ni{constructor(e,t){super(),this._onFocus=this._register(new ci),this.onFocus=this._onFocus.event,this._onBlur=this._register(new ci),this.onBlur=this._onBlur.event,this._onKeyDown=this._register(new ci),this.onKeyDown=this._onKeyDown.event,this._onKeyUp=this._register(new ci),this.onKeyUp=this._onKeyUp.event,this._onCut=this._register(new ci),this.onCut=this._onCut.event,this._onPaste=this._register(new ci),this.onPaste=this._onPaste.event,this._onType=this._register(new ci),this.onType=this._onType.event,this._onCompositionStart=this._register(new ci),this.onCompositionStart=this._onCompositionStart.event,this._onCompositionUpdate=this._register(new ci),this.onCompositionUpdate=this._onCompositionUpdate.event,this._onCompositionEnd=this._register(new ci),this.onCompositionEnd=this._onCompositionEnd.event,this._onSelectionChangeRequest=this._register(new ci),this.onSelectionChangeRequest=this._onSelectionChangeRequest.event,this._host=e,this._textArea=this._register(new nc(t)),this._asyncTriggerCut=this._register(new Ca(()=>this._onCut.fire(),0)),this._textAreaState=Ju.EMPTY,this.writeScreenReaderContent("ctor"),this._hasFocus=!1,this._isDoingComposition=!1,this._nextCommand=0,this._register(nl(t.domNode,"keydown",e=>{this._isDoingComposition&&109===e.keyCode&&e.stopPropagation(),e.equals(9)&&e.preventDefault(),this._onKeyDown.fire(e)})),this._register(nl(t.domNode,"keyup",e=>{this._onKeyUp.fire(e)})),this._register(il(t.domNode,"compositionstart",e=>{this._isDoingComposition||(this._isDoingComposition=!0,Na||this._setAndWriteTextAreaState("compositionstart",Ju.EMPTY),this._onCompositionStart.fire())}))
const i=e=>{const t=this._textAreaState,i=this._textAreaState.readFromTextArea(this._textArea)
return[i,Ju.deduceInput(t,i,e)]},n=e=>{const t=this._textAreaState,i=Ju.selectedText(e)
return[i,{text:i.value,replaceCharCnt:t.selectionEnd-t.selectionStart}]}
this._register(il(t.domNode,"compositionupdate",e=>{if(Ta)return
if(Na&&"ja"===e.locale){const[t,n]=i(!1)
return this._textAreaState=t,this._onType.fire(n),void this._onCompositionUpdate.fire(e)}const[t,s]=n(e.data)
this._textAreaState=t,this._onType.fire(s),this._onCompositionUpdate.fire(e)})),this._register(il(t.domNode,"compositionend",e=>{if(Na&&"ja"===e.locale){const[e,t]=i(!1)
this._textAreaState=e,this._onType.fire(t)}else{const[t,i]=n(e.data)
this._textAreaState=t,this._onType.fire(i)}(Na||Ia)&&(this._textAreaState=this._textAreaState.readFromTextArea(this._textArea)),this._isDoingComposition&&(this._isDoingComposition=!1,this._onCompositionEnd.fire())})),this._register(il(t.domNode,"input",()=>{if(this._textArea.setIgnoreSelectionChangeTime("received input event"),this._isDoingComposition){if(Ta){const[e,t]=n(this._textArea.getValue())
this._textAreaState=e,this._onType.fire(t)
let i={data:t.text}
this._onCompositionUpdate.fire(i)}return}const[e,t]=i(k)
0===t.replaceCharCnt&&1===t.text.length&&Ve(t.text.charCodeAt(0))||(this._textAreaState=e,0===this._nextCommand?""!==t.text&&this._onType.fire(t):(""!==t.text&&this._onPaste.fire({text:t.text}),this._nextCommand=0))})),this._register(il(t.domNode,"cut",e=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(e),this._asyncTriggerCut.schedule()})),this._register(il(t.domNode,"copy",e=>{this._ensureClipboardGetsEditorSelection(e)})),this._register(il(t.domNode,"paste",e=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),ic.canUseTextData(e)){const t=ic.getTextData(e)
""!==t&&this._onPaste.fire({text:t})}else this._textArea.getSelectionStart()!==this._textArea.getSelectionEnd()&&this._setAndWriteTextAreaState("paste",Ju.EMPTY),this._nextCommand=1})),this._register(il(t.domNode,"focus",()=>this._setHasFocus(!0))),this._register(il(t.domNode,"blur",()=>this._setHasFocus(!1)))
let s=0
this._register(il(document,"selectionchange",e=>{if(!this._hasFocus)return
if(this._isDoingComposition)return
if(!Ia||!E)return
const t=Date.now(),i=t-s
if(s=t,i<5)return
const n=t-this._textArea.getIgnoreSelectionChangeTime()
if(this._textArea.resetSelectionChangeTime(),n<100)return
if(!this._textAreaState.selectionStartPosition||!this._textAreaState.selectionEndPosition)return
const r=this._textArea.getValue()
if(this._textAreaState.value!==r)return
const o=this._textArea.getSelectionStart(),a=this._textArea.getSelectionEnd()
if(this._textAreaState.selectionStart===o&&this._textAreaState.selectionEnd===a)return
const l=this._textAreaState.deduceEditorPosition(o),h=this._host.deduceModelPosition(l[0],l[1],l[2]),d=this._textAreaState.deduceEditorPosition(a),u=this._host.deduceModelPosition(d[0],d[1],d[2]),c=new At(h.lineNumber,h.column,u.lineNumber,u.column)
this._onSelectionChangeRequest.fire(c)}))}dispose(){super.dispose()}focusTextArea(){this._setHasFocus(!0)}isFocused(){return this._hasFocus}_setHasFocus(e){this._hasFocus!==e&&(this._hasFocus=e,this._hasFocus&&(La?this._setAndWriteTextAreaState("focusgain",Ju.EMPTY):this.writeScreenReaderContent("focusgain")),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(e,t){this._hasFocus||(t=t.collapseSelection()),t.writeToTextArea(e,this._textArea,this._hasFocus),this._textAreaState=t}writeScreenReaderContent(e){this._isDoingComposition||this._setAndWriteTextAreaState(e,this._host.getScreenReaderContent(this._textAreaState))}_ensureClipboardGetsEditorSelection(e){const t=this._host.getPlainTextToCopy()
if(!ic.canUseTextData(e))return void this._setAndWriteTextAreaState("copy or cut",Ju.selectedText(t))
let i=null
!Na&&(t.length<65536||ec.forceCopyWithSyntaxHighlighting)&&(i=this._host.getHTMLToCopy()),ic.setTextData(e,t,i)}}class ic{static canUseTextData(e){return!!e.clipboardData||!!window.clipboardData}static getTextData(e){if(e.clipboardData)return e.preventDefault(),e.clipboardData.getData("text/plain")
if(window.clipboardData)return e.preventDefault(),window.clipboardData.getData("Text")
throw new Error("ClipboardEventUtils.getTextData: Cannot use text data!")}static setTextData(e,t,i){if(e.clipboardData)return e.clipboardData.setData("text/plain",t),null!==i&&e.clipboardData.setData("text/html",i),void e.preventDefault()
if(window.clipboardData)return window.clipboardData.setData("Text",t),void e.preventDefault()
throw new Error("ClipboardEventUtils.setTextData: Cannot use text data!")}}class nc extends ni{constructor(e){super(),this._actual=e,this._ignoreSelectionChangeTime=0}setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.domNode.value}setValue(e,t){const i=this._actual.domNode
i.value!==t&&(this.setIgnoreSelectionChangeTime("setValue"),i.value=t)}getSelectionStart(){return this._actual.domNode.selectionStart}getSelectionEnd(){return this._actual.domNode.selectionEnd}setSelectionRange(e,t,i){const n=this._actual.domNode,s=document.activeElement===n,r=n.selectionStart,o=n.selectionEnd
if(!s||r!==t||o!==i){if(s)return this.setIgnoreSelectionChangeTime("setSelectionRange"),void n.setSelectionRange(t,i)
try{const e=function(e){let t=[]
for(let i=0;e&&e.nodeType===e.ELEMENT_NODE;i++)t[i]=e.scrollTop,e=e.parentNode
return t}(n)
this.setIgnoreSelectionChangeTime("setSelectionRange"),n.focus(),n.setSelectionRange(t,i),function(e,t){for(let i=0;e&&e.nodeType===e.ELEMENT_NODE;i++)e.scrollTop!==t[i]&&(e.scrollTop=t[i]),e=e.parentNode}(n,e)}catch(e){}}}}class sc extends Xu{constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._context=null,super.dispose()}}class rc{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){let t=e.getAttribute("data-mprt")
return null===t?0:parseInt(t,10)}static collect(e,t){let i=[],n=0
for(;e&&e!==document.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(i[n++]=this.read(e)),e=e.parentElement
let s=new Uint8Array(n)
for(let e=0;e<n;e++)s[e]=i[n-e-1]
return s}}class oc extends sc{constructor(e){super(e),this._canUseLayerHinting=this._context.configuration.editor.canUseLayerHinting,this._contentLeft=this._context.configuration.editor.layoutInfo.contentLeft,this._glyphMarginLeft=this._context.configuration.editor.layoutInfo.glyphMarginLeft,this._glyphMarginWidth=this._context.configuration.editor.layoutInfo.glyphMarginWidth,this._domNode=this._createDomNode()}dispose(){super.dispose()}getDomNode(){return this._domNode}_createDomNode(){let e=Zu(document.createElement("div"))
return e.setClassName("margin"),e.setPosition("absolute"),e.setAttribute("role","presentation"),e.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=Zu(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(oc.CLASS_NAME),e.appendChild(this._glyphMarginBackgroundDomNode),e}onConfigurationChanged(e){return e.canUseLayerHinting&&(this._canUseLayerHinting=this._context.configuration.editor.canUseLayerHinting),e.layoutInfo&&(this._contentLeft=this._context.configuration.editor.layoutInfo.contentLeft,this._glyphMarginLeft=this._context.configuration.editor.layoutInfo.glyphMarginLeft,this._glyphMarginWidth=this._context.configuration.editor.layoutInfo.glyphMarginWidth),!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting)
const t=e.scrollTop-e.bigNumbersDelta
this._domNode.setTop(-t)
let i=Math.min(e.scrollHeight,1e6)
this._domNode.setHeight(i),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(i)}}oc.CLASS_NAME="glyph-margin"
const ac="base.contributions.colors"
const lc=new class{constructor(){this.colorSchema={type:"object",description:Jt("schema.colors","Colors used in the workbench."),properties:{},additionalProperties:!1},this.colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]},this.colorsById={}}registerColor(e,t,i){let n={id:e,description:i,defaults:t}
return this.colorsById[e]=n,this.colorSchema.properties[e]={type:"string",description:i,format:"color-hex",default:"#ff0000"},this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(i),e}getColors(){return Object.keys(this.colorsById).map(e=>this.colorsById[e])}resolveDefaultColor(e,t){let i=this.colorsById[e]
return i&&i.defaults?Ig(i.defaults[t.type],t):null}getColorSchema(){return this.colorSchema}getColorReferenceSchema(){return this.colorReferenceSchema}toString(){return Object.keys(this.colorsById).sort((e,t)=>{let i=-1===e.indexOf(".")?0:1,n=-1===t.indexOf(".")?0:1
return i!==n?i-n:e.localeCompare(t)}).map(e=>`- \`${e}\`: ${this.colorsById[e].description}`).join("\n")}}
function hc(e,t,i){return lc.registerColor(e,t,i)}qr.add(ac,lc)
const dc=hc("foreground",{dark:"#CCCCCC",light:"#6C6C6C",hc:"#FFFFFF"},Jt("foreground","Overall foreground color. This color is only used if not overridden by a component.")),uc=hc("errorForeground",{dark:"#F48771",light:"#A1260D",hc:"#F48771"},Jt("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component.")),cc=(hc("descriptionForeground",{light:Ng(dc,.7),dark:Ng(dc,.7),hc:Ng(dc,.7)},Jt("descriptionForeground","Foreground color for description text providing additional information, for example for a label.")),hc("focusBorder",{dark:Td.fromHex("#0E639C").transparent(.6),light:Td.fromHex("#007ACC").transparent(.4),hc:"#F38518"},Jt("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component."))),gc=hc("contrastBorder",{light:null,dark:null,hc:"#6FC3DF"},Jt("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),mc=hc("contrastActiveBorder",{light:null,dark:null,hc:cc},Jt("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast.")),pc=(hc("selection.background",{light:null,dark:null,hc:null},Jt("selectionBackground","The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor.")),hc("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hc:Td.black},Jt("textSeparatorForeground","Color for text separators.")),hc("textLink.foreground",{light:"#4080D0",dark:"#4080D0",hc:"#4080D0"},Jt("textLinkForeground","Foreground color for links in text."))),fc=(hc("textLink.activeForeground",{light:"#4080D0",dark:"#4080D0",hc:"#4080D0"},Jt("textLinkActiveForeground","Foreground color for active links in text.")),hc("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hc:"#D7BA7D"},Jt("textPreformatForeground","Foreground color for preformatted text segments.")),hc("textBlockQuote.background",{light:"#7f7f7f1a",dark:"#7f7f7f1a",hc:null},Jt("textBlockQuoteBackground","Background color for block quotes in text.")),hc("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hc:Td.white},Jt("textBlockQuoteBorder","Border color for block quotes in text.")),hc("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hc:Td.black},Jt("textCodeBlockBackground","Background color for code blocks in text."))),_c=hc("widget.shadow",{dark:"#000000",light:"#A8A8A8",hc:null},Jt("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),Cc=hc("input.background",{dark:"#3C3C3C",light:Td.white,hc:Td.black},Jt("inputBoxBackground","Input box background.")),bc=hc("input.foreground",{dark:dc,light:dc,hc:dc},Jt("inputBoxForeground","Input box foreground.")),wc=hc("input.border",{dark:null,light:null,hc:gc},Jt("inputBoxBorder","Input box border.")),vc=hc("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hc:mc},Jt("inputBoxActiveOptionBorder","Border color of activated options in input fields.")),Sc=(hc("input.placeholderForeground",{dark:null,light:null,hc:null},Jt("inputPlaceholderForeground","Input box foreground color for placeholder text.")),hc("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hc:Td.black},Jt("inputValidationInfoBackground","Input validation background color for information severity."))),yc=hc("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hc:gc},Jt("inputValidationInfoBorder","Input validation border color for information severity.")),xc=hc("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hc:Td.black},Jt("inputValidationWarningBackground","Input validation background color for information warning.")),Lc=hc("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hc:gc},Jt("inputValidationWarningBorder","Input validation border color for warning severity.")),Nc=hc("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hc:Td.black},Jt("inputValidationErrorBackground","Input validation background color for error severity.")),Ec=hc("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hc:gc},Jt("inputValidationErrorBorder","Input validation border color for error severity.")),kc=hc("dropdown.background",{dark:"#3C3C3C",light:Td.white,hc:Td.black},Jt("dropdownBackground","Dropdown background.")),Ic=(hc("dropdown.foreground",{dark:"#F0F0F0",light:null,hc:Td.white},Jt("dropdownForeground","Dropdown foreground.")),hc("dropdown.border",{dark:kc,light:"#CECECE",hc:gc},Jt("dropdownBorder","Dropdown border.")),hc("list.focusBackground",{dark:"#073655",light:"#DCEBFC",hc:null},Jt("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not."))),Mc=hc("list.focusForeground",{dark:null,light:null,hc:null},Jt("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Dc=hc("list.activeSelectionBackground",{dark:"#094771",light:"#3399FF",hc:null},Jt("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Tc=hc("list.activeSelectionForeground",{dark:Td.white,light:Td.white,hc:null},Jt("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Oc=hc("list.inactiveSelectionBackground",{dark:"#3F3F46",light:"#CCCEDB",hc:null},Jt("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),Rc=hc("list.inactiveSelectionForeground",{dark:null,light:null,hc:null},Jt("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),Ac=hc("list.inactiveFocusBackground",{dark:"#313135",light:"#d8dae6",hc:null},Jt("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),Pc=hc("list.inactiveFocusForeground",{dark:null,light:null,hc:null},Jt("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),Fc=hc("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hc:null},Jt("listHoverBackground","List/Tree background when hovering over items using the mouse.")),Wc=hc("list.hoverForeground",{dark:null,light:null,hc:null},Jt("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),Vc=hc("list.dropBackground",{dark:Ic,light:Ic,hc:null},Jt("listDropBackground","List/Tree drag and drop background when moving items around using the mouse.")),Bc=hc("list.highlightForeground",{dark:"#0097fb",light:"#007acc",hc:cc},Jt("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree.")),Hc=(hc("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hc:"#B89500"},Jt("invalidItemForeground","List/Tree foreground color for invalid items, for example an unresolved root in explorer.")),hc("pickerGroup.foreground",{dark:Td.fromHex("#0097FB").transparent(.6),light:Td.fromHex("#007ACC").transparent(.6),hc:Td.white},Jt("pickerGroupForeground","Quick picker color for grouping labels."))),zc=hc("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hc:Td.white},Jt("pickerGroupBorder","Quick picker color for grouping borders.")),Uc=(hc("button.foreground",{dark:Td.white,light:Td.white,hc:Td.white},Jt("buttonForeground","Button foreground color.")),hc("button.background",{dark:"#0E639C",light:"#007ACC",hc:null},Jt("buttonBackground","Button background color.")))
hc("button.hoverBackground",{dark:Lg(Uc,.2),light:(Kc=Uc,$c=.2,e=>{let t=Ig(Kc,e)
return t?t.darken($c):null}),hc:null},Jt("buttonHoverBackground","Button background color when hovering."))
var Kc,$c
const qc=hc("badge.background",{dark:"#4D4D4D",light:"#BEBEBE",hc:Td.black},Jt("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),Gc=hc("badge.foreground",{dark:Td.white,light:Td.white,hc:Td.white},Jt("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),jc=hc("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hc:null},Jt("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),Yc=hc("scrollbarSlider.background",{dark:Td.fromHex("#797979").transparent(.4),light:Td.fromHex("#646464").transparent(.4),hc:Ng(gc,.6)},Jt("scrollbarSliderBackground","Scrollbar slider background color.")),Zc=hc("scrollbarSlider.hoverBackground",{dark:Td.fromHex("#646464").transparent(.7),light:Td.fromHex("#646464").transparent(.7),hc:Ng(gc,.8)},Jt("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),Xc=hc("scrollbarSlider.activeBackground",{dark:Td.fromHex("#BFBFBF").transparent(.4),light:Td.fromHex("#000000").transparent(.6),hc:gc},Jt("scrollbarSliderActiveBackground","Scrollbar slider background color when active.")),Jc=hc("progressBar.background",{dark:Td.fromHex("#0E70C0"),light:Td.fromHex("#0E70C0"),hc:gc},Jt("progressBarBackground","Background color of the progress bar that can show for long running operations.")),Qc=hc("editor.background",{light:"#fffffe",dark:"#1E1E1E",hc:Td.black},Jt("editorBackground","Editor background color.")),eg=hc("editor.foreground",{light:"#333333",dark:"#BBBBBB",hc:Td.white},Jt("editorForeground","Editor default foreground color.")),tg=hc("editorWidget.background",{dark:"#2D2D30",light:"#EFEFF2",hc:"#0C141F"},Jt("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),ig=hc("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hc:gc},Jt("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget.")),ng=hc("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hc:"#f3f518"},Jt("editorSelectionBackground","Color of the editor selection.")),sg=hc("editor.selectionForeground",{light:null,dark:null,hc:"#000000"},Jt("editorSelectionForeground","Color of the selected text for high contrast.")),rg=hc("editor.inactiveSelectionBackground",{light:Ng(ng,.5),dark:Ng(ng,.5),hc:Ng(ng,.5)},Jt("editorInactiveSelection","Color of the selection in an inactive editor.")),og=hc("editor.selectionHighlightBackground",{light:kg(ng,Qc,.3,.6),dark:kg(ng,Qc,.3,.6),hc:null},Jt("editorSelectionHighlight","Color for regions with the same content as the selection.")),ag=hc("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hc:null},Jt("editorFindMatch","Color of the current search match.")),lg=hc("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hc:null},Jt("findMatchHighlight","Color of the other search matches.")),hg=hc("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hc:null},Jt("findRangeHighlight","Color the range limiting the search.")),dg=hc("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hc:"#ADD6FF26"},Jt("hoverHighlight","Highlight below the word for which a hover is shown.")),ug=hc("editorHoverWidget.background",{light:tg,dark:tg,hc:tg},Jt("hoverBackground","Background color of the editor hover.")),cg=hc("editorHoverWidget.border",{light:ig,dark:ig,hc:ig},Jt("hoverBorder","Border color of the editor hover.")),gg=hc("editorLink.activeForeground",{dark:"#4E94CE",light:Td.blue,hc:Td.cyan},Jt("activeLinkForeground","Color of active links.")),mg=new Td(new Id(155,185,85,.2)),pg=new Td(new Id(255,0,0,.2)),fg=(hc("diffEditor.insertedTextBackground",{dark:mg,light:mg,hc:null},Jt("diffEditorInserted","Background color for text that got inserted.")),hc("diffEditor.removedTextBackground",{dark:pg,light:pg,hc:null},Jt("diffEditorRemoved","Background color for text that got removed.")),hc("diffEditor.insertedTextBorder",{dark:null,light:null,hc:"#33ff2eff"},Jt("diffEditorInsertedOutline","Outline color for the text that got inserted.")),hc("diffEditor.removedTextBorder",{dark:null,light:null,hc:"#FF008F"},Jt("diffEditorRemovedOutline","Outline color for text that got removed.")),Td.fromHex("#40C8AE").transparent(.5)),_g=Td.fromHex("#40A6FF").transparent(.5),Cg=Td.fromHex("#606060").transparent(.4),bg=hc("merge.currentHeaderBackground",{dark:fg,light:fg,hc:null},Jt("mergeCurrentHeaderBackground","Current header background in inline merge-conflicts.")),wg=(hc("merge.currentContentBackground",{dark:Ng(bg,.4),light:Ng(bg,.4),hc:Ng(bg,.4)},Jt("mergeCurrentContentBackground","Current content background in inline merge-conflicts.")),hc("merge.incomingHeaderBackground",{dark:_g,light:_g,hc:null},Jt("mergeIncomingHeaderBackground","Incoming header background in inline merge-conflicts."))),vg=(hc("merge.incomingContentBackground",{dark:Ng(wg,.4),light:Ng(wg,.4),hc:Ng(wg,.4)},Jt("mergeIncomingContentBackground","Incoming content background in inline merge-conflicts.")),hc("merge.commonHeaderBackground",{dark:Cg,light:Cg,hc:null},Jt("mergeCommonHeaderBackground","Common ancestor header background in inline merge-conflicts."))),Sg=(hc("merge.commonContentBackground",{dark:Ng(vg,.4),light:Ng(vg,.4),hc:Ng(vg,.4)},Jt("mergeCommonContentBackground","Common ancester content background in inline merge-conflicts.")),hc("merge.border",{dark:null,light:null,hc:"#C3DF6F"},Jt("mergeBorder","Border color on headers and the splitter in inline merge-conflicts."))),yg=(hc("editorOverviewRuler.currentContentForeground",{dark:Ng(bg,1),light:Ng(bg,1),hc:Sg},Jt("overviewRulerCurrentContentForeground","Current overview ruler foreground for inline merge-conflicts.")),hc("editorOverviewRuler.incomingContentForeground",{dark:Ng(wg,1),light:Ng(wg,1),hc:Sg},Jt("overviewRulerIncomingContentForeground","Incoming overview ruler foreground for inline merge-conflicts.")),hc("editorOverviewRuler.commonContentForeground",{dark:Ng(vg,1),light:Ng(vg,1),hc:Sg},Jt("overviewRulerCommonContentForeground","Common ancestor overview ruler foreground for inline merge-conflicts.")),new Td(new Id(246,185,77,.7))),xg=(hc("editorOverviewRuler.findMatchForeground",{dark:yg,light:yg,hc:yg},Jt("overviewRulerFindMatchForeground","Overview ruler marker color for find matches.")),hc("editorOverviewRuler.selectionHighlightForeground",{dark:"#A0A0A0",light:"#A0A0A0",hc:"#A0A0A0"},Jt("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights.")))
function Lg(e,t){return i=>{let n=Ig(e,i)
return n?n.lighten(t):null}}function Ng(e,t){return i=>{let n=Ig(e,i)
return n?n.transparent(t):null}}function Eg(...e){return t=>{for(let i of e){let e=Ig(i,t)
if(e)return e}return null}}function kg(e,t,i,n){return s=>{let r=Ig(e,s)
if(r){let e=Ig(t,s)
return e?r.isDarkerThan(e)?Td.getLighterColor(r,e,i).transparent(n):Td.getDarkerColor(r,e,i).transparent(n):r.transparent(i*n)}return null}}function Ig(e,t){return null===e?null:"string"==typeof e?"#"===e[0]?Td.fromHex(e):t.getColor(e):e instanceof Td?e:"function"==typeof e?e(t):null}const Mg=Ir("themeService")
function Dg(e){return{id:e}}const Tg="dark",Og="light",Rg="hc"
function Ag(e){switch(e){case Tg:return"vs-dark"
case Rg:return"hc-black"
default:return"vs"}}const Pg="base.contributions.theming"
let Fg=new class{constructor(){this.themingParticipants=[],this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new ci}onThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),{dispose:()=>{const t=this.themingParticipants.indexOf(e)
this.themingParticipants.splice(t,1)}}}get onThemingParticipantAdded(){return this.onThemingParticipantAddedEmitter.event}getThemingParticipants(){return this.themingParticipants}}
function Wg(e){return Fg.onThemeChange(e)}qr.add(Pg,Fg)
const Vg=hc("editor.lineHighlightBackground",{dark:null,light:null,hc:null},Jt("lineHighlight","Background color for the highlight of line at the cursor position.")),Bg=hc("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hc:"#f38518"},Jt("lineHighlightBorderBox","Background color for the border around the line at the cursor position.")),Hg=hc("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hc:null},Jt("rangeHighlight","Background color of highlighted ranges, like by quick open and find features.")),zg=hc("editorCursor.foreground",{dark:"#AEAFAD",light:Td.black,hc:Td.white},Jt("caret","Color of the editor cursor.")),Ug=hc("editorCursor.background",null,Jt("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),Kg=hc("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hc:"#e3e4e229"},Jt("editorWhitespaces","Color of whitespace characters in the editor.")),$g=hc("editorIndentGuide.background",{dark:Kg,light:Kg,hc:Kg},Jt("editorIndentGuides","Color of the editor indentation guides.")),qg=hc("editorLineNumber.foreground",{dark:"#5A5A5A",light:"#2B91AF",hc:Td.white},Jt("editorLineNumbers","Color of editor line numbers.")),Gg=hc("editorRuler.foreground",{dark:"#5A5A5A",light:Td.lightgrey,hc:Td.white},Jt("editorRuler","Color of the editor rulers.")),jg=(hc("editorCodeLens.foreground",{dark:"#999999",light:"#999999",hc:"#999999"},Jt("editorCodeLensForeground","Foreground color of editor code lenses")),hc("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hc:"#0064001a"},Jt("editorBracketMatchBackground","Background color behind matching brackets"))),Yg=hc("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hc:"#fff"},Jt("editorBracketMatchBorder","Color for matching brackets boxes")),Zg=hc("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hc:"#7f7f7f4d"},Jt("editorOverviewRulerBorder","Color of the overview ruler border.")),Xg=hc("editorGutter.background",{dark:Qc,light:Qc,hc:Qc},Jt("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers.")),Jg=hc("editorError.foreground",{dark:"#FF0000",light:"#FF0000",hc:null},Jt("errorForeground","Foreground color of error squigglies in the editor.")),Qg=hc("editorError.border",{dark:null,light:null,hc:Td.fromHex("#E47777").transparent(.8)},Jt("errorBorder","Border color of error squigglies in the editor.")),em=hc("editorWarning.foreground",{dark:"#008000",light:"#008000",hc:null},Jt("warningForeground","Foreground color of warning squigglies in the editor.")),tm=hc("editorWarning.border",{dark:null,light:null,hc:Td.fromHex("#71B771").transparent(.8)},Jt("warningBorder","Border color of warning squigglies in the editor.")),im=hc("editorInfo.foreground",{dark:"#008000",light:"#008000",hc:null},Jt("infoForeground","Foreground color of info squigglies in the editor.")),nm=hc("editorInfo.border",{dark:null,light:null,hc:Td.fromHex("#71B771").transparent(.8)},Jt("infoBorder","Border color of info squigglies in the editor.")),sm=new Td(new Id(0,122,204,.6)),rm=(hc("editorOverviewRuler.rangeHighlightForeground",{dark:sm,light:sm,hc:sm},Jt("overviewRulerRangeHighlight","Overview ruler marker color for range highlights.")),hc("editorOverviewRuler.errorForeground",{dark:new Td(new Id(255,18,18,.7)),light:new Td(new Id(255,18,18,.7)),hc:new Td(new Id(255,50,50,1))},Jt("overviewRuleError","Overview ruler marker color for errors."))),om=hc("editorOverviewRuler.warningForeground",{dark:new Td(new Id(18,136,18,.7)),light:new Td(new Id(18,136,18,.7)),hc:new Td(new Id(50,255,50,1))},Jt("overviewRuleWarning","Overview ruler marker color for warnings.")),am=hc("editorOverviewRuler.infoForeground",{dark:new Td(new Id(18,18,136,.7)),light:new Td(new Id(18,18,136,.7)),hc:new Td(new Id(50,50,255,1))},Jt("overviewRuleInfo","Overview ruler marker color for infos."))
Wg((e,t)=>{let i=e.getColor(Qc)
i&&t.addRule(`.monaco-editor, .monaco-editor-background, .monaco-editor .inputarea.ime-input { background-color: ${i}; }`)
let n=e.getColor(eg)
n&&t.addRule(`.monaco-editor, .monaco-editor .inputarea.ime-input { color: ${n}; }`)
let s=e.getColor(Xg)
s&&t.addRule(`.monaco-editor .margin { background-color: ${s}; }`)
let r=e.getColor(Hg)
r&&t.addRule(`.monaco-editor .rangeHighlight { background-color: ${r}; }`)
let o=e.getColor(mc)
o&&t.addRule(`.monaco-editor .rangeHighlight { border: 1px dotted ${o}; }`)
let a=e.getColor(Kg)
a&&t.addRule(`.vs-whitespace { color: ${a} !important; }`)})
class lm extends Xu{}class hm extends lm{constructor(t){super(),this._context=t,this._readConfig(),this._lastCursorModelPosition=new e(1,1),this._renderResult=null,this._context.addEventHandler(this)}_readConfig(){const e=this._context.configuration.editor
this._lineHeight=e.lineHeight,this._renderLineNumbers=e.viewInfo.renderLineNumbers,this._renderCustomLineNumbers=e.viewInfo.renderCustomLineNumbers,this._renderRelativeLineNumbers=e.viewInfo.renderRelativeLineNumbers,this._lineNumbersLeft=e.layoutInfo.lineNumbersLeft,this._lineNumbersWidth=e.layoutInfo.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._context=null,this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){const t=e.selections[0].getPosition()
return this._lastCursorModelPosition=this._context.model.coordinatesConverter.convertViewPositionToModelPosition(t),!!this._renderRelativeLineNumbers}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getLineRenderLineNumber(t){const i=this._context.model.coordinatesConverter.convertViewPositionToModelPosition(new e(t,1))
if(1!==i.column)return""
let n=i.lineNumber
if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(n)
if(this._renderRelativeLineNumbers){let e=Math.abs(this._lastCursorModelPosition.lineNumber-n)
return 0===e?'<span class="relative-current-line-number">'+n+"</span>":String(e)}return String(n)}prepareRender(e){if(!this._renderLineNumbers)return void(this._renderResult=null)
let t=I?this._lineHeight%2==0?" lh-even":" lh-odd":"",i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,s='<div class="'+hm.CLASS_NAME+t+'" style="left:'+this._lineNumbersLeft.toString()+"px;width:"+this._lineNumbersWidth.toString()+'px;">',r=[]
for(let e=i;e<=n;e++){let t=e-i,n=this._getLineRenderLineNumber(e)
r[t]=n?s+n+"</div>":""}this._renderResult=r}render(e,t){if(!this._renderResult)return""
let i=t-e
if(i<0||i>=this._renderResult.length)throw new Error("Unexpected render request")
return this._renderResult[i]}}hm.CLASS_NAME="line-numbers",Wg((e,t)=>{let i=e.getColor(qg)
i&&t.addRule(`.monaco-editor .line-numbers { color: ${i}; }`)})
class dm{constructor(e,t,i){this.top=e,this.left=t,this.width=i}setWidth(e){return new dm(this.top,this.left,e)}}const um=Na||Ea
class cm extends sc{constructor(e,i,n){super(e),this._primaryCursorVisibleRange=null,this._viewController=i,this._viewHelper=n
const s=this._context.configuration.editor
this._pixelRatio=s.pixelRatio,this._accessibilitySupport=s.accessibilitySupport,this._contentLeft=s.layoutInfo.contentLeft,this._contentWidth=s.layoutInfo.contentWidth,this._contentHeight=s.layoutInfo.contentHeight,this._scrollLeft=0,this._scrollTop=0,this._fontInfo=s.fontInfo,this._lineHeight=s.lineHeight,this._emptySelectionClipboard=s.emptySelectionClipboard,this._visibleTextArea=null,this._selections=[new At(1,1,1,1)],this._lastCopiedValue=null,this._lastCopiedValueIsFromEmptySelection=!1,this.textArea=Zu(document.createElement("textarea")),rc.write(this.textArea,6),this.textArea.setClassName("inputarea"),this.textArea.setAttribute("wrap","off"),this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",s.viewInfo.ariaLabel),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textAreaCover=Zu(document.createElement("div")),this.textAreaCover.setPosition("absolute")
const r={getLineCount:()=>this._context.model.getLineCount(),getLineMaxColumn:e=>this._context.model.getLineMaxColumn(e),getValueInRange:(e,t)=>this._context.model.getValueInRange(e,t)},o={getPlainTextToCopy:()=>{const e=this._context.model.getPlainTextToCopy(this._selections,this._emptySelectionClipboard)
if(this._emptySelectionClipboard){this._lastCopiedValue=Ea?e.replace(/\r\n/g,"\n"):e
let t=this._selections
this._lastCopiedValueIsFromEmptySelection=1===t.length&&t[0].isEmpty()}return e},getHTMLToCopy:()=>this._context.model.getHTMLToCopy(this._selections,this._emptySelectionClipboard),getScreenReaderContent:e=>{if(Da)return Ju.EMPTY
if(1===this._accessibilitySupport){if(k){const e=this._selections[0]
if(e.isEmpty()){const t=e.getStartPosition()
if(t.column>1){const e=this._context.model.getLineContent(t.lineNumber).charAt(t.column-2)
if(!Ve(e.charCodeAt(0)))return new Ju(e,1,1,t,t)}}}return Ju.EMPTY}return Qu.fromEditorSelection(e,r,this._selections[0],0===this._accessibilitySupport)},deduceModelPosition:(e,t,i)=>this._context.model.deduceModelPositionRelativeToViewPosition(e,t,i)}
this._textAreaInput=this._register(new tc(o,this.textArea)),this._register(this._textAreaInput.onKeyDown(e=>{this._viewController.emitKeyDown(e)})),this._register(this._textAreaInput.onKeyUp(e=>{this._viewController.emitKeyUp(e)})),this._register(this._textAreaInput.onPaste(e=>{let t=!1
this._emptySelectionClipboard&&(t=e.text===this._lastCopiedValue&&this._lastCopiedValueIsFromEmptySelection),this._viewController.paste("keyboard",e.text,t)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut("keyboard")})),this._register(this._textAreaInput.onType(e=>{e.replaceCharCnt?this._viewController.replacePreviousChar("keyboard",e.text,e.replaceCharCnt):this._viewController.type("keyboard",e.text)})),this._register(this._textAreaInput.onSelectionChangeRequest(e=>{this._viewController.setSelection("keyboard",e)})),this._register(this._textAreaInput.onCompositionStart(()=>{const e=this._selections[0].startLineNumber,i=this._selections[0].startColumn
this._context.privateViewEventBus.emit(new eh(new t(e,i,e,i),0,!0,1))
const n=this._viewHelper.visibleRangeForPositionRelativeToEditor(e,i)
n&&(this._visibleTextArea=new dm(this._context.viewLayout.getVerticalOffsetForLineNumber(e),n.left,um?0:1),this._render()),this.textArea.setClassName("inputarea ime-input"),this._viewController.compositionStart("keyboard")})),this._register(this._textAreaInput.onCompositionUpdate(e=>{this._visibleTextArea=Na?this._visibleTextArea.setWidth(0):this._visibleTextArea.setWidth(function(e,t){const i=document.createElement("canvas").getContext("2d")
i.font=(n=t,s="normal",r=n.fontWeight,o=n.fontSize,a=n.lineHeight,l=n.fontFamily,`${s} normal ${r} ${o}px / ${a}px ${l}`)
var n,s,r,o,a,l
const h=i.measureText(e)
return Ea?h.width+2:h.width}(e.data,this._fontInfo)),this._render()})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this._render(),this.textArea.setClassName("inputarea"),this._viewController.compositionEnd("keyboard")})),this._register(this._textAreaInput.onFocus(()=>{this._context.privateViewEventBus.emit(new Yl(!0))})),this._register(this._textAreaInput.onBlur(()=>{this._context.privateViewEventBus.emit(new Yl(!1))}))}dispose(){super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.editor
return e.fontInfo&&(this._fontInfo=t.fontInfo),e.viewInfo&&this.textArea.setAttribute("aria-label",t.viewInfo.ariaLabel),e.layoutInfo&&(this._contentLeft=t.layoutInfo.contentLeft,this._contentWidth=t.layoutInfo.contentWidth,this._contentHeight=t.layoutInfo.contentHeight),e.lineHeight&&(this._lineHeight=t.lineHeight),e.pixelRatio&&(this._pixelRatio=t.pixelRatio),e.accessibilitySupport&&(this._accessibilitySupport=t.accessibilitySupport,this._textAreaInput.writeScreenReaderContent("strategy changed")),e.emptySelectionClipboard&&(this._emptySelectionClipboard=t.emptySelectionClipboard),!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),this._textAreaInput.writeScreenReaderContent("selection changed"),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return this._scrollLeft=e.scrollLeft,this._scrollTop=e.scrollTop,!0}onZonesChanged(e){return!0}isFocused(){return this._textAreaInput.isFocused()}focusTextArea(){this._textAreaInput.focusTextArea()}setAriaActiveDescendant(e){e?(this.textArea.setAttribute("role","combobox"),this.textArea.getAttribute("aria-activedescendant")!==e&&(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-activedescendant",e))):(this.textArea.setAttribute("role","textbox"),this.textArea.removeAttribute("aria-activedescendant"),this.textArea.removeAttribute("aria-haspopup"))}prepareRender(t){if(2===this._accessibilitySupport)this._primaryCursorVisibleRange=null
else{const i=new e(this._selections[0].positionLineNumber,this._selections[0].positionColumn)
this._primaryCursorVisibleRange=t.visibleRangeForPosition(i)}}render(e){this._textAreaInput.writeScreenReaderContent("render"),this._render()}_render(){if(this._visibleTextArea)return void this._renderInsideEditor(this._visibleTextArea.top-this._scrollTop,this._contentLeft+this._visibleTextArea.left-this._scrollLeft,this._visibleTextArea.width,this._lineHeight,!0)
if(!this._primaryCursorVisibleRange)return void this._renderAtTopLeft()
const e=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft
if(e<this._contentLeft||e>this._contentLeft+this._contentWidth)return void this._renderAtTopLeft()
const t=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop
t<0||t>this._contentHeight?this._renderAtTopLeft():this._renderInsideEditor(t,e,um?0:1,um?0:1,!1)}_renderInsideEditor(e,t,i,n,s){const r=this.textArea,o=this.textAreaCover
s?ju.applyFontInfo(r,this._fontInfo):(r.setFontSize(1),r.setLineHeight(this._fontInfo.lineHeight)),r.setTop(e),r.setLeft(t),r.setWidth(i),r.setHeight(n),o.setTop(0),o.setLeft(0),o.setWidth(0),o.setHeight(0)}_renderAtTopLeft(){const e=this.textArea,t=this.textAreaCover
if(ju.applyFontInfo(e,this._fontInfo),e.setTop(0),e.setLeft(0),t.setTop(0),t.setLeft(0),um)return e.setWidth(0),e.setHeight(0),t.setWidth(0),void t.setHeight(0)
e.setWidth(1),e.setHeight(1),t.setWidth(1),t.setHeight(1),this._context.configuration.editor.viewInfo.glyphMargin?t.setClassName("monaco-editor-background textAreaCover "+oc.CLASS_NAME):this._context.configuration.editor.viewInfo.renderLineNumbers?t.setClassName("monaco-editor-background textAreaCover "+hm.CLASS_NAME):t.setClassName("monaco-editor-background textAreaCover")}}var gm,mm,pm,fm,_m,Cm,bm,wm;(mm=gm||(gm={})).Tap="-monaco-gesturetap",mm.Change="-monaco-gesturechange",mm.Start="-monaco-gesturestart",mm.End="-monaco-gesturesend",mm.Contextmenu="-monaco-gesturecontextmenu"
class vm{constructor(e){this.callOnTarget=[],this.activeTouches={},this.target=e,this.handle=null}dispose(){this.target=null,this.handle&&(this.handle.dispose(),this.handle=null)}set target(e){this.callOnTarget=ei(this.callOnTarget),this.activeTouches={},this.targetElement=e,this.targetElement&&(this.callOnTarget.push(il(this.targetElement,"touchstart",e=>this.onTouchStart(e))),this.callOnTarget.push(il(this.targetElement,"touchend",e=>this.onTouchEnd(e))),this.callOnTarget.push(il(this.targetElement,"touchmove",e=>this.onTouchMove(e))))}static newGestureEvent(e){let t=document.createEvent("CustomEvent")
return t.initEvent(e,!1,!0),t}onTouchStart(e){let t=Date.now()
e.preventDefault(),this.handle&&(this.handle.dispose(),this.handle=null)
for(let i=0,n=e.targetTouches.length;i<n;i++){let n=e.targetTouches.item(i)
this.activeTouches[n.identifier]={id:n.identifier,initialTarget:n.target,initialTimeStamp:t,initialPageX:n.pageX,initialPageY:n.pageY,rollingTimestamps:[t],rollingPageX:[n.pageX],rollingPageY:[n.pageY]}
let s=vm.newGestureEvent(gm.Start)
s.pageX=n.pageX,s.pageY=n.pageY,this.targetElement.dispatchEvent(s)}}onTouchEnd(e){let t=Date.now()
e.preventDefault(),e.stopPropagation()
let i=Object.keys(this.activeTouches).length
for(let n=0,s=e.changedTouches.length;n<s;n++){let s=e.changedTouches.item(n)
if(!this.activeTouches.hasOwnProperty(String(s.identifier))){console.warn("move of an UNKNOWN touch",s)
continue}let r=this.activeTouches[s.identifier],o=Date.now()-r.initialTimeStamp
if(o<vm.HOLD_DELAY&&Math.abs(r.initialPageX-kn(r.rollingPageX))<30&&Math.abs(r.initialPageY-kn(r.rollingPageY))<30){let e=vm.newGestureEvent(gm.Tap)
e.initialTarget=r.initialTarget,e.pageX=kn(r.rollingPageX),e.pageY=kn(r.rollingPageY),this.targetElement.dispatchEvent(e)}else if(o>=vm.HOLD_DELAY&&Math.abs(r.initialPageX-kn(r.rollingPageX))<30&&Math.abs(r.initialPageY-kn(r.rollingPageY))<30){let e=vm.newGestureEvent(gm.Contextmenu)
e.initialTarget=r.initialTarget,e.pageX=kn(r.rollingPageX),e.pageY=kn(r.rollingPageY),this.targetElement.dispatchEvent(e)}else if(1===i){let e=kn(r.rollingPageX),i=kn(r.rollingPageY),n=kn(r.rollingTimestamps)-r.rollingTimestamps[0],s=e-r.rollingPageX[0],o=i-r.rollingPageY[0]
this.inertia(t,Math.abs(s)/n,s>0?1:-1,e,Math.abs(o)/n,o>0?1:-1,i)}delete this.activeTouches[s.identifier]}}inertia(e,t,i,n,s,r,o){this.handle=al(()=>{let a=Date.now(),l=a-e,h=0,d=0,u=!0
t+=vm.SCROLL_FRICTION*l,s+=vm.SCROLL_FRICTION*l,t>0&&(u=!1,h=i*t*l),s>0&&(u=!1,d=r*s*l)
let c=vm.newGestureEvent(gm.Change)
c.translationX=h,c.translationY=d,this.targetElement.dispatchEvent(c),u||this.inertia(a,t,i,n+h,s,r,o+d)})}onTouchMove(e){let t=Date.now()
e.preventDefault(),e.stopPropagation()
for(let i=0,n=e.changedTouches.length;i<n;i++){let n=e.changedTouches.item(i)
if(!this.activeTouches.hasOwnProperty(String(n.identifier))){console.warn("end of an UNKNOWN touch",n)
continue}let s=this.activeTouches[n.identifier],r=vm.newGestureEvent(gm.Change)
r.translationX=n.pageX-kn(s.rollingPageX),r.translationY=n.pageY-kn(s.rollingPageY),r.pageX=n.pageX,r.pageY=n.pageY,this.targetElement.dispatchEvent(r),s.rollingPageX.length>3&&(s.rollingPageX.shift(),s.rollingPageY.shift(),s.rollingTimestamps.shift()),s.rollingPageX.push(n.pageX),s.rollingPageY.push(n.pageY),s.rollingTimestamps.push(t)}}}function Sm(e,t){let i=new Ka(t)
return i.preventDefault(),{leftButton:i.leftButton,posx:i.posx,posy:i.posy}}vm.HOLD_DELAY=700,vm.SCROLL_FRICTION=-.005,(fm=pm||(pm={}))[fm.EXACT=0]="EXACT",fm[fm.ABOVE=1]="ABOVE",fm[fm.BELOW=2]="BELOW",(Cm=_m||(_m={}))[Cm.TOP_RIGHT_CORNER=0]="TOP_RIGHT_CORNER",Cm[Cm.BOTTOM_RIGHT_CORNER=1]="BOTTOM_RIGHT_CORNER",Cm[Cm.TOP_CENTER=2]="TOP_CENTER",(wm=bm||(bm={}))[wm.UNKNOWN=0]="UNKNOWN",wm[wm.TEXTAREA=1]="TEXTAREA",wm[wm.GUTTER_GLYPH_MARGIN=2]="GUTTER_GLYPH_MARGIN",wm[wm.GUTTER_LINE_NUMBERS=3]="GUTTER_LINE_NUMBERS",wm[wm.GUTTER_LINE_DECORATIONS=4]="GUTTER_LINE_DECORATIONS",wm[wm.GUTTER_VIEW_ZONE=5]="GUTTER_VIEW_ZONE",wm[wm.CONTENT_TEXT=6]="CONTENT_TEXT",wm[wm.CONTENT_EMPTY=7]="CONTENT_EMPTY",wm[wm.CONTENT_VIEW_ZONE=8]="CONTENT_VIEW_ZONE",wm[wm.CONTENT_WIDGET=9]="CONTENT_WIDGET",wm[wm.OVERVIEW_RULER=10]="OVERVIEW_RULER",wm[wm.SCROLLBAR=11]="SCROLLBAR",wm[wm.OVERLAY_WIDGET=12]="OVERLAY_WIDGET",wm[wm.OUTSIDE_EDITOR=13]="OUTSIDE_EDITOR"
class ym extends ni{constructor(){super(),this.hooks=[],this.mouseMoveEventMerger=null,this.mouseMoveCallback=null,this.onStopCallback=null}dispose(){this.stopMonitoring(!1),super.dispose()}stopMonitoring(e){if(!this.isMonitoring())return
this.hooks=ei(this.hooks),this.mouseMoveEventMerger=null,this.mouseMoveCallback=null
let t=this.onStopCallback
this.onStopCallback=null,e&&t()}isMonitoring(){return this.hooks.length>0}startMonitoring(e,t,i){if(this.isMonitoring())return
this.mouseMoveEventMerger=e,this.mouseMoveCallback=t,this.onStopCallback=i
let n=Ua.getSameOriginWindowChain()
for(let e=0;e<n.length;e++)this.hooks.push(cl(n[e].window.document,"mousemove",e=>this.mouseMoveCallback(e),(e,t)=>this.mouseMoveEventMerger(e,t))),this.hooks.push(il(n[e].window.document,"mouseup",e=>this.stopMonitoring(!0)))
if(Ua.hasDifferentOriginAncestor()){let e=n[n.length-1]
this.hooks.push(il(e.window.document,"mouseout",e=>{"html"===new Ka(e).target.tagName.toLowerCase()&&this.stopMonitoring(!0)})),this.hooks.push(il(e.window.document,"mouseover",e=>{"html"===new Ka(e).target.tagName.toLowerCase()&&this.stopMonitoring(!0)})),this.hooks.push(il(e.window.document.body,"mouseleave",e=>{this.stopMonitoring(!0)}))}}}class xm{constructor(e,t){this.x=e,this.y=t}toClientCoordinates(){return new Lm(this.x-bl.scrollX,this.y-bl.scrollY)}}class Lm{constructor(e,t){this.clientX=e,this.clientY=t}toPageCoordinates(){return new xm(this.clientX+bl.scrollX,this.clientY+bl.scrollY)}}class Nm{constructor(e,t,i,n){this.x=e,this.y=t,this.width=i,this.height=n}}function Em(e){let t=Cl(e)
return new Nm(t.left,t.top,t.width,t.height)}class km extends Ka{constructor(e,t){super(e),this.pos=new xm(this.posx,this.posy),this.editorPos=Em(t)}}class Im{constructor(e){this._editorViewDomNode=e}_create(e){return new km(e,this._editorViewDomNode)}onContextMenu(e,t){return il(e,"contextmenu",e=>{t(this._create(e))})}onMouseUp(e,t){return il(e,"mouseup",e=>{t(this._create(e))})}onMouseDown(e,t){return il(e,"mousedown",e=>{t(this._create(e))})}onMouseLeave(e,t){return sl(e,e=>{t(this._create(e))})}onMouseMoveThrottled(e,t,i,n){return cl(e,"mousemove",t,(e,t)=>i(e,this._create(t)),n)}}class Mm extends ni{constructor(e){super(),this._editorViewDomNode=e,this._globalMouseMoveMonitor=this._register(new ym),this._keydownListener=null}startMonitoring(e,t,i){this._keydownListener=nl(document,"keydown",e=>{e.toKeybinding().isModifierKey()||this._globalMouseMoveMonitor.stopMonitoring(!0)},!0)
this._globalMouseMoveMonitor.startMonitoring((t,i)=>e(t,new km(i,this._editorViewDomNode)),t,()=>{this._keydownListener.dispose(),i()})}}class Dm{constructor(e,t,i,n){this.startColumn=e,this.endColumn=t,this.className=i,this.insertsBeforeOrAfter=n}static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.insertsBeforeOrAfter===t.insertsBeforeOrAfter}static equalsArr(e,t){let i=e.length
if(i!==t.length)return!1
for(let n=0;n<i;n++)if(!Dm._equals(e[n],t[n]))return!1
return!0}static filter(e,t,i,n){if(0===e.length)return[]
let s=[],r=0
for(let o=0,a=e.length;o<a;o++){let a=e[o],l=a.range
if(l.endLineNumber<t||l.startLineNumber>t)continue
if(l.isEmpty())continue
let h=l.startLineNumber===t?l.startColumn:i,d=l.endLineNumber===t?l.endColumn:n
d<=1||(s[r++]=new Dm(h,d,a.inlineClassName,a.insertsBeforeOrAfter))}return s}static compare(e,t){return e.startColumn===t.startColumn?e.endColumn===t.endColumn?e.className<t.className?-1:e.className>t.className?1:0:e.endColumn-t.endColumn:e.startColumn-t.startColumn}}class Tm{constructor(e,t,i){this.startOffset=e,this.endOffset=t,this.className=i}}class Om{constructor(){this.stopOffsets=[],this.classNames=[],this.count=0}consumeLowerThan(e,t,i){for(;this.count>0&&this.stopOffsets[0]<e;){for(var n=0;n+1<this.count&&this.stopOffsets[n]===this.stopOffsets[n+1];)n++
i.push(new Tm(t,this.stopOffsets[n],this.classNames.join(" "))),t=this.stopOffsets[n]+1,this.stopOffsets.splice(0,n+1),this.classNames.splice(0,n+1),this.count-=n+1}return this.count>0&&t<e&&(i.push(new Tm(t,e-1,this.classNames.join(" "))),t=e),t}insert(e,t){if(0===this.count||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t)
else for(var i=0;i<this.count;i++)if(this.stopOffsets[i]>=e){this.stopOffsets.splice(i,0,e),this.classNames.splice(i,0,t)
break}this.count++}}class Rm{static normalize(e,t){if(0===t.length)return[]
let i=[],n=new Om,s=0
for(let r=0,o=t.length;r<o;r++){let o=t[r],a=o.startColumn,l=o.endColumn,h=o.className
if(a>1)Ve(e.charCodeAt(a-2))&&a--
if(l>1)Ve(e.charCodeAt(l-2))&&l--
let d=a-1,u=l-2
s=n.consumeLowerThan(d,s,i),0===n.count&&(s=d),n.insert(u,h)}return n.consumeLowerThan(1073741824,s,i),i}}let Am
Am=self.TextDecoder?e=>new class{constructor(e){this._decoder=new TextDecoder("UTF-16LE"),this._capacity=0|e,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return null!==this._completedStrings?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(0===this._bufferLength)return""
const e=new Uint16Array(this._buffer.buffer,0,this._bufferLength)
return this._decoder.decode(e)}_flushBuffer(){const e=this._buildBuffer()
this._bufferLength=0,null===this._completedStrings?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}write1(e){const t=this._capacity-this._bufferLength
t<=1&&(0===t||Ve(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCII(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIIString(e){const t=e.length
if(this._bufferLength+t>=this._capacity)return this._flushBuffer(),void(this._completedStrings[this._completedStrings.length]=e)
for(let i=0;i<t;i++)this._buffer[this._bufferLength++]=e.charCodeAt(i)}}(e):e=>new class{constructor(){this._pieces=[],this._piecesLen=0}reset(){this._pieces=[],this._piecesLen=0}build(){return this._pieces.join("")}write1(e){this._pieces[this._piecesLen++]=String.fromCharCode(e)}appendASCII(e){this._pieces[this._piecesLen++]=String.fromCharCode(e)}appendASCIIString(e){this._pieces[this._piecesLen++]=e}}
class Pm{constructor(e,t){this.endIndex=e,this.type=t}}class Fm{constructor(e,t,i,n,s,r,o,a,l,h,d,u){this.useMonospaceOptimizations=e,this.lineContent=t,this.mightContainRTL=i,this.fauxIndentLength=n,this.lineTokens=s,this.lineDecorations=r,this.tabSize=o,this.spaceWidth=a,this.stopRenderingLineAfter=l,this.renderWhitespace="all"===h?2:"boundary"===h?1:0,this.renderControlCharacters=d,this.fontLigatures=u}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.lineContent===e.lineContent&&this.mightContainRTL===e.mightContainRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.spaceWidth===e.spaceWidth&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&Dm.equalsArr(this.lineDecorations,e.lineDecorations)&&Ft.equalsArr(this.lineTokens,e.lineTokens)}}class Wm{static getPartIndex(e){return(4294901760&e)>>>16}static getCharIndex(e){return(65535&e)>>>0}constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._absoluteOffsets=new Uint32Array(this.length)}setPartData(e,t,i,n){let s=(t<<16|i<<0)>>>0
this._data[e]=s,this._absoluteOffsets[e]=n+i}getAbsoluteOffsets(){return this._absoluteOffsets}charOffsetToPartData(e){return 0===this.length?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}partDataToCharOffset(e,t,i){if(0===this.length)return 0
let n=(e<<16|i<<0)>>>0,s=0,r=this.length-1
for(;s+1<r;){let e=s+r>>>1,t=this._data[e]
if(t===n)return e
t>n?r=e:s=e}if(s===r)return s
let o=this._data[s],a=this._data[r]
if(o===n)return s
if(a===n)return r
let l,h=Wm.getPartIndex(o)
return i-Wm.getCharIndex(o)<=(l=h!==Wm.getPartIndex(a)?t:Wm.getCharIndex(a))-i?s:r}}class Vm{constructor(e,t,i){this.characterMapping=e,this.containsRTL=t,this.containsForeignElements=i}}function Bm(e,t){if(0===e.lineContent.length){let i=!1,n="<span><span> </span></span>"
if(e.lineDecorations.length>0){let t=[]
for(let n=0,s=e.lineDecorations.length;n<s;n++){e.lineDecorations[n].insertsBeforeOrAfter&&(t[n]=e.lineDecorations[n].className,i=!0)}i&&(n=`<span><span class="${t.join(" ")}"> </span></span>`)}return t.appendASCIIString(n),new Vm(new Wm(0,0),!1,i)}return function(e,t){const i=e.fontIsMonospace,n=e.containsForeignElements,s=e.lineContent,r=e.len,o=e.isOverflowing,a=e.parts,l=e.tabSize,h=e.containsRTL,d=e.spaceWidth,u=e.renderWhitespace,c=e.renderControlCharacters,g=new Wm(r+1,a.length)
let m=0,p=0,f=0,_=0,C=0
t.appendASCIIString("<span>")
for(let e=0,r=a.length;e<r;e++){C+=_
const r=a[e],o=r.endIndex,b=r.type,w=0!==u&&b.indexOf("vs-whitespace")>=0
if(f=0,t.appendASCIIString('<span class="'),t.appendASCIIString(b),t.appendASCII(34),w){let r=0
{let e=m,t=p
for(;e<o;e++){const i=s.charCodeAt(e)
if(9===i){let i=l-(e+t)%l
t+=i-1,r+=i}else r++}}if(!i){const e="vs-whitespace"===b
!e&&n||(t.appendASCIIString(' style="width:'),t.appendASCIIString(String(d*r)),t.appendASCIIString('px"'))}for(t.appendASCII(62);m<o;m++){g.setPartData(m,e,f,C)
const i=s.charCodeAt(m)
if(9===i){let e=l-(m+p)%l
for(p+=e-1,f+=e-1,e>0&&(t.write1(8594),e--);e>0;)t.write1(160),e--}else t.write1(183)
f++}_=r}else{let i=0
for(h&&t.appendASCIIString(' dir="ltr"'),t.appendASCII(62);m<o;m++){g.setPartData(m,e,f,C)
const n=s.charCodeAt(m)
switch(n){case 9:let e=l-(m+p)%l
for(p+=e-1,f+=e-1;e>0;)t.write1(160),i++,e--
break
case 32:t.write1(160),i++
break
case 60:t.appendASCIIString("&lt;"),i++
break
case 62:t.appendASCIIString("&gt;"),i++
break
case 38:t.appendASCIIString("&amp;"),i++
break
case 0:t.appendASCIIString("&#00;"),i++
break
case 65279:case 8232:t.write1(65533),i++
break
default:c&&n<32?(t.write1(9216+n),i++):(t.write1(n),i++)}f++}_=i}t.appendASCIIString("</span>")}g.setPartData(r,a.length-1,f,C),o&&t.appendASCIIString("<span>&hellip;</span>")
return t.appendASCIIString("</span>"),new Vm(g,h,n)}(function(e){const t=e.useMonospaceOptimizations,i=e.lineContent
let n,s;-1!==e.stopRenderingLineAfter&&e.stopRenderingLineAfter<i.length?(n=!0,s=e.stopRenderingLineAfter):(n=!1,s=i.length)
let r=function(e,t,i){let n=[],s=0
t>0&&(n[s++]=new Pm(t,""))
for(let r=0,o=e.length;r<o;r++){const o=e[r],a=o.endIndex
if(a<=t)continue
const l=o.getType()
if(a>=i){n[s++]=new Pm(i,l)
break}n[s++]=new Pm(a,l)}return n}(e.lineTokens,e.fauxIndentLength,s)
2!==e.renderWhitespace&&1!==e.renderWhitespace||(r=function(e,t,i,n,s,r,o){let a,l=[],h=0,d=0,u=i[d].type,c=i[d].endIndex,g=Le(e);-1===g?(g=t,a=t):a=Ee(e)
let m=0
for(let t=0;t<n;t++){const i=e.charCodeAt(t)
9===i?m=s:m++}m%=s
let p=!1
for(let f=n;f<t;f++){const _=e.charCodeAt(f)
let C
if(f<g||f>a)C=!0
else if(9===_)C=!0
else if(32===_)if(o)if(p)C=!0
else{const i=f+1<t?e.charCodeAt(f+1):0
C=32===i||9===i}else C=!0
else C=!1
p?(!C||!r&&m>=s)&&(l[h++]=new Pm(f,"vs-whitespace"),m%=s):(f===c||C&&f>n)&&(l[h++]=new Pm(f,u),m%=s),9===_?m=s:m++,p=C,f===c&&(u=i[++d].type,c=i[d].endIndex)}l[h++]=new Pm(t,p?"vs-whitespace":u)
return l}(i,s,r,e.fauxIndentLength,e.tabSize,t,1===e.renderWhitespace))
let o=!1
if(e.lineDecorations.length>0){for(let t=0,i=e.lineDecorations.length;t<i;t++){const i=e.lineDecorations[t]
if(i.insertsBeforeOrAfter){o=!0
break}}r=function(e,t,i,n){n.sort(Dm.compare)
const s=Rm.normalize(e,n),r=s.length
let o=0,a=[],l=0,h=0
for(let e=0,t=i.length;e<t;e++){const t=i[e],n=t.endIndex,d=t.type
for(;o<r&&s[o].startOffset<n;){const e=s[o]
if(e.startOffset>h&&(h=e.startOffset,a[l++]=new Pm(h,d)),!(e.endOffset+1<=n)){h=n,a[l++]=new Pm(h,d+" "+e.className)
break}h=e.endOffset+1,a[l++]=new Pm(h,d+" "+e.className),o++}n>h&&(h=n,a[l++]=new Pm(h,d))}return a}(i,0,r,e.lineDecorations)}let a=!1
e.mightContainRTL&&(a=ze(i))
a||e.fontLigatures||(r=function(e,t){let i=0,n=[],s=0
for(let r=0,o=t.length;r<o;r++){const o=t[r],a=o.endIndex
let l=a-i
if(l>50){const t=o.type,r=Math.ceil(l/50)
for(let o=1;o<r;o++){let r=i+50*o,a=e.charCodeAt(r-1)
Ve(a)&&r--,n[s++]=new Pm(r,t)}n[s++]=new Pm(a,t)}else n[s++]=o
i=a}return n}(i,r))
return new Um(t,i,s,n,r,o,e.tabSize,a,e.spaceWidth,e.renderWhitespace,e.renderControlCharacters)}(e),t)}class Hm{constructor(e,t,i,n){this.characterMapping=e,this.html=t,this.containsRTL=i,this.containsForeignElements=n}}function zm(e){let t=Am(1e4),i=Bm(e,t)
return new Hm(i.characterMapping,t.build(),i.containsRTL,i.containsForeignElements)}class Um{constructor(e,t,i,n,s,r,o,a,l,h,d){this.fontIsMonospace=e,this.lineContent=t,this.len=i,this.isOverflowing=n,this.parts=s,this.containsForeignElements=r,this.tabSize=o,this.containsRTL=a,this.spaceWidth=l,this.renderWhitespace=h,this.renderControlCharacters=d}}class Km{constructor(e,t){this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta
const i=this._viewLayout.getCurrentViewport()
this.scrollTop=i.top,this.scrollLeft=i.left,this.viewportWidth=i.width,this.viewportHeight=i.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e){return this._viewLayout.getVerticalOffsetForLineNumber(e)}lineIsVisible(e){return this.visibleRange.startLineNumber<=e&&e<=this.visibleRange.endLineNumber}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}class $m extends Km{constructor(e,t,i){super(e,t),this._viewLines=i}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){const i=this._viewLines.visibleRangesForRange2(new t(e.lineNumber,e.column,e.lineNumber,e.column))
return i?i[0]:null}}class qm{constructor(e,t){this.lineNumber=e,this.ranges=t}}class Gm{constructor(e,t){this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}}class jm{constructor(e,t){this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}}class Ym{static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,i,n,s){let r=this._createRange()
try{return r.setStart(e,t),r.setEnd(i,n),r.getClientRects()}catch(e){return null}finally{this._detachRange(r,s)}}static _mergeAdjacentRanges(e){if(1===e.length)return[new Gm(e[0].left,e[0].width)]
e.sort(jm.compare)
let t=[],i=0,n=e[0].left,s=e[0].width
for(let r=1,o=e.length;r<o;r++){const o=e[r],a=o.left,l=o.width
n+s+.9>=a?s=Math.max(s,a+l-n):(t[i++]=new Gm(n,s),n=a,s=l)}return t[i++]=new Gm(n,s),t}static _createHorizontalRangesFromClientRects(e,t){if(!e||0===e.length)return null
let i=[]
for(let n=0,s=e.length;n<s;n++){const s=e[n]
i[n]=new jm(Math.max(0,s.left-t),s.width)}return this._mergeAdjacentRanges(i)}static readHorizontalRanges(e,t,i,n,s,r,o){let a=e.children.length-1
if(0>a)return null;(t=Math.min(a,Math.max(0,t)))!==(n=Math.min(a,Math.max(0,n)))&&n>0&&0===s&&(n--,s=Number.MAX_VALUE)
let l=e.children[t].firstChild,h=e.children[n].firstChild
if(!l||!h)return null
i=Math.min(l.textContent.length,Math.max(0,i)),s=Math.min(h.textContent.length,Math.max(0,s))
let d=this._readClientRects(l,i,h,s,o)
return this._createHorizontalRangesFromClientRects(d,r)}}const Zm=!!M||!(I||Ea||Ma),Xm=Na
class Jm{get clientRectDeltaLeft(){return this._clientRectDeltaLeftRead||(this._clientRectDeltaLeftRead=!0,this._clientRectDeltaLeft=this._domNode.getBoundingClientRect().left),this._clientRectDeltaLeft}constructor(e,t){this._domNode=e,this._clientRectDeltaLeft=0,this._clientRectDeltaLeftRead=!1,this.endNode=t}}class Qm{constructor(e,t){this.themeType=t,this.renderWhitespace=e.editor.viewInfo.renderWhitespace,this.renderControlCharacters=e.editor.viewInfo.renderControlCharacters,this.spaceWidth=e.editor.fontInfo.spaceWidth,this.useMonospaceOptimizations=e.editor.fontInfo.isMonospace&&!e.editor.viewInfo.disableMonospaceOptimizations,this.lineHeight=e.editor.lineHeight,this.stopRenderingLineAfter=e.editor.viewInfo.stopRenderingLineAfter,this.fontLigatures=e.editor.viewInfo.fontLigatures}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures}}class ep{constructor(e){this._options=e,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(!this._renderedViewLine)throw new Error("I have no rendered view line to set the dom node to...")
this._renderedViewLine.domNode=Zu(e)}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){return!(!Xm&&this._options.themeType!==Rg)&&(this._isMaybeInvalid=!0,!0)}renderLine(e,t,i,n){if(!1===this._isMaybeInvalid)return!1
this._isMaybeInvalid=!1
const s=i.getViewLineRenderingData(e),r=this._options,o=Dm.filter(s.inlineDecorations,e,s.minColumn,s.maxColumn)
if(Xm||r.themeType===Rg){const t=i.selections
for(let i=0,n=t.length;i<n;i++){const n=t[i]
if(n.endLineNumber<e||n.startLineNumber>e)continue
let r=n.startLineNumber===e?n.startColumn:s.minColumn,a=n.endLineNumber===e?n.endColumn:s.maxColumn
r<a&&o.push(new Dm(r,a,"inline-selected-text",!1))}}let a=new Fm(r.useMonospaceOptimizations,s.content,s.mightContainRTL,s.minColumn-1,s.tokens,o,s.tabSize,r.spaceWidth,r.stopRenderingLineAfter,r.renderWhitespace,r.renderControlCharacters,r.fontLigatures)
if(this._renderedViewLine&&this._renderedViewLine.input.equals(a))return!1
n.appendASCIIString('<div style="top:'),n.appendASCIIString(String(t)),n.appendASCIIString("px;height:"),n.appendASCIIString(String(this._options.lineHeight)),n.appendASCIIString('px;" class="'),n.appendASCIIString(ep.CLASS_NAME),n.appendASCIIString('">')
const l=Bm(a,n)
n.appendASCIIString("</div>")
let h=null
if(Zm&&r.useMonospaceOptimizations&&!l.containsForeignElements){let e=!0
s.mightContainNonBasicASCII&&(e=qe(s.content)),e&&s.content.length<1e3&&(h=new tp(this._renderedViewLine?this._renderedViewLine.domNode:null,a,l.characterMapping))}return h||(h=sp(this._renderedViewLine?this._renderedViewLine.domNode:null,a,l.characterMapping,l.containsRTL,l.containsForeignElements)),this._renderedViewLine=h,!0}layoutLine(e,t){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(this._options.lineHeight))}getWidth(){return this._renderedViewLine?this._renderedViewLine.getWidth():0}getWidthIsFast(){return!this._renderedViewLine||this._renderedViewLine.getWidthIsFast()}getVisibleRangesForRange(e,t,i){return e=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,e)),t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t)),this._renderedViewLine.getVisibleRangesForRange(e,t,i)}getColumnOfNodeOffset(e,t,i){return this._renderedViewLine.getColumnOfNodeOffset(e,t,i)}}ep.CLASS_NAME="view-line"
class tp{constructor(e,t,i){this.domNode=e,this.input=t,this._characterMapping=i,this._charWidth=t.spaceWidth}getWidth(){return this._getCharPosition(this._characterMapping.length)}getWidthIsFast(){return!0}getVisibleRangesForRange(e,t,i){e|=0,t|=0
const n=0|this.input.stopRenderingLineAfter
if(-1!==n&&e>n&&t>n)return null;-1!==n&&e>n&&(e=n),-1!==n&&t>n&&(t=n)
const s=this._getCharPosition(e),r=this._getCharPosition(t)
return[new Gm(s,r-s)]}_getCharPosition(e){const t=this._characterMapping.getAbsoluteOffsets()
return 0===t.length?0:Math.round(this._charWidth*t[e-1])}getColumnOfNodeOffset(e,t,i){let n=t.textContent.length,s=-1
for(;t;)t=t.previousSibling,s++
return this._characterMapping.partDataToCharOffset(s,n,i)+1}}class ip{constructor(e,t,i,n,s){if(this.domNode=e,this.input=t,this._characterMapping=i,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=s,this._cachedWidth=-1,this._pixelOffsetCache=null,!n||0===this._characterMapping.length){this._pixelOffsetCache=new Int32Array(Math.max(2,this._characterMapping.length+1))
for(let e=0,t=this._characterMapping.length;e<=t;e++)this._pixelOffsetCache[e]=-1}}_getReadingTarget(){return this.domNode.domNode.firstChild}getWidth(){return-1===this._cachedWidth&&(this._cachedWidth=this._getReadingTarget().offsetWidth),this._cachedWidth}getWidthIsFast(){return-1!==this._cachedWidth}getVisibleRangesForRange(e,t,i){e|=0,t|=0
const n=0|this.input.stopRenderingLineAfter
if(-1!==n&&e>n&&t>n)return null
if(-1!==n&&e>n&&(e=n),-1!==n&&t>n&&(t=n),null!==this._pixelOffsetCache){let n=this._readPixelOffset(e,i)
if(-1===n)return null
let s=this._readPixelOffset(t,i)
return-1===s?null:[new Gm(n,s-n)]}return this._readVisibleRangesForRange(e,t,i)}_readVisibleRangesForRange(e,t,i){if(e===t){let t=this._readPixelOffset(e,i)
return-1===t?null:[new Gm(t,0)]}return this._readRawVisibleRangesForRange(e,t,i)}_readPixelOffset(e,t){if(0===this._characterMapping.length&&!this._containsForeignElements)return 0
if(null!==this._pixelOffsetCache){let i=this._pixelOffsetCache[e]
if(-1!==i)return i
let n=this._actualReadPixelOffset(e,t)
return this._pixelOffsetCache[e]=n,n}return this._actualReadPixelOffset(e,t)}_actualReadPixelOffset(e,t){if(0===this._characterMapping.length){let e=Ym.readHorizontalRanges(this._getReadingTarget(),0,0,0,0,t.clientRectDeltaLeft,t.endNode)
return e&&0!==e.length?e[0].left:-1}if(e===this._characterMapping.length&&this._isWhitespaceOnly&&!this._containsForeignElements)return this.getWidth()
let i=this._characterMapping.charOffsetToPartData(e-1),n=Wm.getPartIndex(i),s=Wm.getCharIndex(i),r=Ym.readHorizontalRanges(this._getReadingTarget(),n,s,n,s,t.clientRectDeltaLeft,t.endNode)
return r&&0!==r.length?r[0].left:-1}_readRawVisibleRangesForRange(e,t,i){if(1===e&&t===this._characterMapping.length)return[new Gm(0,this.getWidth())]
let n=this._characterMapping.charOffsetToPartData(e-1),s=Wm.getPartIndex(n),r=Wm.getCharIndex(n),o=this._characterMapping.charOffsetToPartData(t-1),a=Wm.getPartIndex(o),l=Wm.getCharIndex(o)
return Ym.readHorizontalRanges(this._getReadingTarget(),s,r,a,l,i.clientRectDeltaLeft,i.endNode)}getColumnOfNodeOffset(e,t,i){let n=t.textContent.length,s=-1
for(;t;)t=t.previousSibling,s++
return this._characterMapping.partDataToCharOffset(s,n,i)+1}}class np extends ip{_readVisibleRangesForRange(e,t,i){let n=super._readVisibleRangesForRange(e,t,i)
if(!n||0===n.length||e===t||1===e&&t===this._characterMapping.length)return n
let s=this._readPixelOffset(t-1,i),r=this._readPixelOffset(t,i)
if(-1!==s&&-1!==r){let e=s<=r,t=n[n.length-1]
e&&t.left<r&&(t.width=r-t.left)}return n}}const sp=ka?rp:op
function rp(e,t,i,n,s){return new np(e,t,i,n,s)}function op(e,t,i,n,s){return new ip(e,t,i,n,s)}class ap{constructor(e,i,n=0,s=null,r=null,o=null){this.element=e,this.type=i,this.mouseColumn=n,this.position=s,!r&&s&&(r=new t(s.lineNumber,s.column,s.lineNumber,s.column)),this.range=r,this.detail=o}static _typeToString(e){return e===bm.TEXTAREA?"TEXTAREA":e===bm.GUTTER_GLYPH_MARGIN?"GUTTER_GLYPH_MARGIN":e===bm.GUTTER_LINE_NUMBERS?"GUTTER_LINE_NUMBERS":e===bm.GUTTER_LINE_DECORATIONS?"GUTTER_LINE_DECORATIONS":e===bm.GUTTER_VIEW_ZONE?"GUTTER_VIEW_ZONE":e===bm.CONTENT_TEXT?"CONTENT_TEXT":e===bm.CONTENT_EMPTY?"CONTENT_EMPTY":e===bm.CONTENT_VIEW_ZONE?"CONTENT_VIEW_ZONE":e===bm.CONTENT_WIDGET?"CONTENT_WIDGET":e===bm.OVERVIEW_RULER?"OVERVIEW_RULER":e===bm.SCROLLBAR?"SCROLLBAR":e===bm.OVERLAY_WIDGET?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+e.detail}toString(){return ap.toString(this)}}class lp{static isTextArea(e){return 2===e.length&&3===e[0]&&6===e[1]}static isChildOfViewLines(e){return e.length>=4&&3===e[0]&&7===e[3]}static isChildOfScrollableElement(e){return e.length>=2&&3===e[0]&&5===e[1]}static isChildOfMinimap(e){return e.length>=2&&3===e[0]&&8===e[1]}static isChildOfContentWidgets(e){return e.length>=4&&3===e[0]&&1===e[3]}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&2===e[0]}static isChildOfOverlayWidgets(e){return e.length>=2&&3===e[0]&&4===e[1]}}class hp{constructor(e,t,i){this.model=e.model,this.layoutInfo=e.configuration.editor.layoutInfo,this.viewDomNode=t.viewDomNode,this.lineHeight=e.configuration.editor.lineHeight,this.typicalHalfwidthCharacterWidth=e.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth,this.lastViewCursorsRenderData=i,this._context=e,this._viewHelper=t}getZoneAtCoord(t){let i=this._context.viewLayout.getWhitespaceAtVerticalOffset(t)
if(i){let n,s=i.verticalOffset+i.height/2,r=this._context.model.getLineCount(),o=null,a=null
return i.afterLineNumber!==r&&(a=new e(i.afterLineNumber+1,1)),i.afterLineNumber>0&&(o=new e(i.afterLineNumber,this._context.model.getLineMaxColumn(i.afterLineNumber))),n=null===a?o:null===o?a:t<s?o:a,{viewZoneId:i.id,afterLineNumber:i.afterLineNumber,positionBefore:o,positionAfter:a,position:n}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){let e=this._context.model.getLineCount(),i=this._context.model.getLineMaxColumn(e)
return{range:new t(e,i,e,i),isAfterLines:!0}}let i=this._context.viewLayout.getLineNumberAtVerticalOffset(e),n=this._context.model.getLineMaxColumn(i)
return{range:new t(i,1,i,n),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return hp._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,i){for(;e&&e!==document.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t)
if(e===i)return null
e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}visibleRangeForPosition2(e,t){return this._viewHelper.visibleRangeForPosition2(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}}class dp{constructor(e,t,i){this.editorPos=t,this.pos=i,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+i.y-t.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+i.x-t.x-e.layoutInfo.contentLeft,this.isInMarginArea=i.x-t.x<e.layoutInfo.contentLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,cp._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}}class up extends dp{constructor(e,t,i,n){super(e,t,i),this._ctx=e,n?(this.target=n,this.targetPath=rc.collect(n,e.viewDomNode)):(this.target=null,this.targetPath=new Uint8Array(0))}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}\n\ttarget: ${this.target?this.target.outerHTML:null}`}fulfill(e,t=null,i=null,n=null){return new ap(this.target,e,this.mouseColumn,t,i,n)}withTarget(e){return new up(this._ctx,this.editorPos,this.pos,e)}}class cp{constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){let t=e.target,i=rc.collect(t,this._viewHelper.viewDomNode)
return!(!lp.isChildOfContentWidgets(i)&&!lp.isChildOfOverflowingContentWidgets(i))||!!lp.isChildOfOverlayWidgets(i)}createMouseTarget(e,t,i,n){const s=new hp(this._context,this._viewHelper,e),r=new up(s,t,i,n)
try{return cp._createMouseTarget(s,r,!1)}catch(e){return r.fulfill(bm.UNKNOWN)}}static _createMouseTarget(e,t,i){if(null===t.target){if(i)return t.fulfill(bm.UNKNOWN)
const n=cp._doHitTest(e,t)
return n.position?cp.createMouseTargetFromHitTestPosition(e,t,n.position.lineNumber,n.position.column):this._createMouseTarget(e,t.withTarget(n.hitTarget),!0)}let n=null
return(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=n||cp._hitTestContentWidget(e,t))||cp._hitTestOverlayWidget(e,t))||cp._hitTestMinimap(e,t))||cp._hitTestScrollbarSlider(e,t))||cp._hitTestViewZone(e,t))||cp._hitTestMargin(e,t))||cp._hitTestViewCursor(e,t))||cp._hitTestTextArea(e,t))||cp._hitTestViewLines(e,t,i))||cp._hitTestScrollbar(e,t))||t.fulfill(bm.UNKNOWN)}static _hitTestContentWidget(e,t){if(lp.isChildOfContentWidgets(t.targetPath)||lp.isChildOfOverflowingContentWidgets(t.targetPath)){let i=e.findAttribute(t.target,"widgetId")
return i?t.fulfill(bm.CONTENT_WIDGET,null,null,i):t.fulfill(bm.UNKNOWN)}return null}static _hitTestOverlayWidget(e,t){if(lp.isChildOfOverlayWidgets(t.targetPath)){let i=e.findAttribute(t.target,"widgetId")
return i?t.fulfill(bm.OVERLAY_WIDGET,null,null,i):t.fulfill(bm.UNKNOWN)}return null}static _hitTestViewCursor(e,t){if(t.target){const i=e.lastViewCursorsRenderData
for(let e=0,n=i.length;e<n;e++){const n=i[e]
if(t.target===n.domNode)return t.fulfill(bm.CONTENT_TEXT,n.position)}}if(t.isInContentArea){const i=e.lastViewCursorsRenderData,n=t.mouseContentHorizontalOffset,s=t.mouseVerticalOffset
for(let r=0,o=i.length;r<o;r++){const o=i[r]
if(n<o.contentLeft)continue
if(n>o.contentLeft+o.width)continue
const a=e.getVerticalOffsetForLineNumber(o.position.lineNumber)
if(a<=s&&s<=a+o.height)return t.fulfill(bm.CONTENT_TEXT,o.position)}}return null}static _hitTestViewZone(e,t){let i=e.getZoneAtCoord(t.mouseVerticalOffset)
if(i){let e=t.isInContentArea?bm.CONTENT_VIEW_ZONE:bm.GUTTER_VIEW_ZONE
return t.fulfill(e,i.position,null,i)}return null}static _hitTestTextArea(e,t){return lp.isTextArea(t.targetPath)?t.fulfill(bm.TEXTAREA):null}static _hitTestMargin(e,t){if(t.isInMarginArea){let i=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),n=i.range.getStartPosition(),s=Math.abs(t.pos.x-t.editorPos.x)
const r={isAfterLines:i.isAfterLines,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:s}
return s<=e.layoutInfo.glyphMarginWidth?t.fulfill(bm.GUTTER_GLYPH_MARGIN,n,i.range,r):(s-=e.layoutInfo.glyphMarginWidth)<=e.layoutInfo.lineNumbersWidth?t.fulfill(bm.GUTTER_LINE_NUMBERS,n,i.range,r):(s-=e.layoutInfo.lineNumbersWidth,t.fulfill(bm.GUTTER_LINE_DECORATIONS,n,i.range,r))}return null}static _hitTestViewLines(t,i,n){if(!lp.isChildOfViewLines(i.targetPath))return null
if(t.isAfterLines(i.mouseVerticalOffset)){const n=t.model.getLineCount(),s=t.model.getLineMaxColumn(n)
return i.fulfill(bm.CONTENT_EMPTY,new e(n,s))}if(n)return i.fulfill(bm.UNKNOWN)
const s=cp._doHitTest(t,i)
return s.position?cp.createMouseTargetFromHitTestPosition(t,i,s.position.lineNumber,s.position.column):this._createMouseTarget(t,i.withTarget(s.hitTarget),!0)}static _hitTestMinimap(t,i){if(lp.isChildOfMinimap(i.targetPath)){const n=t.getLineNumberAtVerticalOffset(i.mouseVerticalOffset),s=t.model.getLineMaxColumn(n)
return i.fulfill(bm.SCROLLBAR,new e(n,s))}return null}static _hitTestScrollbarSlider(t,i){if(lp.isChildOfScrollableElement(i.targetPath)&&i.target&&1===i.target.nodeType){let n=i.target.className
if(n&&/\b(slider|scrollbar)\b/.test(n)){const n=t.getLineNumberAtVerticalOffset(i.mouseVerticalOffset),s=t.model.getLineMaxColumn(n)
return i.fulfill(bm.SCROLLBAR,new e(n,s))}}return null}static _hitTestScrollbar(t,i){if(lp.isChildOfScrollableElement(i.targetPath)){const n=t.getLineNumberAtVerticalOffset(i.mouseVerticalOffset),s=t.model.getLineMaxColumn(n)
return i.fulfill(bm.SCROLLBAR,new e(n,s))}return null}getMouseColumn(e,t){let i=this._context.configuration.editor.layoutInfo,n=this._context.viewLayout.getCurrentScrollLeft()+t.x-e.x-i.contentLeft
return cp._getMouseColumn(n,this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){if(e<0)return 1
return Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(i,n,s,r){let o=new e(s,r),a=i.getLineWidth(s)
if(n.mouseContentHorizontalOffset>a)return La&&1===o.column?n.fulfill(bm.CONTENT_EMPTY,new e(s,i.model.getLineMaxColumn(s))):n.fulfill(bm.CONTENT_EMPTY,o)
let l=i.visibleRangeForPosition2(s,r)
if(!l)return n.fulfill(bm.UNKNOWN,o)
let h,d=l.left
if(n.mouseContentHorizontalOffset===d)return n.fulfill(bm.CONTENT_TEXT,o)
if(r>1){let e=l.left
if(h=(h=(h=!1)||e<n.mouseContentHorizontalOffset&&n.mouseContentHorizontalOffset<d)||d<n.mouseContentHorizontalOffset&&n.mouseContentHorizontalOffset<e){let e=new t(s,r,s,r-1)
return n.fulfill(bm.CONTENT_TEXT,o,e)}}if(r<i.model.getLineMaxColumn(s)){let e=i.visibleRangeForPosition2(s,r+1)
if(e){let i=e.left
if(h=(h=(h=!1)||d<n.mouseContentHorizontalOffset&&n.mouseContentHorizontalOffset<i)||i<n.mouseContentHorizontalOffset&&n.mouseContentHorizontalOffset<d){let e=new t(s,r,s,r+1)
return n.fulfill(bm.CONTENT_TEXT,o,e)}}}return n.fulfill(bm.CONTENT_TEXT,o)}static _doHitTestWithCaretRangeFromPoint(e,t){let i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.getVerticalOffsetForLineNumber(i)+Math.floor(e.lineHeight/2),s=t.pos.y+(n-t.mouseVerticalOffset)
s<=t.editorPos.y&&(s=t.editorPos.y+1),s>=t.editorPos.y+e.layoutInfo.height&&(s=t.editorPos.y+e.layoutInfo.height-1)
let r=new xm(t.pos.x,s),o=this._actualDoHitTestWithCaretRangeFromPoint(e,r.toClientCoordinates())
return o.position?o:this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates())}static _actualDoHitTestWithCaretRangeFromPoint(e,t){let i=document.caretRangeFromPoint(t.clientX,t.clientY)
if(!i||!i.startContainer)return{position:null,hitTarget:null}
let n,s=i.startContainer
if(s.nodeType===s.TEXT_NODE){let t=s.parentNode,r=t?t.parentNode:null,o=r?r.parentNode:null
if((o&&o.nodeType===o.ELEMENT_NODE?o.className:null)===ep.CLASS_NAME)return{position:e.getPositionFromDOMInfo(t,i.startOffset),hitTarget:null}
n=s.parentNode}else if(s.nodeType===s.ELEMENT_NODE){let t=s.parentNode,i=t?t.parentNode:null
if((i&&i.nodeType===i.ELEMENT_NODE?i.className:null)===ep.CLASS_NAME)return{position:e.getPositionFromDOMInfo(s,s.textContent.length),hitTarget:null}
n=s}return{position:null,hitTarget:n}}static _doHitTestWithCaretPositionFromPoint(e,t){let i=document.caretPositionFromPoint(t.clientX,t.clientY)
if(i.offsetNode.nodeType===i.offsetNode.TEXT_NODE){let t=i.offsetNode.parentNode,n=t?t.parentNode:null,s=n?n.parentNode:null
return(s&&s.nodeType===s.ELEMENT_NODE?s.className:null)===ep.CLASS_NAME?{position:e.getPositionFromDOMInfo(i.offsetNode.parentNode,i.offset),hitTarget:null}:{position:null,hitTarget:i.offsetNode.parentNode}}return{position:null,hitTarget:i.offsetNode}}static _doHitTestWithMoveToPoint(e,t){let i=null,n=null,s=document.body.createTextRange()
try{s.moveToPoint(t.clientX,t.clientY)}catch(e){return{position:null,hitTarget:null}}s.collapse(!0)
let r=s?s.parentElement():null,o=r?r.parentNode:null,a=o?o.parentNode:null
if((a&&a.nodeType===a.ELEMENT_NODE?a.className:"")===ep.CLASS_NAME){let t=s.duplicate()
t.moveToElementText(r),t.setEndPoint("EndToStart",s),i=e.getPositionFromDOMInfo(r,t.text.length),t.moveToElementText(e.viewDomNode)}else n=r
return s.moveToElementText(e.viewDomNode),{position:i,hitTarget:n}}static _doHitTest(e,t){return document.caretRangeFromPoint?this._doHitTestWithCaretRangeFromPoint(e,t):document.caretPositionFromPoint?this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates()):document.body.createTextRange?this._doHitTestWithMoveToPoint(e,t.pos.toClientCoordinates()):{position:null,hitTarget:null}}}function gp(e){return function(t,i){let n=!1
return e&&(n=e.mouseTargetIsWidget(i)),n||i.preventDefault(),i}}class mp extends Xu{constructor(e,t,i){super(),this._isFocused=!1,this._context=e,this.viewController=t,this.viewHelper=i,this.mouseTargetFactory=new cp(this._context,i),this._mouseDownOperation=this._register(new pp(this._context,this.viewController,this.viewHelper,(e,t)=>this._createMouseTarget(e,t),e=>this._getMouseColumn(e))),this._asyncFocus=this._register(new Ca(()=>this.viewHelper.focusTextArea(),0)),this.lastMouseLeaveTime=-1
let n=new Im(this.viewHelper.viewDomNode)
this._register(n.onContextMenu(this.viewHelper.viewDomNode,e=>this._onContextMenu(e,!0))),this._register(n.onMouseMoveThrottled(this.viewHelper.viewDomNode,e=>this._onMouseMove(e),gp(this.mouseTargetFactory),mp.MOUSE_MOVE_MINIMUM_TIME)),this._register(n.onMouseUp(this.viewHelper.viewDomNode,e=>this._onMouseUp(e))),this._register(n.onMouseLeave(this.viewHelper.viewDomNode,e=>this._onMouseLeave(e))),this._register(n.onMouseDown(this.viewHelper.viewDomNode,e=>this._onMouseDown(e)))
let s=e=>{if(!this._context.configuration.editor.viewInfo.mouseWheelZoom)return
let t=new qa(e)
if(t.browserEvent.ctrlKey||t.browserEvent.metaKey){let e=Nu.getZoomLevel(),i=t.deltaY>0?1:-1
Nu.setZoomLevel(e+i),t.preventDefault(),t.stopPropagation()}}
this._register(il(this.viewHelper.viewDomNode,"mousewheel",s,!0)),this._register(il(this.viewHelper.viewDomNode,"DOMMouseScroll",s,!0)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return this._isFocused=e.isFocused,!1}onScrollChanged(e){return this._mouseDownOperation.onScrollChanged(),!1}getTargetAtClientPoint(e,t){let i=new Lm(e,t).toPageCoordinates(),n=Em(this.viewHelper.viewDomNode)
if(i.y<n.y||i.y>n.y+n.height||i.x<n.x||i.x>n.x+n.width)return null
let s=this.viewHelper.getLastViewCursorsRenderData()
return this.mouseTargetFactory.createMouseTarget(s,n,i,null)}_createMouseTarget(e,t){let i=this.viewHelper.getLastViewCursorsRenderData()
return this.mouseTargetFactory.createMouseTarget(i,e.editorPos,e.pos,t?e.target:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.editorPos,e.pos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){if(this._mouseDownOperation.isActive())return
e.timestamp<this.lastMouseLeaveTime||this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this.lastMouseLeaveTime=(new Date).getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e){let t=this._createMouseTarget(e,!0),i=t.type===bm.CONTENT_TEXT||t.type===bm.CONTENT_EMPTY,n=t.type===bm.GUTTER_GLYPH_MARGIN||t.type===bm.GUTTER_LINE_NUMBERS||t.type===bm.GUTTER_LINE_DECORATIONS,s=t.type===bm.GUTTER_LINE_NUMBERS,r=this._context.configuration.editor.viewInfo.selectOnLineNumbers,o=t.type===bm.CONTENT_VIEW_ZONE||t.type===bm.GUTTER_VIEW_ZONE,a=t.type===bm.CONTENT_WIDGET,l=e.leftButton
k&&e.ctrlKey&&(l=!1)
let h=()=>{xa&&!this._isFocused?this._asyncFocus.schedule():(e.preventDefault(),this.viewHelper.focusTextArea())}
if(l&&(i||s&&r))h(),this._mouseDownOperation.start(t.type,e)
else if(n)e.preventDefault()
else if(o){let i=t.detail
this.viewHelper.shouldSuppressMouseDownOnViewZone(i.viewZoneId)&&(h(),this._mouseDownOperation.start(t.type,e),e.preventDefault())}else a&&this.viewHelper.shouldSuppressMouseDownOnWidget(t.detail)&&(h(),e.preventDefault())
this.viewController.emitMouseDown({event:e,target:t})}}mp.MOUSE_MOVE_MINIMUM_TIME=100
class pp extends ni{constructor(e,t,i,n,s){super(),this._context=e,this._viewController=t,this._viewHelper=i,this._createMouseTarget=n,this._getMouseColumn=s,this._mouseMoveMonitor=this._register(new Mm(this._viewHelper.viewDomNode)),this._onScrollTimeout=this._register(new fa),this._mouseState=new fp,this._currentSelection=new At(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(e){this._lastMouseEvent=e,this._mouseState.setModifiers(e)
let t=this._findMousePosition(e,!0)
t&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:e,target:t}):this._dispatchMouse(t,!0))}start(e,t){this._lastMouseEvent=t,this._mouseState.setStartedOnLineNumbers(e===bm.GUTTER_LINE_NUMBERS),this._mouseState.setModifiers(t)
let i=this._findMousePosition(t,!0)
if(i){if(this._mouseState.trySetCount(t.detail,i.position),t.detail=this._mouseState.count,!this._context.configuration.editor.readOnly&&this._context.configuration.editor.dragAndDrop&&!this._mouseState.altKey&&t.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&this._currentSelection.containsPosition(i.position))return this._mouseState.isDragAndDrop=!0,this._isActive=!0,void this._mouseMoveMonitor.startMonitoring(gp(null),e=>this._onMouseDownThenMove(e),()=>{let e=this._findMousePosition(this._lastMouseEvent,!0)
this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:e?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()})
this._mouseState.isDragAndDrop=!1,this._dispatchMouse(i,t.shiftKey),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(gp(null),e=>this._onMouseDownThenMove(e),()=>this._stop()))}}_stop(){this._isActive=!1,this._onScrollTimeout.cancel()}onScrollChanged(){this._isActive&&this._onScrollTimeout.setIfNotSet(()=>{let e=this._findMousePosition(this._lastMouseEvent,!1)
e&&(this._mouseState.isDragAndDrop||this._dispatchMouse(e,!0))},10)}onCursorStateChanged(e){this._currentSelection=e.selections[0]}_getPositionOutsideEditor(t){const i=t.editorPos,n=this._context.model,s=this._context.viewLayout,r=this._getMouseColumn(t)
if(t.posy<i.y){let n=s.getLineNumberAtVerticalOffset(Math.max(s.getCurrentScrollTop()-(i.y-t.posy),0))
return new ap(null,bm.OUTSIDE_EDITOR,r,new e(n,1))}if(t.posy>i.y+i.height){let o=s.getLineNumberAtVerticalOffset(s.getCurrentScrollTop()+(t.posy-i.y))
return new ap(null,bm.OUTSIDE_EDITOR,r,new e(o,n.getLineMaxColumn(o)))}let o=s.getLineNumberAtVerticalOffset(s.getCurrentScrollTop()+(t.posy-i.y))
return t.posx<i.x?new ap(null,bm.OUTSIDE_EDITOR,r,new e(o,1)):t.posx>i.x+i.width?new ap(null,bm.OUTSIDE_EDITOR,r,new e(o,n.getLineMaxColumn(o))):null}_findMousePosition(t,i){let n=this._getPositionOutsideEditor(t)
if(n)return n
let s=this._createMouseTarget(t,i)
if(!s.position)return null
if(s.type===bm.CONTENT_VIEW_ZONE||s.type===bm.GUTTER_VIEW_ZONE){let t=new e(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),i=s.detail,n=i.positionBefore,r=i.positionAfter
if(n&&r)return n.isBefore(t)?new ap(s.element,s.type,s.mouseColumn,n,null,s.detail):new ap(s.element,s.type,s.mouseColumn,r,null,s.detail)}return s}_dispatchMouse(e,t){this._viewController.dispatchMouse({position:e.position,mouseColumn:e.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,inSelectionMode:t,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey})}}class fp{constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get shiftKey(){return this._shiftKey}get startedOnLineNumbers(){return this._startedOnLineNumbers}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){let i=(new Date).getTime()
i-this._lastSetMouseDownCountTime>fp.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=i,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}}function _p(e,t){let i={translationY:t.translationY,translationX:t.translationX}
return e&&(i.translationY+=e.translationY,i.translationX+=e.translationX),i}fp.CLEAR_MOUSE_DOWN_COUNT_TIME=400
class Cp extends mp{constructor(e,t,i){super(e,t,i),this.viewHelper.linesContentDomNode.style.msTouchAction="none",this.viewHelper.linesContentDomNode.style.msContentZooming="none",this._installGestureHandlerTimeout=window.setTimeout(()=>{if(this._installGestureHandlerTimeout=-1,window.MSGesture){let e=new MSGesture,t=new MSGesture
e.target=this.viewHelper.linesContentDomNode,t.target=this.viewHelper.linesContentDomNode,this.viewHelper.linesContentDomNode.addEventListener("MSPointerDown",i=>{let n=i.pointerType
n!==(i.MSPOINTER_TYPE_MOUSE||"mouse")?n===(i.MSPOINTER_TYPE_TOUCH||"touch")?(this._lastPointerType="touch",e.addPointer(i.pointerId)):(this._lastPointerType="pen",t.addPointer(i.pointerId)):this._lastPointerType="mouse"}),this._register(cl(this.viewHelper.linesContentDomNode,"MSGestureChange",e=>this._onGestureChange(e),_p)),this._register(il(this.viewHelper.linesContentDomNode,"MSGestureTap",e=>this._onCaptureGestureTap(e),!0))}},100),this._lastPointerType="mouse"}_onMouseDown(e){"mouse"===this._lastPointerType&&super._onMouseDown(e)}_onCaptureGestureTap(e){let t=new km(e,this.viewHelper.viewDomNode),i=this._createMouseTarget(t,!1)
i.position&&this.viewController.moveTo(i.position),t.browserEvent.fromElement?(t.preventDefault(),this.viewHelper.focusTextArea()):setTimeout(()=>{this.viewHelper.focusTextArea()})}_onGestureChange(e){this._context.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}dispose(){window.clearTimeout(this._installGestureHandlerTimeout),super.dispose()}}class bp extends mp{constructor(e,t,i){super(e,t,i),this.viewHelper.linesContentDomNode.style.touchAction="none",this._installGestureHandlerTimeout=window.setTimeout(()=>{if(this._installGestureHandlerTimeout=-1,window.MSGesture){let e=new MSGesture,t=new MSGesture
e.target=this.viewHelper.linesContentDomNode,t.target=this.viewHelper.linesContentDomNode,this.viewHelper.linesContentDomNode.addEventListener("pointerdown",i=>{let n=i.pointerType
"mouse"!==n?"touch"===n?(this._lastPointerType="touch",e.addPointer(i.pointerId)):(this._lastPointerType="pen",t.addPointer(i.pointerId)):this._lastPointerType="mouse"}),this._register(cl(this.viewHelper.linesContentDomNode,"MSGestureChange",e=>this._onGestureChange(e),_p)),this._register(il(this.viewHelper.linesContentDomNode,"MSGestureTap",e=>this._onCaptureGestureTap(e),!0))}},100),this._lastPointerType="mouse"}_onMouseDown(e){"mouse"===this._lastPointerType&&super._onMouseDown(e)}_onCaptureGestureTap(e){let t=new km(e,this.viewHelper.viewDomNode),i=this._createMouseTarget(t,!1)
i.position&&this.viewController.moveTo(i.position),t.browserEvent.fromElement?(t.preventDefault(),this.viewHelper.focusTextArea()):setTimeout(()=>{this.viewHelper.focusTextArea()})}_onGestureChange(e){this._context.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}dispose(){window.clearTimeout(this._installGestureHandlerTimeout),super.dispose()}}class wp extends mp{constructor(e,t,i){super(e,t,i),this.gesture=new vm(this.viewHelper.linesContentDomNode),this._register(il(this.viewHelper.linesContentDomNode,gm.Tap,e=>this.onTap(e))),this._register(il(this.viewHelper.linesContentDomNode,gm.Change,e=>this.onChange(e))),this._register(il(this.viewHelper.linesContentDomNode,gm.Contextmenu,e=>this._onContextMenu(new km(e,this.viewHelper.viewDomNode),!1)))}dispose(){this.gesture.dispose(),super.dispose()}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea()
let t=this._createMouseTarget(new km(e,this.viewHelper.viewDomNode),!1)
t.position&&this.viewController.moveTo(t.position)}onChange(e){this._context.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}}class vp{constructor(e,t,i){window.navigator.msPointerEnabled?this.handler=new Cp(e,t,i):window.TouchEvent?this.handler=new wp(e,t,i):window.navigator.pointerEnabled?this.handler=new bp(e,t,i):this.handler=new mp(e,t,i)}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}dispose(){this.handler.dispose()}}class Sp{constructor(e,t,i,n,s){this.configuration=e,this.viewModel=t,this._execCoreEditorCommandFunc=i,this.outgoingEvents=n,this.commandService=s}_execMouseCommand(e,t){t.source="mouse",this._execCoreEditorCommandFunc(e,t)}paste(e,t,i){this.commandService.executeCommand(f.Paste,{text:t,pasteOnNewLine:i})}type(e,t){this.commandService.executeCommand(f.Type,{text:t})}replacePreviousChar(e,t,i){this.commandService.executeCommand(f.ReplacePreviousChar,{text:t,replaceCharCnt:i})}compositionStart(e){this.commandService.executeCommand(f.CompositionStart,{})}compositionEnd(e){this.commandService.executeCommand(f.CompositionEnd,{})}cut(e){this.commandService.executeCommand(f.Cut,{})}setSelection(e,t){this._execCoreEditorCommandFunc(ta.SetSelection,{source:e,selection:t})}_validateViewColumn(t){let i=this.viewModel.getLineMinColumn(t.lineNumber)
return t.column<i?new e(t.lineNumber,i):t}_hasMulticursorModifier(e){switch(this.configuration.editor.multiCursorModifier){case"altKey":return e.altKey
case"ctrlKey":return e.ctrlKey
case"metaKey":return e.metaKey}return!1}_hasNonMulticursorModifier(e){switch(this.configuration.editor.multiCursorModifier){case"altKey":return e.ctrlKey||e.metaKey
case"ctrlKey":return e.altKey||e.metaKey
case"metaKey":return e.ctrlKey||e.altKey}return!1}dispatchMouse(e){e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this.lastCursorLineSelect(e.position):this.createCursor(e.position,!0):e.inSelectionMode?this.lineSelectDrag(e.position):this.lineSelect(e.position):e.mouseDownCount>=4?this.selectAll():3===e.mouseDownCount?this._hasMulticursorModifier(e)?e.inSelectionMode?this.lastCursorLineSelectDrag(e.position):this.lastCursorLineSelect(e.position):e.inSelectionMode?this.lineSelectDrag(e.position):this.lineSelect(e.position):2===e.mouseDownCount?this._hasMulticursorModifier(e)?this.lastCursorWordSelect(e.position):e.inSelectionMode?this.wordSelectDrag(e.position):this.wordSelect(e.position):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this.columnSelect(e.position,e.mouseColumn):e.inSelectionMode?this.lastCursorMoveToSelect(e.position):this.createCursor(e.position,!1)):e.inSelectionMode?this.moveToSelect(e.position):this.moveTo(e.position)}_usualArgs(e){return e=this._validateViewColumn(e),{position:this.convertViewToModelPosition(e),viewPosition:e}}moveTo(e){this._execMouseCommand(ta.MoveTo,this._usualArgs(e))}moveToSelect(e){this._execMouseCommand(ta.MoveToSelect,this._usualArgs(e))}columnSelect(e,t){e=this._validateViewColumn(e),this._execMouseCommand(ta.ColumnSelect,{position:this.convertViewToModelPosition(e),viewPosition:e,mouseColumn:t})}createCursor(e,t){e=this._validateViewColumn(e),this._execMouseCommand(ta.CreateCursor,{position:this.convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}lastCursorMoveToSelect(e){this._execMouseCommand(ta.LastCursorMoveToSelect,this._usualArgs(e))}wordSelect(e){this._execMouseCommand(ta.WordSelect,this._usualArgs(e))}wordSelectDrag(e){this._execMouseCommand(ta.WordSelectDrag,this._usualArgs(e))}lastCursorWordSelect(e){this._execMouseCommand(ta.LastCursorWordSelect,this._usualArgs(e))}lineSelect(e){this._execMouseCommand(ta.LineSelect,this._usualArgs(e))}lineSelectDrag(e){this._execMouseCommand(ta.LineSelectDrag,this._usualArgs(e))}lastCursorLineSelect(e){this._execMouseCommand(ta.LastCursorLineSelect,this._usualArgs(e))}lastCursorLineSelectDrag(e){this._execMouseCommand(ta.LastCursorLineSelectDrag,this._usualArgs(e))}selectAll(){this._execMouseCommand(ta.SelectAll,{})}convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.outgoingEvents.emitKeyDown(e)}emitKeyUp(e){this.outgoingEvents.emitKeyUp(e)}emitContextMenu(e){this.outgoingEvents.emitContextMenu(e)}emitMouseMove(e){this.outgoingEvents.emitMouseMove(e)}emitMouseLeave(e){this.outgoingEvents.emitMouseLeave(e)}emitMouseUp(e){this.outgoingEvents.emitMouseUp(e)}emitMouseDown(e){this.outgoingEvents.emitMouseDown(e)}emitMouseDrag(e){this.outgoingEvents.emitMouseDrag(e)}emitMouseDrop(e){this.outgoingEvents.emitMouseDrop(e)}}class yp{constructor(e){this._eventHandlerGateKeeper=e,this._eventHandlers=[],this._eventQueue=null,this._isConsumingQueue=!1}addEventHandler(e){for(let t=0,i=this._eventHandlers.length;t<i;t++)this._eventHandlers[t]===e&&console.warn("Detected duplicate listener in ViewEventDispatcher",e)
this._eventHandlers.push(e)}removeEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1)
break}}emit(e){this._eventQueue?this._eventQueue.push(e):this._eventQueue=[e],this._isConsumingQueue||this.consumeQueue()}emitMany(e){this._eventQueue?this._eventQueue=this._eventQueue.concat(e):this._eventQueue=e,this._isConsumingQueue||this.consumeQueue()}consumeQueue(){this._eventHandlerGateKeeper(()=>{try{this._isConsumingQueue=!0,this._doConsumeQueue()}finally{this._isConsumingQueue=!1}})}_doConsumeQueue(){for(;this._eventQueue;){let e=this._eventQueue
this._eventQueue=null
let t=this._eventHandlers.slice(0)
for(let i=0,n=t.length;i<n;i++)t[i].handleEvents(e)}}}class xp{constructor(e){this._createLine=e,this._set(1,[])}flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){let t=e-this._rendLineNumberStart
if(t<0||t>=this._lines.length)throw new Error("Illegal value for lineNumber: "+e)
return this._lines[t]}onLinesDeleted(e,t){if(0===this.getCount())return null
let i=this.getStartLineNumber(),n=this.getEndLineNumber()
if(t<i){let i=t-e+1
return this._rendLineNumberStart-=i,null}if(e>n)return null
let s=0,r=0
for(let o=i;o<=n;o++){let i=o-this._rendLineNumberStart
e<=o&&o<=t&&(0===r?(s=i,r=1):r++)}if(e<i){let n=0
n=t<i?t-e+1:i-e,this._rendLineNumberStart-=n}return this._lines.splice(s,r)}onLinesChanged(e,t){if(0===this.getCount())return!1
let i=this.getStartLineNumber(),n=this.getEndLineNumber(),s=!1
for(let r=e;r<=t;r++)r>=i&&r<=n&&(this._lines[r-this._rendLineNumberStart].onContentChanged(),s=!0)
return s}onLinesInserted(e,t){if(0===this.getCount())return null
let i=t-e+1,n=this.getStartLineNumber(),s=this.getEndLineNumber()
if(e<=n)return this._rendLineNumberStart+=i,null
if(e>s)return null
if(i+e>s)return this._lines.splice(e-this._rendLineNumberStart,s-e+1)
let r=[]
for(let e=0;e<i;e++)r[e]=this._createLine()
let o=e-this._rendLineNumberStart,a=this._lines.slice(0,o),l=this._lines.slice(o,this._lines.length-i),h=this._lines.slice(this._lines.length-i,this._lines.length)
return this._lines=a.concat(r).concat(l),h}onTokensChanged(e){if(0===this.getCount())return!1
let t=this.getStartLineNumber(),i=this.getEndLineNumber(),n=!1
for(let s=0,r=e.length;s<r;s++){let r=e[s]
if(r.toLineNumber<t||r.fromLineNumber>i)continue
let o=Math.max(t,r.fromLineNumber),a=Math.min(i,r.toLineNumber)
for(let e=o;e<=a;e++){let t=e-this._rendLineNumberStart
this._lines[t].onTokensChanged(),n=!0}}return n}}class Lp{constructor(e){this._host=e,this.domNode=this._createDomNode(),this._linesCollection=new xp(()=>this._host.createVisibleLine())}_createDomNode(){let e=Zu(document.createElement("div"))
return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return e.layoutInfo}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.toLineNumber)}onLinesDeleted(e){let t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber)
if(t)for(let e=0,i=t.length;e<i;e++){let i=t[e].getDomNode()
i&&this.domNode.domNode.removeChild(i)}return!0}onLinesInserted(e){let t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber)
if(t)for(let e=0,i=t.length;e<i;e++){let i=t[e].getDomNode()
i&&this.domNode.domNode.removeChild(i)}return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){let t=this._linesCollection._get(),i=new Np(this.domNode.domNode,this._host,e),n={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},s=i.render(n,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset)
this._linesCollection._set(s.rendLineNumberStart,s.lines)}}class Np{constructor(e,t,i){this.domNode=e,this.host=t,this.viewportData=i}render(e,t,i,n){let s={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength}
if(s.rendLineNumberStart+s.linesLength-1<t||i<s.rendLineNumberStart){s.rendLineNumberStart=t,s.linesLength=i-t+1,s.lines=[]
for(let e=t;e<=i;e++)s.lines[e-t]=this.host.createVisibleLine()
return this._finishRendering(s,!0,n),s}if(this._renderUntouchedLines(s,Math.max(t-s.rendLineNumberStart,0),Math.min(i-s.rendLineNumberStart,s.linesLength-1),n,t),s.rendLineNumberStart>t){let e=t,r=Math.min(i,s.rendLineNumberStart-1)
e<=r&&(this._insertLinesBefore(s,e,r,n,t),s.linesLength+=r-e+1)}else if(s.rendLineNumberStart<t){let e=Math.min(s.linesLength,t-s.rendLineNumberStart)
e>0&&(this._removeLinesBefore(s,e),s.linesLength-=e)}if(s.rendLineNumberStart=t,s.rendLineNumberStart+s.linesLength-1<i){let e=s.rendLineNumberStart+s.linesLength,r=i
e<=r&&(this._insertLinesAfter(s,e,r,n,t),s.linesLength+=r-e+1)}else if(s.rendLineNumberStart+s.linesLength-1>i){let e=Math.max(0,i-s.rendLineNumberStart+1),t=s.linesLength-1-e+1
t>0&&(this._removeLinesAfter(s,t),s.linesLength-=t)}return this._finishRendering(s,!1,n),s}_renderUntouchedLines(e,t,i,n,s){const r=e.rendLineNumberStart,o=e.lines
for(let e=t;e<=i;e++){let t=r+e
o[e].layoutLine(t,n[t-s])}}_insertLinesBefore(e,t,i,n,s){let r=[],o=0
for(let e=t;e<=i;e++)r[o++]=this.host.createVisibleLine()
e.lines=r.concat(e.lines)}_removeLinesBefore(e,t){for(let i=0;i<t;i++){let t=e.lines[i].getDomNode()
t&&this.domNode.removeChild(t)}e.lines.splice(0,t)}_insertLinesAfter(e,t,i,n,s){let r=[],o=0
for(let e=t;e<=i;e++)r[o++]=this.host.createVisibleLine()
e.lines=e.lines.concat(r)}_removeLinesAfter(e,t){let i=e.linesLength-t
for(let n=0;n<t;n++){let t=e.lines[i+n].getDomNode()
t&&this.domNode.removeChild(t)}e.lines.splice(i,t)}_finishRenderingNewLines(e,t,i,n){let s=this.domNode.lastChild
t||!s?this.domNode.innerHTML=i:s.insertAdjacentHTML("afterend",i)
let r=this.domNode.lastChild
for(let t=e.linesLength-1;t>=0;t--){let i=e.lines[t]
n[t]&&(i.setDomNode(r),r=r.previousSibling)}}_finishRenderingInvalidLines(e,t,i){let n=document.createElement("div")
n.innerHTML=t
for(let t=0;t<e.linesLength;t++){let s=e.lines[t]
if(i[t]){let e=n.firstChild,t=s.getDomNode()
t.parentNode.replaceChild(e,t),s.setDomNode(e)}}}_finishRendering(e,t,i){const n=Np._sb,s=e.linesLength,r=e.lines,o=e.rendLineNumberStart
let a=[]
{n.reset()
let l=!1
for(let e=0;e<s;e++){const t=r[e];(a[e]=!1,t.getDomNode())||t.renderLine(e+o,i[e],this.viewportData,n)&&(a[e]=!0,l=!0)}l&&this._finishRenderingNewLines(e,t,n.build(),a)}{n.reset()
let t=!1,l=[]
for(let e=0;e<s;e++){let s=r[e]
if(l[e]=!1,a[e])continue
s.renderLine(e+o,i[e],this.viewportData,n)&&(l[e]=!0,t=!0)}t&&this._finishRenderingInvalidLines(e,n.build(),l)}}}Np._sb=Am(1e5)
class Ep extends sc{constructor(e){super(e),this._visibleLines=new Lp(this),this.domNode=this._visibleLines.domNode,this._dynamicOverlays=[],this._isFocused=!1,this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0
for(let e=0,t=this._dynamicOverlays.length;e<t;e++){if(this._dynamicOverlays[e].shouldRender())return!0}return!1}dispose(){super.dispose()
for(let e=0,t=this._dynamicOverlays.length;e<t;e++){this._dynamicOverlays[e].dispose()}this._dynamicOverlays=null}getDomNode(){return this.domNode}createVisibleLine(){return new kp(this._context.configuration,this._dynamicOverlays)}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e)
let t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber()
for(let n=t;n<=i;n++){this._visibleLines.getVisibleLine(n).onConfigurationChanged(e)}return!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){let t=this._dynamicOverlays.filter(e=>e.shouldRender())
for(let i=0,n=t.length;i<n;i++){let n=t[i]
n.prepareRender(e),n.onDidRender()}return null}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}}class kp{constructor(e,t){this._configuration=e,this._lineHeight=this._configuration.editor.lineHeight,this._dynamicOverlays=t,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=Zu(e)}onContentChanged(){}onTokensChanged(){}onConfigurationChanged(e){e.lineHeight&&(this._lineHeight=this._configuration.editor.lineHeight)}renderLine(e,t,i,n){let s=""
for(let t=0,n=this._dynamicOverlays.length;t<n;t++){s+=this._dynamicOverlays[t].render(i.startLineNumber,e)}return this._renderedContent!==s&&(this._renderedContent=s,n.appendASCIIString('<div style="position:absolute;top:'),n.appendASCIIString(String(t)),n.appendASCIIString("px;width:100%;height:"),n.appendASCIIString(String(this._lineHeight)),n.appendASCIIString('px;">'),n.appendASCIIString(s),n.appendASCIIString("</div>"),!0)}layoutLine(e,t){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(this._lineHeight))}}class Ip extends Ep{constructor(e){super(e),this._contentWidth=this._context.configuration.editor.layoutInfo.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){return e.layoutInfo&&(this._contentWidth=this._context.configuration.editor.layoutInfo.contentWidth),super.onConfigurationChanged(e)}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}}class Mp extends Ep{constructor(e){super(e),this._contentLeft=this._context.configuration.editor.layoutInfo.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),ju.applyFontInfo(this.domNode,this._context.configuration.editor.fontInfo)}onConfigurationChanged(e){let t=!1
return e.fontInfo&&(ju.applyFontInfo(this.domNode,this._context.configuration.editor.fontInfo),t=!0),e.layoutInfo&&(this._contentLeft=this._context.configuration.editor.layoutInfo.contentLeft,t=!0),super.onConfigurationChanged(e)||t}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e)
let t=Math.min(e.scrollHeight,1e6)
this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}}class Dp{constructor(e,t){this.top=e,this.left=t}}class Tp extends sc{constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=Zu(document.createElement("div")),rc.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=Zu(document.createElement("div")),rc.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets=null,this.domNode=null}onConfigurationChanged(e){let t=Object.keys(this._widgets)
for(let i=0,n=t.length;i<n;i++){const n=t[i]
this._widgets[n].onConfigurationChanged(e)}return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){let t=Object.keys(this._widgets)
for(let i=0,n=t.length;i<n;i++){const n=t[i]
this._widgets[n].onLineMappingChanged(e)}return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}addWidget(e){const t=new Op(this._context,this._viewDomNode,e)
this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,i){this._widgets[e.getId()].setPosition(t,i),this.setShouldRender()}removeWidget(e){const t=e.getId()
if(this._widgets.hasOwnProperty(t)){const e=this._widgets[t]
delete this._widgets[t]
const i=e.domNode.domNode
i.parentNode.removeChild(i),i.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return!!this._widgets.hasOwnProperty(e)&&this._widgets[e].suppressMouseDown}onBeforeRender(e){let t=Object.keys(this._widgets)
for(let i=0,n=t.length;i<n;i++){const n=t[i]
this._widgets[n].onBeforeRender(e)}}prepareRender(e){let t=Object.keys(this._widgets)
for(let i=0,n=t.length;i<n;i++){const n=t[i]
this._widgets[n].prepareRender(e)}}render(e){let t=Object.keys(this._widgets)
for(let i=0,n=t.length;i<n;i++){const n=t[i]
this._widgets[n].render(e)}}}class Op{constructor(e,t,i){this._context=e,this._viewDomNode=t,this._actual=i,this.domNode=Zu(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1,this._fixedOverflowWidgets=this._context.configuration.editor.viewInfo.fixedOverflowWidgets,this._contentWidth=this._context.configuration.editor.layoutInfo.contentWidth,this._contentLeft=this._context.configuration.editor.layoutInfo.contentLeft,this._lineHeight=this._context.configuration.editor.lineHeight,this._setPosition(null),this._preference=null,this._cachedDomNodeClientWidth=-1,this._cachedDomNodeClientHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){e.lineHeight&&(this._lineHeight=this._context.configuration.editor.lineHeight),e.layoutInfo&&(this._contentLeft=this._context.configuration.editor.layoutInfo.contentLeft,this._contentWidth=this._context.configuration.editor.layoutInfo.contentWidth,this._maxWidth=this._getMaxWidth())}onLineMappingChanged(e){this._setPosition(this._position)}_setPosition(e){if(this._position=e,this._viewPosition=null,this._position){const e=this._context.model.validateModelPosition(this._position)
this._context.model.coordinatesConverter.modelPositionIsVisible(e)&&(this._viewPosition=this._context.model.coordinatesConverter.convertModelPositionToViewPosition(e))}}_getMaxWidth(){return this.allowEditorOverflow?window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth:this._contentWidth}setPosition(e,t){this._setPosition(e),this._preference=t,this._cachedDomNodeClientWidth=-1,this._cachedDomNodeClientHeight=-1}_layoutBoxInViewport(e,t,i,n){let s=e.top,r=s,o=e.top+this._lineHeight,a=s-i,l=r>=i,h=o,d=n.viewportHeight-o>=i,u=e.left
return u+t>n.scrollLeft+n.viewportWidth&&(u=n.scrollLeft+n.viewportWidth-t),u<n.scrollLeft&&(u=n.scrollLeft),{aboveTop:a,fitsAbove:l,belowTop:h,fitsBelow:d,left:u}}_layoutBoxInPage(e,t,i,n){let s=e.left-n.scrollLeft
if(s+t<0||s>this._contentWidth)return null
let r=e.top-i,o=e.top+this._lineHeight,a=s+this._contentLeft,l=Cl(this._viewDomNode.domNode),h=l.top+r-bl.scrollY,d=l.top+o-bl.scrollY,u=l.left+a-bl.scrollX,c=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,g=h>=22,m=d+i<=(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)-22
if(u+t+20>c){let e=u-(c-t-20)
u-=e,a-=e}if(u<0){let e=u
u-=e,a-=e}return this._fixedOverflowWidgets&&(r=h,o=d,a=u),{aboveTop:r,fitsAbove:g,belowTop:o,fitsBelow:m,left:a}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new Dp(e.top,e.left+this._contentLeft)}_getTopLeft(e){if(!this._viewPosition)return null
const t=e.visibleRangeForPosition(this._viewPosition)
if(!t)return null
const i=e.getVerticalOffsetForLineNumber(this._viewPosition.lineNumber)-e.scrollTop
return new Dp(i,t.left)}_prepareRenderWidget(e,t){if(!e)return null
let i=null,n=()=>{if(!i){if(-1===this._cachedDomNodeClientWidth||-1===this._cachedDomNodeClientHeight){const e=this.domNode.domNode
this._cachedDomNodeClientWidth=e.clientWidth,this._cachedDomNodeClientHeight=e.clientHeight}i=this.allowEditorOverflow?this._layoutBoxInPage(e,this._cachedDomNodeClientWidth,this._cachedDomNodeClientHeight,t):this._layoutBoxInViewport(e,this._cachedDomNodeClientWidth,this._cachedDomNodeClientHeight,t)}}
for(let t=1;t<=2;t++)for(let s=0;s<this._preference.length;s++){let r=this._preference[s]
if(r===pm.ABOVE){if(n(),!i)return null
if(2===t||i.fitsAbove)return new Dp(i.aboveTop,i.left)}else{if(r!==pm.BELOW)return this.allowEditorOverflow?this._prepareRenderWidgetAtExactPositionOverflowing(e):e
if(n(),!i)return null
if(2===t||i.fitsBelow)return new Dp(i.belowTop,i.left)}}return null}onBeforeRender(e){this._viewPosition&&this._preference&&(this._viewPosition.lineNumber<e.startLineNumber||this._viewPosition.lineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth))}prepareRender(e){const t=this._getTopLeft(e)
this._renderData=this._prepareRenderWidget(t,e)}render(e){this._renderData?(this.allowEditorOverflow?(this.domNode.setTop(this._renderData.top),this.domNode.setLeft(this._renderData.left)):(this.domNode.setTop(this._renderData.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0)):this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this.domNode.setVisibility("hidden"))}}class Rp extends lm{constructor(e){super(),this._context=e,this._lineHeight=this._context.configuration.editor.lineHeight,this._readOnly=this._context.configuration.editor.readOnly,this._renderLineHighlight=this._context.configuration.editor.viewInfo.renderLineHighlight,this._selectionIsEmpty=!0,this._primaryCursorIsInEditableRange=!0,this._primaryCursorLineNumber=1,this._scrollWidth=0,this._contentWidth=this._context.configuration.editor.layoutInfo.contentWidth,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._context=null,super.dispose()}onConfigurationChanged(e){return e.lineHeight&&(this._lineHeight=this._context.configuration.editor.lineHeight),e.readOnly&&(this._readOnly=this._context.configuration.editor.readOnly),e.viewInfo&&(this._renderLineHighlight=this._context.configuration.editor.viewInfo.renderLineHighlight),e.layoutInfo&&(this._contentWidth=this._context.configuration.editor.layoutInfo.contentWidth),!0}onCursorStateChanged(e){let t=!1
this._primaryCursorIsInEditableRange!==e.isInEditableRange&&(this._primaryCursorIsInEditableRange=e.isInEditableRange,t=!0)
const i=e.selections[0].positionLineNumber
this._primaryCursorLineNumber!==i&&(this._primaryCursorLineNumber=i,t=!0)
const n=e.selections[0].isEmpty()
return this._selectionIsEmpty!==n?(this._selectionIsEmpty=n,t=!0,!0):t}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){this._scrollWidth=e.scrollWidth}render(e,t){return t===this._primaryCursorLineNumber&&this._shouldShowCurrentLine()?'<div class="'+("current-line"+(this._willRenderMarginCurrentLine()?" current-line-both":""))+'" style="width:'+String(Math.max(this._scrollWidth,this._contentWidth))+"px; height:"+String(this._lineHeight)+'px;"></div>':""}_shouldShowCurrentLine(){return("line"===this._renderLineHighlight||"all"===this._renderLineHighlight)&&this._selectionIsEmpty&&this._primaryCursorIsInEditableRange}_willRenderMarginCurrentLine(){return("gutter"===this._renderLineHighlight||"all"===this._renderLineHighlight)&&this._primaryCursorIsInEditableRange}}Wg((e,t)=>{let i=e.getColor(Vg)
if(i&&t.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${i}; }`),!i||i.isTransparent()||e.defines(Bg)){let i=e.getColor(Bg)
i&&(t.addRule(`.monaco-editor .view-overlays .current-line { border: 2px solid ${i}; }`),"hc"===e.type&&t.addRule(".monaco-editor .view-overlays .current-line { border-width: 1px; }"))}})
class Ap extends lm{constructor(e){super(),this._context=e,this._lineHeight=this._context.configuration.editor.lineHeight,this._renderLineHighlight=this._context.configuration.editor.viewInfo.renderLineHighlight,this._selectionIsEmpty=!0,this._primaryCursorIsInEditableRange=!0,this._primaryCursorLineNumber=1,this._contentLeft=this._context.configuration.editor.layoutInfo.contentLeft,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._context=null,super.dispose()}onConfigurationChanged(e){return e.lineHeight&&(this._lineHeight=this._context.configuration.editor.lineHeight),e.viewInfo&&(this._renderLineHighlight=this._context.configuration.editor.viewInfo.renderLineHighlight),e.layoutInfo&&(this._contentLeft=this._context.configuration.editor.layoutInfo.contentLeft),!0}onCursorStateChanged(e){let t=!1
this._primaryCursorIsInEditableRange!==e.isInEditableRange&&(this._primaryCursorIsInEditableRange=e.isInEditableRange,t=!0)
const i=e.selections[0].positionLineNumber
this._primaryCursorLineNumber!==i&&(this._primaryCursorLineNumber=i,t=!0)
const n=e.selections[0].isEmpty()
return this._selectionIsEmpty!==n?(this._selectionIsEmpty=n,t=!0,!0):t}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onZonesChanged(e){return!0}prepareRender(e){}render(e,t){return t===this._primaryCursorLineNumber&&this._shouldShowCurrentLine()?'<div class="'+("current-line-margin"+(this._willRenderContentCurrentLine()?" current-line-margin-both":""))+'" style="width:'+String(this._contentLeft)+"px; height:"+String(this._lineHeight)+'px;"></div>':""}_shouldShowCurrentLine(){return("gutter"===this._renderLineHighlight||"all"===this._renderLineHighlight)&&this._primaryCursorIsInEditableRange}_willRenderContentCurrentLine(){return("line"===this._renderLineHighlight||"all"===this._renderLineHighlight)&&this._selectionIsEmpty&&this._primaryCursorIsInEditableRange}}Wg((e,t)=>{let i=e.getColor(Vg)
if(i)t.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${i}; border: none; }`)
else{let i=e.getColor(Bg)
i&&t.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { border: 2px solid ${i}; }`),"hc"===e.type&&t.addRule(".monaco-editor .margin-view-overlays .current-line-margin { border-width: 1px; }")}})
class Pp extends lm{constructor(e){super(),this._context=e,this._lineHeight=this._context.configuration.editor.lineHeight,this._typicalHalfwidthCharacterWidth=this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._context=null,this._renderResult=null,super.dispose()}onConfigurationChanged(e){return e.lineHeight&&(this._lineHeight=this._context.configuration.editor.lineHeight),e.fontInfo&&(this._typicalHalfwidthCharacterWidth=this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){let i=e.getDecorationsInViewport(),n=[],s=0
for(let e=0,t=i.length;e<t;e++){let t=i[e]
t.options.className&&(n[s++]=t)}n=n.sort((e,i)=>{let n=e.options.className,s=i.options.className
return n<s?-1:n>s?1:t.compareRangesUsingStarts(e.range,i.range)})
let r=e.visibleRange.startLineNumber,o=e.visibleRange.endLineNumber,a=[]
for(let e=r;e<=o;e++){a[e-r]=""}this._renderWholeLineDecorations(e,n,a),this._renderNormalDecorations(e,n,a),this._renderResult=a}_renderWholeLineDecorations(e,t,i){let n=String(this._lineHeight),s=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber
for(let e=0,o=t.length;e<o;e++){let o=t[e]
if(!o.options.isWholeLine)continue
let a='<div class="cdr '+o.options.className+'" style="left:0;width:100%;height:'+n+'px;"></div>',l=Math.max(o.range.startLineNumber,s),h=Math.min(o.range.endLineNumber,r)
for(let e=l;e<=h;e++){i[e-s]+=a}}}_renderNormalDecorations(e,i,n){let s=String(this._lineHeight),r=e.visibleRange.startLineNumber
for(let o=0,a=i.length;o<a;o++){const a=i[o]
if(a.options.isWholeLine)continue
const l=a.options.className,h=a.options.showIfCollapsed
let d=a.range
h&&1===d.endColumn&&d.endLineNumber!==d.startLineNumber&&(d=new t(d.startLineNumber,d.startColumn,d.endLineNumber-1,this._context.model.getLineMaxColumn(d.endLineNumber-1)))
let u=e.linesVisibleRangesForRange(d,"findMatch"===l)
if(u)for(let e=0,t=u.length;e<t;e++){let t=u[e]
const i=t.lineNumber-r
if(h&&1===t.ranges.length){const e=t.ranges[0]
0===e.width&&(t.ranges[0]=new Gm(e.left,this._typicalHalfwidthCharacterWidth))}for(let e=0,r=t.ranges.length;e<r;e++){const r=t.ranges[e],o='<div class="cdr '+l+'" style="left:'+String(r.left)+"px;width:"+String(r.width)+"px;height:"+s+'px;"></div>'
n[i]+=o}}}}render(e,t){if(!this._renderResult)return""
let i=t-e
if(i<0||i>=this._renderResult.length)throw new Error("Unexpected render request")
return this._renderResult[i]}}class Fp{constructor(e,t,i){this.startLineNumber=+e,this.endLineNumber=+t,this.className=String(i)}}class Wp extends lm{_render(e,t,i){let n=[]
for(let i=e;i<=t;i++){n[i-e]=[]}if(0===i.length)return n
i.sort((e,t)=>e.className===t.className?e.startLineNumber===t.startLineNumber?e.endLineNumber-t.endLineNumber:e.startLineNumber-t.startLineNumber:e.className<t.className?-1:1)
let s=null,r=0
for(let o=0,a=i.length;o<a;o++){let a=i[o],l=a.className,h=Math.max(a.startLineNumber,e)-e,d=Math.min(a.endLineNumber,t)-e
s===l?(h=Math.max(r+1,h),r=Math.max(r,d)):(s=l,r=d)
for(let e=h;e<=r;e++)n[e].push(s)}return n}}class Vp extends Wp{constructor(e){super(),this._context=e,this._lineHeight=this._context.configuration.editor.lineHeight,this._glyphMargin=this._context.configuration.editor.viewInfo.glyphMargin,this._glyphMarginLeft=this._context.configuration.editor.layoutInfo.glyphMarginLeft,this._glyphMarginWidth=this._context.configuration.editor.layoutInfo.glyphMarginWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._context=null,this._renderResult=null,super.dispose()}onConfigurationChanged(e){return e.lineHeight&&(this._lineHeight=this._context.configuration.editor.lineHeight),e.viewInfo&&(this._glyphMargin=this._context.configuration.editor.viewInfo.glyphMargin),e.layoutInfo&&(this._glyphMarginLeft=this._context.configuration.editor.layoutInfo.glyphMarginLeft,this._glyphMarginWidth=this._context.configuration.editor.layoutInfo.glyphMarginWidth),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){let t=e.getDecorationsInViewport(),i=[],n=0
for(let e=0,s=t.length;e<s;e++){let s=t[e],r=s.options.glyphMarginClassName
r&&(i[n++]=new Fp(s.range.startLineNumber,s.range.endLineNumber,r))}return i}prepareRender(e){if(!this._glyphMargin)return void(this._renderResult=null)
let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),s=this._lineHeight.toString(),r='" style="left:'+this._glyphMarginLeft.toString()+"px;width:"+this._glyphMarginWidth.toString()+"px;height:"+s+'px;"></div>',o=[]
for(let e=t;e<=i;e++){let i=e-t,s=n[i]
0===s.length?o[i]="":o[i]='<div class="cgmr '+s.join(" ")+r}this._renderResult=o}render(e,t){if(!this._renderResult)return""
let i=t-e
if(i<0||i>=this._renderResult.length)throw new Error("Unexpected render request")
return this._renderResult[i]}}class Bp extends lm{constructor(e){super(),this._context=e,this._lineHeight=this._context.configuration.editor.lineHeight,this._spaceWidth=this._context.configuration.editor.fontInfo.spaceWidth,this._enabled=this._context.configuration.editor.viewInfo.renderIndentGuides,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._context=null,this._renderResult=null,super.dispose()}onConfigurationChanged(e){return e.lineHeight&&(this._lineHeight=this._context.configuration.editor.lineHeight),e.fontInfo&&(this._spaceWidth=this._context.configuration.editor.fontInfo.spaceWidth),e.viewInfo&&(this._enabled=this._context.configuration.editor.viewInfo.renderIndentGuides),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(t){if(!this._enabled)return void(this._renderResult=null)
const i=t.visibleRange.startLineNumber,n=t.visibleRange.endLineNumber,s=this._context.model.getTabSize()*this._spaceWidth,r=this._lineHeight,o=Bl(1),a=this._context.model.getLinesIndentGuides(i,n)
let l=[]
for(let h=i;h<=n;h++){const n=h-i,d=a[n]
let u="",c=t.visibleRangeForPosition(new e(h,1)),g=c?c.left:0
for(let e=0;e<d;e++)u+=`<div class="cigr" style="left:${g}px;height:${r}px;width:${o}px"></div>`,g+=s
l[n]=u}this._renderResult=l}render(e,t){if(!this._renderResult)return""
let i=t-e
if(i<0||i>=this._renderResult.length)throw new Error("Unexpected render request")
return this._renderResult[i]}}Wg((e,t)=>{let i=e.getColor($g)
i&&t.addRule(`.monaco-editor .lines-content .cigr { background-color: ${i}; }`)})
class Hp{constructor(){this._currentVisibleRange=new t(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}}class zp{constructor(e,t,i,n,s,r){this.lineNumber=e,this.startColumn=t,this.endColumn=i,this.startScrollTop=n,this.stopScrollTop=s,this.scrollType=r}}class Up extends sc{constructor(e,t){super(e),this._linesContent=t,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new Lp(this),this.domNode=this._visibleLines.domNode
const i=this._context.configuration
this._lineHeight=i.editor.lineHeight,this._typicalHalfwidthCharacterWidth=i.editor.fontInfo.typicalHalfwidthCharacterWidth,this._isViewportWrapping=i.editor.wrappingInfo.isViewportWrapping,this._revealHorizontalRightPadding=i.editor.viewInfo.revealHorizontalRightPadding,this._canUseLayerHinting=i.editor.canUseLayerHinting,this._viewLineOptions=new Qm(i,this._context.theme.type),rc.write(this.domNode,7),this.domNode.setClassName("view-lines"),ju.applyFontInfo(this.domNode,i.editor.fontInfo),this._maxLineWidth=0,this._asyncUpdateLineWidths=new Ca(()=>{this._updateLineWidthsSlow()},200),this._lastRenderedData=new Hp,this._horizontalRevealRequest=null}dispose(){this._asyncUpdateLineWidths.dispose(),super.dispose()}getDomNode(){return this.domNode}createVisibleLine(){return new ep(this._viewLineOptions)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.wrappingInfo&&(this._maxLineWidth=0)
const t=this._context.configuration
return e.lineHeight&&(this._lineHeight=t.editor.lineHeight),e.fontInfo&&(this._typicalHalfwidthCharacterWidth=t.editor.fontInfo.typicalHalfwidthCharacterWidth),e.wrappingInfo&&(this._isViewportWrapping=t.editor.wrappingInfo.isViewportWrapping),e.viewInfo&&(this._revealHorizontalRightPadding=t.editor.viewInfo.revealHorizontalRightPadding),e.canUseLayerHinting&&(this._canUseLayerHinting=t.editor.canUseLayerHinting),e.fontInfo&&ju.applyFontInfo(this.domNode,t.editor.fontInfo),this._onOptionsMaybeChanged(),e.layoutInfo&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){const e=this._context.configuration
let t=new Qm(e,this._context.theme.type)
if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t
let e=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber()
for(let t=e;t<=i;t++){this._visibleLines.getVisibleLine(t).onOptionsChanged(this._viewLineOptions)}return!0}return!1}onCursorStateChanged(e){let t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber(),n=!1
for(let e=t;e<=i;e++)n=this._visibleLines.getVisibleLine(e).onSelectionChanged()||n
return n}onDecorationsChanged(e){{let e=this._visibleLines.getStartLineNumber(),t=this._visibleLines.getEndLineNumber()
for(let i=e;i<=t;i++)this._visibleLines.getVisibleLine(i).onDecorationsChanged()}return!0}onFlushed(e){let t=this._visibleLines.onFlushed(e)
return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){const t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.range,e.verticalType)
let i=this._context.viewLayout.validateScrollPosition({scrollTop:t})
e.revealHorizontal?e.range.startLineNumber!==e.range.endLineNumber?i={scrollTop:i.scrollTop,scrollLeft:0}:this._horizontalRevealRequest=new zp(e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType):this._horizontalRevealRequest=null
const n=Math.abs(this._context.viewLayout.getCurrentScrollTop()-i.scrollTop)
return 0===e.scrollType&&n>this._lineHeight?this._context.viewLayout.setScrollPositionSmooth(i):this._context.viewLayout.setScrollPositionNow(i),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){const t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),i=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>i)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(t,i){let n=this._getViewLineDomNode(t)
if(null===n)return null
let s=this._getLineNumberFor(n)
if(-1===s)return null
if(s<1||s>this._context.model.getLineCount())return null
if(1===this._context.model.getLineMaxColumn(s))return new e(s,1)
let r=this._visibleLines.getStartLineNumber(),o=this._visibleLines.getEndLineNumber()
if(s<r||s>o)return null
let a=this._visibleLines.getVisibleLine(s).getColumnOfNodeOffset(s,t,i),l=this._context.model.getLineMinColumn(s)
return a<l&&(a=l),new e(s,a)}_getViewLineDomNode(e){for(;e&&1===e.nodeType;){if(e.className===ep.CLASS_NAME)return e
e=e.parentElement}return null}_getLineNumberFor(e){let t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber()
for(let n=t;n<=i;n++){if(e===this._visibleLines.getVisibleLine(n).getDomNode())return n}return-1}getLineWidth(e){let t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber()
return e<t||e>i?-1:this._visibleLines.getVisibleLine(e).getWidth()}linesVisibleRangesForRange(i,n){if(this.shouldRender())return null
let s=i.endLineNumber
if(!(i=t.intersectRanges(i,this._lastRenderedData.getCurrentVisibleRange())))return null
let r,o=[],a=0,l=new Jm(this.domNode.domNode,this._textRangeRestingSpot)
n&&(r=this._context.model.coordinatesConverter.convertViewPositionToModelPosition(new e(i.startLineNumber,1)).lineNumber)
let h=this._visibleLines.getStartLineNumber(),d=this._visibleLines.getEndLineNumber()
for(let t=i.startLineNumber;t<=i.endLineNumber;t++){if(t<h||t>d)continue
let u=t===i.startLineNumber?i.startColumn:1,c=t===i.endLineNumber?i.endColumn:this._context.model.getLineMaxColumn(t),g=this._visibleLines.getVisibleLine(t).getVisibleRangesForRange(u,c,l)
if(g&&0!==g.length){if(n&&t<s)r!==(r=this._context.model.coordinatesConverter.convertViewPositionToModelPosition(new e(t+1,1)).lineNumber)&&(g[g.length-1].width+=this._typicalHalfwidthCharacterWidth)
o[a++]=new qm(t,g)}}return 0===a?null:o}visibleRangesForRange2(e){if(this.shouldRender())return null
if(!(e=t.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange())))return null
let i=[],n=new Jm(this.domNode.domNode,this._textRangeRestingSpot),s=this._visibleLines.getStartLineNumber(),r=this._visibleLines.getEndLineNumber()
for(let t=e.startLineNumber;t<=e.endLineNumber;t++){if(t<s||t>r)continue
let o=t===e.startLineNumber?e.startColumn:1,a=t===e.endLineNumber?e.endColumn:this._context.model.getLineMaxColumn(t),l=this._visibleLines.getVisibleLine(t).getVisibleRangesForRange(o,a,n)
l&&0!==l.length&&(i=i.concat(l))}return 0===i.length?null:i}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidths(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber()
let n=1,s=!0
for(let r=t;r<=i;r++){const t=this._visibleLines.getVisibleLine(r)
!e||t.getWidthIsFast()?n=Math.max(n,t.getWidth()):s=!1}return s&&1===t&&i===this._context.model.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(n),s}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){const t=this._horizontalRevealRequest.lineNumber,i=this._horizontalRevealRequest.startColumn,n=this._horizontalRevealRequest.endColumn,s=this._horizontalRevealRequest.scrollType
if(e.startLineNumber<=t&&t<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender()
let e=this._computeScrollLeftToRevealRange(t,i,n)
this._isViewportWrapping||this._ensureMaxLineWidth(e.maxHorizontalOffset),0===s?this._context.viewLayout.setScrollPositionSmooth({scrollLeft:e.scrollLeft}):this._context.viewLayout.setScrollPositionNow({scrollLeft:e.scrollLeft})}}this._updateLineWidthsFast()||this._asyncUpdateLineWidths.schedule(),this._linesContent.setLayerHinting(this._canUseLayerHinting)
const t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta
this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){let t=Math.ceil(e)
this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.viewLayout.onMaxLineWidthChanged(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,i){let n,s,r,o=e.top,a=e.height,l=o+a
if(n=this._context.viewLayout.getVerticalOffsetForLineNumber(t.startLineNumber),s=this._context.viewLayout.getVerticalOffsetForLineNumber(t.endLineNumber)+this._lineHeight,0!==i&&4!==i||(s+=this._lineHeight),1===i||2===i)if(2===i&&o<=n&&s<=l)r=o
else{let e=(n+s)/2
r=Math.max(0,e-a/2)}else r=this._computeMinimumScrolling(o,l,n,s,3===i,4===i)
return r}_computeScrollLeftToRevealRange(e,i,n){let s=0,r=this._context.viewLayout.getCurrentViewport(),o=r.left,a=o+r.width,l=this.visibleRangesForRange2(new t(e,i,e,n)),h=Number.MAX_VALUE,d=0
if(!l)return{scrollLeft:o,maxHorizontalOffset:s}
for(let e=0;e<l.length;e++){let t=l[e]
t.left<h&&(h=t.left),t.left+t.width>d&&(d=t.left+t.width)}return s=d,h=Math.max(0,h-Up.HORIZONTAL_EXTRA_PX),d+=this._revealHorizontalRightPadding,{scrollLeft:this._computeMinimumScrolling(o,a,h,d),maxHorizontalOffset:s}}_computeMinimumScrolling(e,t,i,n,s,r){s=!!s,r=!!r
let o=(t|=0)-(e|=0)
return(n|=0)-(i|=0)<o?s?i:r?Math.max(0,n-o):i<e?i:n>t?Math.max(0,n-o):e:i}}Up.HORIZONTAL_EXTRA_PX=30
class Kp extends Wp{constructor(e){super(),this._context=e,this._decorationsLeft=this._context.configuration.editor.layoutInfo.decorationsLeft,this._decorationsWidth=this._context.configuration.editor.layoutInfo.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._context=null,this._renderResult=null,super.dispose()}onConfigurationChanged(e){return e.layoutInfo&&(this._decorationsLeft=this._context.configuration.editor.layoutInfo.decorationsLeft,this._decorationsWidth=this._context.configuration.editor.layoutInfo.decorationsWidth),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){let t=e.getDecorationsInViewport(),i=[],n=0
for(let e=0,s=t.length;e<s;e++){let s=t[e],r=s.options.linesDecorationsClassName
r&&(i[n++]=new Fp(s.range.startLineNumber,s.range.endLineNumber,r))}return i}prepareRender(e){let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),s='" style="left:'+this._decorationsLeft.toString()+"px;width:"+this._decorationsWidth.toString()+'px;"></div>',r=[]
for(let e=t;e<=i;e++){let i=e-t,o=n[i],a=""
for(let e=0,t=o.length;e<t;e++)a+='<div class="cldr '+o[e]+s
r[i]=a}this._renderResult=r}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}class $p extends Wp{constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._context=null,this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){let t=e.getDecorationsInViewport(),i=[],n=0
for(let e=0,s=t.length;e<s;e++){let s=t[e],r=s.options.marginClassName
r&&(i[n++]=new Fp(s.range.startLineNumber,s.range.endLineNumber,r))}return i}prepareRender(e){let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),s=[]
for(let e=t;e<=i;e++){let i=e-t,r=n[i],o=""
for(let e=0,t=r.length;e<t;e++)o+='<div class="cmdr '+r[e]+'" style=""></div>'
s[i]=o}this._renderResult=s}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}class qp extends sc{constructor(e){super(e),this._widgets={},this._verticalScrollbarWidth=this._context.configuration.editor.layoutInfo.verticalScrollbarWidth,this._minimapWidth=this._context.configuration.editor.layoutInfo.minimapWidth,this._horizontalScrollbarHeight=this._context.configuration.editor.layoutInfo.horizontalScrollbarHeight,this._editorHeight=this._context.configuration.editor.layoutInfo.height,this._editorWidth=this._context.configuration.editor.layoutInfo.width,this._domNode=Zu(document.createElement("div")),rc.write(this._domNode,4),this._domNode.setClassName("overlayWidgets")}dispose(){super.dispose(),this._widgets=null}getDomNode(){return this._domNode}onConfigurationChanged(e){return!!e.layoutInfo&&(this._verticalScrollbarWidth=this._context.configuration.editor.layoutInfo.verticalScrollbarWidth,this._minimapWidth=this._context.configuration.editor.layoutInfo.minimapWidth,this._horizontalScrollbarHeight=this._context.configuration.editor.layoutInfo.horizontalScrollbarHeight,this._editorHeight=this._context.configuration.editor.layoutInfo.height,this._editorWidth=this._context.configuration.editor.layoutInfo.width,!0)}addWidget(e){const t=Zu(e.getDomNode())
this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),this._domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){let i=this._widgets[e.getId()]
return i.preference!==t&&(i.preference=t,this.setShouldRender(),!0)}removeWidget(e){let t=e.getId()
if(this._widgets.hasOwnProperty(t)){const e=this._widgets[t].domNode.domNode
delete this._widgets[t],e.parentNode.removeChild(e),this.setShouldRender()}}_renderWidget(e){const t=e.domNode
if(null!==e.preference)if(e.preference===_m.TOP_RIGHT_CORNER)t.setTop(0),t.setRight(2*this._verticalScrollbarWidth+this._minimapWidth)
else if(e.preference===_m.BOTTOM_RIGHT_CORNER){let e=t.domNode.clientHeight
t.setTop(this._editorHeight-e-2*this._horizontalScrollbarHeight),t.setRight(2*this._verticalScrollbarWidth+this._minimapWidth)}else e.preference===_m.TOP_CENTER&&(t.setTop(0),t.domNode.style.right="50%")
else t.unsetTop()}prepareRender(e){}render(e){this._domNode.setWidth(this._editorWidth)
let t=Object.keys(this._widgets)
for(let e=0,i=t.length;e<i;e++){let i=t[e]
this._renderWidget(this._widgets[i])}}}class Gp{constructor(e,t){this.lineHeight=e.editor.lineHeight,this.pixelRatio=e.editor.pixelRatio,this.overviewRulerLanes=e.editor.viewInfo.overviewRulerLanes,this.renderBorder=e.editor.viewInfo.overviewRulerBorder
const i=t.getColor(Zg)
this.borderColor=i?i.toString():null,this.hideCursor=e.editor.viewInfo.hideCursorInOverviewRuler
const n=t.getColor(zg)
this.cursorColor=n?n.transparent(.7).toString():null,this.themeType=t.type
const s=e.editor.viewInfo.minimap.enabled?js.getDefaultBackground():null
this.backgroundColor=s?Td.Format.CSS.formatHex(s):null
const r=e.editor.layoutInfo.overviewRuler
this.top=r.top,this.right=r.right,this.domWidth=r.width,this.domHeight=r.height,this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0
const[o,a]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes)
this.x=o,this.w=a}_initLanes(e,t,i){const n=t-e
if(i>=3){const t=Math.floor(n/3),i=Math.floor(n/3),s=n-t-i,r=e+t
return[[0,e,r,e,e+t+s,e,r,e],[0,t,s,t+s,i,t+s+i,s+i,t+s+i]]}if(2===i){const t=Math.floor(n/2),i=n-t
return[[0,e,e,e,e+t,e,e,e],[0,t,t,t,i,t+i,t+i,t+i]]}return[[0,e,e,e,e,e,e,e],[0,n,n,n,n,n,n,n]]}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColor===e.cursorColor&&this.themeType===e.themeType&&this.backgroundColor===e.backgroundColor&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}}class jp extends sc{constructor(e){super(e),this._domNode=Zu(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._settings=null,this._updateSettings(!1),this._tokensColorTrackerListener=js.onDidChange(e=>{e.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){const t=new Gp(this._context.configuration,this._context.theme)
return(null===this._settings||!this._settings.equals(t))&&(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}onConfigurationChanged(e){return this._updateSettings(!1)}onCursorStateChanged(e){this._cursorPositions=[]
for(let t=0,i=e.selections.length;t<i;t++)this._cursorPositions[t]=e.selections[t].getPosition()
return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onScrollChanged(e){return e.scrollHeightChanged}onZonesChanged(e){return!0}onThemeChanged(e){return this._context.model.invalidateOverviewRulerColorCache(),this._updateSettings(!1)}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render()}_render(){const e=this._settings.canvasWidth,t=this._settings.canvasHeight,i=this._settings.lineHeight,n=this._context.viewLayout,s=t/this._context.viewLayout.getScrollHeight(),r=this._context.model.getAllOverviewRulerDecorations(this._context.theme),o=6*this._settings.pixelRatio|0,a=o/2|0,l=this._domNode.domNode.getContext("2d")
null===this._settings.backgroundColor?l.clearRect(0,0,e,t):(l.fillStyle=this._settings.backgroundColor,l.fillRect(0,0,e,t))
const h=this._settings.x,d=this._settings.w,u=Object.keys(r)
u.sort()
for(let e=0,c=u.length;e<c;e++){const c=u[e],g=r[c]
l.fillStyle=c
let m=0,p=0,f=0
for(let e=0,r=g.length;e<r;e++){const r=g[3*e],u=g[3*e+1],c=g[3*e+2]
let _=n.getVerticalOffsetForLineNumber(u)*s|0,C=(n.getVerticalOffsetForLineNumber(c)+i)*s|0
if(C-_<o){let e=(_+C)/2|0
e<a?e=a:e+a>t&&(e=t-a),_=e-a,C=e+a}_>f+1||r!==m?(0!==e&&l.fillRect(h[m],p,d[m],f-p),m=r,p=_,f=C):C>f&&(f=C)}l.fillRect(h[m],p,d[m],f-p)}if(!this._settings.hideCursor){const e=2*this._settings.pixelRatio|0,i=e/2|0,r=this._settings.x[7],o=this._settings.w[7]
l.fillStyle=this._settings.cursorColor
let a=-100,h=-100
for(let d=0,u=this._cursorPositions.length;d<u;d++){const u=this._cursorPositions[d]
let c=n.getVerticalOffsetForLineNumber(u.lineNumber)*s|0
c<i?c=i:c+i>t&&(c=t-i)
const g=c-i,m=g+e
g>h+1?(0!==d&&l.fillRect(r,a,o,h-a),a=g,h=m):m>h&&(h=m)}l.fillRect(r,a,o,h-a)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(l.beginPath(),l.lineWidth=1,l.strokeStyle=this._settings.borderColor,l.moveTo(0,0),l.lineTo(0,t),l.stroke(),l.moveTo(0,0),l.lineTo(e,0),l.stroke())}}class Yp{constructor(e,t,i,n){this.from=0|e,this.to=0|t,this.colorId=0|i,this.position=0|n}}class Zp{constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._maximumHeight=0,this._minimumHeight=0,this._themeType=Og,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){e.sort((e,t)=>e.compareTo(t))
let t=this._zones,i=0,n=this._zones.length,s=0,r=e.length,o=[]
for(;s<r;){let r=e[s]
if(i>=n)o.push(r),s++
else{let e=t[i],n=e.compareTo(r)
n<0?i++:n>0?(o.push(r),s++):(o.push(e),i++,s++)}}this._zones=o}setLineHeight(e){return this._lineHeight!==e&&(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth!==e&&(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight!==e&&(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight!==e&&(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}setMaximumHeight(e){return this._maximumHeight!==e&&(this._maximumHeight=e,this._colorZonesInvalid=!0,!0)}setMinimumHeight(e){return this._minimumHeight!==e&&(this._minimumHeight=e,this._colorZonesInvalid=!0,!0)}setThemeType(e){return this._themeType!==e&&(this._themeType=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){const e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),i=Math.floor(this.getCanvasHeight()),n=Math.floor(this._maximumHeight*this._pixelRatio),s=Math.floor(this._minimumHeight*this._pixelRatio),r=this._themeType,o=i/Math.floor(this._outerHeight)
let a=[]
for(let l=0,h=this._zones.length;l<h;l++){let h=this._zones[l]
if(!e){let e=h.getColorZones()
if(e){for(let t=0,i=e.length;t<i;t++)a.push(e[t])
continue}}let d=[]
if(h.forceHeight){let e=Math.floor(h.forceHeight*this._pixelRatio),t=Math.floor(this._getVerticalOffsetForLine(h.startLineNumber)),n=(t=Math.floor(t*o))+e
d.push(this.createZone(i,t,n,e,e,h.getColor(r),h.position))}else{let e=Math.floor(this._getVerticalOffsetForLine(h.startLineNumber)),a=Math.floor(this._getVerticalOffsetForLine(h.endLineNumber))+t
e=Math.floor(e*o),a=Math.floor(a*o)
let l=(h.endLineNumber-h.startLineNumber+1)*n
if(a-e>l)for(let l=h.startLineNumber;l<=h.endLineNumber;l++)a=(e=Math.floor(this._getVerticalOffsetForLine(l)))+t,e=Math.floor(e*o),a=Math.floor(a*o),d.push(this.createZone(i,e,a,s,n,h.getColor(r),h.position))
else d.push(this.createZone(i,e,a,s,l,h.getColor(r),h.position))}h.setColorZones(d)
for(let e=0,t=d.length;e<t;e++)a.push(d[e])}this._colorZonesInvalid=!1
return a.sort((e,t)=>e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId),a}createZone(e,t,i,n,s,r,o){e=Math.floor(e),t=Math.floor(t),i=Math.floor(i),n=Math.floor(n),s=Math.floor(s)
let a=Math.floor((t+i)/2),l=i-a
l>s/2&&(l=s/2),l<n/2&&(l=n/2),a-l<0&&(a=l),a+l>e&&(a=e-l)
let h=this._color2Id[r]
return h||(h=++this._lastAssignedId,this._color2Id[r]=h,this._id2Color[h]=r),new Yp(a-l,a+l,h,o)}}class Xp{constructor(e,t,i,n,s,r,o,a){this._canvasLeftOffset=e,this._domNode=Zu(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._lanesCount=3,this._background=null,this._zoneManager=new Zp(a),this._zoneManager.setMinimumHeight(r),this._zoneManager.setMaximumHeight(o),this._zoneManager.setThemeType(Og),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(i),this._zoneManager.setLineHeight(n),this._zoneManager.setPixelRatio(s)}dispose(){this._zoneManager=null}setLayout(e,t){this._domNode.setTop(e.top),this._domNode.setRight(e.right)
let i=!1
i=this._zoneManager.setDOMWidth(e.width)||i,(i=this._zoneManager.setDOMHeight(e.height)||i)&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),t&&this.render(!0))}getLanesCount(){return this._lanesCount}setLanesCount(e,t){this._lanesCount=e,t&&this.render(!0)}setThemeType(e,t){this._zoneManager.setThemeType(e),t&&this.render(!0)}setUseBackground(e,t){this._background=e,t&&this.render(!0)}getDomNode(){return this._domNode.domNode}getPixelWidth(){return this._zoneManager.getCanvasWidth()}getPixelHeight(){return this._zoneManager.getCanvasHeight()}setScrollHeight(e,t){this._zoneManager.setOuterHeight(e),t&&this.render(!0)}setLineHeight(e,t){this._zoneManager.setLineHeight(e),t&&this.render(!0)}setPixelRatio(e,t){this._zoneManager.setPixelRatio(e),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),t&&this.render(!0)}setZones(e,t){this._zoneManager.setZones(e),t&&this.render(!1)}render(e){if(0===this._zoneManager.getOuterHeight())return!1
const t=this._zoneManager.getCanvasWidth(),i=this._zoneManager.getCanvasHeight()
let n=this._zoneManager.resolveColorZones(),s=this._zoneManager.getId2Color(),r=this._domNode.domNode.getContext("2d")
if(null===this._background?r.clearRect(0,0,t,i):(r.fillStyle=Td.Format.CSS.formatHex(this._background),r.fillRect(0,0,t,i)),n.length>0){let e=t-this._canvasLeftOffset
this._lanesCount>=3?this._renderThreeLanes(r,n,s,e):2===this._lanesCount?this._renderTwoLanes(r,n,s,e):1===this._lanesCount&&this._renderOneLane(r,n,s,e)}return!0}_renderOneLane(e,t,n,s){this._renderVerticalPatch(e,t,n,i.Left|i.Center|i.Right,this._canvasLeftOffset,s)}_renderTwoLanes(e,t,n,s){let r=Math.floor(s/2),o=s-r,a=this._canvasLeftOffset,l=this._canvasLeftOffset+r
this._renderVerticalPatch(e,t,n,i.Left|i.Center,a,r),this._renderVerticalPatch(e,t,n,i.Right,l,o)}_renderThreeLanes(e,t,n,s){let r=Math.floor(s/3),o=Math.floor(s/3),a=s-r-o,l=this._canvasLeftOffset,h=this._canvasLeftOffset+r,d=this._canvasLeftOffset+r+a
this._renderVerticalPatch(e,t,n,i.Left,l,r),this._renderVerticalPatch(e,t,n,i.Center,h,a),this._renderVerticalPatch(e,t,n,i.Right,d,o)}_renderVerticalPatch(e,t,i,n,s,r){let o=0,a=0,l=0
for(let h=0,d=t.length;h<d;h++){let d=t[h]
if(!(d.position&n))continue
let u=d.colorId,c=d.from,g=d.to
u!==o?(e.fillRect(s,a,r,l-a),o=u,e.fillStyle=i[o],a=c,l=g):l>=c?l=Math.max(l,g):(e.fillRect(s,a,r,l-a),a=c,l=g)}e.fillRect(s,a,r,l-a)}}class Jp extends Xu{constructor(e,t,i,n){super(),this._context=e,this._overviewRuler=new Xp(0,t,this._context.viewLayout.getScrollHeight(),this._context.configuration.editor.lineHeight,this._context.configuration.editor.pixelRatio,i,n,e=>this._context.viewLayout.getVerticalOffsetForLineNumber(e)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._overviewRuler.dispose(),super.dispose()}onConfigurationChanged(e){return e.lineHeight&&this._overviewRuler.setLineHeight(this._context.configuration.editor.lineHeight,!0),e.pixelRatio&&this._overviewRuler.setPixelRatio(this._context.configuration.editor.pixelRatio,!0),!0}onFlushed(e){return!0}onScrollChanged(e){return this._overviewRuler.setScrollHeight(e.scrollHeight,!0),super.onScrollChanged(e)||e.scrollHeightChanged}onZonesChanged(e){return!0}getDomNode(){return this._overviewRuler.getDomNode()}setLayout(e){this._overviewRuler.setLayout(e,!0)}setZones(e){this._overviewRuler.setZones(e,!0)}}class Qp extends sc{constructor(e){super(e),this.domNode=Zu(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[],this._rulers=this._context.configuration.editor.viewInfo.rulers,this._height=this._context.configuration.editor.layoutInfo.contentHeight,this._typicalHalfwidthCharacterWidth=this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){return!!(e.viewInfo||e.layoutInfo||e.fontInfo)&&(this._rulers=this._context.configuration.editor.viewInfo.rulers,this._height=this._context.configuration.editor.layoutInfo.contentHeight,this._typicalHalfwidthCharacterWidth=this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth,!0)}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){const e=this._renderedRulers.length,t=this._rulers.length
if(e===t)return
if(e<t){const i=Bl(1)
let n=t-e
for(;n>0;){let e=Zu(document.createElement("div"))
e.setClassName("view-ruler"),e.setWidth(i),this.domNode.appendChild(e),this._renderedRulers.push(e),n--}return}let i=e-t
for(;i>0;){let e=this._renderedRulers.pop()
this.domNode.removeChild(e),i--}}render(e){this._ensureRulersCount()
for(let t=0,i=this._rulers.length;t<i;t++){let i=this._renderedRulers[t]
i.setHeight(Math.min(e.scrollHeight,1e6)),i.setLeft(this._rulers[t]*this._typicalHalfwidthCharacterWidth)}}}Wg((e,t)=>{let i=e.getColor(Gg)
i&&t.addRule(`.monaco-editor .view-ruler { background-color: ${i}; }`)})
class ef extends sc{constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1,this._useShadows=this._context.configuration.editor.viewInfo.scrollbar.useShadows,this._domNode=Zu(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){let e=this._useShadows&&this._scrollTop>0
return this._shouldShow!==e&&(this._shouldShow=e,!0)}getDomNode(){return this._domNode}_updateWidth(){const e=this._context.configuration.editor.layoutInfo
let t=e.width-e.minimapWidth
return this._width!==t&&(this._width=t,!0)}onConfigurationChanged(e){let t=!1
return e.viewInfo&&(this._useShadows=this._context.configuration.editor.viewInfo.scrollbar.useShadows),e.layoutInfo&&(t=this._updateWidth()),this._updateShouldShow()||t}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}}Wg((e,t)=>{let i=e.getColor(jc)
i&&t.addRule(`.monaco-editor .scroll-decoration { box-shadow: ${i} 0 6px 6px -6px inset; }`)})
class tf{constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}}class nf{constructor(e,t){this.lineNumber=e,this.ranges=t}}function sf(e){return new tf(e)}function rf(e){return new nf(e.lineNumber,e.ranges.map(sf))}const of=Na
class af extends lm{constructor(e){super(),this._previousFrameVisibleRangesWithStyle=[],this._context=e,this._lineHeight=this._context.configuration.editor.lineHeight,this._roundedSelection=this._context.configuration.editor.viewInfo.roundedSelection,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._context=null,this._selections=null,this._renderResult=null,super.dispose()}onConfigurationChanged(e){return e.lineHeight&&(this._lineHeight=this._context.configuration.editor.lineHeight),e.viewInfo&&(this._roundedSelection=this._context.configuration.editor.viewInfo.roundedSelection),!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,i=e.length;t<i;t++){if(e[t].ranges.length>1)return!0}return!1}_enrichVisibleRangesWithStyle(e,t){let i=null,n=null
if(t&&t.length>0&&e.length>0){let s=e[0].lineNumber
for(let e=0;!i&&e<t.length;e++)t[e].lineNumber===s&&(i=t[e].ranges[0])
let r=e[e.length-1].lineNumber
for(let e=t.length-1;!n&&e>=0;e--)t[e].lineNumber===r&&(n=t[e].ranges[0])
i&&!i.startStyle&&(i=null),n&&!n.startStyle&&(n=null)}for(let t=0,s=e.length;t<s;t++){let r=e[t].ranges[0],o=r.left,a=r.left+r.width,l={top:0,bottom:0},h={top:0,bottom:0}
if(t>0){let i=e[t-1].ranges[0].left,n=e[t-1].ranges[0].left+e[t-1].ranges[0].width
o===i?l.top=2:o>i&&(l.top=1),a===n?h.top=2:i<a&&a<n&&(h.top=1)}else i&&(l.top=i.startStyle.top,h.top=i.endStyle.top)
if(t+1<s){let i=e[t+1].ranges[0].left,n=e[t+1].ranges[0].left+e[t+1].ranges[0].width
o===i?l.bottom=2:i<o&&o<n&&(l.bottom=1),a===n?h.bottom=2:a<n&&(h.bottom=1)}else n&&(l.bottom=n.startStyle.bottom,h.bottom=n.endStyle.bottom)
r.startStyle=l,r.endStyle=h}}_getVisibleRangesWithStyle(e,t,i){let n=(t.linesVisibleRangesForRange(e,!0)||[]).map(rf),s=this._visibleRangesHaveGaps(n)
return of||s||!this._roundedSelection||this._enrichVisibleRangesWithStyle(n,i),n}_createSelectionPiece(e,t,i,n,s){return'<div class="cslr '+i+'" style="top:'+e.toString()+"px;left:"+n.toString()+"px;width:"+s.toString()+"px;height:"+t+'px;"></div>'}_actualRenderOneSelection(e,t,i,n){let s=n.length>0&&n[0].ranges[0].startStyle,r=this._lineHeight.toString(),o=(this._lineHeight-1).toString(),a=n.length>0?n[0].lineNumber:0,l=n.length>0?n[n.length-1].lineNumber:0
for(let h=0,d=n.length;h<d;h++){let d=n[h],u=d.lineNumber,c=u-t,g=i&&(u===l||u===a)?o:r,m=i&&u===a?1:0,p=""
for(let e=0,t=d.ranges.length;e<t;e++){let t=d.ranges[e]
if(s){if(1===t.startStyle.top||1===t.startStyle.bottom){p+=this._createSelectionPiece(m,g,af.SELECTION_CLASS_NAME,t.left-af.ROUNDED_PIECE_WIDTH,af.ROUNDED_PIECE_WIDTH)
let e=af.EDITOR_BACKGROUND_CLASS_NAME
1===t.startStyle.top&&(e+=" "+af.SELECTION_TOP_RIGHT),1===t.startStyle.bottom&&(e+=" "+af.SELECTION_BOTTOM_RIGHT),p+=this._createSelectionPiece(m,g,e,t.left-af.ROUNDED_PIECE_WIDTH,af.ROUNDED_PIECE_WIDTH)}if(1===t.endStyle.top||1===t.endStyle.bottom){p+=this._createSelectionPiece(m,g,af.SELECTION_CLASS_NAME,t.left+t.width,af.ROUNDED_PIECE_WIDTH)
let e=af.EDITOR_BACKGROUND_CLASS_NAME
1===t.endStyle.top&&(e+=" "+af.SELECTION_TOP_LEFT),1===t.endStyle.bottom&&(e+=" "+af.SELECTION_BOTTOM_LEFT),p+=this._createSelectionPiece(m,g,e,t.left+t.width,af.ROUNDED_PIECE_WIDTH)}}let i=af.SELECTION_CLASS_NAME
s&&(0===t.startStyle.top&&(i+=" "+af.SELECTION_TOP_LEFT),0===t.startStyle.bottom&&(i+=" "+af.SELECTION_BOTTOM_LEFT),0===t.endStyle.top&&(i+=" "+af.SELECTION_TOP_RIGHT),0===t.endStyle.bottom&&(i+=" "+af.SELECTION_BOTTOM_RIGHT)),p+=this._createSelectionPiece(m,g,i,t.left,t.width)}e[c]+=p}}prepareRender(e){let t=[],i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber
for(let e=i;e<=n;e++){t[e-i]=""}let s=[]
for(let n=0,r=this._selections.length;n<r;n++){let r=this._selections[n]
if(r.isEmpty()){s[n]=null
continue}let o=this._getVisibleRangesWithStyle(r,e,this._previousFrameVisibleRangesWithStyle[n])
s[n]=o,this._actualRenderOneSelection(t,i,this._selections.length>1,o)}this._previousFrameVisibleRangesWithStyle=s,this._renderResult=t}render(e,t){if(!this._renderResult)return""
let i=t-e
if(i<0||i>=this._renderResult.length)throw new Error("Unexpected render request")
return this._renderResult[i]}}af.SELECTION_CLASS_NAME="selected-text",af.SELECTION_TOP_LEFT="top-left-radius",af.SELECTION_BOTTOM_LEFT="bottom-left-radius",af.SELECTION_TOP_RIGHT="top-right-radius",af.SELECTION_BOTTOM_RIGHT="bottom-right-radius",af.EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background",af.ROUNDED_PIECE_WIDTH=10,Wg((e,t)=>{let i=e.getColor(ng)
i&&t.addRule(`.monaco-editor .focused .selected-text { background-color: ${i}; }`)
let n=e.getColor(rg)
n&&t.addRule(`.monaco-editor .selected-text { background-color: ${n}; }`)
let s=e.getColor(sg)
s&&t.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${s}; }`)})
class lf{constructor(e,t,i,n){this.top=e,this.left=t,this.width=i,this.textContent=n}}class hf{constructor(t,i){this._context=t,this._isSecondary=i,this._cursorStyle=this._context.configuration.editor.viewInfo.cursorStyle,this._lineHeight=this._context.configuration.editor.lineHeight,this._typicalHalfwidthCharacterWidth=this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth,this._isVisible=!0,this._domNode=Zu(document.createElement("div")),this._isSecondary?this._domNode.setClassName("cursor secondary"):this._domNode.setClassName("cursor"),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),ju.applyFontInfo(this._domNode,this._context.configuration.editor.fontInfo),this._domNode.setDisplay("none"),this.updatePosition(new e(1,1)),this._isInEditableRange=!0,this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getIsInEditableRange(){return this._isInEditableRange}getPosition(){return this._position}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){return e.lineHeight&&(this._lineHeight=this._context.configuration.editor.lineHeight),e.viewInfo&&(this._cursorStyle=this._context.configuration.editor.viewInfo.cursorStyle),e.fontInfo&&(ju.applyFontInfo(this._domNode,this._context.configuration.editor.fontInfo),this._typicalHalfwidthCharacterWidth=this._context.configuration.editor.fontInfo.typicalHalfwidthCharacterWidth),!0}onCursorPositionChanged(e,t){return this.updatePosition(e),this._isInEditableRange=t,!0}_prepareRender(e){if(this._cursorStyle===Oi.Line||this._cursorStyle===Oi.LineThin){const t=e.visibleRangeForPosition(this._position)
if(!t)return null
let i
i=this._cursorStyle===Oi.Line?Bl(2):Bl(1)
const n=e.getVerticalOffsetForLineNumber(this._position.lineNumber)-e.bigNumbersDelta
return new lf(n,t.left,i,"")}const i=e.linesVisibleRangesForRange(new t(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column+1),!1)
if(!i||0===i.length||0===i[0].ranges.length)return null
const n=i[0].ranges[0],s=n.width<1?this._typicalHalfwidthCharacterWidth:n.width
let r=""
this._cursorStyle===Oi.Block&&(r=this._context.model.getLineContent(this._position.lineNumber).charAt(this._position.column-1))
const o=e.getVerticalOffsetForLineNumber(this._position.lineNumber)-e.bigNumbersDelta
return new lf(o,n.left,s,r)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._lineHeight),this._domNode.setHeight(this._lineHeight),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._lineHeight,width:2}):(this._domNode.setDisplay("none"),null)}updatePosition(e){this._position=e}}class df extends sc{constructor(e){super(e),this._readOnly=this._context.configuration.editor.readOnly,this._cursorBlinking=this._context.configuration.editor.viewInfo.cursorBlinking,this._cursorStyle=this._context.configuration.editor.viewInfo.cursorStyle,this._selectionIsEmpty=!0,this._primaryCursor=new hf(this._context,!1),this._secondaryCursors=[],this._renderData=[],this._domNode=Zu(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new fa,this._cursorFlatBlinkInterval=new _a,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){e.readOnly&&(this._readOnly=this._context.configuration.editor.readOnly),e.viewInfo&&(this._cursorBlinking=this._context.configuration.editor.viewInfo.cursorBlinking,this._cursorStyle=this._context.configuration.editor.viewInfo.cursorStyle),this._primaryCursor.onConfigurationChanged(e),this._updateBlinking(),e.viewInfo&&this._updateDomClassName()
for(let t=0,i=this._secondaryCursors.length;t<i;t++)this._secondaryCursors[t].onConfigurationChanged(e)
return!0}_onCursorPositionChanged(e,t,i){if(this._primaryCursor.onCursorPositionChanged(e,i),this._updateBlinking(),this._secondaryCursors.length<t.length){let e=t.length-this._secondaryCursors.length
for(let t=0;t<e;t++){let e=new hf(this._context,!0)
this._domNode.domNode.insertBefore(e.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(e)}}else if(this._secondaryCursors.length>t.length){let e=this._secondaryCursors.length-t.length
for(let t=0;t<e;t++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let e=0;e<t.length;e++)this._secondaryCursors[e].onCursorPositionChanged(t[e],i)}onCursorStateChanged(e){let t=[]
for(let i=0,n=e.selections.length;i<n;i++)t[i]=e.selections[i].getPosition()
this._onCursorPositionChanged(t[0],t.slice(1),e.isInEditableRange)
const i=e.selections[0].isEmpty()
return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){let t=t=>{for(let i=0,n=e.ranges.length;i<n;i++)if(e.ranges[i].fromLineNumber<=t.lineNumber&&t.lineNumber<=e.ranges[i].toLineNumber)return!0
return!1}
if(t(this._primaryCursor.getPosition()))return!0
for(let e=0;e<this._secondaryCursors.length;e++)if(t(this._secondaryCursors[e].getPosition()))return!0
return!1}onZonesChanged(e){return!0}getPosition(){return this._primaryCursor.getPosition()}_getCursorBlinking(){return this._editorHasFocus?this._readOnly||!this._primaryCursor.getIsInEditableRange()?Di.Solid:this._cursorBlinking:Di.Hidden}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel()
let e=this._getCursorBlinking(),t=e===Di.Hidden,i=e===Di.Solid
t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),t||i||(e===Di.Blink?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},df.BLINK_INTERVAL):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},df.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer"
switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case Oi.Line:e+=" cursor-line-style"
break
case Oi.Block:e+=" cursor-block-style"
break
case Oi.Underline:e+=" cursor-underline-style"
break
case Oi.LineThin:e+=" cursor-line-thin-style"
break
case Oi.BlockOutline:e+=" cursor-block-outline-style"
break
case Oi.UnderlineThin:e+=" cursor-underline-thin-style"
break
default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case Di.Blink:e+=" cursor-blink"
break
case Di.Smooth:e+=" cursor-smooth"
break
case Di.Phase:e+=" cursor-phase"
break
case Di.Expand:e+=" cursor-expand"
break
case Di.Solid:e+=" cursor-solid"
break
default:e+=" cursor-solid"}else e+=" cursor-solid"
return e}_show(){this._primaryCursor.show()
for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show()
this._isVisible=!0}_hide(){this._primaryCursor.hide()
for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide()
this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e)
for(let t=0,i=this._secondaryCursors.length;t<i;t++)this._secondaryCursors[t].prepareRender(e)}render(e){let t=[],i=0
const n=this._primaryCursor.render(e)
n&&(t[i++]=n)
for(let n=0,s=this._secondaryCursors.length;n<s;n++){const s=this._secondaryCursors[n].render(e)
s&&(t[i++]=s)}this._renderData=t}getLastRenderData(){return this._renderData}}df.BLINK_INTERVAL=500,Wg((e,t)=>{let i=e.getColor(zg)
if(i){let n=e.getColor(Ug)
n||(n=i.opposite()),t.addRule(`.monaco-editor .cursor { background-color: ${i}; border-color: ${i}; color: ${n}; }`),"hc"===e.type&&t.addRule(`.monaco-editor .cursors-layer.has-selection .cursor { border-left: 1px solid ${n}; border-right: 1px solid ${n}; }`)}})
class uf extends sc{constructor(e){super(e),this._lineHeight=this._context.configuration.editor.lineHeight,this._contentWidth=this._context.configuration.editor.layoutInfo.contentWidth,this._contentLeft=this._context.configuration.editor.layoutInfo.contentLeft,this.domNode=Zu(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=Zu(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){let e=!1,t=Object.keys(this._zones)
for(let i=0,n=t.length;i<n;i++){let n=t[i],s=this._zones[n],r=this._computeWhitespaceProps(s.delegate)
this._context.viewLayout.changeWhitespace(parseInt(n,10),r.afterViewLineNumber,r.heightInPx)&&(this._safeCallOnComputedHeight(s.delegate,r.heightInPx),e=!0)}return e}onConfigurationChanged(e){return e.lineHeight?(this._lineHeight=this._context.configuration.editor.lineHeight,this._recomputeWhitespacesProps()):(e.layoutInfo&&(this._contentWidth=this._context.configuration.editor.layoutInfo.contentWidth,this._contentLeft=this._context.configuration.editor.layoutInfo.contentLeft),!0)}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){return void 0!==e.afterColumn?e.afterColumn:1e4}_computeWhitespaceProps(t){if(0===t.afterLineNumber)return{afterViewLineNumber:0,heightInPx:this._heightInPixels(t)}
let i,n
if(void 0!==t.afterColumn)i=this._context.model.validateModelPosition({lineNumber:t.afterLineNumber,column:t.afterColumn})
else{let n=this._context.model.validateModelPosition({lineNumber:t.afterLineNumber,column:1}).lineNumber
i=new e(n,this._context.model.getModelLineMaxColumn(n))}n=i.column===this._context.model.getModelLineMaxColumn(i.lineNumber)?this._context.model.validateModelPosition({lineNumber:i.lineNumber+1,column:1}):this._context.model.validateModelPosition({lineNumber:i.lineNumber,column:i.column+1})
let s=this._context.model.coordinatesConverter.convertModelPositionToViewPosition(i),r=this._context.model.coordinatesConverter.modelPositionIsVisible(n)
return{afterViewLineNumber:s.lineNumber,heightInPx:r?this._heightInPixels(t):0}}addZone(e){let t=this._computeWhitespaceProps(e),i={whitespaceId:this._context.viewLayout.addWhitespace(t.afterViewLineNumber,this._getZoneOrdinal(e),t.heightInPx),delegate:e,isVisible:!1,domNode:Zu(e.domNode),marginDomNode:e.marginDomNode?Zu(e.marginDomNode):null}
return this._safeCallOnComputedHeight(i.delegate,t.heightInPx),i.domNode.setPosition("absolute"),i.domNode.domNode.style.width="100%",i.domNode.setDisplay("none"),i.domNode.setAttribute("monaco-view-zone",i.whitespaceId.toString()),this.domNode.appendChild(i.domNode),i.marginDomNode&&(i.marginDomNode.setPosition("absolute"),i.marginDomNode.domNode.style.width="100%",i.marginDomNode.setDisplay("none"),i.marginDomNode.setAttribute("monaco-view-zone",i.whitespaceId.toString()),this.marginDomNode.appendChild(i.marginDomNode)),this._zones[i.whitespaceId.toString()]=i,this.setShouldRender(),i.whitespaceId}removeZone(e){if(this._zones.hasOwnProperty(e.toString())){let t=this._zones[e.toString()]
return delete this._zones[e.toString()],this._context.viewLayout.removeWhitespace(t.whitespaceId),t.domNode.removeAttribute("monaco-visible-view-zone"),t.domNode.removeAttribute("monaco-view-zone"),t.domNode.domNode.parentNode.removeChild(t.domNode.domNode),t.marginDomNode&&(t.marginDomNode.removeAttribute("monaco-visible-view-zone"),t.marginDomNode.removeAttribute("monaco-view-zone"),t.marginDomNode.domNode.parentNode.removeChild(t.marginDomNode.domNode)),this.setShouldRender(),!0}return!1}layoutZone(e){let t=!1
if(this._zones.hasOwnProperty(e.toString())){let i=this._zones[e.toString()],n=this._computeWhitespaceProps(i.delegate);(t=this._context.viewLayout.changeWhitespace(i.whitespaceId,n.afterViewLineNumber,n.heightInPx)||t)&&(this._safeCallOnComputedHeight(i.delegate,n.heightInPx),this.setShouldRender())}return t}shouldSuppressMouseDownOnViewZone(e){return!!this._zones.hasOwnProperty(e.toString())&&this._zones[e.toString()].delegate.suppressMouseDown}_heightInPixels(e){return"number"==typeof e.heightInPx?e.heightInPx:"number"==typeof e.heightInLines?this._lineHeight*e.heightInLines:this._lineHeight}_safeCallOnComputedHeight(e,t){if("function"==typeof e.onComputedHeight)try{e.onComputedHeight(t)}catch(e){St(e)}}_safeCallOnDomNodeTop(e,t){if("function"==typeof e.onDomNodeTop)try{e.onDomNodeTop(t)}catch(e){St(e)}}prepareRender(e){}render(e){const t=e.viewportData.whitespaceViewportData
let i={},n=!1
for(let e=0,s=t.length;e<s;e++)i[t[e].id.toString()]=t[e],n=!0
let s=Object.keys(this._zones)
for(let t=0,n=s.length;t<n;t++){let n=s[t],r=this._zones[n],o=0,a=0,l="none"
i.hasOwnProperty(n)?(o=i[n].verticalOffset-e.bigNumbersDelta,a=i[n].height,l="block",r.isVisible||(r.domNode.setAttribute("monaco-visible-view-zone","true"),r.isVisible=!0),this._safeCallOnDomNodeTop(r.delegate,e.getScrolledTopFromAbsoluteTop(i[n].verticalOffset))):(r.isVisible&&(r.domNode.removeAttribute("monaco-visible-view-zone"),r.isVisible=!1),this._safeCallOnDomNodeTop(r.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),r.domNode.setTop(o),r.domNode.setHeight(a),r.domNode.setDisplay(l),r.marginDomNode&&(r.marginDomNode.setTop(o),r.marginDomNode.setHeight(a),r.marginDomNode.setDisplay(l))}n&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}}class cf{constructor(e,t,i,n){this.configuration=e,this.theme=t,this.model=i,this.viewLayout=i.viewLayout,this.privateViewEventBus=n}addEventHandler(e){this.privateViewEventBus.addEventHandler(e)}removeEventHandler(e){this.privateViewEventBus.removeEventHandler(e)}}class gf extends ni{constructor(e){super(),this.onDidScroll=null,this.onDidGainFocus=null,this.onDidLoseFocus=null,this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseUp=null,this.onMouseDown=null,this.onMouseDrag=null,this.onMouseDrop=null,this._viewModel=e}emitScrollChanged(e){this.onDidScroll&&this.onDidScroll(e)}emitViewFocusGained(){this.onDidGainFocus&&this.onDidGainFocus(void 0)}emitViewFocusLost(){this.onDidLoseFocus&&this.onDidLoseFocus(void 0)}emitKeyDown(e){this.onKeyDown&&this.onKeyDown(e)}emitKeyUp(e){this.onKeyUp&&this.onKeyUp(e)}emitContextMenu(e){this.onContextMenu&&this.onContextMenu(this._convertViewToModelMouseEvent(e))}emitMouseMove(e){this.onMouseMove&&this.onMouseMove(this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){this.onMouseLeave&&this.onMouseLeave(this._convertViewToModelMouseEvent(e))}emitMouseUp(e){this.onMouseUp&&this.onMouseUp(this._convertViewToModelMouseEvent(e))}emitMouseDown(e){this.onMouseDown&&this.onMouseDown(this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){this.onMouseDrag&&this.onMouseDrag(this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){this.onMouseDrop&&this.onMouseDrop(this._convertViewToModelMouseEvent(e))}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return new mf(e.element,e.type,e.mouseColumn,e.position?this._convertViewToModelPosition(e.position):null,e.range?this._convertViewToModelRange(e.range):null,e.detail)}_convertViewToModelPosition(e){return this._viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}_convertViewToModelRange(e){return this._viewModel.coordinatesConverter.convertViewRangeToModelRange(e)}}class mf{constructor(e,t,i,n,s,r){this.element=e,this.type=t,this.mouseColumn=i,this.position=n,this.range=s,this.detail=r}toString(){return ap.toString(this)}}class pf{constructor(e,i,n,s){this.selections=e,this.startLineNumber=0|i.startLineNumber,this.endLineNumber=0|i.endLineNumber,this.relativeVerticalOffset=i.relativeVerticalOffset,this.bigNumbersDelta=0|i.bigNumbersDelta,this.whitespaceViewportData=n,this._model=s,this.visibleRange=new t(i.startLineNumber,this._model.getLineMinColumn(i.startLineNumber),i.endLineNumber,this._model.getLineMaxColumn(i.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}}class ff extends ni{onclick(e,t){this._register(il(e,kl.CLICK,e=>t(new Ka(e))))}onmousedown(e,t){this._register(il(e,kl.MOUSE_DOWN,e=>t(new Ka(e))))}onmouseover(e,t){this._register(il(e,kl.MOUSE_OVER,e=>t(new Ka(e))))}onnonbubblingmouseout(e,t){this._register(sl(e,e=>t(new Ka(e))))}onkeydown(e,t){this._register(il(e,kl.KEY_DOWN,e=>t(new Wa(e))))}onkeyup(e,t){this._register(il(e,kl.KEY_UP,e=>t(new Wa(e))))}oninput(e,t){this._register(il(e,kl.INPUT,t))}onblur(e,t){this._register(il(e,kl.BLUR,t))}onfocus(e,t){this._register(il(e,kl.FOCUS,t))}onchange(e,t){this._register(il(e,kl.CHANGE,t))}}const _f=11
class Cf extends ff{constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",void 0!==e.top&&(this.bgDomNode.style.top="0px"),void 0!==e.left&&(this.bgDomNode.style.left="0px"),void 0!==e.bottom&&(this.bgDomNode.style.bottom="0px"),void 0!==e.right&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.style.position="absolute",this.domNode.style.width=_f+"px",this.domNode.style.height=_f+"px",void 0!==e.top&&(this.domNode.style.top=e.top+"px"),void 0!==e.left&&(this.domNode.style.left=e.left+"px"),void 0!==e.bottom&&(this.domNode.style.bottom=e.bottom+"px"),void 0!==e.right&&(this.domNode.style.right=e.right+"px"),this._mouseMoveMonitor=this._register(new ym),this.onmousedown(this.bgDomNode,e=>this._arrowMouseDown(e)),this.onmousedown(this.domNode,e=>this._arrowMouseDown(e)),this._mousedownRepeatTimer=this._register(new _a),this._mousedownScheduleRepeatTimer=this._register(new fa)}_arrowMouseDown(e){this._onActivate(),this._mousedownRepeatTimer.cancel(),this._mousedownScheduleRepeatTimer.cancelAndSet(()=>{this._mousedownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24)},200),this._mouseMoveMonitor.startMonitoring(Sm,e=>{},()=>{this._mousedownRepeatTimer.cancel(),this._mousedownScheduleRepeatTimer.cancel()}),e.preventDefault()}}class bf extends ni{constructor(e,t,i){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=i,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new fa)}applyVisibilitySetting(e){return this._visibility!==hi.Hidden&&(this._visibility===hi.Visible||e)}setShouldBeVisible(e){let t=this.applyVisibilitySetting(e)
this._shouldBeVisible!==t&&(this._shouldBeVisible=t,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){this._isNeeded?this._shouldBeVisible?this._reveal():this._hide(!0):this._hide(!1)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode.setClassName(this._visibleClassName)},0))}_hide(e){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode.setClassName(this._invisibleClassName+(e?" fade":"")))}}const wf=140
class vf extends ff{constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new bf(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._mouseMoveMonitor=this._register(new ym),this._shouldRender=!0,this.domNode=Zu(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this.onmousedown(this.domNode.domNode,e=>this._domNodeMouseDown(e))}_createArrow(e){let t=this._register(new Cf(e))
this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,i,n){this.slider=Zu(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),this.slider.setWidth(i),this.slider.setHeight(n),this.slider.setLayerHinting(!0),this.domNode.domNode.appendChild(this.slider.domNode),this.onmousedown(this.slider.domNode,e=>{e.leftButton&&(e.preventDefault(),this._sliderMouseDown(e,()=>{}))})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodeMouseDown(e){e.target===this.domNode.domNode&&this._onMouseDown(e)}delegateMouseDown(e){let t=this.domNode.domNode.getClientRects()[0].top,i=t+this._scrollbarState.getSliderPosition(),n=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),s=this._sliderMousePosition(e)
i<=s&&s<=n?e.leftButton&&(e.preventDefault(),this._sliderMouseDown(e,()=>{})):this._onMouseDown(e)}delegateSliderMouseDown(e,t){this._sliderMouseDown(e,t)}_onMouseDown(e){let t,i
if(e.target===this.domNode.domNode&&"number"==typeof e.browserEvent.offsetX&&"number"==typeof e.browserEvent.offsetY)t=e.browserEvent.offsetX,i=e.browserEvent.offsetY
else{const n=Cl(this.domNode.domNode)
t=e.posx-n.left,i=e.posy-n.top}this._setDesiredScrollPositionNow(this._scrollbarState.getDesiredScrollPositionFromOffset(this._mouseDownRelativePosition(t,i))),e.leftButton&&(e.preventDefault(),this._sliderMouseDown(e,()=>{}))}_sliderMouseDown(e,t){const i=this._sliderMousePosition(e),n=this._sliderOrthogonalMousePosition(e),s=this._scrollbarState.clone()
this.slider.toggleClassName("active",!0),this._mouseMoveMonitor.startMonitoring(Sm,e=>{const t=this._sliderOrthogonalMousePosition(e),r=Math.abs(t-n)
if(E&&r>wf)return void this._setDesiredScrollPositionNow(s.getScrollPosition())
const o=this._sliderMousePosition(e)-i
this._setDesiredScrollPositionNow(s.getDesiredScrollPositionFromDelta(o))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd(),t()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){let t={}
this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}}const Sf=20
class yf{constructor(e,t,i){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(i),this._arrowSize=Math.round(e),this._visibleSize=0,this._scrollSize=0,this._scrollPosition=0,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){let e=new yf(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize)
return e.setVisibleSize(this._visibleSize),e.setScrollSize(this._scrollSize),e.setScrollPosition(this._scrollPosition),e}setVisibleSize(e){let t=Math.round(e)
return this._visibleSize!==t&&(this._visibleSize=t,this._refreshComputedValues(),!0)}setScrollSize(e){let t=Math.round(e)
return this._scrollSize!==t&&(this._scrollSize=t,this._refreshComputedValues(),!0)}setScrollPosition(e){let t=Math.round(e)
return this._scrollPosition!==t&&(this._scrollPosition=t,this._refreshComputedValues(),!0)}static _computeValues(e,t,i,n,s){const r=Math.max(0,i-e),o=Math.max(0,r-2*t),a=n>0&&n>i
if(!a)return{computedAvailableSize:Math.round(r),computedIsNeeded:a,computedSliderSize:Math.round(o),computedSliderRatio:0,computedSliderPosition:0}
const l=Math.round(Math.max(Sf,Math.floor(i*o/n))),h=(o-l)/(n-i),d=s*h
return{computedAvailableSize:Math.round(r),computedIsNeeded:a,computedSliderSize:Math.round(l),computedSliderRatio:h,computedSliderPosition:Math.round(d)}}_refreshComputedValues(){const e=yf._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition)
this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getSliderCenter(){return this._computedSliderPosition+this._computedSliderSize/2}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0
let t=e-this._arrowSize-this._computedSliderSize/2
return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0
let t=this._computedSliderPosition+e
return Math.round(t/this._computedSliderRatio)}}class xf extends vf{constructor(e,t,i){if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new yf(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===hi.Hidden?0:t.horizontalScrollbarSize,t.vertical===hi.Hidden?0:t.verticalScrollbarSize),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e}),t.horizontalHasArrows){let e=(t.arrowSize-_f)/2,i=(t.horizontalScrollbarSize-_f)/2
this._createArrow({className:"left-arrow",top:i,left:e,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new qa(null,1,0))}),this._createArrow({className:"right-arrow",top:i,left:void 0,bottom:void 0,right:e,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new qa(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,null,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_mouseDownRelativePosition(e,t){return e}_sliderMousePosition(e){return e.posx}_sliderOrthogonalMousePosition(e){return e.posy}writeScrollPosition(e,t){e.scrollLeft=t}}class Lf extends vf{constructor(e,t,i){if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new yf(t.verticalHasArrows?t.arrowSize:0,t.vertical===hi.Hidden?0:t.verticalScrollbarSize,0),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e}),t.verticalHasArrows){let e=(t.arrowSize-_f)/2,i=(t.verticalScrollbarSize-_f)/2
this._createArrow({className:"up-arrow",top:e,left:i,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new qa(null,0,1))}),this._createArrow({className:"down-arrow",top:void 0,left:i,bottom:e,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new qa(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,null)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_mouseDownRelativePosition(e,t){return t}_sliderMousePosition(e){return e.posy}_sliderOrthogonalMousePosition(e){return e.posx}writeScrollPosition(e,t){e.scrollTop=t}}const Nf=500,Ef=50,kf=!0
class If{constructor(e,t,i){this.timestamp=e,this.deltaX=t,this.deltaY=i,this.score=0}}class Mf{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(-1===this._front&&-1===this._rear)return!1
let e=1,t=0,i=1,n=this._rear
for(;;){const s=n===this._front?e:Math.pow(2,-i)
if(e-=s,t+=this._memory[n].score*s,n===this._front)break
n=(this._capacity+n-1)%this._capacity,i++}return t<=.5}accept(e,t,i){const n=new If(e,t,i)
n.score=this._computeScore(n),-1===this._front&&-1===this._rear?(this._memory[0]=n,this._front=0,this._rear=0):(this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=n)}_computeScore(e){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1
let t=.5;-1===this._front&&-1===this._rear||this._memory[this._rear]
return(Math.abs(e.deltaX-Math.round(e.deltaX))>0||Math.abs(e.deltaY-Math.round(e.deltaY))>0)&&(t+=.25),Math.min(Math.max(t,0),1)}}Mf.INSTANCE=new Mf
class Df extends ff{constructor(e,t,i){super(),this._onScroll=this._register(new ci),this.onScroll=this._onScroll.event,e.style.overflow="hidden",this._options=Af(t),this._scrollable=i,this._register(this._scrollable.onScroll(e=>{this._onDidScroll(e),this._onScroll.fire(e)}))
let n={onMouseWheel:e=>this._onMouseWheel(e),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()}
this._verticalScrollbar=this._register(new Lf(this._scrollable,this._options,n)),this._horizontalScrollbar=this._register(new xf(this._scrollable,this._options,n)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows&&(this._leftShadowDomNode=Zu(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=Zu(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=Zu(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow top-left-corner"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,e=>this._onMouseOver(e)),this.onnonbubblingmouseout(this._listenOnDomNode,e=>this._onMouseOut(e)),this._hideTimeout=this._register(new fa),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0}dispose(){this._mouseWheelToDispose=ei(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarMouseDown(e){this._verticalScrollbar.delegateMouseDown(e)}delegateSliderMouseDown(e,t){this._verticalScrollbar.delegateSliderMouseDown(e,t)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e)}updateClassName(e){this._options.className=e,k&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){let t=Af(e)
this._options.handleMouseWheel=t.handleMouseWheel,this._options.mouseWheelScrollSensitivity=t.mouseWheelScrollSensitivity,this._setListeningToMouseWheel(this._options.handleMouseWheel),this._options.lazyRender||this._render()}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=ei(this._mouseWheelToDispose),e)){let e=e=>{let t=new qa(e)
this._onMouseWheel(t)}
this._mouseWheelToDispose.push(il(this._listenOnDomNode,"mousewheel",e)),this._mouseWheelToDispose.push(il(this._listenOnDomNode,"DOMMouseScroll",e))}}_onMouseWheel(e){const t=Mf.INSTANCE
if(kf&&t.accept(Date.now(),e.deltaX,e.deltaY),e.deltaY||e.deltaX){let i=e.deltaY*this._options.mouseWheelScrollSensitivity,n=e.deltaX*this._options.mouseWheelScrollSensitivity
this._options.flipAxes&&([i,n]=[n,i])
const s=!k&&e.browserEvent.shiftKey
!this._options.scrollYToX&&!s||n||(n=i,i=0),k&&(i&&Math.abs(n)<.2&&(n=0),Math.abs(i)>.5*Math.abs(n)&&(n=0))
const r=this._scrollable.getFutureScrollPosition()
let o={}
if(i){const e=r.scrollTop-Ef*i
this._verticalScrollbar.writeScrollPosition(o,e)}if(n){const e=r.scrollLeft-Ef*n
this._horizontalScrollbar.writeScrollPosition(o,e)}if(o=this._scrollable.validateScrollPosition(o),r.scrollLeft!==o.scrollLeft||r.scrollTop!==o.scrollTop)kf&&this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(o):this._scrollable.setScrollPositionNow(o),this._shouldRender=!0}(this._options.alwaysConsumeMouseWheel||this._shouldRender)&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!")
this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){const e=this._scrollable.getCurrentScrollPosition()
let t=e.scrollTop>0,i=e.scrollLeft>0
this._leftShadowDomNode.setClassName("shadow"+(i?" left":"")),this._topShadowDomNode.setClassName("shadow"+(t?" top":"")),this._topLeftShadowDomNode.setClassName("shadow top-left-corner"+(t?" top":"")+(i?" left":""))}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseOut(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){this._mouseIsOver||this._isDragging||(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){this._mouseIsOver||this._isDragging||this._hideTimeout.cancelAndSet(()=>this._hide(),Nf)}}class Tf extends Df{constructor(e,t){(t=t||{}).mouseWheelSmoothScroll=!1
const i=new bi(0,e=>al(e))
super(e,t,i),this._register(i)}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}}class Of extends Df{constructor(e,t,i){super(e,t,i)}}class Rf extends Tf{constructor(e,t){super(e,t),this._element=e,this.onScroll(e=>{e.scrollTopChanged&&(this._element.scrollTop=e.scrollTop),e.scrollLeftChanged&&(this._element.scrollLeft=e.scrollLeft)}),this.scanDomNode()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}}function Af(e){let t={lazyRender:void 0!==e.lazyRender&&e.lazyRender,className:void 0!==e.className?e.className:"",useShadows:void 0===e.useShadows||e.useShadows,handleMouseWheel:void 0===e.handleMouseWheel||e.handleMouseWheel,flipAxes:void 0!==e.flipAxes&&e.flipAxes,alwaysConsumeMouseWheel:void 0!==e.alwaysConsumeMouseWheel&&e.alwaysConsumeMouseWheel,scrollYToX:void 0!==e.scrollYToX&&e.scrollYToX,mouseWheelScrollSensitivity:void 0!==e.mouseWheelScrollSensitivity?e.mouseWheelScrollSensitivity:1,mouseWheelSmoothScroll:void 0===e.mouseWheelSmoothScroll||e.mouseWheelSmoothScroll,arrowSize:void 0!==e.arrowSize?e.arrowSize:11,listenOnDomNode:void 0!==e.listenOnDomNode?e.listenOnDomNode:null,horizontal:void 0!==e.horizontal?e.horizontal:hi.Auto,horizontalScrollbarSize:void 0!==e.horizontalScrollbarSize?e.horizontalScrollbarSize:10,horizontalSliderSize:void 0!==e.horizontalSliderSize?e.horizontalSliderSize:0,horizontalHasArrows:void 0!==e.horizontalHasArrows&&e.horizontalHasArrows,vertical:void 0!==e.vertical?e.vertical:hi.Auto,verticalScrollbarSize:void 0!==e.verticalScrollbarSize?e.verticalScrollbarSize:10,verticalHasArrows:void 0!==e.verticalHasArrows&&e.verticalHasArrows,verticalSliderSize:void 0!==e.verticalSliderSize?e.verticalSliderSize:0}
return t.horizontalSliderSize=void 0!==e.horizontalSliderSize?e.horizontalSliderSize:t.horizontalScrollbarSize,t.verticalSliderSize=void 0!==e.verticalSliderSize?e.verticalSliderSize:t.verticalScrollbarSize,k&&(t.className+=" mac"),t}class Pf extends sc{constructor(e,t,i,n){super(e)
const s=this._context.configuration.editor.viewInfo.scrollbar
let r={listenOnDomNode:i.domNode,className:"editor-scrollable "+Ag(e.theme.type),useShadows:!1,lazyRender:!0,vertical:s.vertical,horizontal:s.horizontal,verticalHasArrows:s.verticalHasArrows,horizontalHasArrows:s.horizontalHasArrows,verticalScrollbarSize:s.verticalScrollbarSize,verticalSliderSize:s.verticalSliderSize,horizontalScrollbarSize:s.horizontalScrollbarSize,horizontalSliderSize:s.horizontalSliderSize,handleMouseWheel:s.handleMouseWheel,arrowSize:s.arrowSize,mouseWheelScrollSensitivity:s.mouseWheelScrollSensitivity}
this.scrollbar=this._register(new Of(t.domNode,r,this._context.viewLayout.scrollable)),rc.write(this.scrollbar.getDomNode(),5),this.scrollbarDomNode=Zu(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout()
let o=(e,t,i)=>{let n={}
if(t){let t=e.scrollTop
t&&(n.scrollTop=this._context.viewLayout.getCurrentScrollTop()+t,e.scrollTop=0)}if(i){let t=e.scrollLeft
t&&(n.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+t,e.scrollLeft=0)}this._context.viewLayout.setScrollPositionNow(n)}
this._register(il(i.domNode,"scroll",e=>o(i.domNode,!0,!0))),this._register(il(t.domNode,"scroll",e=>o(t.domNode,!0,!1))),this._register(il(n.domNode,"scroll",e=>o(n.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){const e=this._context.configuration.editor.layoutInfo
this.scrollbarDomNode.setLeft(e.contentLeft),this.scrollbarDomNode.setWidth(e.contentWidth+e.minimapWidth),this.scrollbarDomNode.setHeight(e.contentHeight)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarMouseDown(e){this.scrollbar.delegateVerticalScrollbarMouseDown(e)}delegateSliderMouseDown(e,t){this.scrollbar.delegateSliderMouseDown(e,t)}onConfigurationChanged(e){if(e.viewInfo){const e=this._context.configuration.editor
let t={handleMouseWheel:e.viewInfo.scrollbar.handleMouseWheel,mouseWheelScrollSensitivity:e.viewInfo.scrollbar.mouseWheelScrollSensitivity}
this.scrollbar.updateOptions(t)}return e.layoutInfo&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+Ag(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}}function Ff(e){let t=new Uint8ClampedArray(e.length)
for(let i=0,n=e.length;i<n;i++)t[i]=e[i]
return t}let Wf=null
var Vf=[0,0,0,0,0,0,0,0,39,14,39,14,14,5,29,10,96,96,29,29,0,0,0,0,49,113,195,214,227,166,135,42,40,29,194,38,75,148,197,187,145,0,160,61,75,143,2,183,138,58,163,6,177,223,197,227,38,13,11,4,0,0,0,0,10,54,52,8,62,4,71,122,73,2,19,40,10,50,155,36,79,70,145,121,7,5,0,0,2,1,36,12,204,166,16,5,0,0,0,0,1,0,154,34,0,0,0,0,96,83,0,0,0,0,0,0,0,0,46,34,0,82,2,56,53,3,146,0,146,119,152,132,152,131,145,119,170,42,15,42,15,42,172,194,131,132,0,139,80,28,227,143,159,135,15,118,11,126,171,144,20,124,88,106,217,196,0,106,189,92,168,43,5,130,164,133,130,115,183,65,134,120,141,141,170,196,2,106,31,32,105,2,145,130,116,114,132,135,138,140,138,113,147,137,81,183,129,94,0,0,21,16,4,3,46,34,0,0,45,34,1,0,160,49,0,0,43,143,203,23,1,76,0,0,38,28,131,96,38,28,0,0,168,31,29,191,98,0,118,139,5,113,45,13,37,6,97,115,161,179,204,105,223,224,83,52,111,100,184,186,120,132,212,145,180,139,174,161,212,182,104,162,131,0,131,0,104,161,219,120,110,116,110,116,219,120,207,154,163,40,147,22,207,154,202,159,161,47,145,23,111,0,139,154,144,30,144,135,139,187,110,110,168,161,150,145,110,110,185,162,43,16,43,16,185,162,73,129,0,110,0,110,191,87,149,149,236,48,195,91,146,149,146,0,146,0,146,0,187,173,200,201,222,215,172,147,95,95,193,97,224,129,159,206,97,192,155,139,153,115,153,115,156,140,189,158,123,136,190,64,111,0,155,139,153,115,153,114,156,241,197,148,150,152,170,116,110,157,156,128,169,14,13,159,158,149,212,189,43,16,43,16,43,16,148,110,148,110,147,109,182,151,133,121,106,118,114,103,89,66,94,94,211,188,205,207,139,168,151,152,87,76,101,79,151,152,130,156,125,116,47,29,43,16,169,228,11,103,120,6,230,176,55,49,55,6,55,6,193,102,92,0,71,0,13,30,0,147,63,43,12,43,12,43,142,152,71,53,61,61,0,0,0,0,0,0,0,0,0,0,158,146,25,2,0,0,0,0,0,0,0,0,107,130,170,194,176,188,109,0,203,159,113,111,202,158,0,0,135,135,114,0,136,135,0,109,187,190,148,126,177,187,0,0,149,130,218,105,169,135,37,113,146,113,49,13,49,13,0,0,178,195,147,114,255,255,109,0,193,149,110,109,109,109,12,15,125,41,33,41,144,188,1,6,75,53,10,53,210,161,110,0,152,148,210,60,110,156,213,5,63,5,63,5,45,111,0,0,232,172,190,168,190,169,0,0,190,144,109,109,109,109,0,0,168,140,148,111,168,140,0,0,200,151,113,110,255,158,0,0,184,188,147,139,186,255,0,0,122,130,111,0,109,0,0,0,132,69,109,93,110,136,51,5,205,103,61,6,47,106,0,0,110,109,110,122,155,179,0,0,132,120,113,114,84,63,0,0,124,108,202,189,160,174,0,0,144,142,79,57,159,146,0,0,138,138,119,117,255,69,0,0,97,198,47,38,208,84,23,112,41,14,157,7,121,192,35,11,35,11,35,11,160,61,129,9,40,19,20,139,236,44,0,0,15,3,97,93,0,0],Bf=[0,0,23,12,53,0,130,127,58,149,67,77,72,198,13,0,25,51,25,49,94,2,8,64,0,24,0,21,0,9,19,27,126,126,51,80,72,105,87,98,73,93,106,85,111,123,87,30,116,126,123,110,4,16,9,28,21,53,8,62,23,52,73,21,132,183,78,142,168,175,70,70,128,128,123,110,125,43,100,139,125,119,78,78,54,77,139,139,33,87,201,117,162,149,130,130,138,60,130,172,149,127,95,98,95,25,118,135,110,85,147,175,105,110,121,30,101,113,34,68,20,26,34,68,56,0,0,44,3,0,27,175,80,133,31,66,85,147,32,150,90,25,45,230,77,101,36,83,22,84,71,118,44,44,52,172,38,101,35,130,40,197,43,197,29,26,23,103,67,44,25,129,29,85,27,177,33,97,32,145,33,77,38,96,20,55,36,95,2,22]
function Hf(e){return 2===e?4:4===e?6:1===e?2:3}function zf(e){return 2===e?2:4===e?2:1}const Uf=140
class Kf{constructor(e){const t=e.editor.pixelRatio,i=e.editor.layoutInfo,n=e.editor.viewInfo,s=e.editor.fontInfo
this.renderMinimap=0|i.renderMinimap,this.scrollBeyondLastLine=n.scrollBeyondLastLine,this.showSlider=n.minimap.showSlider,this.pixelRatio=t,this.typicalHalfwidthCharacterWidth=s.typicalHalfwidthCharacterWidth,this.lineHeight=e.editor.lineHeight,this.minimapWidth=i.minimapWidth,this.minimapHeight=i.height,this.canvasInnerWidth=Math.max(1,Math.floor(t*this.minimapWidth)),this.canvasInnerHeight=Math.max(1,Math.floor(t*this.minimapHeight)),this.canvasOuterWidth=this.canvasInnerWidth/t,this.canvasOuterHeight=this.canvasInnerHeight/t}equals(e){return this.renderMinimap===e.renderMinimap&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.showSlider===e.showSlider&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight}}class $f{constructor(e,t,i,n,s,r,o){this.scrollTop=e,this.scrollHeight=t,this._computedSliderRatio=i,this.sliderTop=n,this.sliderHeight=s,this.startLineNumber=r,this.endLineNumber=o}getDesiredScrollTopFromDelta(e){let t=this.sliderTop+e
return Math.round(t/this._computedSliderRatio)}static create(e,t,i,n,s,r,o,a,l){const h=e.pixelRatio,d=Hf(e.renderMinimap),u=Math.floor(e.canvasInnerHeight/d),c=e.lineHeight
let g,m
if(s&&i!==r){const e=i-t+1
g=Math.floor(e*d/h)}else{const e=n/c
g=Math.floor(e*d/h)}m=e.scrollBeyondLastLine?(r-1)*d/h:Math.max(0,r*d/h-g)
const p=(m=Math.min(e.minimapHeight-g,m))/(a-n),f=o*p
if(u>=r)return new $f(o,a,p,f,g,1,r)
{let e=Math.max(1,Math.floor(t-f*h/d))
l&&l.scrollHeight===a&&(l.scrollTop>o&&(e=Math.min(e,l.startLineNumber)),l.scrollTop<o&&(e=Math.max(e,l.startLineNumber)))
const i=Math.min(r,e+u-1)
return new $f(o,a,p,f,g,e,i)}}}class qf{constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}}qf.INVALID=new qf(-1)
class Gf{constructor(e,t,i){this.renderedLayout=e,this._imageData=t,this._renderedLines=new xp(()=>qf.INVALID),this._renderedLines._set(e.startLineNumber,i)}linesEquals(e){if(this.renderedLayout.startLineNumber!==e.startLineNumber)return!1
if(this.renderedLayout.endLineNumber!==e.endLineNumber)return!1
const t=this._renderedLines._get().lines
for(let e=0,i=t.length;e<i;e++)if(-1===t[e].dy)return!1
return!0}_get(){let e=this._renderedLines._get()
return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e){return this._renderedLines.onLinesChanged(e.fromLineNumber,e.toLineNumber)}onLinesDeleted(e){this._renderedLines.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){this._renderedLines.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e.ranges)}}class jf{constructor(e,t,i,n){this._backgroundFillData=jf._createBackgroundFillData(t,i,n),this._buffers=[e.createImageData(t,i),e.createImageData(t,i)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer
let e=this._buffers[this._lastUsedBuffer]
return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,i){const n=i.r,s=i.g,r=i.b
let o=new Uint8ClampedArray(e*t*4),a=0
for(let i=0;i<t;i++)for(let t=0;t<e;t++)o[a]=n,o[a+1]=s,o[a+2]=r,o[a+3]=255,a+=4
return o}}class Yf extends sc{constructor(e){super(e),this._options=new Kf(this._context.configuration),this._lastRenderData=null,this._buffers=null,this._domNode=Zu(document.createElement("div")),rc.write(this._domNode,8),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._domNode.setRight(this._context.configuration.editor.layoutInfo.verticalScrollbarWidth),this._shadow=Zu(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=Zu(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._slider=Zu(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._domNode.appendChild(this._slider),this._sliderHorizontal=Zu(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._tokensColorTracker=$d.getInstance(),this._minimapCharRenderer=function(){if(!Wf){let e=Ff(Bf)
Bf=null
let t=Ff(Vf)
Vf=null,Wf=new qd(t,e)}return Wf}(),this._applyLayout(),this._mouseDownListener=nl(this._canvas.domNode,"mousedown",e=>{e.preventDefault()
const i=this._options.renderMinimap
if(0===i)return
if(!this._lastRenderData)return
const n=Hf(i),s=this._options.pixelRatio*e.browserEvent.offsetY
let r=Math.floor(s/n)+this._lastRenderData.renderedLayout.startLineNumber
r=Math.min(r,this._context.model.getLineCount()),this._context.privateViewEventBus.emit(new eh(new t(r,1,r,1),1,!1,0))}),this._sliderMouseMoveMonitor=new ym,this._sliderMouseDownListener=nl(this._slider.domNode,"mousedown",e=>{if(e.preventDefault(),e.leftButton&&this._lastRenderData){const t=e.posy,i=e.posx,n=this._lastRenderData.renderedLayout
this._slider.toggleClassName("active",!0),this._sliderMouseMoveMonitor.startMonitoring(Sm,e=>{const s=Math.abs(e.posx-i)
if(E&&s>Uf)return void this._context.viewLayout.setScrollPositionNow({scrollTop:n.scrollTop})
const r=e.posy-t
this._context.viewLayout.setScrollPositionNow({scrollTop:n.getDesiredScrollTopFromDelta(r)})},()=>{this._slider.toggleClassName("active",!1)})}})}dispose(){this._mouseDownListener.dispose(),this._sliderMouseMoveMonitor.dispose(),this._sliderMouseDownListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){return"always"===this._options.showSlider?"minimap slider-always":"minimap slider-mouseover"}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setWidth(this._options.minimapWidth),this._domNode.setHeight(this._options.minimapHeight),this._shadow.setHeight(this._options.minimapHeight),this._canvas.setWidth(this._options.canvasOuterWidth),this._canvas.setHeight(this._options.canvasOuterHeight),this._canvas.domNode.width=this._options.canvasInnerWidth,this._canvas.domNode.height=this._options.canvasInnerHeight,this._slider.setWidth(this._options.minimapWidth)}_getBuffer(){return this._buffers||(this._buffers=new jf(this._canvas.domNode.getContext("2d"),this._options.canvasInnerWidth,this._options.canvasInnerHeight,this._tokensColorTracker.getColor(2))),this._buffers.getBuffer()}_onOptionsMaybeChanged(){let e=new Kf(this._context.configuration)
return!this._options.equals(e)&&(this._options=e,this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName()),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onFlushed(e){return this._lastRenderData=null,!0}onLinesChanged(e){return!!this._lastRenderData&&this._lastRenderData.onLinesChanged(e)}onLinesDeleted(e){return this._lastRenderData&&this._lastRenderData.onLinesDeleted(e),!0}onLinesInserted(e){return this._lastRenderData&&this._lastRenderData.onLinesInserted(e),!0}onScrollChanged(e){return!0}onTokensChanged(e){return!!this._lastRenderData&&this._lastRenderData.onTokensChanged(e)}onTokensColorsChanged(e){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(e){return this._lastRenderData=null,!0}prepareRender(e){}render(e){if(0===this._options.renderMinimap)return void this._shadow.setClassName("minimap-shadow-hidden")
e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible")
const t=$f.create(this._options,e.visibleRange.startLineNumber,e.visibleRange.endLineNumber,e.viewportHeight,e.viewportData.whitespaceViewportData.length>0,this._context.model.getLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null)
this._slider.setTop(t.sliderTop),this._slider.setHeight(t.sliderHeight)
const i=e.scrollLeft/this._options.typicalHalfwidthCharacterWidth,n=Math.min(this._options.minimapWidth,Math.round(i*zf(this._options.renderMinimap)/this._options.pixelRatio))
this._sliderHorizontal.setLeft(n),this._sliderHorizontal.setWidth(this._options.minimapWidth-n),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(t.sliderHeight),this._lastRenderData=this.renderLines(t)}renderLines(e){const t=this._options.renderMinimap,i=e.startLineNumber,n=e.endLineNumber,s=Hf(t)
if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){const t=this._lastRenderData._get()
return new Gf(e,t.imageData,t.lines)}const r=this._getBuffer()
let[o,a,l]=Yf._renderUntouchedLines(r,i,n,s,this._lastRenderData)
const h=this._context.model.getMinimapLinesRenderingData(i,n,l),d=h.tabSize,u=this._tokensColorTracker.getColor(2),c=this._tokensColorTracker.backgroundIsLight()
let g=0,m=[]
for(let e=0,o=n-i+1;e<o;e++)l[e]&&Yf._renderLine(r,u,c,t,this._tokensColorTracker,this._minimapCharRenderer,g,d,h.data[e]),m[e]=new qf(g),g+=s
const p=-1===o?0:o,f=(-1===a?r.height:a)-p
return this._canvas.domNode.getContext("2d").putImageData(r,0,0,0,p,r.width,f),new Gf(e,r,m)}static _renderUntouchedLines(e,t,i,n,s){let r=[]
if(!s){for(let e=0,n=i-t+1;e<n;e++)r[e]=!0
return[-1,-1,r]}const o=s._get(),a=o.imageData.data,l=o.rendLineNumberStart,h=o.lines,d=h.length,u=e.width,c=e.data,g=(i-t+1)*n*u*4
let m=-1,p=-1,f=-1,_=-1,C=-1,b=-1,w=0
for(let e=t;e<=i;e++){const i=e-t,s=e-l,o=s>=0&&s<d?h[s].dy:-1
if(-1===o){r[i]=!0,w+=n
continue}let v=o*u*4,S=(o+n)*u*4,y=w*u*4,x=(w+n)*u*4
_===v&&b===y?(_=S,b=x):(-1!==f&&(c.set(a.subarray(f,_),C),-1===m&&0===f&&f===C&&(m=_),-1===p&&_===g&&f===C&&(p=f)),f=v,_=S,C=y,b=x),r[i]=!1,w+=n}return-1!==f&&(c.set(a.subarray(f,_),C),-1===m&&0===f&&f===C&&(m=_),-1===p&&_===g&&f===C&&(p=f)),[-1===m?-1:m/(4*u),-1===p?-1:p/(4*u),r]}static _renderLine(e,t,i,n,s,r,o,a,l){const h=l.content,d=l.tokens,u=zf(n),c=e.width-u
let g=0,m=0,p=0
for(let l=0,f=d.length;l<f;l++){const f=d[l],_=f.endIndex,C=f.getForeground(),b=s.getColor(C)
for(;m<_;m++){if(g>c)return
const s=h.charCodeAt(m)
if(9===s){let e=a-(m+p)%a
p+=e-1,g+=e*u}else 32===s?g+=u:(2===n?r.x2RenderChar(e,g,o,s,b,t,i):1===n?r.x1RenderChar(e,g,o,s,b,t,i):4===n?r.x2BlockRenderChar(e,g,o,b,t,i):r.x1BlockRenderChar(e,g,o,b,t,i),g+=u)}}}}Wg((e,t)=>{const i=e.getColor(Yc)
if(i){const e=i.transparent(.5)
t.addRule(`.monaco-editor .minimap-slider, .monaco-editor .minimap-slider .minimap-slider-horizontal { background: ${e}; }`)}const n=e.getColor(Zc)
if(n){const e=n.transparent(.5)
t.addRule(`.monaco-editor .minimap-slider:hover, .monaco-editor .minimap-slider:hover .minimap-slider-horizontal { background: ${e}; }`)}const s=e.getColor(Xc)
if(s){const e=s.transparent(.5)
t.addRule(`.monaco-editor .minimap-slider.active, .monaco-editor .minimap-slider.active .minimap-slider-horizontal { background: ${e}; }`)}const r=e.getColor(jc)
r&&t.addRule(`.monaco-editor .minimap-shadow-visible { box-shadow: ${r} -6px 0 6px -6px inset; }`)})
function Zf(e){try{return e()}catch(e){St(e)}}class Xf{constructor(e,t,i,n,s,r){this.id=e,this.label=t,this.alias=i,this._precondition=n,this._run=s,this._contextKeyService=r}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(){if(!this.isSupported())return bt.as(void 0)
const e=this._run()
return e||bt.as(void 0)}}let Jf=class extends class extends ni{constructor(e,t,i,n){super(),this._onDidDispose=this._register(new ci),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new ci),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new ci),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new ci),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new ci),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new ci),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeConfiguration=this._register(new ci),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onDidChangeModel=this._register(new ci),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new ci),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new ci),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidLayoutChange=this._register(new ci),this.onDidLayoutChange=this._onDidLayoutChange.event,this._onDidFocusEditorText=this._register(new ci),this.onDidFocusEditorText=this._onDidFocusEditorText.event,this._onDidBlurEditorText=this._register(new ci),this.onDidBlurEditorText=this._onDidBlurEditorText.event,this._onDidFocusEditor=this._register(new ci),this.onDidFocusEditor=this._onDidFocusEditor.event,this._onDidBlurEditor=this._register(new ci),this.onDidBlurEditor=this._onDidBlurEditor.event,this._onWillType=this._register(new ci),this.onWillType=this._onWillType.event,this._onDidType=this._register(new ci),this.onDidType=this._onDidType.event,this._onDidPaste=this._register(new ci),this.onDidPaste=this._onDidPaste.event,this.domElement=e,this.id=++lu,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},t=t||{},this._configuration=this._register(this._createConfiguration(t)),this._register(this._configuration.onDidChange(e=>{this._onDidChangeConfiguration.fire(e),e.layoutInfo&&this._onDidLayoutChange.fire(this._configuration.editor.layoutInfo)})),this._contextKeyService=this._register(n.createScoped(this.domElement)),this._register(new hu(this,this._contextKeyService)),this._register(new au(this,this._contextKeyService)),this._instantiationService=i.createChild(new zl([Lo,this._contextKeyService])),this._attachModel(null),this._contributions={},this._actions={}}getId(){return this.getEditorType()+":"+this.id}getEditorType(){return m.ICodeEditor}destroy(){this.dispose()}dispose(){let e=Object.keys(this._contributions)
for(let t=0,i=e.length;t<i;t++){let i=e[t]
this._contributions[i].dispose()}this._contributions={},this._actions={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(e){return this._instantiationService.invokeFunction(e)}updateOptions(e){this._configuration.updateOptions(e)}getConfiguration(){return this._configuration.editor}getRawConfiguration(){return this._configuration.getRawOptions()}getValue(e=null){if(this.model){let t=!(!e||!e.preserveBOM),i=s.TextDefined
return e&&e.lineEnding&&"\n"===e.lineEnding?i=s.LF:e&&e.lineEnding&&"\r\n"===e.lineEnding&&(i=s.CRLF),this.model.getValue(i,t)}return""}setValue(e){this.model&&this.model.setValue(e)}getModel(){return this.model}setModel(e=null){if(this.model===e)return
let t=this._detachModel()
this._attachModel(e)
let i={oldModelUrl:t?t.uri:null,newModelUrl:e?e.uri:null}
this._removeDecorationTypes(),this._onDidChangeModel.fire(i),this._postDetachModelCleanup(t)}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(let e in this._decorationTypeSubtypes){let t=this._decorationTypeSubtypes[e]
for(let i in t)this._removeDecorationType(e+"-"+i)}this._decorationTypeSubtypes={}}}getCenteredRangeInViewport(){return this.hasView?this.viewModel.getCenteredRangeInViewport():null}getVisibleColumnFromPosition(e){if(!this.model)return e.column
let t=this.model.validatePosition(e),i=this.model.getOptions().tabSize
return Cr.visibleColumnFromColumn(this.model.getLineContent(t.lineNumber),t.column,i)+1}getPosition(){return this.cursor?this.cursor.getPosition().clone():null}setPosition(t){if(this.cursor){if(!e.isIPosition(t))throw new Error("Invalid arguments")
this.cursor.setSelections("api",[{selectionStartLineNumber:t.lineNumber,selectionStartColumn:t.column,positionLineNumber:t.lineNumber,positionColumn:t.column}])}}_sendRevealRange(e,i,n,s){if(!this.model||!this.cursor)return
if(!t.isIRange(e))throw new Error("Invalid arguments")
const r=this.model.validateRange(e),o=this.viewModel.coordinatesConverter.convertModelRangeToViewRange(r)
this.cursor.emitCursorRevealRange(o,i,n,s)}revealLine(e,t=0){this._revealLine(e,0,t)}revealLineInCenter(e,t=0){this._revealLine(e,1,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._revealLine(e,2,t)}_revealLine(e,i,n){if("number"!=typeof e)throw new Error("Invalid arguments")
this._sendRevealRange(new t(e,1,e,1),i,!1,n)}revealPosition(e,t=0){this._revealPosition(e,0,!0,t)}revealPositionInCenter(e,t=0){this._revealPosition(e,1,!0,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._revealPosition(e,2,!0,t)}_revealPosition(i,n,s,r){if(!e.isIPosition(i))throw new Error("Invalid arguments")
this._sendRevealRange(new t(i.lineNumber,i.column,i.lineNumber,i.column),n,s,r)}getSelection(){return this.cursor?this.cursor.getSelection().clone():null}getSelections(){if(!this.cursor)return null
let e=this.cursor.getSelections(),t=[]
for(let i=0,n=e.length;i<n;i++)t[i]=e[i].clone()
return t}setSelection(e){let i=At.isISelection(e),n=t.isIRange(e)
if(!i&&!n)throw new Error("Invalid arguments")
if(i)this._setSelectionImpl(e)
else if(n){let t={selectionStartLineNumber:e.startLineNumber,selectionStartColumn:e.startColumn,positionLineNumber:e.endLineNumber,positionColumn:e.endColumn}
this._setSelectionImpl(t)}}_setSelectionImpl(e){if(!this.cursor)return
let t=new At(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)
this.cursor.setSelections("api",[t])}revealLines(e,t,i=0){this._revealLines(e,t,0,i)}revealLinesInCenter(e,t,i=0){this._revealLines(e,t,1,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._revealLines(e,t,2,i)}_revealLines(e,i,n,s){if("number"!=typeof e||"number"!=typeof i)throw new Error("Invalid arguments")
this._sendRevealRange(new t(e,1,i,1),n,!1,s)}revealRange(e,t=0,i=!1,n=!0){this._revealRange(e,i?1:0,n,t)}revealRangeInCenter(e,t=0){this._revealRange(e,1,!0,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._revealRange(e,2,!0,t)}revealRangeAtTop(e,t=0){this._revealRange(e,3,!0,t)}_revealRange(e,i,n,s){if(!t.isIRange(e))throw new Error("Invalid arguments")
this._sendRevealRange(t.lift(e),i,n,s)}setSelections(e){if(this.cursor){if(!e||0===e.length)throw new Error("Invalid arguments")
for(let t=0,i=e.length;t<i;t++)if(!At.isISelection(e[t]))throw new Error("Invalid arguments")
this.cursor.setSelections("api",e)}}getScrollWidth(){return this.hasView?this.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this.hasView?this.viewModel.viewLayout.getCurrentScrollLeft():-1}getScrollHeight(){return this.hasView?this.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this.hasView?this.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(e){if(this.hasView){if("number"!=typeof e)throw new Error("Invalid arguments")
this.viewModel.viewLayout.setScrollPositionNow({scrollLeft:e})}}setScrollTop(e){if(this.hasView){if("number"!=typeof e)throw new Error("Invalid arguments")
this.viewModel.viewLayout.setScrollPositionNow({scrollTop:e})}}setScrollPosition(e){this.hasView&&this.viewModel.viewLayout.setScrollPositionNow(e)}saveViewState(){if(!this.cursor||!this.hasView)return null
let e={},t=Object.keys(this._contributions)
for(let i=0,n=t.length;i<n;i++){let n=t[i],s=this._contributions[n]
"function"==typeof s.saveViewState&&(e[n]=s.saveViewState())}return{cursorState:this.cursor.saveState(),viewState:this.viewModel.viewLayout.saveState(),contributionsState:e}}restoreViewState(e){if(this.cursor&&this.hasView&&e&&e.cursorState&&e.viewState){let t=e,i=t.cursorState
Array.isArray(i)?this.cursor.restoreState(i):this.cursor.restoreState([i]),this.viewModel.viewLayout.restoreState(t.viewState)
let n=e.contributionsState||{},s=Object.keys(this._contributions)
for(let e=0,t=s.length;e<t;e++){let t=s[e],i=this._contributions[t]
"function"==typeof i.restoreViewState&&i.restoreViewState(n[t])}}}onVisible(){}onHide(){}getContribution(e){return this._contributions[e]||null}getActions(){let e=[],t=Object.keys(this._actions)
for(let i=0,n=t.length;i<n;i++){let n=t[i]
e.push(this._actions[n])}return e}getSupportedActions(){let e=this.getActions()
return e=e.filter(e=>e.isSupported())}getAction(e){return this._actions[e]||null}trigger(e,i,n){if(n=n||{},i===f.Type){if(!this.cursor||"string"!=typeof n.text||0===n.text.length)return
return"keyboard"===e&&this._onWillType.fire(n.text),this.cursor.trigger(e,i,n),void("keyboard"===e&&this._onDidType.fire(n.text))}if(i===f.Paste){if(!this.cursor||"string"!=typeof n.text||0===n.text.length)return
const s=this.cursor.getSelection().getStartPosition()
this.cursor.trigger(e,i,n)
const r=this.cursor.getSelection().getStartPosition()
return void("keyboard"===e&&this._onDidPaste.fire(new t(s.lineNumber,s.column,r.lineNumber,r.column)))}const s=this.getAction(i)
if(s)return void bt.as(s.run()).done(null,St)
if(!this.cursor)return
const r=No.getEditorCommand(i)
if(r)return(n=n||{}).source=e,void bt.as(r.runEditorCommand(null,this,n)).done(null,St)
this.cursor.trigger(e,i,n)}_getCursors(){return this.cursor}_getCursorConfiguration(){return this.cursor.context.config}pushUndoStop(){return!!this.model&&!this._configuration.editor.readOnly&&(this.model.pushStackElement(),!0)}executeEdits(e,t,i){return!!this.cursor&&!this._configuration.editor.readOnly&&(this.model.pushEditOperations(this.cursor.getSelections(),t,()=>i||this.cursor.getSelections()),i&&this.cursor.setSelections(e,i),!0)}executeCommand(e,t){this.cursor&&this.cursor.trigger(e,f.ExecuteCommand,t)}executeCommands(e,t){this.cursor&&this.cursor.trigger(e,f.ExecuteCommands,t)}changeDecorations(e){return this.model?this.model.changeDecorations(e,this.id):null}getLineDecorations(e){return this.model?this.model.getLineDecorations(e,this.id,this._configuration.editor.readOnly):null}deltaDecorations(e,t){return this.model?0===e.length&&0===t.length?e:this.model.deltaDecorations(e,t,this.id):[]}setDecorations(e,t){let i={},n=this._decorationTypeSubtypes[e]||{}
this._decorationTypeSubtypes[e]=i
let s=[]
for(let r of t){let t=e
if(r.renderOptions){let s=iu(r.renderOptions).toString(16)
t=e+"-"+s,n[s]||i[s]||this._registerDecorationType(t,r.renderOptions,e),i[s]=!0}let o=this._resolveDecorationOptions(t,!!r.hoverMessage)
r.hoverMessage&&(o.hoverMessage=r.hoverMessage),s.push({range:r.range,options:o})}for(let t in n)i[t]||this._removeDecorationType(e+"-"+t)
let r=this._decorationTypeKeysToIds[e]||[]
this._decorationTypeKeysToIds[e]=this.deltaDecorations(r,s)}setDecorationsFast(e,t){let i=this._decorationTypeSubtypes[e]||{}
for(let t in i)this._removeDecorationType(e+"-"+t)
this._decorationTypeSubtypes[e]={}
const n=Ld.createDynamic(this._resolveDecorationOptions(e,!1))
let s=new Array(t.length)
for(let e=0,i=t.length;e<i;e++)s[e]={range:t[e],options:n}
let r=this._decorationTypeKeysToIds[e]||[]
this._decorationTypeKeysToIds[e]=this.deltaDecorations(r,s)}removeDecorations(e){let t=this._decorationTypeKeysToIds[e]
t&&this.deltaDecorations(t,[]),this._decorationTypeKeysToIds.hasOwnProperty(e)&&delete this._decorationTypeKeysToIds[e],this._decorationTypeSubtypes.hasOwnProperty(e)&&delete this._decorationTypeSubtypes[e]}getLayoutInfo(){return this._configuration.editor.layoutInfo}_attachModel(e){this.model=e||null,this.listenersToRemove=[],this.viewModel=null,this.cursor=null,this.model?(this.domElement.setAttribute("data-mode-id",this.model.getLanguageIdentifier().language),this._configuration.setIsDominatedByLongLines(this.model.isDominatedByLongLines()),this._configuration.setMaxLineNumber(this.model.getLineCount()),this.model.onBeforeAttached(),this.viewModel=new tu(this.id,this._configuration,this.model,e=>this._scheduleAtNextAnimationFrame(e)),this.listenersToRemove.push(this.model.addBulkListener(e=>{for(let t=0,i=e.length;t<i;t++){let i=e[t].type,n=e[t].data
switch(i){case cn.ModelDecorationsChanged:this._onDidChangeModelDecorations.fire(n)
break
case cn.ModelLanguageChanged:this.domElement.setAttribute("data-mode-id",this.model.getLanguageIdentifier().language),this._onDidChangeModelLanguage.fire(n)
break
case cn.ModelLanguageConfigurationChanged:this._onDidChangeModelLanguageConfiguration.fire(n)
break
case cn.ModelContentChanged:this._onDidChangeModelContent.fire(n)
break
case cn.ModelOptionsChanged:this._onDidChangeModelOptions.fire(n)
break
case cn.ModelDispose:this.setModel(null)}}})),this.cursor=new uh(this._configuration,this.model,this.viewModel),this._createView(),this.listenersToRemove.push(this.cursor.onDidChange(e=>{let t=[]
for(let i=0,n=e.selections.length;i<n;i++)t[i]=e.selections[i].getPosition()
const i={position:t[0],secondaryPositions:t.slice(1),reason:e.reason,source:e.source}
this._onDidChangeCursorPosition.fire(i)
const n={selection:e.selections[0],secondarySelections:e.selections.slice(1),source:e.source,reason:e.reason}
this._onDidChangeCursorSelection.fire(n)}))):this.hasView=!1}_postDetachModelCleanup(e){e&&e.removeAllDecorationsWithOwnerId(this.id)}_detachModel(){this.model&&this.model.onBeforeDetached(),this.hasView=!1,this.listenersToRemove=ei(this.listenersToRemove),this.cursor&&(this.cursor.dispose(),this.cursor=null),this.viewModel&&(this.viewModel.dispose(),this.viewModel=null)
let e=this.model
return this.model=null,this.domElement.removeAttribute("data-mode-id"),e}getTelemetryData(){return null}}{constructor(e,t,i,n,s,r,o){super(e,t,i,r),this._onMouseUp=this._register(new ci),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new ci),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new ci),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new ci),this.onMouseDrop=this._onMouseDrop.event,this._onContextMenu=this._register(new ci),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new ci),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new ci),this.onMouseLeave=this._onMouseLeave.event,this._onKeyUp=this._register(new ci),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new ci),this.onKeyDown=this._onKeyDown.event,this._onDidScrollChange=this._register(new ci),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new ci),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._codeEditorService=n,this._commandService=s,this._themeService=o,this._focusTracker=new class extends ni{constructor(e){super(),this._onChange=this._register(new ci),this.onChange=this._onChange.event,this._hasFocus=!1,this._domFocusTracker=this._register(Dl(e)),this._domFocusTracker.addFocusListener(()=>{this._hasFocus=!0,this._onChange.fire(void 0)}),this._domFocusTracker.addBlurListener(()=>{this._hasFocus=!1,this._onChange.fire(void 0)})}hasFocus(){return this._hasFocus}}(e),this._focusTracker.onChange(()=>{this._focusTracker.hasFocus()?this._onDidFocusEditor.fire():this._onDidBlurEditor.fire()}),this.contentWidgets={},this.overlayWidgets={}
let a=this._getContributions()
for(let e=0,t=a.length;e<t;e++){let t=a[e]
try{let e=this._instantiationService.createInstance(t,this)
this._contributions[e.getId()]=e}catch(e){St(e)}}this._getActions().forEach(e=>{const t=new Xf(e.id,e.label,e.alias,e.precondition,()=>this._instantiationService.invokeFunction(t=>e.runEditorCommand(t,this,null)),this._contextKeyService)
this._actions[t.id]=t}),this._codeEditorService.addCodeEditor(this)}_createConfiguration(e){return new ju(e,this.domElement)}dispose(){this._codeEditorService.removeCodeEditor(this),this.contentWidgets={},this.overlayWidgets={},this._focusTracker.dispose(),super.dispose()}createOverviewRuler(e,t,i){return this._view.createOverviewRuler(e,t,i)}getDomNode(){return this.hasView?this._view.domNode.domNode:null}getCompletelyVisibleLinesRangeInViewport(){if(!this.hasView)return null
const e=this.viewModel.getCompletelyVisibleViewRange()
return this.viewModel.coordinatesConverter.convertViewRangeToModelRange(e)}delegateVerticalScrollbarMouseDown(e){this.hasView&&this._view.delegateVerticalScrollbarMouseDown(e)}layout(e){this._configuration.observeReferenceElement(e),this.render()}focus(){this.hasView&&this._view.focus()}isFocused(){return this.hasView&&this._view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(e){let t={widget:e,position:e.getPosition()}
this.contentWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a content widget with the same id."),this.contentWidgets[e.getId()]=t,this.hasView&&this._view.addContentWidget(t)}layoutContentWidget(e){let t=e.getId()
if(this.contentWidgets.hasOwnProperty(t)){let i=this.contentWidgets[t]
i.position=e.getPosition(),this.hasView&&this._view.layoutContentWidget(i)}}removeContentWidget(e){let t=e.getId()
if(this.contentWidgets.hasOwnProperty(t)){let e=this.contentWidgets[t]
delete this.contentWidgets[t],this.hasView&&this._view.removeContentWidget(e)}}addOverlayWidget(e){let t={widget:e,position:e.getPosition()}
this.overlayWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting an overlay widget with the same id."),this.overlayWidgets[e.getId()]=t,this.hasView&&this._view.addOverlayWidget(t)}layoutOverlayWidget(e){let t=e.getId()
if(this.overlayWidgets.hasOwnProperty(t)){let i=this.overlayWidgets[t]
i.position=e.getPosition(),this.hasView&&this._view.layoutOverlayWidget(i)}}removeOverlayWidget(e){let t=e.getId()
if(this.overlayWidgets.hasOwnProperty(t)){let e=this.overlayWidgets[t]
delete this.overlayWidgets[t],this.hasView&&this._view.removeOverlayWidget(e)}}changeViewZones(e){if(!this.hasView)return
this._view.change(e)&&this._onDidChangeViewZones.fire()}getWhitespaces(){return this.hasView?this.viewModel.viewLayout.getWhitespaces():[]}_getVerticalOffsetForPosition(e,t){let i=this.model.validatePosition({lineNumber:e,column:t}),n=this.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i)
return this.viewModel.viewLayout.getVerticalOffsetForLineNumber(n.lineNumber)}getTopForLineNumber(e){return this.hasView?this._getVerticalOffsetForPosition(e,1):-1}getTopForPosition(e,t){return this.hasView?this._getVerticalOffsetForPosition(e,t):-1}getTargetAtClientPoint(e,t){return this.hasView?this._view.getTargetAtClientPoint(e,t):null}getScrolledVisiblePosition(e){if(!this.hasView)return null
let t=this.model.validatePosition(e),i=this._configuration.editor.layoutInfo
return{top:this._getVerticalOffsetForPosition(t.lineNumber,t.column)-this.getScrollTop(),left:this._view.getOffsetForColumn(t.lineNumber,t.column)+i.glyphMarginWidth+i.lineNumbersWidth+i.decorationsWidth-this.getScrollLeft(),height:this._configuration.editor.lineHeight}}getOffsetForColumn(e,t){return this.hasView?this._view.getOffsetForColumn(e,t):-1}render(){this.hasView&&this._view.render(!0,!1)}setHiddenAreas(e){this.viewModel&&this.viewModel.setHiddenAreas(e.map(e=>t.lift(e)))}setAriaActiveDescendant(e){this.hasView&&this._view.setAriaActiveDescendant(e)}applyFontInfo(e){ju.applyFontInfoSlow(e,this._configuration.editor.fontInfo)}_attachModel(e){if(this._view=null,super._attachModel(e),this._view){this.domElement.appendChild(this._view.domNode.domNode)
let t=Object.keys(this.contentWidgets)
for(let e=0,i=t.length;e<i;e++){let i=t[e]
this._view.addContentWidget(this.contentWidgets[i])}for(let e=0,i=(t=Object.keys(this.overlayWidgets)).length;e<i;e++){let i=t[e]
this._view.addOverlayWidget(this.overlayWidgets[i])}this._view.render(!1,!0),this.hasView=!0,this._view.domNode.domNode.setAttribute("data-uri",e.uri.toString())}}_scheduleAtNextAnimationFrame(e){return al(e)}_createView(){this._view=new class extends Xu{constructor(e,t,i,n,s,r){super(),this._isDisposed=!1,this._cursor=s,this._renderAnimationFrame=null,this.outgoingEvents=new gf(n)
let o=new Sp(t,n,r,this.outgoingEvents,e)
this.eventDispatcher=new yp(e=>this._renderOnce(e)),this.eventDispatcher.addEventHandler(this),this._context=new cf(t,i.getTheme(),n,this.eventDispatcher),this._register(i.onThemeChange(e=>{this._context.theme=e,this.eventDispatcher.emit(new nh),this.render(!0,!1)})),this.viewParts=[],this._textAreaHandler=new cm(this._context,o,this.createTextAreaHandlerHelper()),this.viewParts.push(this._textAreaHandler),this.createViewParts(),this._setLayout(),this.pointerHandler=new vp(this._context,o,this.createPointerHandlerHelper()),this._register(n.addEventListener(e=>{this.eventDispatcher.emitMany(e)})),this._register(this._cursor.addEventListener(e=>{this.eventDispatcher.emitMany(e)}))}createViewParts(){this.linesContent=Zu(document.createElement("div")),this.linesContent.setClassName("lines-content monaco-editor-background"),this.linesContent.setPosition("absolute"),this.domNode=Zu(document.createElement("div")),this.domNode.setClassName(this.getEditorClassName()),this.overflowGuardContainer=Zu(document.createElement("div")),rc.write(this.overflowGuardContainer,3),this.overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new Pf(this._context,this.linesContent,this.domNode,this.overflowGuardContainer),this.viewParts.push(this._scrollbar),this.viewLines=new Up(this._context,this.linesContent),this.viewZones=new uf(this._context),this.viewParts.push(this.viewZones)
let e=new jp(this._context)
this.viewParts.push(e)
let t=new ef(this._context)
this.viewParts.push(t)
let i=new Ip(this._context)
this.viewParts.push(i),i.addDynamicOverlay(new Rp(this._context)),i.addDynamicOverlay(new af(this._context)),i.addDynamicOverlay(new Pp(this._context)),i.addDynamicOverlay(new Bp(this._context))
let n=new Mp(this._context)
this.viewParts.push(n),n.addDynamicOverlay(new Ap(this._context)),n.addDynamicOverlay(new Vp(this._context)),n.addDynamicOverlay(new $p(this._context)),n.addDynamicOverlay(new Kp(this._context)),n.addDynamicOverlay(new hm(this._context))
let s=new oc(this._context)
s.getDomNode().appendChild(this.viewZones.marginDomNode),s.getDomNode().appendChild(n.getDomNode()),this.viewParts.push(s),this.contentWidgets=new Tp(this._context,this.domNode),this.viewParts.push(this.contentWidgets),this.viewCursors=new df(this._context),this.viewParts.push(this.viewCursors),this.overlayWidgets=new qp(this._context),this.viewParts.push(this.overlayWidgets)
let r=new Qp(this._context)
this.viewParts.push(r)
let o=new Yf(this._context)
if(this.viewParts.push(o),e){let t=this._scrollbar.getOverviewRulerLayoutInfo()
t.parent.insertBefore(e.getDomNode(),t.insertBefore)}this.linesContent.appendChild(i.getDomNode()),this.linesContent.appendChild(r.domNode),this.linesContent.appendChild(this.viewZones.domNode),this.linesContent.appendChild(this.viewLines.getDomNode()),this.linesContent.appendChild(this.contentWidgets.domNode),this.linesContent.appendChild(this.viewCursors.getDomNode()),this.overflowGuardContainer.appendChild(s.getDomNode()),this.overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this.overflowGuardContainer.appendChild(t.getDomNode()),this.overflowGuardContainer.appendChild(this._textAreaHandler.textArea),this.overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover),this.overflowGuardContainer.appendChild(this.overlayWidgets.getDomNode()),this.overflowGuardContainer.appendChild(o.getDomNode()),this.domNode.appendChild(this.overflowGuardContainer),this.domNode.appendChild(this.contentWidgets.overflowingContentWidgetsDomNode)}_flushAccumulatedAndRenderNow(){this._renderNow()}createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this.linesContent.domNode,focusTextArea:()=>{this.focus()},getLastViewCursorsRenderData:()=>this.viewCursors.getLastRenderData()||[],shouldSuppressMouseDownOnViewZone:e=>this.viewZones.shouldSuppressMouseDownOnViewZone(e),shouldSuppressMouseDownOnWidget:e=>this.contentWidgets.shouldSuppressMouseDownOnWidget(e),getPositionFromDOMInfo:(e,t)=>(this._flushAccumulatedAndRenderNow(),this.viewLines.getPositionFromDOMInfo(e,t)),visibleRangeForPosition2:(e,i)=>{this._flushAccumulatedAndRenderNow()
let n=this.viewLines.visibleRangesForRange2(new t(e,i,e,i))
return n?n[0]:null},getLineWidth:e=>(this._flushAccumulatedAndRenderNow(),this.viewLines.getLineWidth(e))}}createTextAreaHandlerHelper(){return{visibleRangeForPositionRelativeToEditor:(e,i)=>{this._flushAccumulatedAndRenderNow()
let n=this.viewLines.visibleRangesForRange2(new t(e,i,e,i))
return n?n[0]:null}}}_setLayout(){const e=this._context.configuration.editor.layoutInfo
this.domNode.setWidth(e.width),this.domNode.setHeight(e.height),this.overflowGuardContainer.setWidth(e.width),this.overflowGuardContainer.setHeight(e.height),this.linesContent.setWidth(1e6),this.linesContent.setHeight(1e6)}getEditorClassName(){let e=this._textAreaHandler.isFocused()?" focused":""
return this._context.configuration.editor.editorClassName+" "+Ag(this._context.theme.type)+e}onConfigurationChanged(e){return e.editorClassName&&this.domNode.setClassName(this.getEditorClassName()),e.layoutInfo&&this._setLayout(),!1}onFocusChanged(e){return this.domNode.setClassName(this.getEditorClassName()),e.isFocused?this.outgoingEvents.emitViewFocusGained():this.outgoingEvents.emitViewFocusLost(),!1}onScrollChanged(e){return this.outgoingEvents.emitScrollChanged(e),!1}onThemeChanged(e){return this.domNode.setClassName(this.getEditorClassName()),!1}dispose(){this._isDisposed=!0,null!==this._renderAnimationFrame&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this.eventDispatcher.removeEventHandler(this),this.outgoingEvents.dispose(),this.pointerHandler.dispose(),this.viewLines.dispose()
for(let e=0,t=this.viewParts.length;e<t;e++)this.viewParts[e].dispose()
this.viewParts=[],super.dispose()}_renderOnce(e){let t=Zf(e)
return this._scheduleRender(),t}_scheduleRender(){null===this._renderAnimationFrame&&(this._renderAnimationFrame=ol(this._onRenderScheduled.bind(this),100))}_onRenderScheduled(){this._renderAnimationFrame=null,this._flushAccumulatedAndRenderNow()}_renderNow(){Zf(()=>this._actualRender())}_getViewPartsToRender(){let e=[],t=0
for(let i=0,n=this.viewParts.length;i<n;i++){let n=this.viewParts[i]
n.shouldRender()&&(e[t++]=n)}return e}_actualRender(){if(!function(e){for(;e;){if(e===document.body)return!0
e=e.parentNode}return!1}(this.domNode.domNode))return
let e=this._getViewPartsToRender()
if(!this.viewLines.shouldRender()&&0===e.length)return
const t=this._context.viewLayout.getLinesViewportData()
this._context.model.setViewport(t.startLineNumber,t.endLineNumber,t.centeredLineNumber)
let i=new pf(this._cursor.getViewSelections(),t,this._context.viewLayout.getWhitespaceViewportData(),this._context.model)
this.contentWidgets.shouldRender()&&this.contentWidgets.onBeforeRender(i),this.viewLines.shouldRender()&&(this.viewLines.renderText(i),this.viewLines.onDidRender(),e=this._getViewPartsToRender())
let n=new $m(this._context.viewLayout,i,this.viewLines)
for(let t=0,i=e.length;t<i;t++)e[t].prepareRender(n)
for(let t=0,i=e.length;t<i;t++){let i=e[t]
i.render(n),i.onDidRender()}}delegateVerticalScrollbarMouseDown(e){this._scrollbar.delegateVerticalScrollbarMouseDown(e)}getOffsetForColumn(e,i){let n=this._context.model.validateModelPosition({lineNumber:e,column:i}),s=this._context.model.coordinatesConverter.convertModelPositionToViewPosition(n)
this._flushAccumulatedAndRenderNow()
let r=this.viewLines.visibleRangesForRange2(new t(s.lineNumber,s.column,s.lineNumber,s.column))
return r?r[0].left:-1}getTargetAtClientPoint(e,t){return this.pointerHandler.getTargetAtClientPoint(e,t)}getInternalEventBus(){return this.outgoingEvents}createOverviewRuler(e,t,i){return new Jp(this._context,e,t,i)}change(e){let t=!1
return this._renderOnce(()=>{let i={addZone:e=>(t=!0,this.viewZones.addZone(e)),removeZone:e=>{e&&(t=this.viewZones.removeZone(e)||t)},layoutZone:e=>{e&&(t=this.viewZones.layoutZone(e)||t)}}
!function(e,t){try{e(t)}catch(e){St(e)}}(e,i),i.addZone=null,i.removeZone=null,t&&(this._context.viewLayout.onHeightMaybeChanged(),this._context.privateViewEventBus.emit(new rh))}),t}render(e,t){if(t){this.viewLines.forceShouldRender()
for(let e=0,t=this.viewParts.length;e<t;e++)this.viewParts[e].forceShouldRender()}e?this._flushAccumulatedAndRenderNow():this._scheduleRender()}setAriaActiveDescendant(e){this._textAreaHandler.setAriaActiveDescendant(e)}focus(){this._textAreaHandler.focusTextArea()}isFocused(){return this._textAreaHandler.isFocused()}addContentWidget(e){this.contentWidgets.addWidget(e.widget),this.layoutContentWidget(e),this._scheduleRender()}layoutContentWidget(e){let t=e.position?e.position.position:null,i=e.position?e.position.preference:null
this.contentWidgets.setWidgetPosition(e.widget,t,i),this._scheduleRender()}removeContentWidget(e){this.contentWidgets.removeWidget(e.widget),this._scheduleRender()}addOverlayWidget(e){this.overlayWidgets.addWidget(e.widget),this.layoutOverlayWidget(e),this._scheduleRender()}layoutOverlayWidget(e){let t=e.position?e.position.preference:null
this.overlayWidgets.setWidgetPosition(e.widget,t)&&this._scheduleRender()}removeOverlayWidget(e){this.overlayWidgets.removeWidget(e.widget),this._scheduleRender()}}(this._commandService,this._configuration,this._themeService,this.viewModel,this.cursor,(e,t)=>{this.cursor&&e.runCoreEditorCommand(this.cursor,t)})
const e=this._view.getInternalEventBus()
e.onDidGainFocus=(()=>{this._onDidFocusEditorText.fire(),this._onDidFocusEditor.fire()}),e.onDidScroll=(e=>this._onDidScrollChange.fire(e)),e.onDidLoseFocus=(()=>this._onDidBlurEditorText.fire()),e.onContextMenu=(e=>this._onContextMenu.fire(e)),e.onMouseDown=(e=>this._onMouseDown.fire(e)),e.onMouseUp=(e=>this._onMouseUp.fire(e)),e.onMouseDrag=(e=>this._onMouseDrag.fire(e)),e.onMouseDrop=(e=>this._onMouseDrop.fire(e)),e.onKeyUp=(e=>this._onKeyUp.fire(e)),e.onMouseMove=(e=>this._onMouseMove.fire(e)),e.onMouseLeave=(e=>this._onMouseLeave.fire(e)),e.onKeyDown=(e=>this._onKeyDown.fire(e))}_detachModel(){let e=null
this._view&&(this._view.dispose(),e=this._view.domNode.domNode,this._view=null)
let t=super._detachModel()
return e&&this.domElement.removeChild(e),t}_registerDecorationType(e,t,i){this._codeEditorService.registerDecorationType(e,t,i)}_removeDecorationType(e){this._codeEditorService.removeDecorationType(e)}_resolveDecorationOptions(e,t){return this._codeEditorService.resolveDecorationOptions(e,t)}}
Jf=Nn([En(2,Er),En(3,Eo),En(4,Dr),En(5,Lo),En(6,Mg)],Jf)
const Qf=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' height='3' width='6'><g fill='"),e_=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>")
function t_(e){return Qf+encodeURIComponent(e.toString())+e_}Wg((e,t)=>{let i=e.getColor(Qg)
i&&t.addRule(`.monaco-editor .errorsquiggly { border-bottom: 4px double ${i}; }`)
let n=e.getColor(Jg)
n&&t.addRule(`.monaco-editor .errorsquiggly { background: url("data:image/svg+xml,${t_(n)}") repeat-x bottom left; }`)
let s=e.getColor(tm)
s&&t.addRule(`.monaco-editor .warningsquiggly { border-bottom: 4px double ${s}; }`)
let r=e.getColor(em)
r&&t.addRule(`.monaco-editor .warningsquiggly { background: url("data:image/svg+xml;utf8,${t_(r)}") repeat-x bottom left; }`)
let o=e.getColor(nm)
s&&t.addRule(`.monaco-editor .infosquiggly { border-bottom: 4px double ${o}; }`)
let a=e.getColor(im)
r&&t.addRule(`.monaco-editor .infosquiggly { background: url("data:image/svg+xml;utf8,${t_(a)}") repeat-x bottom left; }`)})
Oo(class extends To{constructor(){super({id:"editor.action.jumpToBracket",label:Jt("smartSelect.jumpBracket","Go to Bracket"),alias:"Go to Bracket",precondition:null,kbOpts:{kbExpr:Vo.textFocus,primary:3160}})}run(e,t){let i=n_.get(t)
i&&i.jumpToBracket()}})
class i_{constructor(e,t){this.position=e,this.brackets=t}}let n_=s_=class extends ni{constructor(e){super(),this._editor=e,this._lastBracketsData=[],this._lastVersionId=0,this._decorations=[],this._updateBracketsSoon=this._register(new Ca(()=>this._updateBrackets(),50)),this._matchBrackets=this._editor.getConfiguration().contribInfo.matchBrackets,this._updateBracketsSoon.schedule(),this._register(e.onDidChangeCursorPosition(e=>{this._matchBrackets&&this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModel(e=>{this._decorations=[],this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModelLanguageConfiguration(e=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeConfiguration(e=>{this._matchBrackets=this._editor.getConfiguration().contribInfo.matchBrackets,!this._matchBrackets&&this._decorations.length>0&&(this._decorations=this._editor.deltaDecorations(this._decorations,[])),this._updateBracketsSoon.schedule()}))}static get(e){return e.getContribution(s_.ID)}getId(){return s_.ID}jumpToBracket(){const e=this._editor.getModel()
if(!e)return
let t=this._editor.getSelections().map(t=>{const i=t.getStartPosition(),n=e.matchBracket(i)
let s=null
if(n)n[0].containsPosition(i)?s=n[1].getStartPosition():n[1].containsPosition(i)&&(s=n[0].getStartPosition())
else{const t=e.findNextBracket(i)
t&&t.range&&(s=t.range.getStartPosition())}return s?new At(s.lineNumber,s.column,s.lineNumber,s.column):new At(i.lineNumber,i.column,i.lineNumber,i.column)})
this._editor.setSelections(t),this._editor.revealRange(t[0])}_updateBrackets(){if(!this._matchBrackets)return
this._recomputeBrackets()
let e=[],t=0
for(let i=0,n=this._lastBracketsData.length;i<n;i++){let n=this._lastBracketsData[i].brackets
n&&(e[t++]={range:n[0],options:s_._DECORATION_OPTIONS},e[t++]={range:n[1],options:s_._DECORATION_OPTIONS})}this._decorations=this._editor.deltaDecorations(this._decorations,e)}_recomputeBrackets(){const t=this._editor.getModel()
if(!t)return this._lastBracketsData=[],void(this._lastVersionId=0)
const i=t.getVersionId()
let n=[]
this._lastVersionId===i&&(n=this._lastBracketsData)
const s=this._editor.getSelections()
let r=[],o=0
for(let e=0,t=s.length;e<t;e++){let t=s[e]
t.isEmpty()&&(r[o++]=t.getStartPosition())}r.length>1&&r.sort(e.compare)
let a=[],l=0,h=0,d=n.length
for(let e=0,i=r.length;e<i;e++){let i=r[e]
for(;h<d&&n[h].position.isBefore(i);)h++
if(h<d&&n[h].position.equals(i))a[l++]=n[h]
else{let e=t.matchBracket(i)
a[l++]=new i_(i,e)}}this._lastBracketsData=a,this._lastVersionId=i}}
var s_
n_.ID="editor.contrib.bracketMatchingController",n_._DECORATION_OPTIONS=Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,className:"bracket-match"}),n_=s_=Nn([Po],n_),Wg((e,t)=>{let i=e.getColor(jg)
i&&t.addRule(`.monaco-editor .bracket-match { background-color: ${i}; }`)
let n=e.getColor(Yg)
n&&t.addRule(`.monaco-editor .bracket-match { border: 1px solid ${n}; }`)})
class r_{constructor(e,t){this._selection=e,this._isMovingLeft=t}getEditOperations(e,i){var n=this._selection
if(this._selectionId=i.trackSelection(n),n.startLineNumber===n.endLineNumber&&(!this._isMovingLeft||0!==n.startColumn)&&(this._isMovingLeft||n.endColumn!==e.getLineMaxColumn(n.startLineNumber))){var s,r,o,a=n.selectionStartLineNumber,l=e.getLineContent(a)
this._isMovingLeft?(s=l.substring(0,n.startColumn-2),r=l.substring(n.startColumn-1,n.endColumn-1),o=l.substring(n.startColumn-2,n.startColumn-1)+l.substring(n.endColumn-1)):(s=l.substring(0,n.startColumn-1)+l.substring(n.endColumn-1,n.endColumn),r=l.substring(n.startColumn-1,n.endColumn-1),o=l.substring(n.endColumn))
var h=s+r+o
i.addEditOperation(new t(a,1,a,e.getLineMaxColumn(a)),null),i.addEditOperation(new t(a,1,a,1),h),this._cutStartIndex=n.startColumn+(this._isMovingLeft?-1:1),this._cutEndIndex=this._cutStartIndex+n.endColumn-n.startColumn,this._moved=!0}}computeCursorState(e,t){var i=t.getTrackedSelection(this._selectionId)
return this._moved&&(i=(i=i.setStartPosition(i.startLineNumber,this._cutStartIndex)).setEndPosition(i.startLineNumber,this._cutEndIndex)),i}}class o_ extends To{constructor(e,t){super(t),this.left=e}run(e,t){for(var i=[],n=t.getSelections(),s=0;s<n.length;s++)i.push(new r_(n[s],this.left))
t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}}Oo(class extends o_{constructor(){super(!0,{id:"editor.action.moveCarretLeftAction",label:Jt("caret.moveLeft","Move Caret Left"),alias:"Move Caret Left",precondition:Vo.writable})}})
Oo(class extends o_{constructor(){super(!1,{id:"editor.action.moveCarretRightAction",label:Jt("caret.moveRight","Move Caret Right"),alias:"Move Caret Right",precondition:Vo.writable})}})
Oo(class extends To{constructor(){super({id:"editor.action.transposeLetters",label:Jt("transposeLetters.label","Transpose Letters"),alias:"Transpose Letters",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:0,mac:{primary:306}}})}run(e,i){let n=i.getModel(),s=[],r=i.getSelections()
for(let e=0;e<r.length;e++){let i=r[e]
if(!i.isEmpty())continue
let o=i.startLineNumber,a=i.startColumn
if(1===a)continue
if(a===n.getLineMaxColumn(o))continue
let l=n.getLineContent(o),h=l.charAt(a-2),d=l.charAt(a-1),u=new t(o,a-1,o,a+1)
s.push(new Ho(u,d+h))}s.length>0&&(i.pushUndoStop(),i.executeCommands(this.id,s),i.pushUndoStop())}})
const a_="9_cutcopypaste",l_=M||document.queryCommandSupported("cut"),h_=M||document.queryCommandSupported("copy"),d_=h_&&!Na,u_=M||!Ia&&document.queryCommandSupported("paste")
function c_(e){return e?Oo:()=>{}}class g_ extends To{constructor(e,t){super(t),this.browserCommand=e}runCommand(e,t){let i=e.get(Eo).getFocusedCodeEditor()
i&&i.isFocused()?i.trigger("keyboard",this.id,t):document.execCommand(this.browserCommand)}run(e,t){t.focus(),document.execCommand(this.browserCommand)}}let m_=class extends g_{constructor(){let e={kbExpr:Vo.textFocus,primary:2102,win:{primary:2102,secondary:[1044]}}
M||(e=null),super("cut",{id:"editor.action.clipboardCutAction",label:Jt("actions.clipboard.cutLabel","Cut"),alias:"Cut",precondition:Vo.writable,kbOpts:e,menuOpts:{group:a_,order:1}})}run(e,t){!t.getConfiguration().emptySelectionClipboard&&t.getSelection().isEmpty()||super.run(e,t)}}
m_=Nn([c_(l_)],m_)
let p_=class extends g_{constructor(){let e={kbExpr:Vo.textFocus,primary:2081,win:{primary:2081,secondary:[2067]}}
M||(e=null),super("copy",{id:"editor.action.clipboardCopyAction",label:Jt("actions.clipboard.copyLabel","Copy"),alias:"Copy",precondition:null,kbOpts:e,menuOpts:{group:a_,order:2}})}run(e,t){!t.getConfiguration().emptySelectionClipboard&&t.getSelection().isEmpty()||super.run(e,t)}}
p_=Nn([c_(h_)],p_)
let f_=class extends g_{constructor(){let e={kbExpr:Vo.textFocus,primary:2100,win:{primary:2100,secondary:[1043]}}
M||(e=null),super("paste",{id:"editor.action.clipboardPasteAction",label:Jt("actions.clipboard.pasteLabel","Paste"),alias:"Paste",precondition:Vo.writable,kbOpts:e,menuOpts:{group:a_,order:3}})}}
f_=Nn([c_(u_)],f_)
let __=class extends g_{constructor(){super("copy",{id:"editor.action.clipboardCopyWithSyntaxHighlightingAction",label:Jt("actions.clipboard.copyWithSyntaxHighlightingLabel","Copy With Syntax Highlighting"),alias:"Copy With Syntax Highlighting",precondition:null,kbOpts:{kbExpr:Vo.textFocus,primary:null}})}run(e,t){!t.getConfiguration().emptySelectionClipboard&&t.getSelection().isEmpty()||(ec.forceCopyWithSyntaxHighlighting=!0,super.run(e,t),ec.forceCopyWithSyntaxHighlighting=!1)}}
__=Nn([c_(d_)],__)
class C_{static insert(e,i){return{identifier:null,range:new t(e.lineNumber,e.column,e.lineNumber,e.column),text:i,forceMoveMarkers:!0}}static delete(e){return{identifier:null,range:e,text:null,forceMoveMarkers:!0}}static replace(e,t){return{identifier:null,range:e,text:t,forceMoveMarkers:!1}}static replaceMove(e,t){return{identifier:null,range:e,text:t,forceMoveMarkers:!0}}}class b_{constructor(e){this._selection=e,this._usedEndToken=null}static _haystackHasNeedleAtOffset(e,t,i){if(i<0)return!1
const n=t.length
if(i+n>e.length)return!1
for(let s=0;s<n;s++)if(e.charCodeAt(i+s)!==t.charCodeAt(s))return!1
return!0}_createOperationsForBlockComment(e,i,n,s){const r=e.startLineNumber,o=e.startColumn,a=e.endLineNumber,l=e.endColumn,h=n.getLineContent(r),d=n.getLineContent(a)
let u,c=i.blockCommentStartToken,g=i.blockCommentEndToken,m=h.lastIndexOf(c,o-1+c.length),p=d.indexOf(g,l-1-g.length)
if(-1!==m&&-1!==p)if(r===a){h.substring(m+c.length,p).indexOf(g)>=0&&(m=-1,p=-1)}else{const e=h.substring(m+c.length),t=d.substring(0,p);(e.indexOf(g)>=0||t.indexOf(g)>=0)&&(m=-1,p=-1)}-1!==m&&-1!==p?(m+c.length<h.length&&32===h.charCodeAt(m+c.length)&&(c+=" "),p>0&&32===d.charCodeAt(p-1)&&(g=" "+g,p-=1),u=b_._createRemoveBlockCommentOperations(new t(r,m+c.length+1,a,p+1),c,g)):(u=b_._createAddBlockCommentOperations(e,c,g),this._usedEndToken=1===u.length?g:null)
for(let e=0;e<u.length;e++)s.addTrackedEditOperation(u[e].range,u[e].text)}static _createRemoveBlockCommentOperations(e,i,n){let s=[]
return t.isEmpty(e)?s.push(C_.delete(new t(e.startLineNumber,e.startColumn-i.length,e.endLineNumber,e.endColumn+n.length))):(s.push(C_.delete(new t(e.startLineNumber,e.startColumn-i.length,e.startLineNumber,e.startColumn))),s.push(C_.delete(new t(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn+n.length)))),s}static _createAddBlockCommentOperations(i,n,s){let r=[]
return t.isEmpty(i)?r.push(C_.replace(new t(i.startLineNumber,i.startColumn,i.endLineNumber,i.endColumn),n+"  "+s)):(r.push(C_.insert(new e(i.startLineNumber,i.startColumn),n+" ")),r.push(C_.insert(new e(i.endLineNumber,i.endColumn)," "+s))),r}getEditOperations(e,t){const i=this._selection.startLineNumber,n=this._selection.startColumn
e.tokenizeIfCheap(i)
const s=e.getLanguageIdAtPosition(i,n),r=cr.getComments(s)
r&&r.blockCommentStartToken&&r.blockCommentEndToken&&this._createOperationsForBlockComment(this._selection,r,e,t)}computeCursorState(e,t){const i=t.getInverseEditOperations()
if(2===i.length){const e=i[0],t=i[1]
return new At(e.range.endLineNumber,e.range.endColumn,t.range.startLineNumber,t.range.startColumn)}{const e=i[0].range,t=this._usedEndToken?-this._usedEndToken.length-1:0
return new At(e.endLineNumber,e.endColumn+t,e.endLineNumber,e.endColumn+t)}}}class w_{constructor(e,t,i){this._selection=e,this._tabSize=t,this._type=i,this._deltaColumn=0}static _gatherPreflightCommentStrings(e,t,i){e.tokenizeIfCheap(t)
const n=e.getLanguageIdAtPosition(t,1),s=cr.getComments(n),r=s?s.lineCommentToken:null
if(!r)return null
let o=[]
for(let e=0,n=i-t+1;e<n;e++)o[e]={ignore:!1,commentStr:r,commentStrOffset:0,commentStrLength:r.length}
return o}static _analyzeLines(e,t,i,n){var s,r,o,a,l,h,d,u,c=!0
for(d=0===e||1!==e,a=0,l=i.length;a<l;a++)s=i[a],h=n+a,-1!==(r=Le(u=t.getLineContent(h)))?(c=!1,s.ignore=!1,s.commentStrOffset=r,d&&!b_._haystackHasNeedleAtOffset(u,s.commentStr,r)&&(0===e?d=!1:1===e||(s.ignore=!0)),d&&(o=r+s.commentStrLength)<u.length&&32===u.charCodeAt(o)&&(s.commentStrLength+=1)):(s.ignore=!0,s.commentStrOffset=u.length)
if(0===e&&c)for(d=!1,a=0,l=i.length;a<l;a++)i[a].ignore=!1
return{supported:!0,shouldRemoveComments:d,lines:i}}static _gatherPreflightData(e,t,i,n){var s=w_._gatherPreflightCommentStrings(t,i,n)
return null===s?{supported:!1,shouldRemoveComments:!1,lines:null}:w_._analyzeLines(e,t,s,i)}_executeLineComments(t,i,n,s){var r
n.shouldRemoveComments?r=w_._createRemoveLineCommentsOperations(n.lines,s.startLineNumber):(w_._normalizeInsertionPoint(t,n.lines,s.startLineNumber,this._tabSize),r=w_._createAddLineCommentsOperations(n.lines,s.startLineNumber))
const o=new e(s.positionLineNumber,s.positionColumn)
for(var a=0,l=r.length;a<l;a++){if(i.addEditOperation(r[a].range,r[a].text),r[a].range.isEmpty()&&r[a].range.getStartPosition().equals(o))t.getLineContent(o.lineNumber).length+1===o.column&&(this._deltaColumn=r[a].text.length)}this._selectionId=i.trackSelection(s)}_attemptRemoveBlockComment(e,i,n,s){let r=i.startLineNumber,o=i.endLineNumber,a=s.length+Math.max(e.getLineFirstNonWhitespaceColumn(i.startLineNumber),i.startColumn),l=e.getLineContent(r).lastIndexOf(n,a-1),h=e.getLineContent(o).indexOf(s,i.endColumn-1-n.length)
return-1!==l&&-1===h&&(h=e.getLineContent(r).indexOf(s,l+n.length),o=r),-1===l&&-1!==h&&(l=e.getLineContent(o).lastIndexOf(n,h),r=o),!i.isEmpty()||-1!==l&&-1!==h||-1!==(l=e.getLineContent(r).indexOf(n))&&(h=e.getLineContent(r).indexOf(s,l+n.length)),-1!==l&&32===e.getLineContent(r).charCodeAt(l+n.length)&&(n+=" "),-1!==h&&32===e.getLineContent(o).charCodeAt(h-1)&&(s=" "+s,h-=1),-1!==l&&-1!==h?b_._createRemoveBlockCommentOperations(new t(r,l+n.length+1,o,h+1),n,s):null}_executeBlockComment(e,i,n){e.tokenizeIfCheap(n.startLineNumber)
let s=e.getLanguageIdAtPosition(n.startLineNumber,1),r=cr.getComments(s)
if(r&&r.blockCommentStartToken&&r.blockCommentEndToken){var o=r.blockCommentStartToken,a=r.blockCommentEndToken,l=this._attemptRemoveBlockComment(e,n,o,a)
if(!l){if(n.isEmpty()){var h=e.getLineContent(n.startLineNumber),d=Le(h);-1===d&&(d=h.length),l=b_._createAddBlockCommentOperations(new t(n.startLineNumber,d+1,n.startLineNumber,h.length+1),o,a)}else l=b_._createAddBlockCommentOperations(new t(n.startLineNumber,e.getLineFirstNonWhitespaceColumn(n.startLineNumber),n.endLineNumber,e.getLineMaxColumn(n.endLineNumber)),o,a)
1===l.length&&(this._deltaColumn=o.length+1)}this._selectionId=i.trackSelection(n)
for(var u=0;u<l.length;u++)i.addEditOperation(l[u].range,l[u].text)}}getEditOperations(e,t){var i=this._selection
this._moveEndPositionDown=!1,i.startLineNumber<i.endLineNumber&&1===i.endColumn&&(this._moveEndPositionDown=!0,i=i.setEndPosition(i.endLineNumber-1,e.getLineMaxColumn(i.endLineNumber-1)))
var n=w_._gatherPreflightData(this._type,e,i.startLineNumber,i.endLineNumber)
return n.supported?this._executeLineComments(e,t,n,i):this._executeBlockComment(e,t,i)}computeCursorState(e,t){var i=t.getTrackedSelection(this._selectionId)
return this._moveEndPositionDown&&(i=i.setEndPosition(i.endLineNumber+1,1)),new At(i.startLineNumber,i.startColumn+this._deltaColumn,i.endLineNumber,i.endColumn+this._deltaColumn)}static _createRemoveLineCommentsOperations(e,i){var n,s,r,o=[]
for(n=0,s=e.length;n<s;n++)(r=e[n]).ignore||o.push(C_.delete(new t(i+n,r.commentStrOffset+1,i+n,r.commentStrOffset+r.commentStrLength+1)))
return o}static _createAddLineCommentsOperations(t,i){var n,s,r,o=[]
for(n=0,s=t.length;n<s;n++)(r=t[n]).ignore||o.push(C_.insert(new e(i+n,r.commentStrOffset+1),r.commentStr+" "))
return o}static nextVisibleColumn(e,t,i,n){return i?e+(t-e%t):e+n}static _normalizeInsertionPoint(e,t,i,n){var s,r,o,a,l,h,d=Number.MAX_VALUE
for(s=0,r=t.length;s<r;s++)if(!t[s].ignore){for(o=e.getLineContent(i+s),h=0,a=0,l=t[s].commentStrOffset;h<d&&a<l;a++)h=w_.nextVisibleColumn(h,n,9===o.charCodeAt(a),1)
h<d&&(d=h)}for(d=Math.floor(d/n)*n,s=0,r=t.length;s<r;s++)if(!t[s].ignore){for(o=e.getLineContent(i+s),h=0,a=0,l=t[s].commentStrOffset;h<d&&a<l;a++)h=w_.nextVisibleColumn(h,n,9===o.charCodeAt(a),1)
t[s].commentStrOffset=h>d?a-1:a}}}class v_ extends To{constructor(e,t){super(t),this._type=e}run(e,t){let i=t.getModel()
if(i){for(var n=[],s=t.getSelections(),r=i.getOptions(),o=0;o<s.length;o++)n.push(new w_(s[o],r.tabSize,this._type))
t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}}Oo(class extends v_{constructor(){super(0,{id:"editor.action.commentLine",label:Jt("comment.line","Toggle Line Comment"),alias:"Toggle Line Comment",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:2133}})}})
Oo(class extends v_{constructor(){super(1,{id:"editor.action.addCommentLine",label:Jt("comment.line.add","Add Line Comment"),alias:"Add Line Comment",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:Wr(2089,2081)}})}})
Oo(class extends v_{constructor(){super(2,{id:"editor.action.removeCommentLine",label:Jt("comment.line.remove","Remove Line Comment"),alias:"Remove Line Comment",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:Wr(2089,2099)}})}})
Oo(class extends To{constructor(){super({id:"editor.action.blockComment",label:Jt("comment.block","Toggle Block Comment"),alias:"Toggle Block Comment",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:1567,linux:{primary:3103}}})}run(e,t){for(var i=[],n=t.getSelections(),s=0;s<n.length;s++)i.push(new b_(n[s]))
t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}})
const S_={withElementById:function(e,t){$r(rt(e),"Expected String as parameter")
let i=document.getElementById(e)
return i?new M_(i,t):null}}
let y_="_msDataKey",x_="__$binding",L_="__$listeners",N_="__$visibility"
class E_{constructor(e,t){this.width=e,this.height=t}substract(e){return new E_(this.width-e.left-e.right,this.height-e.top-e.bottom)}}function k_(e){return e[y_]||(e[y_]={}),e[y_]}function I_(e){return!!e[y_]}class M_{constructor(e,t){this.offdom=t,this.container=e,this.currentElement=e,this.createdElements=[],this.toUnbind={},this.captureToUnbind={}}asContainer(){return T_(this,this.offdom)}clone(){let e=new M_(this.container,this.offdom)
return e.currentElement=this.currentElement,e.createdElements=this.createdElements,e.captureToUnbind=this.captureToUnbind,e.toUnbind=this.toUnbind,e}and(e){e instanceof M_||e instanceof D_||(e=new M_(e,this.offdom))
let t=[this]
if(e instanceof D_)for(let i=0;i<e.length;i++)t.push(e.item(i))
else t.push(e)
return new D_(t)}build(e,t){$r(this.offdom,"This builder was not created off-dom, so build() can not be called."),e?e instanceof M_&&(e=e.getHTMLElement()):e=this.container,$r(e,"Builder can only be build() with a container provided."),$r(El(e),"The container must either be a HTMLElement or a Builder.")
let i,n,s=e,r=s.childNodes
if(at(t)&&t<r.length)for(i=0,n=this.createdElements.length;i<n;i++)s.insertBefore(this.createdElements[i],r[t++])
else for(i=0,n=this.createdElements.length;i<n;i++)s.appendChild(this.createdElements[i])
return this}appendTo(e,t){e?e instanceof M_&&(e=e.getHTMLElement()):e=this.container,$r(e,"Builder can only be build() with a container provided."),$r(El(e),"The container must either be a HTMLElement or a Builder.")
let i=e
this.currentElement.parentNode&&this.currentElement.parentNode.removeChild(this.currentElement)
let n=i.childNodes
return at(t)&&t<n.length?i.insertBefore(this.currentElement,n[t]):i.appendChild(this.currentElement),this}append(e,t){return $r(e,"Need a child to append"),El(e)&&(e=O_(e)),$r(e instanceof M_||e instanceof D_,"Need a child to append"),e.appendTo(this,t),this}offDOM(){return this.currentElement.parentNode&&this.currentElement.parentNode.removeChild(this.currentElement),this}getHTMLElement(){return this.currentElement}getContainer(){return this.container}div(e,t){return this.doElement("div",e,t)}p(e,t){return this.doElement("p",e,t)}ul(e,t){return this.doElement("ul",e,t)}ol(e,t){return this.doElement("ol",e,t)}li(e,t){return this.doElement("li",e,t)}span(e,t){return this.doElement("span",e,t)}img(e,t){return this.doElement("img",e,t)}a(e,t){return this.doElement("a",e,t)}header(e,t){return this.doElement("header",e,t)}section(e,t){return this.doElement("section",e,t)}footer(e,t){return this.doElement("footer",e,t)}element(e,t,i){return this.doElement(e,t,i)}doElement(e,t,i){let n=document.createElement(e)
if(this.currentElement=n,this.offdom&&this.createdElements.push(n),ot(t)&&this.attr(t),gt(t)&&(i=t),gt(i)){let e=new M_(n)
i.call(e,e)}return this.offdom||this.container.appendChild(n),this}domFocus(){return this.currentElement.focus(),this}hasFocus(){return document.activeElement===this.currentElement}domSelect(e=null){let t=this.currentElement
return t.select(),e&&t.setSelectionRange(e.start,e.end),this}domBlur(){return this.currentElement.blur(),this}domClick(){return this.currentElement.click(),this}on(e,t,i,n){if(st(e))e.forEach(e=>{this.on(e,t,i,n)})
else{let s=e,r=il(this.currentElement,s,e=>{t(e,this,r)},n||!1)
n?(this.captureToUnbind[s]||(this.captureToUnbind[s]=[]),this.captureToUnbind[s].push(r)):(this.toUnbind[s]||(this.toUnbind[s]=[]),this.toUnbind[s].push(r))
let o=this.getProperty(L_,[])
o.push(r),this.setProperty(L_,o),i&&st(i)&&i.push(r)}return this}off(e,t){if(st(e))e.forEach(e=>{this.off(e)})
else{let i=e
t?this.captureToUnbind[i]&&(this.captureToUnbind[i]=ei(this.captureToUnbind[i])):this.toUnbind[i]&&(this.toUnbind[i]=ei(this.toUnbind[i]))}return this}once(e,t,i,n){if(st(e))e.forEach(e=>{this.once(e,t)})
else{let s=e,r=il(this.currentElement,s,e=>{t(e,this,r),r.dispose()},n||!1)
i&&st(i)&&i.push(r)}return this}preventDefault(e,t,i,n){return this.on(e,function(e){e.preventDefault(),t&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)},i,n)}attr(e,t){if(ot(e)){for(let t in e)if(e.hasOwnProperty(t)){let i=e[t]
this.doSetAttr(t,i)}return this}return rt(e)&&!rt(t)?this.currentElement.getAttribute(e):(rt(e)&&(rt(t)||(t=String(t)),this.doSetAttr(e,t)),this)}doSetAttr(e,t){"class"===e&&(e="addClass"),this[e]?st(t)?this[e].apply(this,t):this[e].call(this,t):this.currentElement.setAttribute(e,t)}removeAttribute(e){this.currentElement.removeAttribute(e)}id(e){return this.currentElement.setAttribute("id",e),this}src(e){return this.currentElement.setAttribute("src",e),this}href(e){return this.currentElement.setAttribute("href",e),this}title(e){return this.currentElement.setAttribute("title",e),this}name(e){return this.currentElement.setAttribute("name",e),this}type(e){return this.currentElement.setAttribute("type",e),this}value(e){return this.currentElement.setAttribute("value",e),this}alt(e){return this.currentElement.setAttribute("alt",e),this}draggable(e){return this.currentElement.setAttribute("draggable",e?"true":"false"),this}tabindex(e){return this.currentElement.setAttribute("tabindex",e.toString()),this}style(e,t){if(ot(e)){for(let t in e)if(e.hasOwnProperty(t)){let i=e[t]
this.doSetStyle(t,i)}return this}const i=rt(e)
return i&&ht(t)?this.currentElement.style[this.cssKeyToJavaScriptProperty(e)]:(i&&this.doSetStyle(e,t),this)}doSetStyle(e,t){if(e.indexOf("-")>=0){let t=e.split("-")
e=t[0]
for(let i=1;i<t.length;i++){let n=t[i]
e=e+n.charAt(0).toUpperCase()+n.substr(1)}}this.currentElement.style[this.cssKeyToJavaScriptProperty(e)]=t}cssKeyToJavaScriptProperty(e){if(e.indexOf("-")>=0){let t=e.split("-")
e=t[0]
for(let i=1;i<t.length;i++){let n=t[i]
e=e+n.charAt(0).toUpperCase()+n.substr(1)}}else"float"===e&&(e="cssFloat")
return e}getComputedStyle(){return gl(this.currentElement)}addClass(...e){return e.forEach(e=>{e.split(" ").forEach(e=>{Ja(this.currentElement,e)})}),this}setClass(e,t=null){return null===t?this.currentElement.className=e:t?this.addClass(e):this.removeClass(e),this}hasClass(e){return Xa(this.currentElement,e)}removeClass(...e){return e.forEach(e=>{e.split(" ").forEach(e=>{Qa(this.currentElement,e)})}),this}swapClass(e,t){return this.hasClass(e)?(this.removeClass(e),this.addClass(t)):(this.removeClass(t),this.addClass(e)),this}toggleClass(e){return this.hasClass(e)?this.removeClass(e):this.addClass(e),this}color(e){return this.currentElement.style.color=e,this}background(e){return this.currentElement.style.backgroundColor=e,this}padding(e,t,i,n){return rt(e)&&e.indexOf(" ")>=0?this.padding.apply(this,e.split(" ")):(dt(e)||(this.currentElement.style.paddingTop=this.toPixel(e)),dt(t)||(this.currentElement.style.paddingRight=this.toPixel(t)),dt(i)||(this.currentElement.style.paddingBottom=this.toPixel(i)),dt(n)||(this.currentElement.style.paddingLeft=this.toPixel(n)),this)}margin(e,t,i,n){return rt(e)&&e.indexOf(" ")>=0?this.margin.apply(this,e.split(" ")):(dt(e)||(this.currentElement.style.marginTop=this.toPixel(e)),dt(t)||(this.currentElement.style.marginRight=this.toPixel(t)),dt(i)||(this.currentElement.style.marginBottom=this.toPixel(i)),dt(n)||(this.currentElement.style.marginLeft=this.toPixel(n)),this)}position(e,t,i,n,s){return rt(e)&&e.indexOf(" ")>=0?this.position.apply(this,e.split(" ")):(dt(e)||(this.currentElement.style.top=this.toPixel(e)),dt(t)||(this.currentElement.style.right=this.toPixel(t)),dt(i)||(this.currentElement.style.bottom=this.toPixel(i)),dt(n)||(this.currentElement.style.left=this.toPixel(n)),s||(s="absolute"),this.currentElement.style.position=s,this)}size(e,t){return rt(e)&&e.indexOf(" ")>=0?this.size.apply(this,e.split(" ")):(dt(e)||(this.currentElement.style.width=this.toPixel(e)),dt(t)||(this.currentElement.style.height=this.toPixel(t)),this)}minSize(e,t){return rt(e)&&e.indexOf(" ")>=0?this.minSize.apply(this,e.split(" ")):(dt(e)||(this.currentElement.style.minWidth=this.toPixel(e)),dt(t)||(this.currentElement.style.minHeight=this.toPixel(t)),this)}maxSize(e,t){return rt(e)&&e.indexOf(" ")>=0?this.maxSize.apply(this,e.split(" ")):(dt(e)||(this.currentElement.style.maxWidth=this.toPixel(e)),dt(t)||(this.currentElement.style.maxHeight=this.toPixel(t)),this)}float(e){return this.currentElement.style.cssFloat=e,this}clear(e){return this.currentElement.style.clear=e,this}normal(){return this.currentElement.style.fontStyle="normal",this.currentElement.style.fontWeight="normal",this.currentElement.style.textDecoration="none",this}italic(){return this.currentElement.style.fontStyle="italic",this}bold(){return this.currentElement.style.fontWeight="bold",this}underline(){return this.currentElement.style.textDecoration="underline",this}overflow(e){return this.currentElement.style.overflow=e,this}display(e){return this.currentElement.style.display=e,this}disable(){return this.currentElement.setAttribute("disabled","disabled"),this}enable(){return this.currentElement.removeAttribute("disabled"),this}show(){return this.hasClass("builder-hidden")&&this.removeClass("builder-hidden"),this.attr("aria-hidden","false"),this.cancelVisibilityPromise(),this}showDelayed(e){this.cancelVisibilityPromise()
let t=bt.timeout(e)
return this.setProperty(N_,t),t.done(()=>{this.removeProperty(N_),this.show()}),this}hide(){return this.hasClass("builder-hidden")||this.addClass("builder-hidden"),this.attr("aria-hidden","true"),this.cancelVisibilityPromise(),this}isHidden(){return this.hasClass("builder-hidden")||"none"===this.currentElement.style.display}toggleVisibility(){return this.cancelVisibilityPromise(),this.swapClass("builder-visible","builder-hidden"),this.isHidden()?this.attr("aria-hidden","true"):this.attr("aria-hidden","false"),this}cancelVisibilityPromise(){let e=this.getProperty(N_)
e&&(e.cancel(),this.removeProperty(N_))}border(e,t,i){return rt(e)&&e.indexOf(" ")>=0?this.border.apply(this,e.split(" ")):(this.currentElement.style.borderWidth=this.toPixel(e),i&&(this.currentElement.style.borderColor=i),t&&(this.currentElement.style.borderStyle=t),this)}borderTop(e,t,i){return rt(e)&&e.indexOf(" ")>=0?this.borderTop.apply(this,e.split(" ")):(this.currentElement.style.borderTopWidth=this.toPixel(e),i&&(this.currentElement.style.borderTopColor=i),t&&(this.currentElement.style.borderTopStyle=t),this)}borderBottom(e,t,i){return rt(e)&&e.indexOf(" ")>=0?this.borderBottom.apply(this,e.split(" ")):(this.currentElement.style.borderBottomWidth=this.toPixel(e),i&&(this.currentElement.style.borderBottomColor=i),t&&(this.currentElement.style.borderBottomStyle=t),this)}borderLeft(e,t,i){return rt(e)&&e.indexOf(" ")>=0?this.borderLeft.apply(this,e.split(" ")):(this.currentElement.style.borderLeftWidth=this.toPixel(e),i&&(this.currentElement.style.borderLeftColor=i),t&&(this.currentElement.style.borderLeftStyle=t),this)}borderRight(e,t,i){return rt(e)&&e.indexOf(" ")>=0?this.borderRight.apply(this,e.split(" ")):(this.currentElement.style.borderRightWidth=this.toPixel(e),i&&(this.currentElement.style.borderRightColor=i),t&&(this.currentElement.style.borderRightStyle=t),this)}textAlign(e){return this.currentElement.style.textAlign=e,this}verticalAlign(e){return this.currentElement.style.verticalAlign=e,this}toPixel(e){return-1===e.toString().indexOf("px")?e.toString()+"px":e}innerHtml(e,t){return t?this.currentElement.innerHTML+=e:this.currentElement.innerHTML=e,this}text(e,t){return t?0===this.currentElement.children.length?this.currentElement.textContent+=e:this.currentElement.appendChild(document.createTextNode(e)):this.currentElement.textContent=e,this}safeInnerHtml(e,t){return this.innerHtml(de(e),t)}bind(e){return W_(this.currentElement,e),this}unbind(){return V_(this.currentElement),this}getBinding(){return B_(this.currentElement)}setProperty(e,t){return A_(this.currentElement,e,t),this}getProperty(e,t){return P_(this.currentElement,e,t)}removeProperty(e){return I_(this.currentElement)&&delete k_(this.currentElement)[e],this}parent(e){return $r(!this.offdom,"Builder was created with offdom = true and thus has no parent set"),O_(this.currentElement.parentNode,e)}children(e){let t=this.currentElement.children,i=[]
for(let n=0;n<t.length;n++)i.push(O_(t.item(n),e))
return new D_(i)}child(e=0){return O_(this.currentElement.children.item(e))}removeChild(e){return this.currentElement===e.parent().getHTMLElement()&&this.currentElement.removeChild(e.getHTMLElement()),this}select(e,t){$r(rt(e),"Expected String as parameter")
let i=this.currentElement.querySelectorAll(e),n=[]
for(let e=0;e<i.length;e++)n.push(O_(i.item(e),t))
return new D_(n)}matches(e){let t=this.currentElement,i=t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector
return i&&i.call(t,e)}isEmpty(){return!this.currentElement.childNodes||0===this.currentElement.childNodes.length}unbindDescendants(e){if(e&&e.children)for(let t=0,i=e.children.length;t<i;t++){let i=e.children.item(t)
if(I_(i)){let e=k_(i)[L_]
if(st(e))for(;e.length;)e.pop().dispose()
delete i[y_]}this.unbindDescendants(i)}}empty(){return this.unbindDescendants(this.currentElement),this.clearChildren(),this.offdom&&(this.createdElements=[]),this}clearChildren(){return this.currentElement&&Ga(this.currentElement),this}destroy(){if(this.currentElement&&(this.currentElement.parentNode&&this.currentElement.parentNode.removeChild(this.currentElement),this.empty(),I_(this.currentElement))){let e=k_(this.currentElement)[L_]
if(st(e))for(;e.length;)e.pop().dispose()
delete this.currentElement[y_]}let e
for(e in this.toUnbind)this.toUnbind.hasOwnProperty(e)&&st(this.toUnbind[e])&&(this.toUnbind[e]=ei(this.toUnbind[e]))
for(e in this.captureToUnbind)this.captureToUnbind.hasOwnProperty(e)&&st(this.captureToUnbind[e])&&(this.captureToUnbind[e]=ei(this.captureToUnbind[e]))
this.currentElement=null,this.container=null,this.offdom=null,this.createdElements=null,this.captureToUnbind=null,this.toUnbind=null}dispose(){this.destroy()}getTotalSize(){let e=wl(this.currentElement),t=Sl(this.currentElement)
return new E_(e,t)}getContentSize(){let e=function(e){let t=fl.getBorderLeftWidth(e)+fl.getBorderRightWidth(e),i=fl.getPaddingLeft(e)+fl.getPaddingRight(e)
return e.offsetWidth-t-i}(this.currentElement),t=vl(this.currentElement)
return new E_(e,t)}getClientArea(){if(this.currentElement!==document.body)return new E_(this.currentElement.clientWidth,this.currentElement.clientHeight)
if(window.innerWidth&&window.innerHeight)return new E_(window.innerWidth,window.innerHeight)
if(document.body&&document.body.clientWidth&&document.body.clientWidth)return new E_(document.body.clientWidth,document.body.clientHeight)
if(document.documentElement&&document.documentElement.clientWidth&&document.documentElement.clientHeight)return new E_(document.documentElement.clientWidth,document.documentElement.clientHeight)
throw new Error("Unable to figure out browser width and height")}}class D_ extends M_{constructor(e){if($r(st(e)||e instanceof D_,"Expected Array or MultiBuilder as parameter"),super(),this.length=0,this.builders=[],st(e))for(let t=0;t<e.length;t++)e[t]instanceof HTMLElement?this.push(O_(e[t])):this.push(e[t])
else for(let t=0;t<e.length;t++)this.push(e.item(t))
let t=this,i=e=>{t[e]=function(){let i,n=Array.prototype.slice.call(arguments),s=!1
for(let r=0;r<t.length;r++){let o=t.item(r)[e].apply(t.item(r),n)
if(o instanceof D_){i||(i=[]),s=!0
for(let e=0;e<o.length;e++)i.push(o.item(e))}else ht(o)||o instanceof M_||(i||(i=[]),i.push(o))}return i&&s?new D_(i):i||t}}
for(let e in M_.prototype)"clone"!==e&&"and"!==e&&M_.prototype.hasOwnProperty(e)&&gt(M_.prototype[e])&&i(e)}item(e){return this.builders[e]}push(...e){for(let t=0;t<e.length;t++)this.builders.push(e[t])
this.length=this.builders.length}pop(){let e=this.builders.pop()
return this.length=this.builders.length,e}concat(e){let t=this.builders.concat(e)
return this.length=this.builders.length,t}shift(){let e=this.builders.shift()
return this.length=this.builders.length,e}unshift(e){let t=this.builders.unshift(e)
return this.length=this.builders.length,t}slice(e,t){let i=this.builders.slice(e,t)
return this.length=this.builders.length,i}splice(e,t){let i=this.builders.splice(e,t)
return this.length=this.builders.length,i}clone(){return new D_(this)}and(e){e instanceof M_||e instanceof D_||(e=new M_(e))
let t=[]
if(e instanceof D_)for(let i=0;i<e.length;i++)t.push(e.item(i))
else t.push(e)
return this.push.apply(this,t),this}}function T_(e,t){return e instanceof D_?new D_(e):new M_(e.getHTMLElement(),t)}function O_(e,t){return new M_(e,t)}function R_(){return new M_(null,!0)}function A_(e,t,i){k_(e)[t]=i}function P_(e,t,i){if(I_(e)){let i=k_(e)[t]
if(!ht(i))return i}return i}function F_(e,t){I_(e)&&delete k_(e)[t]}function W_(e,t){A_(e,x_,t)}function V_(e){F_(e,x_)}function B_(e){return P_(e,x_)}const H_={setPropertyOnElement:A_,getPropertyFromElement:P_,removePropertyFromElement:F_,bindElement:W_,unbindElement:V_,getBindingFromElement:B_}
let z_=/([\w\-]+)?(#([\w\-]+))?((.([\w\-]+))*)/
const U_=function(e){if(ht(e))return R_()
if(!e)throw new Error("Bad use of $")
if(El(e)||e===window)return O_(e)
if(st(e))return new D_(e)
if(e instanceof M_)return T_(e)
if(rt(e)){if("<"===e[0]){let e,t=document.createElement("div")
if(t.innerHTML=he.apply(it,arguments),0===t.children.length)throw new Error("Bad use of $")
if(1===t.children.length)return e=t.firstChild,t.removeChild(e),O_(e)
let i=[]
for(;t.firstChild;)e=t.firstChild,t.removeChild(e),i.push(O_(e))
return new D_(i)}if(1===arguments.length){let t=z_.exec(e)
if(!t)throw new Error("Bad use of $")
let i=t[1]||"div",n=t[3]||void 0,s=(t[4]||"").replace(/\./g," "),r={}
return n&&(r.id=n),s&&(r.class=s),R_().element(i,r)}{let e=R_()
return e.element.apply(e,arguments),e}}throw new Error("Bad use of $")}
U_.Box=class{constructor(e,t,i,n){this.top=e,this.right=t,this.bottom=i,this.left=n}},U_.Dimension=E_,U_.Position=class{constructor(e,t){this.x=e,this.y=t}},U_.Builder=M_,U_.MultiBuilder=D_,U_.Build=S_,U_.Binding=H_
Td.fromHex("#3C3C3C"),Td.fromHex("#F0F0F0"),Td.fromHex("#3C3C3C")
class K_ extends It{constructor(e,t,i){super(),this.options=i,this._callOnDispose=[],this._context=e||this,this._action=t,t instanceof Jr&&this._callOnDispose.push(t.onDidChange(e=>{this.builder&&this._handleActionChangeEvent(e)}))}_handleActionChangeEvent(e){void 0!==e.enabled&&this._updateEnabled(),void 0!==e.checked&&this._updateChecked(),void 0!==e.class&&this._updateClass(),void 0!==e.label&&(this._updateLabel(),this._updateTooltip()),void 0!==e.tooltip&&this._updateTooltip()}get callOnDispose(){return this._callOnDispose}set actionRunner(e){this._actionRunner=e}get actionRunner(){return this._actionRunner}getAction(){return this._action}isEnabled(){return this._action.enabled}setActionContext(e){this._context=e}render(e){this.builder=U_(e),this.gesture=new vm(e)
const t=this.options&&this.options.draggable
t&&(e.draggable=!0),this.builder.on(gm.Tap,e=>this.onClick(e)),this.builder.on(kl.MOUSE_DOWN,e=>{t||Il.stop(e,!0),this._action.enabled&&0===e.button&&this.builder.addClass("active")}),this.builder.on(kl.CLICK,e=>{Il.stop(e,!0),this.options&&this.options.isMenu?this.onClick(e):setTimeout(()=>this.onClick(e),50)}),this.builder.on([kl.MOUSE_UP,kl.MOUSE_OUT],e=>{Il.stop(e),this.builder.removeClass("active")})}onClick(e){let t
Il.stop(e,!0),dt(this._context)?t=e:(t=this._context).event=e,this._actionRunner.run(this._action,t)}focus(){this.builder&&this.builder.domFocus()}blur(){this.builder&&this.builder.domBlur()}_updateEnabled(){}_updateLabel(){}_updateTooltip(){}_updateClass(){}_updateChecked(){}dispose(){super.dispose(),this.builder&&(this.builder.destroy(),this.builder=null),this.gesture&&(this.gesture.dispose(),this.gesture=null),this._callOnDispose=ei(this._callOnDispose)}}class $_ extends Jr{constructor(e,t){super($_.ID,e,e?"separator text":"separator"),this.checked=!1,this.radio=!1,this.enabled=!1,this.order=t}}$_.ID="vs.actions.separator"
class q_ extends K_{constructor(e,t,i={}){super(e,t,i),this.options=i,this.options.icon=void 0!==i.icon&&i.icon,this.options.label=void 0===i.label||i.label,this.cssClass=""}render(e){super.render(e),this.$e=U_("a.action-label").appendTo(this.builder),this._action.id===$_.ID?this.$e.attr({role:"presentation"}):this.options.isMenu?this.$e.attr({role:"menuitem"}):this.$e.attr({role:"button"}),this.options.label&&this.options.keybinding&&U_("span.keybinding").text(this.options.keybinding).appendTo(this.builder),this._updateClass(),this._updateLabel(),this._updateTooltip(),this._updateEnabled(),this._updateChecked()}focus(){super.focus(),this.$e.domFocus()}_updateLabel(){this.options.label&&this.$e.text(this.getAction().label)}_updateTooltip(){let e=null
this.getAction().tooltip?e=this.getAction().tooltip:!this.options.label&&this.getAction().label&&this.options.icon&&(e=this.getAction().label,this.options.keybinding&&(e=Jt({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",e,this.options.keybinding))),e&&this.$e.attr({title:e})}_updateClass(){this.cssClass&&this.$e.removeClass(this.cssClass),this.options.icon?(this.cssClass=this.getAction().class,this.$e.addClass("icon"),this.cssClass&&this.$e.addClass(this.cssClass),this._updateEnabled()):this.$e.removeClass("icon")}_updateEnabled(){this.getAction().enabled?(this.builder.removeClass("disabled"),this.$e.removeClass("disabled"),this.$e.attr({tabindex:0})):(this.builder.addClass("disabled"),this.$e.addClass("disabled"),Wl(this.$e.getHTMLElement()))}_updateChecked(){this.getAction().checked?this.$e.addClass("checked"):this.$e.removeClass("checked")}_updateRadio(){this.getAction().radio?this.$e.addClass("radio"):this.$e.removeClass("radio")}}var G_,j_;(j_=G_||(G_={}))[j_.HORIZONTAL=0]="HORIZONTAL",j_[j_.HORIZONTAL_REVERSE=1]="HORIZONTAL_REVERSE",j_[j_.VERTICAL=2]="VERTICAL",j_[j_.VERTICAL_REVERSE=3]="VERTICAL_REVERSE"
let Y_={orientation:G_.HORIZONTAL,context:null}
class Z_ extends It{constructor(e,t=Y_){let i,n
switch(super(),this.options=t,this._context=t.context,this.toDispose=[],this._actionRunner=this.options.actionRunner,this._actionRunner||(this._actionRunner=new Qr,this.toDispose.push(this._actionRunner)),this.toDispose.push(this.addEmitter(this._actionRunner)),this.items=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar",!1!==t.animated&&Ja(this.domNode,"animated"),this.options.orientation){case G_.HORIZONTAL:i=15,n=17
break
case G_.HORIZONTAL_REVERSE:i=17,n=15,this.domNode.className+=" reverse"
break
case G_.VERTICAL:i=16,n=18,this.domNode.className+=" vertical"
break
case G_.VERTICAL_REVERSE:i=18,n=16,this.domNode.className+=" vertical reverse"}U_(this.domNode).on(kl.KEY_DOWN,e=>{let t=new Wa(e),s=!0
t.equals(i)?this.focusPrevious():t.equals(n)?this.focusNext():t.equals(9)?this.cancel():t.equals(3)||t.equals(10)||(s=!1),s&&(t.preventDefault(),t.stopPropagation())}),U_(this.domNode).on(kl.KEY_UP,e=>{let t=new Wa(e)
t.equals(3)||t.equals(10)?(this.doTrigger(t),t.preventDefault(),t.stopPropagation()):(t.equals(2)||t.equals(1026))&&this.updateFocusedItem()}),this.focusTracker=Dl(this.domNode),this.focusTracker.addBlurListener(()=>{document.activeElement!==this.domNode&&yl(document.activeElement,this.domNode)||(this.emit(kl.BLUR,{}),this.focusedItem=void 0)}),this.focusTracker.addFocusListener(()=>this.updateFocusedItem()),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.isMenu?this.actionsList.setAttribute("role","menubar"):this.actionsList.setAttribute("role","toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),(e instanceof M_?e.getHTMLElement():e).appendChild(this.domNode)}setAriaLabel(e){e?this.actionsList.setAttribute("aria-label",e):this.actionsList.removeAttribute("aria-label")}updateFocusedItem(){for(let e=0;e<this.actionsList.children.length;e++){let t=this.actionsList.children[e]
if(yl(document.activeElement,t)){this.focusedItem=e
break}}}get context(){return this._context}set context(e){this._context=e,this.items.forEach(t=>t.setActionContext(e))}get actionRunner(){return this._actionRunner}set actionRunner(e){e&&(this._actionRunner=e,this.items.forEach(t=>t.actionRunner=e))}getContainer(){return U_(this.domNode)}push(e,t={}){const i=Array.isArray(e)?e:[e]
let n=at(t.index)?t.index:null
i.forEach(e=>{const i=document.createElement("li")
i.className="action-item",i.setAttribute("role","presentation"),U_(i).on(kl.CONTEXT_MENU,e=>{e.preventDefault(),e.stopPropagation()})
let s=null
this.options.actionItemProvider&&(s=this.options.actionItemProvider(e)),s||(s=new q_(this.context,e,t)),s.actionRunner=this._actionRunner,s.setActionContext(this.context),this.addEmitter(s),s.render(i),null===n||n<0||n>=this.actionsList.children.length?this.actionsList.appendChild(i):this.actionsList.insertBefore(i,this.actionsList.children[n++]),this.items.push(s)})}getWidth(e){return e>=0&&e<this.actionsList.children.length?this.actionsList.children.item(e).clientWidth:0}getHeight(e){return e>=0&&e<this.actionsList.children.length?this.actionsList.children.item(e).clientHeight:0}pull(e){e>=0&&e<this.items.length&&(this.items.splice(e,1),this.actionsList.removeChild(this.actionsList.childNodes[e]))}clear(){this.items=ei(this.items),U_(this.actionsList).empty()}length(){return this.items.length}isEmpty(){return 0===this.items.length}focus(e){e&&void 0===this.focusedItem&&(this.focusedItem=0),this.updateFocus()}focusNext(){void 0===this.focusedItem&&(this.focusedItem=this.items.length-1)
let e,t=this.focusedItem
do{this.focusedItem=(this.focusedItem+1)%this.items.length,e=this.items[this.focusedItem]}while(this.focusedItem!==t&&!e.isEnabled())
this.focusedItem!==t||e.isEnabled()||(this.focusedItem=void 0),this.updateFocus()}focusPrevious(){void 0===this.focusedItem&&(this.focusedItem=0)
let e,t=this.focusedItem
do{this.focusedItem=this.focusedItem-1,this.focusedItem<0&&(this.focusedItem=this.items.length-1),e=this.items[this.focusedItem]}while(this.focusedItem!==t&&!e.isEnabled())
this.focusedItem!==t||e.isEnabled()||(this.focusedItem=void 0),this.updateFocus(!0)}updateFocus(e){if(void 0!==this.focusedItem)for(let t=0;t<this.items.length;t++){let i=this.items[t]
t===this.focusedItem?gt(i.focus)&&i.focus(e):gt(i.blur)&&i.blur()}else this.domNode.focus()}doTrigger(e){if(void 0===this.focusedItem)return
let t=this.items[this.focusedItem]
if(t instanceof K_){const i=null===t._context||void 0===t._context?e:t._context
this.run(t._action,i).done()}}cancel(){document.activeElement instanceof HTMLElement&&document.activeElement.blur(),this.emit(Xr.CANCEL)}run(e,t){return this._actionRunner.run(e,t)}dispose(){null!==this.items&&ei(this.items),this.items=null,this.focusTracker&&(this.focusTracker.dispose(),this.focusTracker=null),this.toDispose=ei(this.toDispose),this.getContainer().destroy(),super.dispose()}}const X_=Ir("contextViewService"),J_=Ir("contextMenuService")
var Q_,eC;(eC=Q_||(Q_={}))[eC.Default=1]="Default",eC[eC.User=2]="User"
const tC=Ir("keybindingService")
function iC(e){sC.INSTANCE.registerEditorBrowserContribution(e)}var nC
!function(e){(nC||(nC={})).getEditorContributions=function(){return sC.INSTANCE.getEditorBrowserContributions()}}()
class sC{constructor(){this.editorContributions=[]}registerEditorBrowserContribution(e){this.editorContributions.push(e)}getEditorBrowserContributions(){return this.editorContributions.slice(0)}}sC.INSTANCE=new sC,qr.add("editor.contributions",sC.INSTANCE)
let rC=oC=class{constructor(e,t,i,n,s,r){this._contextMenuService=t,this._contextViewService=i,this._contextKeyService=n,this._keybindingService=s,this._menuService=r,this._toDispose=[],this._contextMenuIsBeingShownCount=0,this._editor=e,this._toDispose.push(this._editor.onContextMenu(e=>this._onContextMenu(e))),this._toDispose.push(this._editor.onDidScrollChange(e=>{this._contextMenuIsBeingShownCount>0&&this._contextViewService.hideContextView()})),this._toDispose.push(this._editor.onKeyDown(e=>{58===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.showContextMenu())}))}static get(e){return e.getContribution(oC.ID)}_onContextMenu(e){if(!this._editor.getConfiguration().contribInfo.contextmenu)return this._editor.focus(),void(e.target.position&&!this._editor.getSelection().containsPosition(e.target.position)&&this._editor.setPosition(e.target.position))
var t
e.target.type!==bm.OVERLAY_WIDGET&&(e.event.preventDefault(),(e.target.type===bm.CONTENT_TEXT||e.target.type===bm.CONTENT_EMPTY||e.target.type===bm.TEXTAREA)&&(this._editor.focus(),e.target.position&&!this._editor.getSelection().containsPosition(e.target.position)&&this._editor.setPosition(e.target.position),e.target.type!==bm.TEXTAREA&&(t={x:e.event.posx,y:e.event.posy+1}),this.showContextMenu(t)))}showContextMenu(e){if(this._editor.getConfiguration().contribInfo.contextmenu)if(this._contextMenuService){var t=this._getMenuActions()
t.length>0&&this._doShowContextMenu(t,e)}else this._editor.focus()}_getMenuActions(){const e=[]
let t=this._menuService.createMenu(io.EditorContext,this._contextKeyService)
const i=t.getActions({arg:this._editor.getModel().uri})
t.dispose()
for(let t of i){const[,i]=t
e.push(...i),e.push(new $_)}return e.pop(),e}_doShowContextMenu(e,t=null){var i=this._editor.getConfiguration().contribInfo.hover
this._editor.updateOptions({hover:!1})
var n=t
if(!n){this._editor.revealPosition(this._editor.getPosition(),1),this._editor.render()
var s=this._editor.getScrolledVisiblePosition(this._editor.getPosition()),r=Cl(this._editor.getDomNode()),o=r.left+s.left,a=r.top+s.top+s.height
n={x:o,y:a}}this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({getAnchor:()=>n,getActions:()=>bt.as(e),getActionItem:e=>{var t=this._keybindingFor(e)
if(t)return new q_(e,e,{label:!0,keybinding:t.getLabel(),isMenu:!0})
var i=e
return"function"==typeof i.getActionItem?i.getActionItem():new q_(e,e,{icon:!0,label:!0,isMenu:!0})},getKeyBinding:e=>this._keybindingFor(e),onHide:e=>{this._contextMenuIsBeingShownCount--,this._editor.focus(),this._editor.updateOptions({hover:i})}})}_keybindingFor(e){return this._keybindingService.lookupKeybinding(e.id)}getId(){return oC.ID}dispose(){this._contextMenuIsBeingShownCount>0&&this._contextViewService.hideContextView(),this._toDispose=ei(this._toDispose)}}
rC.ID="editor.contrib.contextmenu",rC=oC=Nn([iC,En(1,J_),En(2,X_),En(3,Lo),En(4,tC),En(5,no)],rC)
var oC
Oo(class extends To{constructor(){super({id:"editor.action.showContextMenu",label:Jt("action.showContextMenu.label","Show Editor Context Menu"),alias:"Show Editor Context Menu",precondition:null,kbOpts:{kbExpr:Vo.textFocus,primary:1092}})}run(e,t){rC.get(t).showContextMenu()}})
class aC{constructor(e){this.selections=e}equals(e){const t=this.selections.length
if(t!==e.selections.length)return!1
for(let i=0;i<t;i++)if(!this.selections[i].equalsSelection(e.selections[i]))return!1
return!0}}let lC=hC=class extends ni{constructor(e){super(),this._editor=e,this._isCursorUndo=!1,this._undoStack=[],this._prevState=this._readState(),this._register(e.onDidChangeModel(e=>{this._undoStack=[],this._prevState=null})),this._register(e.onDidChangeModelContent(e=>{this._undoStack=[],this._prevState=null})),this._register(e.onDidChangeCursorSelection(e=>{!this._isCursorUndo&&this._prevState&&(this._undoStack.push(this._prevState),this._undoStack.length>50&&this._undoStack.shift()),this._prevState=this._readState()}))}static get(e){return e.getContribution(hC.ID)}_readState(){return this._editor.getModel()?new aC(this._editor.getSelections()):null}getId(){return hC.ID}cursorUndo(){const e=new aC(this._editor.getSelections())
for(;this._undoStack.length>0;){const t=this._undoStack.pop()
if(!t.equals(e))return this._isCursorUndo=!0,this._editor.setSelections(t.selections),this._editor.revealRangeInCenterIfOutsideViewport(t.selections[0],0),void(this._isCursorUndo=!1)}}}
lC.ID="editor.contrib.cursorUndoController",lC=hC=Nn([iC],lC)
var hC
Ro(class extends Do{constructor(){super({id:"cursorUndo",precondition:null,kbOpts:{kbExpr:Vo.textFocus,primary:2099}})}runEditorCommand(e,t,i){lC.get(t).cursorUndo()}})
class dC{constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}const uC=new dC("id#")
if(window.MonacoEnvironment)var cC=window.MonacoEnvironment.marked
function gC(e){const t=e.inline?"span":"div",i=document.createElement(t)
return e.className&&(i.className=e.className),i}function mC(e,t={}){const i=gC(t)
return function e(t,i,n){let s
if(2===i.type)s=document.createTextNode(i.content)
else if(3===i.type)s=document.createElement("b")
else if(4===i.type)s=document.createElement("i")
else if(5===i.type){const e=document.createElement("a")
e.href="#",nl(e,"click",e=>{n(String(i.index),e)}),s=e}else 7===i.type?s=document.createElement("br"):1===i.type&&(s=t)
t!==s&&t.appendChild(s)
Array.isArray(i.children)&&i.children.forEach(t=>{e(s,t,n)})}(i,function(e){const t={type:1,children:[]}
let i=0,n=t
const s=[],r=new fC(e)
for(;!r.eos();){let e=r.next()
const t="\\"===e&&0!==_C(r.peek())
if(t&&(e=r.next()),t||0===_C(e)||e!==r.peek())if("\n"===e)2===n.type&&(n=s.pop()),n.children.push({type:7})
else if(2!==n.type){const t={type:2,content:e}
n.children.push(t),s.push(n),n=t}else n.content+=e
else{r.advance(),2===n.type&&(n=s.pop())
const t=_C(e)
if(n.type===t||5===n.type&&6===t)n=s.pop()
else{const e={type:t,children:[]}
5===t&&(e.index=i,i++),n.children.push(e),s.push(n),n=e}}}2===n.type&&(n=s.pop())
return t}(e),t.actionCallback),i}function pC(e,t={}){const i=gC(t)
let n
const s=new bt(e=>n=e),r=new cC.Renderer
return r.image=((e,t,i)=>{let n=[]
if(e){const t=e.split("|").map(e=>e.trim())
e=t[0]
const i=t[1]
if(i){const e=/height=(\d+)/.exec(i),t=/width=(\d+)/.exec(i),s=e&&e[1],r=t&&t[1],o=isFinite(parseInt(r)),a=isFinite(parseInt(s))
o&&n.push(`width="${r}"`),a&&n.push(`height="${s}"`)}}let s=[]
return e&&s.push(`src="${e}"`),i&&s.push(`alt="${i}"`),t&&s.push(`title="${t}"`),n.length&&(s=s.concat(n)),"<img "+s.join(" ")+">"}),r.link=((t,i,n)=>(t===n&&(n=Ah(n)),i=Ah(i),!(t=Ah(t))||t.match(/^data:|javascript:/i)||t.match(/^command:/i)&&!e.isTrusted?n:`<a href="#" data-href="${t}" title="${i||n}">${n}</a>`)),r.paragraph=(e=>`<p>${e}</p>`),t.codeBlockRenderer&&(r.code=((e,n)=>{const r=t.codeBlockRenderer(n,e)
if("string"==typeof r)return r
if(bt.is(r)){const t=uC.nextId()
return bt.join([r,s]).done(e=>{const n=e[0],s=i.querySelector(`div[data-code="${t}"]`)
s&&(s.innerHTML=n)},e=>{}),`<div class="code" data-code="${t}">${de(e)}</div>`}return e})),t.actionCallback&&nl(i,"click",e=>{let i=e.target
if("A"!==i.tagName&&(!(i=i.parentElement)||"A"!==i.tagName))return
const n=i.dataset.href
n&&t.actionCallback(n,e)}),i.innerHTML=cC(e.value,{sanitize:!0,renderer:r}),n(),i}class fC{constructor(e){this.source=e,this.index=0}eos(){return this.index>=this.source.length}next(){const e=this.peek()
return this.advance(),e}peek(){return this.source[this.index]}advance(){this.index++}}function _C(e){switch(e){case"*":return 3
case"_":return 4
case"[":return 5
case"]":return 6
default:return 0}}let CC,bC,wC
function vC(e){!function(e,t){if(!CC)return
e.textContent===t&&(t=Jt("repeated","{0} (occurred again)",t))
Ga(e),e.textContent=t,e.style.visibility="hidden",e.style.visibility="visible"}(bC,e)}var SC,yC,xC,LC;(yC=SC||(SC={}))[yC.LEFT=0]="LEFT",yC[yC.RIGHT=1]="RIGHT",(LC=xC||(xC={}))[LC.BELOW=0]="BELOW",LC[LC.ABOVE=1]="ABOVE"
class NC extends It{constructor(e){super(),this.$view=U_(".context-view").hide(),this.setContainer(e),this.toDispose=[{dispose:()=>{this.setContainer(null)}}],this.toDisposeOnClean=null}setContainer(e){this.$container&&(this.$container.off(NC.BUBBLE_UP_EVENTS),this.$container.off(NC.BUBBLE_DOWN_EVENTS,!0),this.$container=null),e&&(this.$container=U_(e),this.$view.appendTo(this.$container),this.$container.on(NC.BUBBLE_UP_EVENTS,e=>{this.onDOMEvent(e,document.activeElement,!1)}),this.$container.on(NC.BUBBLE_DOWN_EVENTS,e=>{this.onDOMEvent(e,document.activeElement,!0)},null,!0))}show(e){this.isVisible()&&this.hide(),this.$view.setClass("context-view").empty().style({top:"0px",left:"0px"}).show(),this.toDisposeOnClean=e.render(this.$view.getHTMLElement()),this.delegate=e,this.doLayout()}layout(){this.isVisible()&&(!1!==this.delegate.canRelayout?(this.delegate.layout&&this.delegate.layout(),this.doLayout()):this.hide())}doLayout(){let e,t=this.delegate.getAnchor()
if(El(t)){let i=Cl(t)
e={top:i.top,left:i.left,width:i.width,height:i.height}}else{let i=t
e={top:i.y,left:i.x,width:i.width||0,height:i.height||0}}let i={top:bl.scrollY,left:bl.scrollX,height:window.innerHeight,width:window.innerWidth},n=this.$view.getTotalSize(),s={width:n.width,height:n.height},r=this.delegate.anchorPosition||xC.BELOW,o=this.delegate.anchorAlignment||SC.LEFT,a=function(e,t,i,n,s){let r=(e,t,i,n)=>t?e:n?i:e,o=(e,t,i,n,s)=>s?r(e,t,i,n):r(i,n,e,t)
return{top:(()=>{let s=t.top-e.height,r=t.top+t.height,a=s>=i.top&&s+e.height<=i.top+i.height,l=r>=i.top&&r+e.height<=i.top+i.height
return o(s,a,r,l,n===xC.ABOVE)})(),left:(()=>{let n=t.left,r=t.left+t.width-e.width,a=n>=i.left&&n+e.width<=i.left+i.width,l=r>=i.left&&r+e.width<=i.left+i.width
return o(n,a,r,l,s===SC.LEFT)})()}}(s,e,i,r,o),l=Cl(this.$container.getHTMLElement())
a.top-=l.top,a.left-=l.left,this.$view.removeClass("top","bottom","left","right"),this.$view.addClass(r===xC.BELOW?"bottom":"top"),this.$view.addClass(o===SC.LEFT?"left":"right"),this.$view.style({top:a.top+"px",left:a.left+"px",width:"initial"})}hide(e){this.delegate&&this.delegate.onHide&&this.delegate.onHide(e),this.delegate=null,this.toDisposeOnClean&&(this.toDisposeOnClean.dispose(),this.toDisposeOnClean=null),this.$view.hide()}isVisible(){return!!this.delegate}onDOMEvent(e,t,i){this.delegate&&(this.delegate.onDOMEvent?this.delegate.onDOMEvent(e,document.activeElement):i&&!yl(e.target,this.$container.getHTMLElement())&&this.hide())}dispose(){super.dispose(),this.hide(),this.toDispose=ei(this.toDispose)}}NC.BUBBLE_UP_EVENTS=["click","keydown","focus","blur"],NC.BUBBLE_DOWN_EVENTS=["click"]
const EC=Al
var kC,IC;(IC=kC||(kC={}))[IC.INFO=1]="INFO",IC[IC.WARNING=2]="WARNING",IC[IC.ERROR=3]="ERROR"
const MC={inputBackground:Td.fromHex("#3C3C3C"),inputForeground:Td.fromHex("#CCCCCC"),inputValidationInfoBorder:Td.fromHex("#55AAFF"),inputValidationInfoBackground:Td.fromHex("#063B49"),inputValidationWarningBorder:Td.fromHex("#B89500"),inputValidationWarningBackground:Td.fromHex("#352A05"),inputValidationErrorBorder:Td.fromHex("#BE1100"),inputValidationErrorBackground:Td.fromHex("#5A1D1D")}
class DC extends ff{constructor(e,t,i){super(),this.state="idle",this._onDidChange=this._register(new ci),this.onDidChange=this._onDidChange.event,this._onDidHeightChange=this._register(new ci),this.onDidHeightChange=this._onDidHeightChange.event,this.contextViewProvider=t,this.options=i||Object.create(null),Vn(this.options,MC,!1),this.message=null,this.cachedHeight=null,this.placeholder=this.options.placeholder||"",this.ariaLabel=this.options.ariaLabel||"",this.inputBackground=this.options.inputBackground,this.inputForeground=this.options.inputForeground,this.inputBorder=this.options.inputBorder,this.inputValidationInfoBorder=this.options.inputValidationInfoBorder,this.inputValidationInfoBackground=this.options.inputValidationInfoBackground,this.inputValidationWarningBorder=this.options.inputValidationWarningBorder,this.inputValidationWarningBackground=this.options.inputValidationWarningBackground,this.inputValidationErrorBorder=this.options.inputValidationErrorBorder,this.inputValidationErrorBackground=this.options.inputValidationErrorBackground,this.options.validationOptions&&(this.validation=this.options.validationOptions.validation,this.showValidationMessage=this.options.validationOptions.showMessage||!1),this.element=Tl(e,EC(".monaco-inputbox.idle"))
let n=this.options.flexibleHeight?"textarea":"input",s=Tl(this.element,EC(".wrapper"))
this.input=Tl(s,EC(n+".input")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>Ja(this.element,"synthetic-focus")),this.onblur(this.input,()=>Qa(this.element,"synthetic-focus")),this.options.flexibleHeight?this.mirror=Tl(s,EC("div.mirror")):(this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off")),this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&(this.input.setAttribute("placeholder",this.placeholder),this.input.title=this.placeholder),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this.placeholder&&xa&&this.onclick(this.input,e=>{Il.stop(e,!0),this.input.focus()}),setTimeout(()=>{this.input&&this.updateMirror()},0),this.options.actions&&(this.actionbar=this._register(new Z_(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage()}onFocus(){this._showMessage()}setPlaceHolder(e){this.input&&this.input.setAttribute("placeholder",e)}setAriaLabel(e){this.ariaLabel=e,this.input&&(e?this.input.setAttribute("aria-label",this.ariaLabel):this.input.removeAttribute("aria-label"))}setContextViewProvider(e){this.contextViewProvider=e}get inputElement(){return this.input}get value(){return this.input.value}set value(e){this.input.value!==e&&(this.input.value=e,this.onValueChange())}get height(){return null===this.cachedHeight?Sl(this.element):this.cachedHeight}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return document.activeElement===this.input}select(e=null){this.input.select(),e&&this.input.setSelectionRange(e.start,e.end)}enable(){this.input.removeAttribute("disabled")}disable(){this.input.disabled=!0,this._hideMessage()}setEnabled(e){e?this.enable():this.disable()}get width(){return wl(this.input)}set width(e){this.input.style.width=e+"px"}showMessage(e,t){this.message=e,Qa(this.element,"idle"),Qa(this.element,"info"),Qa(this.element,"warning"),Qa(this.element,"error"),Ja(this.element,this.classForType(e.type))
const i=this.stylesForType(this.message.type)
let n
this.element.style.border=i.border?`1px solid ${i.border}`:null,vC(n=e.type===kC.ERROR?Jt("alertErrorMessage","Error: {0}",e.content):e.type===kC.WARNING?Jt("alertWarningMessage","Warning: {0}",e.content):Jt("alertInfoMessage","Info: {0}",e.content)),(this.hasFocus()||t)&&this._showMessage()}hideMessage(){this.message=null,Qa(this.element,"info"),Qa(this.element,"warning"),Qa(this.element,"error"),Ja(this.element,"idle"),this._hideMessage(),this.applyStyles()}isInputValid(){return!!this.validation&&!this.validation(this.value)}validate(){let e=null
return this.validation&&((e=this.validation(this.value))?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(e)):(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),!e}stylesForType(e){switch(e){case kC.INFO:return{border:this.inputValidationInfoBorder,background:this.inputValidationInfoBackground}
case kC.WARNING:return{border:this.inputValidationWarningBorder,background:this.inputValidationWarningBackground}
default:return{border:this.inputValidationErrorBorder,background:this.inputValidationErrorBackground}}}classForType(e){switch(e){case kC.INFO:return"info"
case kC.WARNING:return"warning"
default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return
let e,t=()=>e.style.width=wl(this.element)+"px"
this.state="open",this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:SC.RIGHT,render:i=>{e=Tl(i,EC(".monaco-inputbox-container")),t()
const n={inline:!0,className:"monaco-inputbox-message"},s=this.message.formatContent?mC(this.message.content,n):function(e,t={}){const i=gC(t)
return i.textContent=e,i}(this.message.content,n)
Ja(s,this.classForType(this.message.type))
const r=this.stylesForType(this.message.type)
return s.style.backgroundColor=r.background?r.background.toString():null,s.style.border=r.border?`1px solid ${r.border}`:null,Tl(e,s),null},layout:t})}_hideMessage(){this.contextViewProvider&&"open"===this.state&&(this.state="idle",this.contextViewProvider.hideContextView())}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),"open"===this.state&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return
const e=this.value||this.placeholder
let t=10===e.charCodeAt(e.length-1)?" ":""
this.mirror.textContent=e+t,this.layout()}style(e){this.inputBackground=e.inputBackground,this.inputForeground=e.inputForeground,this.inputBorder=e.inputBorder,this.inputValidationInfoBackground=e.inputValidationInfoBackground,this.inputValidationInfoBorder=e.inputValidationInfoBorder,this.inputValidationWarningBackground=e.inputValidationWarningBackground,this.inputValidationWarningBorder=e.inputValidationWarningBorder,this.inputValidationErrorBackground=e.inputValidationErrorBackground,this.inputValidationErrorBorder=e.inputValidationErrorBorder,this.applyStyles()}applyStyles(){if(this.element){const e=this.inputBackground?this.inputBackground.toString():null,t=this.inputForeground?this.inputForeground.toString():null,i=this.inputBorder?this.inputBorder.toString():null
this.element.style.backgroundColor=e,this.element.style.color=t,this.input.style.backgroundColor=e,this.input.style.color=t,this.element.style.borderWidth=i?"1px":null,this.element.style.borderStyle=i?"solid":null,this.element.style.borderColor=i}}layout(){if(!this.mirror)return
const e=this.cachedHeight
this.cachedHeight=Sl(this.mirror),e!==this.cachedHeight&&(this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedHeight))}dispose(){this._hideMessage(),this.element=null,this.input=null,this.contextViewProvider=null,this.message=null,this.placeholder=null,this.ariaLabel=null,this.validation=null,this.showValidationMessage=null,this.state=null,this.actionbar=null,super.dispose()}}const TC={inputActiveOptionBorder:Td.fromHex("#007ACC")}
class OC extends ff{constructor(e){super(),this._opts=Wn(e),Vn(this._opts,TC,!1),this._checked=this._opts.isChecked,this.domNode=document.createElement("div"),this.domNode.title=this._opts.title,this.domNode.className=this._className(),this.domNode.tabIndex=0,this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,e=>{this.checked=!this._checked,this._opts.onChange(!1),e.preventDefault()}),this.onkeydown(this.domNode,e=>{if(10===e.keyCode||3===e.keyCode)return this.checked=!this._checked,this._opts.onChange(!0),void e.preventDefault()
this._opts.onKeyDown&&this._opts.onKeyDown(e)})}get enabled(){return"true"!==this.domNode.getAttribute("aria-disabled")}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.className=this._className(),this.applyStyles()}_className(){return"custom-checkbox "+this._opts.actionClassName+" "+(this._checked?"checked":"unchecked")}width(){return 22}style(e){e.inputActiveOptionBorder&&(this._opts.inputActiveOptionBorder=e.inputActiveOptionBorder),this.applyStyles()}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder?this._opts.inputActiveOptionBorder.toString():"transparent")}enable(){this.domNode.tabIndex=0,this.domNode.setAttribute("aria-disabled",String(!1))}disable(){Wl(this.domNode),this.domNode.setAttribute("aria-disabled",String(!0))}}const RC=Jt("caseDescription","Match Case"),AC=Jt("wordsDescription","Match Whole Word"),PC=Jt("regexDescription","Use Regular Expression")
class FC extends OC{constructor(e){super({actionClassName:"monaco-case-sensitive",title:RC+e.appendTitle,isChecked:e.isChecked,onChange:e.onChange,onKeyDown:e.onKeyDown,inputActiveOptionBorder:e.inputActiveOptionBorder})}}class WC extends OC{constructor(e){super({actionClassName:"monaco-whole-word",title:AC+e.appendTitle,isChecked:e.isChecked,onChange:e.onChange,onKeyDown:e.onKeyDown,inputActiveOptionBorder:e.inputActiveOptionBorder})}}class VC extends OC{constructor(e){super({actionClassName:"monaco-regex",title:PC+e.appendTitle,isChecked:e.isChecked,onChange:e.onChange,onKeyDown:e.onKeyDown,inputActiveOptionBorder:e.inputActiveOptionBorder})}}const BC=Jt("defaultLabel","input")
class HC extends ff{constructor(e,t,i){super(),this._onDidOptionChange=this._register(new ci),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new ci),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new ci),this.onMouseDown=this._onMouseDown.event,this._onInput=this._register(new ci),this.onInput=this._onInput.event,this._onKeyUp=this._register(new ci),this.onKeyUp=this._onKeyUp.event,this._onCaseSensitiveKeyDown=this._register(new ci),this.onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event,this._lastHighlightFindOptions=0,this.contextViewProvider=t,this.width=i.width||100,this.placeholder=i.placeholder||"",this.validation=i.validation,this.label=i.label||BC,this.inputActiveOptionBorder=i.inputActiveOptionBorder,this.inputBackground=i.inputBackground,this.inputForeground=i.inputForeground,this.inputBorder=i.inputBorder,this.inputValidationInfoBorder=i.inputValidationInfoBorder,this.inputValidationInfoBackground=i.inputValidationInfoBackground,this.inputValidationWarningBorder=i.inputValidationWarningBorder,this.inputValidationWarningBackground=i.inputValidationWarningBackground,this.inputValidationErrorBorder=i.inputValidationErrorBorder,this.inputValidationErrorBackground=i.inputValidationErrorBackground,this.regex=null,this.wholeWords=null,this.caseSensitive=null,this.domNode=null,this.inputBox=null,this.buildDomNode(i.appendCaseSensitiveLabel||"",i.appendWholeWordsLabel||"",i.appendRegexLabel||""),Boolean(e)&&e.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,e=>this._onKeyDown.fire(e)),this.onkeyup(this.inputBox.inputElement,e=>this._onKeyUp.fire(e)),this.oninput(this.inputBox.inputElement,e=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,e=>this._onMouseDown.fire(e))}enable(){Qa(this.domNode,"disabled"),this.inputBox.enable(),this.regex.enable(),this.wholeWords.enable(),this.caseSensitive.enable()}disable(){Ja(this.domNode,"disabled"),this.inputBox.disable(),this.regex.disable(),this.wholeWords.disable(),this.caseSensitive.disable()}setEnabled(e){e?this.enable():this.disable()}clear(){this.clearValidation(),this.setValue(""),this.focus()}setWidth(e){this.width=e,this.domNode.style.width=this.width+"px",this.contextViewProvider.layout(),this.setInputWidth()}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}style(e){this.inputActiveOptionBorder=e.inputActiveOptionBorder,this.inputBackground=e.inputBackground,this.inputForeground=e.inputForeground,this.inputBorder=e.inputBorder,this.inputValidationInfoBackground=e.inputValidationInfoBackground,this.inputValidationInfoBorder=e.inputValidationInfoBorder,this.inputValidationWarningBackground=e.inputValidationWarningBackground,this.inputValidationWarningBorder=e.inputValidationWarningBorder,this.inputValidationErrorBackground=e.inputValidationErrorBackground,this.inputValidationErrorBorder=e.inputValidationErrorBorder,this.applyStyles()}applyStyles(){if(this.domNode){const e={inputActiveOptionBorder:this.inputActiveOptionBorder}
this.regex.style(e),this.wholeWords.style(e),this.caseSensitive.style(e)
const t={inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorBorder:this.inputValidationErrorBorder}
this.inputBox.style(t)}}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){return this.caseSensitive.checked}setCaseSensitive(e){this.caseSensitive.checked=e,this.setInputWidth()}getWholeWords(){return this.wholeWords.checked}setWholeWords(e){this.wholeWords.checked=e,this.setInputWidth()}getRegex(){return this.regex.checked}setRegex(e){this.regex.checked=e,this.setInputWidth(),this.validate()}focusOnCaseSensitive(){this.caseSensitive.focus()}highlightFindOptions(){Qa(this.domNode,"highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,Ja(this.domNode,"highlight-"+this._lastHighlightFindOptions)}setInputWidth(){let e=this.width-this.caseSensitive.width()-this.wholeWords.width()-this.regex.width()
this.inputBox.width=e}buildDomNode(e,t,i){this.domNode=document.createElement("div"),this.domNode.style.width=this.width+"px",Ja(this.domNode,"monaco-findInput"),this.inputBox=this._register(new DC(this.domNode,this.contextViewProvider,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation||null,showMessage:!0},inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorBorder:this.inputValidationErrorBorder})),this.regex=this._register(new VC({appendTitle:i,isChecked:!1,onChange:e=>{this._onDidOptionChange.fire(e),e||this.inputBox.focus(),this.setInputWidth(),this.validate()},inputActiveOptionBorder:this.inputActiveOptionBorder})),this.wholeWords=this._register(new WC({appendTitle:t,isChecked:!1,onChange:e=>{this._onDidOptionChange.fire(e),e||this.inputBox.focus(),this.setInputWidth(),this.validate()},inputActiveOptionBorder:this.inputActiveOptionBorder})),this.caseSensitive=this._register(new FC({appendTitle:e,isChecked:!1,onChange:e=>{this._onDidOptionChange.fire(e),e||this.inputBox.focus(),this.setInputWidth(),this.validate()},onKeyDown:e=>{this._onCaseSensitiveKeyDown.fire(e)},inputActiveOptionBorder:this.inputActiveOptionBorder}))
let n=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode]
this.onkeydown(this.domNode,e=>{if(e.equals(15)||e.equals(17)||e.equals(9)){let t,i=n.indexOf(document.activeElement)
if(i>=0)e.equals(17)?t=(i+1)%n.length:e.equals(15)&&(t=0===i?n.length-1:i-1),e.equals(9)?n[i].blur():t>=0&&n[t].focus(),Il.stop(e,!0)}}),this.setInputWidth()
let s=document.createElement("div")
s.className="controls",s.appendChild(this.caseSensitive.domNode),s.appendChild(this.wholeWords.domNode),s.appendChild(this.regex.domNode),this.domNode.appendChild(s)}validate(){this.inputBox.validate()}showMessage(e){this.inputBox.showMessage(e)}clearMessage(){this.inputBox.hideMessage()}clearValidation(){this.inputBox.hideMessage()}dispose(){super.dispose()}}var zC,UC
HC.OPTION_CHANGE="optionChange",(UC=zC||(zC={}))[UC.VERTICAL=0]="VERTICAL",UC[UC.HORIZONTAL=1]="HORIZONTAL"
class KC extends It{constructor(e,t,i={}){super(),this.$e=U_(".monaco-sash").appendTo(e),k&&this.$e.addClass("mac"),this.gesture=new vm(this.$e.getHTMLElement()),this.$e.on(kl.MOUSE_DOWN,e=>{this.onMouseDown(e)}),this.$e.on(kl.DBLCLICK,e=>{this.emit("reset",e)}),this.$e.on(gm.Start,e=>{this.onTouchStart(e)}),this.size=i.baseSize||5,Da&&(this.size*=4,this.$e.addClass("touch")),this.setOrientation(i.orientation||zC.VERTICAL),this.isDisabled=!1,this.hidden=!1,this.layoutProvider=t}getHTMLElement(){return this.$e.getHTMLElement()}setOrientation(e){this.orientation=e,this.$e.removeClass("horizontal","vertical"),this.$e.addClass(this.getOrientation()),this.orientation===zC.HORIZONTAL?this.$e.size(null,this.size):this.$e.size(this.size),this.layoutProvider&&this.layout()}getOrientation(){return this.orientation===zC.HORIZONTAL?"horizontal":"vertical"}onMouseDown(e){if(Il.stop(e,!1),this.isDisabled)return
const t=U_(Vl("iframe"))
t&&t.style("pointer-events","none")
let i=new Ka(e),n=i.posx,s=i.posy,r={startX:n,currentX:n,startY:s,currentY:s}
this.$e.addClass("active"),this.emit("start",r)
let o=U_(window),a=`${this.getOrientation()}-cursor-container${k?"-mac":""}`
o.on("mousemove",e=>{Il.stop(e,!1)
let t=new Ka(e),i={startX:n,currentX:t.posx,startY:s,currentY:t.posy}
this.emit("change",i)}).once("mouseup",e=>{Il.stop(e,!1),this.$e.removeClass("active"),this.emit("end"),o.off("mousemove"),document.body.classList.remove(a)
const t=U_(Vl("iframe"))
t&&t.style("pointer-events","auto")}),document.body.classList.add(a)}onTouchStart(e){Il.stop(e)
let t=[],i=e.pageX,n=e.pageY
this.emit("start",{startX:i,currentX:i,startY:n,currentY:n})
let s=i,r=n
t.push(il(this.$e.getHTMLElement(),gm.Change,e=>{at(e.pageX)&&at(e.pageY)&&(this.emit("change",{startX:i,currentX:e.pageX,startY:n,currentY:e.pageY}),s=e.pageX,r=e.pageY)})),t.push(il(this.$e.getHTMLElement(),gm.End,e=>{this.emit("end"),ei(t)}))}layout(){let e
if(this.orientation===zC.VERTICAL){let t=this.layoutProvider
e={left:t.getVerticalSashLeft(this)-this.size/2+"px"},t.getVerticalSashTop&&(e.top=t.getVerticalSashTop(this)+"px"),t.getVerticalSashHeight&&(e.height=t.getVerticalSashHeight(this)+"px")}else{let t=this.layoutProvider
e={top:t.getHorizontalSashTop(this)-this.size/2+"px"},t.getHorizontalSashLeft&&(e.left=t.getHorizontalSashLeft(this)+"px"),t.getHorizontalSashWidth&&(e.width=t.getHorizontalSashWidth(this)+"px")}this.$e.style(e)}show(){this.hidden=!1,this.$e.show()}hide(){this.hidden=!0,this.$e.hide()}isHidden(){return this.hidden}enable(){this.$e.removeClass("disabled"),this.isDisabled=!1}disable(){this.$e.addClass("disabled"),this.isDisabled=!0}get enabled(){return!this.isDisabled}dispose(){this.$e&&(this.$e.destroy(),this.$e=null),super.dispose()}}class $C{static fromStaticValue(e){return new $C([qC.staticValue(e)])}get hasReplacementPatterns(){return null===this._staticValue}constructor(e){e&&0!==e.length?1===e.length&&null!==e[0].staticValue?(this._staticValue=e[0].staticValue,this._pieces=null):(this._staticValue=null,this._pieces=e):(this._staticValue="",this._pieces=null)}buildReplaceString(e){if(null!==this._staticValue)return this._staticValue
let t=""
for(let i=0,n=this._pieces.length;i<n;i++){let n=this._pieces[i]
null===n.staticValue?t+=$C._substitute(n.matchIndex,e):t+=n.staticValue}return t}static _substitute(e,t){if(0===e)return t[0]
let i=""
for(;e>0;){if(e<t.length)return(t[e]||"")+i
i=String(e%10)+i,e=Math.floor(e/10)}return"$"+i}}class qC{static staticValue(e){return new qC(e,-1)}static matchIndex(e){return new qC(null,e)}constructor(e,t){this.staticValue=e,this.matchIndex=t}}class GC{constructor(e){this._source=e,this._lastCharIndex=0,this._result=[],this._resultLen=0,this._currentStaticPiece=""}emitUnchanged(e){this._emitStatic(this._source.substring(this._lastCharIndex,e)),this._lastCharIndex=e}emitStatic(e,t){this._emitStatic(e),this._lastCharIndex=t}_emitStatic(e){0!==e.length&&(this._currentStaticPiece+=e)}emitMatchIndex(e,t){0!==this._currentStaticPiece.length&&(this._result[this._resultLen++]=qC.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),this._result[this._resultLen++]=qC.matchIndex(e),this._lastCharIndex=t}finalize(){return this.emitUnchanged(this._source.length),0!==this._currentStaticPiece.length&&(this._result[this._resultLen++]=qC.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),new $C(this._result)}}class jC{constructor(e){this._editor=e,this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationId=null,this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null,this._startPosition=this._editor.getPosition()}dispose(){this._editor.deltaDecorations(this._allDecorations(),[]),this._editor=null,this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationId=null,this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null,this._startPosition=null}reset(){this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationId=null,this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}getCount(){return this._decorations.length}getFindScope(){return this._findScopeDecorationId?this._editor.getModel().getDecorationRange(this._findScopeDecorationId):null}getStartPosition(){return this._startPosition}setStartPosition(e){this._startPosition=e,this.setCurrentFindMatch(null)}_getDecorationIndex(e){const t=this._decorations.indexOf(e)
return t>=0?t+1:1}getCurrentMatchesPosition(e){let t=this._editor.getModel().getDecorationsInRange(e)
for(let e=0,i=t.length;e<i;e++){const i=t[e],n=i.options
if(n===jC._FIND_MATCH_DECORATION||n===jC._CURRENT_FIND_MATCH_DECORATION)return this._getDecorationIndex(i.id)}return 1}setCurrentFindMatch(e){let i=null,n=0
if(e)for(let t=0,s=this._decorations.length;t<s;t++){let s=this._editor.getModel().getDecorationRange(this._decorations[t])
if(e.equalsRange(s)){i=this._decorations[t],n=t+1
break}}return null===this._highlightedDecorationId&&null===i||this._editor.changeDecorations(e=>{if(null!==this._highlightedDecorationId&&(e.changeDecorationOptions(this._highlightedDecorationId,jC._FIND_MATCH_DECORATION),this._highlightedDecorationId=null),null!==i&&(this._highlightedDecorationId=i,e.changeDecorationOptions(this._highlightedDecorationId,jC._CURRENT_FIND_MATCH_DECORATION)),null!==this._rangeHighlightDecorationId&&(e.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),null!==i){let n=this._editor.getModel().getDecorationRange(i)
if(n.startLineNumber!==n.endLineNumber&&1===n.endColumn){let e=n.endLineNumber-1,i=this._editor.getModel().getLineMaxColumn(e)
n=new t(n.startLineNumber,n.startColumn,e,i)}this._rangeHighlightDecorationId=e.addDecoration(n,jC._RANGE_HIGHLIGHT_DECORATION)}}),n}set(e,i){this._editor.changeDecorations(n=>{let s=jC._FIND_MATCH_DECORATION,r=[]
if(e.length>1e3){s=jC._FIND_MATCH_NO_OVERVIEW_DECORATION
const i=this._editor.getModel().getLineCount(),n=this._editor.getLayoutInfo().height/i,o=Math.max(2,Math.ceil(3/n))
let a=e[0].range.startLineNumber,l=e[0].range.endLineNumber
for(let i=1,n=e.length;i<n;i++){const n=e[i].range
l+o>=n.startLineNumber?n.endLineNumber>l&&(l=n.endLineNumber):(r.push({range:new t(a,1,l,1),options:jC._FIND_MATCH_ONLY_OVERVIEW_DECORATION}),a=n.startLineNumber,l=n.endLineNumber)}r.push({range:new t(a,1,l,1),options:jC._FIND_MATCH_ONLY_OVERVIEW_DECORATION})}let o=new Array(e.length)
for(let t=0,i=e.length;t<i;t++)o[t]={range:e[t].range,options:s}
this._decorations=n.deltaDecorations(this._decorations,o),this._overviewRulerApproximateDecorations=n.deltaDecorations(this._overviewRulerApproximateDecorations,r),this._rangeHighlightDecorationId&&(n.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),this._findScopeDecorationId&&(n.removeDecoration(this._findScopeDecorationId),this._findScopeDecorationId=null),i&&(this._findScopeDecorationId=n.addDecoration(i,jC._FIND_SCOPE_DECORATION))})}_allDecorations(){let e=[]
return e=(e=e.concat(this._decorations)).concat(this._overviewRulerApproximateDecorations),this._findScopeDecorationId&&e.push(this._findScopeDecorationId),this._rangeHighlightDecorationId&&e.push(this._rangeHighlightDecorationId),e}}jC._CURRENT_FIND_MATCH_DECORATION=Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,className:"currentFindMatch",showIfCollapsed:!0,overviewRuler:{color:Dg(ag),darkColor:Dg(ag),position:i.Center}}),jC._FIND_MATCH_DECORATION=Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,className:"findMatch",showIfCollapsed:!0,overviewRuler:{color:Dg(lg),darkColor:Dg(lg),position:i.Center}}),jC._FIND_MATCH_NO_OVERVIEW_DECORATION=Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,className:"findMatch",showIfCollapsed:!0}),jC._FIND_MATCH_ONLY_OVERVIEW_DECORATION=Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,overviewRuler:{color:Dg(lg),darkColor:Dg(lg),position:i.Center}}),jC._RANGE_HIGHLIGHT_DECORATION=Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,className:"rangeHighlight",isWholeLine:!0}),jC._FIND_SCOPE_DECORATION=Ld.register({className:"findScope",isWholeLine:!0})
class YC{constructor(e,t,i){this._editorSelection=e,this._ranges=t,this._replaceStrings=i}getEditOperations(e,i){if(this._ranges.length>0){for(var n=[],s=0;s<this._ranges.length;s++)n.push({range:this._ranges[s],text:this._replaceStrings[s]})
n.sort((e,i)=>t.compareRangesUsingStarts(e.range,i.range))
var r=[],o=n[0]
for(s=1;s<n.length;s++)o.range.endLineNumber===n[s].range.startLineNumber&&o.range.endColumn===n[s].range.startColumn?(o.range=o.range.plusRange(n[s].range),o.text=o.text+n[s].text):(r.push(o),o=n[s])
r.push(o)
for(s=0;s<r.length;s++)i.addEditOperation(r[s].range,r[s].text)}this._trackedEditorSelectionId=i.trackSelection(this._editorSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._trackedEditorSelectionId)}}const ZC={primary:545,mac:{primary:2593}},XC={primary:565,mac:{primary:2613}},JC={primary:560,mac:{primary:2608}},QC={primary:554,mac:{primary:2602}},eb={primary:528},tb={primary:530},ib={StartFindAction:"actions.find",NextMatchFindAction:"editor.action.nextMatchFindAction",PreviousMatchFindAction:"editor.action.previousMatchFindAction",NextSelectionMatchFindAction:"editor.action.nextSelectionMatchFindAction",PreviousSelectionMatchFindAction:"editor.action.previousSelectionMatchFindAction",StartFindReplaceAction:"editor.action.startFindReplaceAction",CloseFindWidgetCommand:"closeFindWidget",ToggleCaseSensitiveCommand:"toggleFindCaseSensitive",ToggleWholeWordCommand:"toggleFindWholeWord",ToggleRegexCommand:"toggleFindRegex",ToggleSearchScopeCommand:"toggleFindInSelection",ReplaceOneAction:"editor.action.replaceOne",ReplaceAllAction:"editor.action.replaceAll",SelectAllMatchesAction:"editor.action.selectAllMatches",ShowPreviousFindTermAction:"find.history.showPrevious",ShowNextFindTermAction:"find.history.showNext"},nb=19999
class sb{constructor(e,t){this._editor=e,this._state=t,this._toDispose=[],this._isDisposed=!1,this._decorations=new jC(e),this._toDispose.push(this._decorations),this._updateDecorationsScheduler=new Ca(()=>this.research(!1),100),this._toDispose.push(this._updateDecorationsScheduler),this._toDispose.push(this._editor.onDidChangeCursorPosition(e=>{e.reason!==br.Explicit&&e.reason!==br.Undo&&e.reason!==br.Redo||this._decorations.setStartPosition(this._editor.getPosition())})),this._ignoreModelContentChanged=!1,this._toDispose.push(this._editor.onDidChangeModelContent(e=>{this._ignoreModelContentChanged||(e.isFlush&&this._decorations.reset(),this._decorations.setStartPosition(this._editor.getPosition()),this._updateDecorationsScheduler.schedule())})),this._toDispose.push(this._state.addChangeListener(e=>this._onStateChanged(e))),this.research(!1,this._state.searchScope)}dispose(){this._isDisposed=!0,this._toDispose=ei(this._toDispose)}_onStateChanged(e){this._isDisposed||this._editor.getModel()&&(e.searchString||e.isReplaceRevealed||e.isRegex||e.wholeWord||e.matchCase||e.searchScope)&&(e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor))}static _getSearchRange(e,t,i){let n
return n=t?e.getEditableRange():e.getFullModelRange(),i&&(n=n.intersectRanges(i)),n}research(e,i){let n=null
null!==(n=void 0!==i?i:this._decorations.getFindScope())&&n.startLineNumber!==n.endLineNumber&&(n=new t(n.startLineNumber,1,n.endLineNumber,this._editor.getModel().getLineMaxColumn(n.endLineNumber)))
let s=this._findMatches(n,!1,nb)
this._decorations.set(s,n),this._state.changeMatchInfo(this._decorations.getCurrentMatchesPosition(this._editor.getSelection()),this._decorations.getCount(),void 0),e&&this._moveToNextMatch(this._decorations.getStartPosition())}_hasMatches(){return this._state.matchesCount>0}_cannotFind(){if(!this._hasMatches()){let e=this._decorations.getFindScope()
return e&&this._editor.revealRangeInCenterIfOutsideViewport(e,0),!0}return!1}_setCurrentFindMatch(e){let t=this._decorations.setCurrentFindMatch(e)
this._state.changeMatchInfo(t,this._decorations.getCount(),e),this._editor.setSelection(e),this._editor.revealRangeInCenterIfOutsideViewport(e,0)}_moveToPrevMatch(t,i=!1){if(this._cannotFind())return
let n=this._decorations.getFindScope(),s=sb._getSearchRange(this._editor.getModel(),this._state.isReplaceRevealed,n)
s.getEndPosition().isBefore(t)&&(t=s.getEndPosition()),t.isBefore(s.getStartPosition())&&(t=s.getEndPosition())
let{lineNumber:r,column:o}=t,a=this._editor.getModel(),l=new e(r,o),h=a.findPreviousMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getConfiguration().wordSeparators:null,!1)
h&&h.range.isEmpty()&&h.range.getStartPosition().equals(l)&&(this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0)||1===o?(1===r?r=a.getLineCount():r--,o=a.getLineMaxColumn(r)):o--,l=new e(r,o),h=a.findPreviousMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getConfiguration().wordSeparators:null,!1))
return h?i||s.containsRange(h.range)?void this._setCurrentFindMatch(h.range):this._moveToPrevMatch(h.range.getStartPosition(),!0):null}moveToPrevMatch(){this._moveToPrevMatch(this._editor.getSelection().getStartPosition())}_moveToNextMatch(e){let t=this._getNextMatch(e,!1,!0)
t&&this._setCurrentFindMatch(t.range)}_getNextMatch(t,i,n,s=!1){if(this._cannotFind())return null
let r=this._decorations.getFindScope(),o=sb._getSearchRange(this._editor.getModel(),this._state.isReplaceRevealed,r)
o.getEndPosition().isBefore(t)&&(t=o.getStartPosition()),t.isBefore(o.getStartPosition())&&(t=o.getStartPosition())
let{lineNumber:a,column:l}=t,h=this._editor.getModel(),d=new e(a,l),u=h.findNextMatch(this._state.searchString,d,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getConfiguration().wordSeparators:null,i)
n&&u&&u.range.isEmpty()&&u.range.getStartPosition().equals(d)&&(this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0)||l===h.getLineMaxColumn(a)?(a===h.getLineCount()?a=1:a++,l=1):l++,d=new e(a,l),u=h.findNextMatch(this._state.searchString,d,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getConfiguration().wordSeparators:null,i))
return u?s||o.containsRange(u.range)?u:this._getNextMatch(u.range.getEndPosition(),i,n,!0):null}moveToNextMatch(){this._moveToNextMatch(this._editor.getSelection().getEndPosition())}_getReplacePattern(){return this._state.isRegex?function(e){if(!e||0===e.length)return new $C(null)
let t=new GC(e)
for(let i=0,n=e.length;i<n;i++){let s=e.charCodeAt(i)
if(92!==s){if(36===s){if(++i>=n)break
let s=e.charCodeAt(i)
if(36===s){t.emitUnchanged(i-1),t.emitStatic("$",i+1)
continue}if(48===s||38===s){t.emitUnchanged(i-1),t.emitMatchIndex(0,i+1)
continue}if(49<=s&&s<=57){let r=s-48
if(i+1<n){let n=e.charCodeAt(i+1)
if(48<=n&&n<=57){i++,r=10*r+(n-48),t.emitUnchanged(i-2),t.emitMatchIndex(r,i+1)
continue}}t.emitUnchanged(i-1),t.emitMatchIndex(r,i+1)
continue}}}else{if(++i>=n)break
switch(e.charCodeAt(i)){case 92:t.emitUnchanged(i-1),t.emitStatic("\\",i+1)
break
case 110:t.emitUnchanged(i-1),t.emitStatic("\n",i+1)
break
case 116:t.emitUnchanged(i-1),t.emitStatic("\t",i+1)}}}return t.finalize()}(this._state.replaceString):$C.fromStaticValue(this._state.replaceString)}replace(){if(!this._hasMatches())return
let t=this._getReplacePattern(),i=this._editor.getSelection(),n=this._getNextMatch(i.getStartPosition(),t.hasReplacementPatterns,!1)
if(n)if(i.equalsRange(n.range)){let s=t.buildReplaceString(n.matches),r=new Ho(i,s)
this._executeEditorCommand("replace",r),this._decorations.setStartPosition(new e(i.startLineNumber,i.startColumn+s.length)),this.research(!0)}else this._decorations.setStartPosition(this._editor.getPosition()),this._setCurrentFindMatch(n.range)}_findMatches(e,t,i){let n=sb._getSearchRange(this._editor.getModel(),this._state.isReplaceRevealed,e)
return this._editor.getModel().findMatches(this._state.searchString,n,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getConfiguration().wordSeparators:null,t,i)}replaceAll(){if(!this._hasMatches())return
const e=this._decorations.getFindScope()
null===e&&this._state.matchesCount>=nb?this._largeReplaceAll():this._regularReplaceAll(e),this.research(!1)}_largeReplaceAll(){const e=new sn(this._state.searchString,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getConfiguration().wordSeparators:null).parseSearchRequest()
if(!e)return
let t=e.regex
if(!t.multiline){let e="m"
t.ignoreCase&&(e+="i"),t.global&&(e+="g"),t=new RegExp(t.source,e)}const i=this._editor.getModel(),n=i.getValue(s.LF),r=i.getFullModelRange(),o=this._getReplacePattern()
let a
a=o.hasReplacementPatterns?n.replace(t,function(){return o.buildReplaceString(arguments)}):n.replace(t,o.buildReplaceString(null))
let l=new Ko(r,a,this._editor.getSelection())
this._executeEditorCommand("replaceAll",l)}_regularReplaceAll(e){const t=this._getReplacePattern()
let i=this._findMatches(e,t.hasReplacementPatterns,1073741824),n=[]
for(let e=0,s=i.length;e<s;e++)n[e]=t.buildReplaceString(i[e].matches)
let s=new YC(this._editor.getSelection(),i.map(e=>e.range),n)
this._executeEditorCommand("replaceAll",s)}selectAllMatches(){if(!this._hasMatches())return
let e=this._decorations.getFindScope(),t=this._findMatches(e,!1,1073741824).map(e=>new At(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn)),i=this._editor.getSelection()
for(let e=0,n=t.length;e<n;e++){if(t[e].equalsRange(i)){t=[i].concat(t.slice(0,e)).concat(t.slice(e+1))
break}}this._editor.setSelections(t)}_executeEditorCommand(e,t){try{this._ignoreModelContentChanged=!0,this._editor.pushUndoStop(),this._editor.executeCommand(e,t),this._editor.pushUndoStop()}finally{this._ignoreModelContentChanged=!1}}}class rb{constructor(e,t=0,i=e.length){this.items=e,this.start=t,this.end=i,this.index=t-1}first(){return this.index=this.start,this.current()}next(){return this.index=Math.min(this.index+1,this.end),this.current()}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}}class ob extends rb{constructor(e,t=0,i=e.length){super(e,t,i)}current(){return super.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}parent(){return null}}class ab{constructor(e,t){this.iterator=e,this.fn=t}next(){return this.fn(this.iterator.next())}}class lb extends ab{constructor(e,t){super(e,t),this.navigator=e}current(){return this.fn(this.navigator.current())}previous(){return this.fn(this.navigator.previous())}parent(){return this.fn(this.navigator.parent())}first(){return this.fn(this.navigator.first())}last(){return this.fn(this.navigator.last())}next(){return this.fn(this.navigator.next())}}function hb(e,t){return 1===e||2!==e&&t}class db{constructor(){this._searchString="",this._replaceString="",this._isRevealed=!1,this._isReplaceRevealed=!1,this._isRegex=!1,this._isRegexOverride=0,this._wholeWord=!1,this._wholeWordOverride=0,this._matchCase=!1,this._matchCaseOverride=0,this._searchScope=null,this._matchesPosition=0,this._matchesCount=0,this._currentMatch=null,this._eventEmitter=new It}get searchString(){return this._searchString}get replaceString(){return this._replaceString}get isRevealed(){return this._isRevealed}get isReplaceRevealed(){return this._isReplaceRevealed}get isRegex(){return hb(this._isRegexOverride,this._isRegex)}get wholeWord(){return hb(this._wholeWordOverride,this._wholeWord)}get matchCase(){return hb(this._matchCaseOverride,this._matchCase)}get searchScope(){return this._searchScope}get matchesPosition(){return this._matchesPosition}get matchesCount(){return this._matchesCount}get currentMatch(){return this._currentMatch}dispose(){this._eventEmitter.dispose()}addChangeListener(e){return this._eventEmitter.addListener(db._CHANGED_EVENT,e)}changeMatchInfo(e,i,n){let s={moveCursor:!1,updateHistory:!1,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1},r=!1
0===i&&(e=0),e>i&&(e=i),this._matchesPosition!==e&&(this._matchesPosition=e,s.matchesPosition=!0,r=!0),this._matchesCount!==i&&(this._matchesCount=i,s.matchesCount=!0,r=!0),void 0!==n&&(t.equalsRange(this._currentMatch,n)||(this._currentMatch=n,s.currentMatch=!0,r=!0)),r&&this._eventEmitter.emit(db._CHANGED_EVENT,s)}change(e,i,n=!0){let s={moveCursor:i,updateHistory:n,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1},r=!1
const o=this.isRegex,a=this.wholeWord,l=this.matchCase
void 0!==e.searchString&&this._searchString!==e.searchString&&(this._searchString=e.searchString,s.searchString=!0,r=!0),void 0!==e.replaceString&&this._replaceString!==e.replaceString&&(this._replaceString=e.replaceString,s.replaceString=!0,r=!0),void 0!==e.isRevealed&&this._isRevealed!==e.isRevealed&&(this._isRevealed=e.isRevealed,s.isRevealed=!0,r=!0),void 0!==e.isReplaceRevealed&&this._isReplaceRevealed!==e.isReplaceRevealed&&(this._isReplaceRevealed=e.isReplaceRevealed,s.isReplaceRevealed=!0,r=!0),void 0!==e.isRegex&&(this._isRegex=e.isRegex),void 0!==e.wholeWord&&(this._wholeWord=e.wholeWord),void 0!==e.matchCase&&(this._matchCase=e.matchCase),void 0!==e.searchScope&&(t.equalsRange(this._searchScope,e.searchScope)||(this._searchScope=e.searchScope,s.searchScope=!0,r=!0)),this._isRegexOverride=void 0!==e.isRegexOverride?e.isRegexOverride:0,this._wholeWordOverride=void 0!==e.wholeWordOverride?e.wholeWordOverride:0,this._matchCaseOverride=void 0!==e.matchCaseOverride?e.matchCaseOverride:0,o!==this.isRegex&&(r=!0,s.isRegex=!0),a!==this.wholeWord&&(r=!0,s.wholeWord=!0),l!==this.matchCase&&(r=!0,s.matchCase=!0),r&&this._eventEmitter.emit(db._CHANGED_EVENT,s)}}function ub(e){let t=e.getSelection()
if(t.startLineNumber===t.endLineNumber){if(!t.isEmpty())return e.getModel().getValueInRange(t)
{let i=e.getModel().getWordAtPosition(t.getStartPosition())
if(i)return i.word}}return null}db._CHANGED_EVENT="changed"
const cb=new xo("findWidgetVisible",!1),gb=(cb.toNegated(),new xo("findInputFocussed",!1))
let mb=class e extends ni{constructor(e,t,i){super(),this._editor=e,this._findWidgetVisible=cb.bindTo(t),this._storageService=i,this._updateHistoryDelayer=new class{constructor(e){this.defaultDelay=e,this.timeout=null,this.completionPromise=null,this.onSuccess=null,this.task=null}trigger(e,t=this.defaultDelay){return this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new bt(e=>{this.onSuccess=e},()=>{}).then(()=>{this.completionPromise=null,this.onSuccess=null
const e=this.task
return this.task=null,e()})),this.timeout=setTimeout(()=>{this.timeout=null,this.onSuccess(null)},t),this.completionPromise}isTriggered(){return null!==this.timeout}cancel(){this.cancelTimeout(),this.completionPromise&&(this.completionPromise.cancel(),this.completionPromise=null)}cancelTimeout(){null!==this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}}(500),this._currentHistoryNavigator=new class{constructor(e=[],t=10){this._initialize(e),this._limit=t,this._onChange()}getHistory(){return this._elements}add(e){this._history.delete(e),this._history.add(e),this._onChange()}addIfNotPresent(e){this._history.has(e)||this.add(e)}next(){return this._navigator.next()?this._navigator.current():(this.last(),null)}previous(){return this._navigator.previous()?this._navigator.current():(this.first(),null)}current(){return this._navigator.current()}parent(){return null}first(){return this._navigator.first()}last(){return this._navigator.last()}_onChange(){this._reduceToLimit(),this._navigator=new ob(this._elements),this._navigator.last()}_reduceToLimit(){let e=this._elements
e.length>this._limit&&this._initialize(e.slice(e.length-this._limit))}_initialize(e){this._history=new Set
for(const t of e)this._history.add(t)}get _elements(){const e=[]
return this._history.forEach(t=>e.push(t)),e}},this._state=this._register(new db),this.loadQueryState(),this._register(this._state.addChangeListener(e=>this._onStateChanged(e))),this._model=null,this._register(this._editor.onDidChangeModel(()=>{let e=this._editor.getModel()&&this._state.isRevealed
this.disposeModel(),this._state.change({searchScope:null,matchCase:this._storageService.getBoolean("editor.matchCase",Uu.WORKSPACE,!1),wholeWord:this._storageService.getBoolean("editor.wholeWord",Uu.WORKSPACE,!1),isRegex:this._storageService.getBoolean("editor.isRegex",Uu.WORKSPACE,!1)},!1),e&&this._start({forceRevealReplace:!1,seedSearchStringFromSelection:!1,shouldFocus:0,shouldAnimate:!1})}))}static get(t){return t.getContribution(e.ID)}dispose(){this.disposeModel(),super.dispose()}disposeModel(){this._model&&(this._model.dispose(),this._model=null)}getId(){return e.ID}_onStateChanged(e){this.saveQueryState(e),e.updateHistory&&e.searchString&&this._delayedUpdateHistory(),e.isRevealed&&(this._state.isRevealed?this._findWidgetVisible.set(!0):(this._findWidgetVisible.reset(),this.disposeModel()))}saveQueryState(e){e.isRegex&&void 0!==this._state.isRegex&&this._storageService.store("editor.isRegex",this._state.isRegex,Uu.WORKSPACE),e.wholeWord&&void 0!==this._state.wholeWord&&this._storageService.store("editor.wholeWord",this._state.wholeWord,Uu.WORKSPACE),e.matchCase&&void 0!==this._state.matchCase&&this._storageService.store("editor.matchCase",this._state.matchCase,Uu.WORKSPACE)}loadQueryState(){this._state.change({matchCase:this._storageService.getBoolean("editor.matchCase",Uu.WORKSPACE,this._state.matchCase),wholeWord:this._storageService.getBoolean("editor.wholeWord",Uu.WORKSPACE,this._state.wholeWord),isRegex:this._storageService.getBoolean("editor.isRegex",Uu.WORKSPACE,this._state.isRegex)},!1)}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this))}_updateHistory(){this._state.searchString&&this._currentHistoryNavigator.add(this._state.searchString)}getState(){return this._state}getHistory(){return this._currentHistoryNavigator}closeFindWidget(){this._state.change({isRevealed:!1,searchScope:null},!1),this._editor.focus()}toggleCaseSensitive(){this._state.change({matchCase:!this._state.matchCase},!1)}toggleWholeWords(){this._state.change({wholeWord:!this._state.wholeWord},!1)}toggleRegex(){this._state.change({isRegex:!this._state.isRegex},!1)}toggleSearchScope(){if(this._state.searchScope)this._state.change({searchScope:null},!0)
else{let e=this._editor.getSelection()
1===e.endColumn&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,1)),e.isEmpty()||this._state.change({searchScope:e},!0)}}setSearchString(e){this._state.change({searchString:e},!1)}highlightFindOptions(){}_start(e){if(this.disposeModel(),!this._editor.getModel())return
let t={isRevealed:!0}
if(e.seedSearchStringFromSelection&&this._editor.getConfiguration().contribInfo.find.seedSearchStringFromSelection){let e=ub(this._editor)
e&&(this._state.isRegex?t.searchString=ue(e):t.searchString=e)}e.forceRevealReplace?t.isReplaceRevealed=!0:this._findWidgetVisible.get()||(t.isReplaceRevealed=!1),this._state.change(t,!1),this._model||(this._model=new sb(this._editor,this._state))}start(e){this._start(e)}moveToNextMatch(){return!!this._model&&(this._model.moveToNextMatch(),!0)}moveToPrevMatch(){return!!this._model&&(this._model.moveToPrevMatch(),!0)}replace(){return!!this._model&&(this._model.replace(),!0)}replaceAll(){return!!this._model&&(this._model.replaceAll(),!0)}selectAllMatches(){return!!this._model&&(this._model.selectAllMatches(),this._editor.focus(),!0)}showPreviousFindTerm(){let e=this._currentHistoryNavigator.previous()
return e&&this._state.change({searchString:e},!1,!1),!0}showNextFindTerm(){let e=this._currentHistoryNavigator.next()
return e&&this._state.change({searchString:e},!1,!1),!0}}
mb.ID="editor.contrib.findController",mb=Nn([En(1,Lo),En(2,zu)],mb)
Oo(class extends To{constructor(){super({id:ib.StartFindAction,label:Jt("startFindAction","Find"),alias:"Find",precondition:null,kbOpts:{kbExpr:null,primary:2084,mac:{primary:2084,secondary:[2083]}}})}run(e,t){let i=mb.get(t)
i&&i.start({forceRevealReplace:!1,seedSearchStringFromSelection:!0,shouldFocus:1,shouldAnimate:!0})}})
class pb extends To{run(e,t){let i=mb.get(t)
i&&!this._run(i)&&(i.start({forceRevealReplace:!1,seedSearchStringFromSelection:0===i.getState().searchString.length,shouldFocus:0,shouldAnimate:!0}),this._run(i))}}Oo(class extends pb{constructor(){super({id:ib.NextMatchFindAction,label:Jt("findNextMatchAction","Find Next"),alias:"Find Next",precondition:null,kbOpts:{kbExpr:Vo.focus,primary:61,mac:{primary:2085,secondary:[61]}}})}_run(e){return e.moveToNextMatch()}})
Oo(class extends pb{constructor(){super({id:ib.PreviousMatchFindAction,label:Jt("findPreviousMatchAction","Find Previous"),alias:"Find Previous",precondition:null,kbOpts:{kbExpr:Vo.focus,primary:1085,mac:{primary:3109,secondary:[1085]}}})}_run(e){return e.moveToPrevMatch()}})
class fb extends To{run(e,t){let i=mb.get(t)
if(!i)return
let n=ub(t)
n&&i.setSearchString(n),this._run(i)||(i.start({forceRevealReplace:!1,seedSearchStringFromSelection:!1,shouldFocus:0,shouldAnimate:!0}),this._run(i))}}Oo(class extends fb{constructor(){super({id:ib.NextSelectionMatchFindAction,label:Jt("nextSelectionMatchFindAction","Find Next Selection"),alias:"Find Next Selection",precondition:null,kbOpts:{kbExpr:Vo.focus,primary:2109}})}_run(e){return e.moveToNextMatch()}})
Oo(class extends fb{constructor(){super({id:ib.PreviousSelectionMatchFindAction,label:Jt("previousSelectionMatchFindAction","Find Previous Selection"),alias:"Find Previous Selection",precondition:null,kbOpts:{kbExpr:Vo.focus,primary:3133}})}_run(e){return e.moveToPrevMatch()}})
Oo(class extends To{constructor(){super({id:ib.StartFindReplaceAction,label:Jt("startReplace","Replace"),alias:"Replace",precondition:null,kbOpts:{kbExpr:null,primary:2086,mac:{primary:2596}}})}run(e,t){if(t.getConfiguration().readOnly)return
let i=mb.get(t),n=t.getSelection(),s=!n.isEmpty()&&n.startLineNumber===n.endLineNumber,r=i.getState().searchString||s?2:1
i&&i.start({forceRevealReplace:!0,seedSearchStringFromSelection:s,shouldFocus:r,shouldAnimate:!0})}})
Oo(class extends pb{constructor(){super({id:ib.ShowNextFindTermAction,label:Jt("showNextFindTermAction","Show Next Find Term"),alias:"Show Next Find Term",precondition:cb,kbOpts:{weight:No.commandWeight(5),kbExpr:_o.and(gb,Vo.focus),primary:tb.primary,mac:tb.mac,win:tb.win,linux:tb.linux}})}_run(e){return e.showNextFindTerm()}})
Oo(class extends pb{constructor(){super({id:ib.ShowPreviousFindTermAction,label:Jt("showPreviousFindTermAction","Show Previous Find Term"),alias:"Find Show Previous Find Term",precondition:cb,kbOpts:{weight:No.commandWeight(5),kbExpr:_o.and(gb,Vo.focus),primary:eb.primary,mac:eb.mac,win:eb.win,linux:eb.linux}})}_run(e){return e.showPreviousFindTerm()}})
const _b=Do.bindToContribution(mb.get)
No.registerEditorCommand(new _b({id:ib.CloseFindWidgetCommand,precondition:cb,handler:e=>e.closeFindWidget(),kbOpts:{weight:No.commandWeight(5),kbExpr:Vo.focus,primary:9,secondary:[1033]}})),No.registerEditorCommand(new _b({id:ib.ToggleCaseSensitiveCommand,precondition:null,handler:e=>e.toggleCaseSensitive(),kbOpts:{weight:No.commandWeight(5),kbExpr:Vo.focus,primary:ZC.primary,mac:ZC.mac,win:ZC.win,linux:ZC.linux}})),No.registerEditorCommand(new _b({id:ib.ToggleWholeWordCommand,precondition:null,handler:e=>e.toggleWholeWords(),kbOpts:{weight:No.commandWeight(5),kbExpr:Vo.focus,primary:XC.primary,mac:XC.mac,win:XC.win,linux:XC.linux}})),No.registerEditorCommand(new _b({id:ib.ToggleRegexCommand,precondition:null,handler:e=>e.toggleRegex(),kbOpts:{weight:No.commandWeight(5),kbExpr:Vo.focus,primary:JC.primary,mac:JC.mac,win:JC.win,linux:JC.linux}})),No.registerEditorCommand(new _b({id:ib.ToggleSearchScopeCommand,precondition:null,handler:e=>e.toggleSearchScope(),kbOpts:{weight:No.commandWeight(5),kbExpr:Vo.focus,primary:QC.primary,mac:QC.mac,win:QC.win,linux:QC.linux}})),No.registerEditorCommand(new _b({id:ib.ReplaceOneAction,precondition:cb,handler:e=>e.replace(),kbOpts:{weight:No.commandWeight(5),kbExpr:Vo.focus,primary:3094}})),No.registerEditorCommand(new _b({id:ib.ReplaceAllAction,precondition:cb,handler:e=>e.replaceAll(),kbOpts:{weight:No.commandWeight(5),kbExpr:Vo.focus,primary:2563}})),No.registerEditorCommand(new _b({id:ib.SelectAllMatchesAction,precondition:cb,handler:e=>e.selectAllMatches(),kbOpts:{weight:No.commandWeight(5),kbExpr:Vo.focus,primary:515}}))
const Cb=Jt("label.find","Find"),bb=Jt("placeholder.find","Find"),wb=Jt("label.previousMatchButton","Previous match"),vb=Jt("label.nextMatchButton","Next match"),Sb=Jt("label.toggleSelectionFind","Find in selection"),yb=Jt("label.closeButton","Close"),xb=Jt("label.replace","Replace"),Lb=Jt("placeholder.replace","Replace"),Nb=Jt("label.replaceButton","Replace"),Eb=Jt("label.replaceAllButton","Replace All"),kb=Jt("label.toggleReplaceButton","Toggle Replace mode"),Ib=Jt("title.matchesCountLimit","Only the first {0} results are highlighted, but all find operations work on the entire text.",nb),Mb=Jt("label.matchesLocation","{0} of {1}"),Db=Jt("label.noResults","No Results"),Tb=411,Ob=221,Rb=Ob
let Ab=69,Pb=17+(Ab+3+1)+92+2
const Fb=34,Wb=64
class Vb{constructor(e){this.afterLineNumber=e,this.heightInPx=Fb,this.suppressMouseDown=!1,this.domNode=document.createElement("div"),this.domNode.className="dock-find-viewzone"}}class Bb extends ff{constructor(e,i,n,s,r,o,a){super(),this._codeEditor=e,this._controller=i,this._state=n,this._contextViewProvider=s,this._keybindingService=r,this._isVisible=!1,this._isReplaceVisible=!1,this._register(this._state.addChangeListener(e=>this._onStateChanged(e))),this._buildDomNode(),this._updateButtons()
let l=()=>{let e=this._codeEditor.getConfiguration().layoutInfo.width,t=this._codeEditor.getConfiguration().layoutInfo.minimapWidth,i=!1,n=!1,s=!1
if(wl(this._domNode)>Tb)return this._domNode.style.maxWidth=`${e-28-t-15}px`,void(this._replaceInputBox.inputElement.style.width=`${wl(this._findInput.inputBox.inputElement)}px`)
Tb+28+t>=e&&(n=!0),Tb+28+t-Ab>=e&&(s=!0),Tb+28+t-Ab>=e+50&&(i=!0),el(this._domNode,"collapsed-find-widget",i),el(this._domNode,"narrow-find-widget",s),el(this._domNode,"reduced-find-widget",n),s||i||(this._domNode.style.maxWidth=`${e-28-t-15}px`)
let r=wl(this._findInput.inputBox.inputElement)
r>0&&(this._replaceInputBox.inputElement.style.width=`${r}px`)}
l(),this._register(this._codeEditor.onDidChangeConfiguration(e=>{e.readOnly&&(this._codeEditor.getConfiguration().readOnly&&this._state.change({isReplaceRevealed:!1},!1),this._updateButtons()),e.layoutInfo&&l()})),this._register(this._codeEditor.onDidChangeCursorSelection(()=>{this._isVisible&&this._updateToggleSelectionFindButton()})),this._findInputFocused=gb.bindTo(o),this._focusTracker=this._register(Dl(this._findInput.inputBox.inputElement)),this._focusTracker.addFocusListener(()=>{if(this._findInputFocused.set(!0),this._toggleSelectionFind.checked){let e=this._codeEditor.getSelection()
1===e.endColumn&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,1))
let i=this._state.currentMatch
e.startLineNumber!==e.endLineNumber&&(t.equalsRange(e,i)||this._state.change({searchScope:e},!0))}}),this._focusTracker.addBlurListener(()=>{this._findInputFocused.set(!1)}),this._codeEditor.addOverlayWidget(this),this._viewZone=new Vb(0),this._applyTheme(a.getTheme()),this._register(a.onThemeChange(this._applyTheme.bind(this))),this._register(this._codeEditor.onDidChangeModel(e=>{this._isVisible&&void 0!==this._viewZoneId&&this._codeEditor.changeViewZones(e=>{e.removeZone(this._viewZoneId),this._viewZoneId=void 0})})),this._register(this._codeEditor.onDidScrollChange(e=>{e.scrollTopChanged?this._layoutViewZone():setTimeout(()=>{this._layoutViewZone()},0)}))}getId(){return Bb.ID}getDomNode(){return this._domNode}getPosition(){return this._isVisible?{preference:_m.TOP_RIGHT_CORNER}:null}_onStateChanged(e){if(e.searchString&&(this._findInput.setValue(this._state.searchString),this._updateButtons()),e.replaceString&&(this._replaceInputBox.value=this._state.replaceString),e.isRevealed&&(this._state.isRevealed?this._reveal(!0):this._hide(!0)),e.isReplaceRevealed&&(this._state.isReplaceRevealed?this._codeEditor.getConfiguration().readOnly||this._isReplaceVisible||(this._isReplaceVisible=!0,this._updateButtons()):this._isReplaceVisible&&(this._isReplaceVisible=!1,this._updateButtons())),e.isRegex&&this._findInput.setRegex(this._state.isRegex),e.wholeWord&&this._findInput.setWholeWords(this._state.wholeWord),e.matchCase&&this._findInput.setCaseSensitive(this._state.matchCase),e.searchScope&&(this._state.searchScope?this._toggleSelectionFind.checked=!0:this._toggleSelectionFind.checked=!1,this._updateToggleSelectionFindButton()),e.searchString||e.matchesCount||e.matchesPosition){let e=this._state.searchString.length>0&&0===this._state.matchesCount
el(this._domNode,"no-results",e),this._updateMatchesCount()}(e.searchString||e.currentMatch)&&this._layoutViewZone()}_updateMatchesCount(){let e
if(this._matchesCount.style.minWidth=Ab+"px",this._state.matchesCount>=nb?this._matchesCount.title=Ib:this._matchesCount.title="",this._matchesCount.firstChild&&this._matchesCount.removeChild(this._matchesCount.firstChild),this._state.matchesCount>0){let t=String(this._state.matchesCount)
this._state.matchesCount>=nb&&(t+="+")
let i=String(this._state.matchesPosition)
"0"===i&&(i="?"),e=he(Mb,i,t)}else e=Db
this._matchesCount.appendChild(document.createTextNode(e)),Ab=Math.max(Ab,this._matchesCount.clientWidth)}_updateToggleSelectionFindButton(){let e=this._codeEditor.getSelection(),t=!!e&&(e.startLineNumber!==e.endLineNumber||e.startColumn!==e.endColumn),i=this._toggleSelectionFind.checked
this._toggleSelectionFind.setEnabled(this._isVisible&&(i||t))}_updateButtons(){this._findInput.setEnabled(this._isVisible),this._replaceInputBox.setEnabled(this._isVisible&&this._isReplaceVisible),this._updateToggleSelectionFindButton(),this._closeBtn.setEnabled(this._isVisible)
let e=this._state.searchString.length>0
this._prevBtn.setEnabled(this._isVisible&&e),this._nextBtn.setEnabled(this._isVisible&&e),this._replaceBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._replaceAllBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),el(this._domNode,"replaceToggled",this._isReplaceVisible),this._toggleReplaceBtn.toggleClass("collapse",!this._isReplaceVisible),this._toggleReplaceBtn.toggleClass("expand",this._isReplaceVisible),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible)
let t=!this._codeEditor.getConfiguration().readOnly
this._toggleReplaceBtn.setEnabled(this._isVisible&&t)}_reveal(e){if(!this._isVisible){this._isVisible=!0
let t=this._codeEditor.getSelection()
!!t&&(t.startLineNumber!==t.endLineNumber||t.startColumn!==t.endColumn)&&this._codeEditor.getConfiguration().contribInfo.find.autoFindInSelection?this._toggleSelectionFind.checked=!0:this._toggleSelectionFind.checked=!1,this._updateButtons(),setTimeout(()=>{Ja(this._domNode,"visible"),this._domNode.setAttribute("aria-hidden","false"),e||(Ja(this._domNode,"noanimation"),setTimeout(()=>{Qa(this._domNode,"noanimation")},200))},0),this._codeEditor.layoutOverlayWidget(this)
let i=!0
if(this._codeEditor.getConfiguration().contribInfo.find.seedSearchStringFromSelection&&t){let e=Cl(this._codeEditor.getDomNode()),n=this._codeEditor.getScrolledVisiblePosition(t.getStartPosition()),s=e.left+n.left
if(n.top<this._viewZone.heightInPx){t.endLineNumber>t.startLineNumber&&(i=!1)
let n=_l(this._domNode).left
s>n&&(i=!1)
let r=this._codeEditor.getScrolledVisiblePosition(t.getEndPosition())
e.left+r.left>n&&(i=!1)}}this._showViewZone(i)}}_hide(e){this._isVisible&&(this._isVisible=!1,this._updateButtons(),Qa(this._domNode,"visible"),this._domNode.setAttribute("aria-hidden","true"),e&&this._codeEditor.focus(),this._codeEditor.layoutOverlayWidget(this),this._codeEditor.changeViewZones(e=>{void 0!==this._viewZoneId&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0,this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()-this._viewZone.heightInPx))}))}_layoutViewZone(){this._isVisible&&void 0===this._viewZoneId&&this._codeEditor.changeViewZones(e=>{this._state.isReplaceRevealed?this._viewZone.heightInPx=Wb:this._viewZone.heightInPx=Fb,this._viewZoneId=e.addZone(this._viewZone),this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+this._viewZone.heightInPx)})}_showViewZone(e=!0){this._isVisible&&this._codeEditor.changeViewZones(t=>{let i=Fb
void 0!==this._viewZoneId?(this._state.isReplaceRevealed?(this._viewZone.heightInPx=Wb,i=Wb-Fb):(this._viewZone.heightInPx=Fb,i=Fb-Wb),t.removeZone(this._viewZoneId)):this._viewZone.heightInPx=Fb,this._viewZoneId=t.addZone(this._viewZone),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+i)})}_applyTheme(e){let t={inputActiveOptionBorder:e.getColor(vc),inputBackground:e.getColor(Cc),inputForeground:e.getColor(bc),inputBorder:e.getColor(wc),inputValidationInfoBackground:e.getColor(Sc),inputValidationInfoBorder:e.getColor(yc),inputValidationWarningBackground:e.getColor(xc),inputValidationWarningBorder:e.getColor(Lc),inputValidationErrorBackground:e.getColor(Nc),inputValidationErrorBorder:e.getColor(Ec)}
this._findInput.style(t),this._replaceInputBox.style(t)}focusFindInput(){this._findInput.select(),this._findInput.focus()}focusReplaceInput(){this._replaceInputBox.select(),this._replaceInputBox.focus()}highlightFindOptions(){this._findInput.highlightFindOptions()}_onFindInputMouseDown(e){e.middleButton&&e.stopPropagation()}_onFindInputKeyDown(e){return e.equals(3)?(this._codeEditor.getAction(ib.NextMatchFindAction).run().done(null,St),void e.preventDefault()):e.equals(1027)?(this._codeEditor.getAction(ib.PreviousMatchFindAction).run().done(null,St),void e.preventDefault()):e.equals(2)?(this._isReplaceVisible?this._replaceInputBox.focus():this._findInput.focusOnCaseSensitive(),void e.preventDefault()):e.equals(2066)?(this._codeEditor.focus(),void e.preventDefault()):void 0}_onReplaceInputKeyDown(e){return e.equals(3)?(this._controller.replace(),void e.preventDefault()):e.equals(2051)?(this._controller.replaceAll(),void e.preventDefault()):e.equals(2)?(this._findInput.focusOnCaseSensitive(),void e.preventDefault()):e.equals(1026)?(this._findInput.focus(),void e.preventDefault()):e.equals(2066)?(this._codeEditor.focus(),void e.preventDefault()):void 0}getHorizontalSashTop(e){return 0}getHorizontalSashLeft(e){return 0}getHorizontalSashWidth(e){return 500}_keybindingLabelFor(e){let t=this._keybindingService.lookupKeybinding(e)
return t?` (${t.getLabel()})`:""}_buildFindPart(){this._findInput=this._register(new HC(null,this._contextViewProvider,{width:Ob,label:Cb,placeholder:bb,appendCaseSensitiveLabel:this._keybindingLabelFor(ib.ToggleCaseSensitiveCommand),appendWholeWordsLabel:this._keybindingLabelFor(ib.ToggleWholeWordCommand),appendRegexLabel:this._keybindingLabelFor(ib.ToggleRegexCommand),validation:e=>{if(0===e.length)return null
if(!this._findInput.getRegex())return null
try{return null}catch(e){return{content:e.message}}}})),this._findInput.setRegex(!!this._state.isRegex),this._findInput.setCaseSensitive(!!this._state.matchCase),this._findInput.setWholeWords(!!this._state.wholeWord),this._register(this._findInput.onKeyDown(e=>this._onFindInputKeyDown(e))),this._register(this._findInput.onInput(()=>{this._state.change({searchString:this._findInput.getValue()},!0)})),this._register(this._findInput.onDidOptionChange(()=>{this._state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)})),this._register(this._findInput.onCaseSensitiveKeyDown(e=>{e.equals(1026)&&this._isReplaceVisible&&(this._replaceInputBox.focus(),e.preventDefault())})),I&&this._register(this._findInput.onMouseDown(e=>this._onFindInputMouseDown(e))),this._matchesCount=document.createElement("div"),this._matchesCount.className="matchesCount",this._updateMatchesCount(),this._prevBtn=this._register(new zb({label:wb+this._keybindingLabelFor(ib.PreviousMatchFindAction),className:"previous",onTrigger:()=>{this._codeEditor.getAction(ib.PreviousMatchFindAction).run().done(null,St)},onKeyDown:e=>{}})),this._nextBtn=this._register(new zb({label:vb+this._keybindingLabelFor(ib.NextMatchFindAction),className:"next",onTrigger:()=>{this._codeEditor.getAction(ib.NextMatchFindAction).run().done(null,St)},onKeyDown:e=>{}}))
let e=document.createElement("div")
return e.className="find-part",e.appendChild(this._findInput.domNode),e.appendChild(this._matchesCount),e.appendChild(this._prevBtn.domNode),e.appendChild(this._nextBtn.domNode),this._toggleSelectionFind=this._register(new Hb({parent:e,title:Sb+this._keybindingLabelFor(ib.ToggleSearchScopeCommand),onChange:()=>{if(this._toggleSelectionFind.checked){let e=this._codeEditor.getSelection()
1===e.endColumn&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,1)),e.isEmpty()||this._state.change({searchScope:e},!0)}else this._state.change({searchScope:null},!0)}})),this._closeBtn=this._register(new zb({label:yb+this._keybindingLabelFor(ib.CloseFindWidgetCommand),className:"close-fw",onTrigger:()=>{this._state.change({isRevealed:!1,searchScope:null},!1)},onKeyDown:e=>{e.equals(2)&&this._isReplaceVisible&&(this._replaceBtn.isEnabled()?this._replaceBtn.focus():this._codeEditor.focus(),e.preventDefault())}})),e.appendChild(this._closeBtn.domNode),e}_buildReplacePart(){let e=document.createElement("div")
e.className="replace-input",e.style.width=Rb+"px",this._replaceInputBox=this._register(new DC(e,null,{ariaLabel:xb,placeholder:Lb})),this._register(nl(this._replaceInputBox.inputElement,"keydown",e=>this._onReplaceInputKeyDown(e))),this._register(nl(this._replaceInputBox.inputElement,"input",e=>{this._state.change({replaceString:this._replaceInputBox.value},!1)})),this._replaceBtn=this._register(new zb({label:Nb+this._keybindingLabelFor(ib.ReplaceOneAction),className:"replace",onTrigger:()=>{this._controller.replace()},onKeyDown:e=>{e.equals(1026)&&(this._closeBtn.focus(),e.preventDefault())}})),this._replaceAllBtn=this._register(new zb({label:Eb+this._keybindingLabelFor(ib.ReplaceAllAction),className:"replace-all",onTrigger:()=>{this._controller.replaceAll()},onKeyDown:e=>{}}))
let t=document.createElement("div")
return t.className="replace-part",t.appendChild(e),t.appendChild(this._replaceBtn.domNode),t.appendChild(this._replaceAllBtn.domNode),t}_buildDomNode(){let e=this._buildFindPart(),t=this._buildReplacePart()
this._toggleReplaceBtn=this._register(new zb({label:kb,className:"toggle left",onTrigger:()=>{this._state.change({isReplaceRevealed:!this._isReplaceVisible},!1),this._isReplaceVisible&&(this._replaceInputBox.width=this._findInput.inputBox.width),this._showViewZone()},onKeyDown:e=>{}})),this._toggleReplaceBtn.toggleClass("expand",this._isReplaceVisible),this._toggleReplaceBtn.toggleClass("collapse",!this._isReplaceVisible),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible),this._domNode=document.createElement("div"),this._domNode.className="editor-widget find-widget",this._domNode.setAttribute("aria-hidden","true"),this._domNode.style.width=`${Tb}px`,this._domNode.appendChild(this._toggleReplaceBtn.domNode),this._domNode.appendChild(e),this._domNode.appendChild(t),this._buildSash()}_buildSash(){this._resizeSash=new KC(this._domNode,this,{orientation:zC.VERTICAL})
let e=Tb
this._register(this._resizeSash.addListener("start",t=>{e=wl(this._domNode)})),this._register(this._resizeSash.addListener("change",t=>{let i=e+t.startX-t.currentX
if(i<Tb)return
let n=i-Pb
i>(parseFloat(gl(this._domNode).maxWidth)||0)||(this._domNode.style.width=`${i}px`,this._isReplaceVisible&&(this._replaceInputBox.width=n))}))}}Bb.ID="editor.contrib.findWidget"
class Hb extends ff{constructor(e){super(),this._opts=e,this._domNode=document.createElement("div"),this._domNode.className="monaco-checkbox",this._domNode.title=this._opts.title,this._domNode.tabIndex=0,this._checkbox=document.createElement("input"),this._checkbox.type="checkbox",this._checkbox.className="checkbox",this._checkbox.id="checkbox-"+Hb._COUNTER++,this._checkbox.tabIndex=-1,this._label=document.createElement("label"),this._label.className="label",this._label.htmlFor=this._checkbox.id,this._label.tabIndex=-1,this._domNode.appendChild(this._checkbox),this._domNode.appendChild(this._label),this._opts.parent.appendChild(this._domNode),this.onchange(this._checkbox,e=>{this._opts.onChange()})}get domNode(){return this._domNode}get checked(){return this._checkbox.checked}set checked(e){this._checkbox.checked=e}focus(){this._checkbox.focus()}enable(){this._checkbox.removeAttribute("disabled")}disable(){this._checkbox.disabled=!0}setEnabled(e){e?(this.enable(),this.domNode.tabIndex=0):(this.disable(),this.domNode.tabIndex=-1)}}Hb._COUNTER=0
class zb extends ff{constructor(e){super(),this._opts=e,this._domNode=document.createElement("div"),this._domNode.title=this._opts.label,this._domNode.tabIndex=0,this._domNode.className="button "+this._opts.className,this._domNode.setAttribute("role","button"),this._domNode.setAttribute("aria-label",this._opts.label),this.onclick(this._domNode,e=>{this._opts.onTrigger(),e.preventDefault()}),this.onkeydown(this._domNode,e=>{if(e.equals(10)||e.equals(3))return this._opts.onTrigger(),void e.preventDefault()
this._opts.onKeyDown(e)})}get domNode(){return this._domNode}isEnabled(){return this._domNode.tabIndex>=0}focus(){this._domNode.focus()}setEnabled(e){el(this._domNode,"disabled",!e),this._domNode.setAttribute("aria-disabled",String(!e)),this._domNode.tabIndex=e?0:-1}setExpanded(e){this._domNode.setAttribute("aria-expanded",String(!!e))}toggleClass(e,t){el(this._domNode,e,t)}}Wg((e,t)=>{function i(e,i){i&&t.addRule(`.monaco-editor ${e} { background-color: ${i}; }`)}i(".findMatch",e.getColor(lg)),i(".currentFindMatch",e.getColor(ag)),i(".findScope",e.getColor(hg)),i(".find-widget",e.getColor(tg))
let n=e.getColor(_c)
n&&t.addRule(`.monaco-editor .find-widget { box-shadow: 0 2px 8px ${n}; }`)
let s=e.getColor(mc)
s&&(t.addRule(`.monaco-editor .findScope { border: 1px dashed ${s.transparent(.4)}; }`),t.addRule(`.monaco-editor .currentFindMatch { border: 2px solid ${s}; padding: 1px; -moz-box-sizing: border-box; box-sizing: border-box; }`),t.addRule(`.monaco-editor .findMatch { border: 1px dotted ${s}; -moz-box-sizing: border-box; box-sizing: border-box; }`))
let r=e.getColor(gc)
r&&t.addRule(`.monaco-editor .find-widget { border: 2px solid ${r}; }`)
let o=e.getColor(uc)
o&&t.addRule(`.monaco-editor .find-widget.no-results .matchesCount { color: ${o}; }`)
let a=e.getColor(ig)
a&&t.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${a}; width: 3px !important; margin-left: -4px;}`)})
class Ub extends ff{constructor(e,t,i,n){super(),this._hideSoon=this._register(new Ca(()=>this._hide(),2e3)),this._isVisible=!1,this._editor=e,this._state=t,this._keybindingService=i,this._domNode=document.createElement("div"),this._domNode.className="findOptionsWidget",this._domNode.style.display="none",this._domNode.style.top="10px",this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")
let s=n.getTheme().getColor(vc)
this.caseSensitive=this._register(new FC({appendTitle:this._keybindingLabelFor(ib.ToggleCaseSensitiveCommand),isChecked:this._state.matchCase,onChange:e=>{this._state.change({matchCase:this.caseSensitive.checked},!1)},inputActiveOptionBorder:s})),this._domNode.appendChild(this.caseSensitive.domNode),this.wholeWords=this._register(new WC({appendTitle:this._keybindingLabelFor(ib.ToggleWholeWordCommand),isChecked:this._state.wholeWord,onChange:e=>{this._state.change({wholeWord:this.wholeWords.checked},!1)},inputActiveOptionBorder:s})),this._domNode.appendChild(this.wholeWords.domNode),this.regex=this._register(new VC({appendTitle:this._keybindingLabelFor(ib.ToggleRegexCommand),isChecked:this._state.isRegex,onChange:e=>{this._state.change({isRegex:this.regex.checked},!1)},inputActiveOptionBorder:s})),this._domNode.appendChild(this.regex.domNode),this._editor.addOverlayWidget(this),this._register(this._state.addChangeListener(e=>{let t=!1
e.isRegex&&(this.regex.checked=this._state.isRegex,t=!0),e.wholeWord&&(this.wholeWords.checked=this._state.wholeWord,t=!0),e.matchCase&&(this.caseSensitive.checked=this._state.matchCase,t=!0),!this._state.isRevealed&&t&&this._revealTemporarily()})),this._register(sl(this._domNode,e=>this._onMouseOut())),this._register(il(this._domNode,"mouseover",e=>this._onMouseOver())),this._applyTheme(n.getTheme()),this._register(n.onThemeChange(this._applyTheme.bind(this)))}_keybindingLabelFor(e){let t=this._keybindingService.lookupKeybinding(e)
return t?` (${t.getLabel()})`:""}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return Ub.ID}getDomNode(){return this._domNode}getPosition(){return{preference:_m.TOP_RIGHT_CORNER}}highlightFindOptions(){this._revealTemporarily()}_revealTemporarily(){this._show(),this._hideSoon.schedule()}_onMouseOut(){this._hideSoon.schedule()}_onMouseOver(){this._hideSoon.cancel()}_show(){this._isVisible||(this._isVisible=!0,this._domNode.style.display="block")}_hide(){this._isVisible&&(this._isVisible=!1,this._domNode.style.display="none")}_applyTheme(e){let t={inputActiveOptionBorder:e.getColor(vc)}
this.caseSensitive.style(t),this.wholeWords.style(t),this.regex.style(t)}}Ub.ID="editor.contrib.findOptionsWidget",Wg((e,t)=>{let i=e.getColor(tg)
i&&t.addRule(`.monaco-editor .findOptionsWidget { background-color: ${i}; }`)
let n=e.getColor(_c)
n&&t.addRule(`.monaco-editor .findOptionsWidget { box-shadow: 0 2px 8px ${n}; }`)
let s=e.getColor(gc)
s&&t.addRule(`.monaco-editor .findOptionsWidget { border: 2px solid ${s}; }`)})
let Kb=class extends mb{constructor(e,t,i,n,s,r){super(e,i,r),this._widget=this._register(new Bb(e,this,this._state,t,n,i,s)),this._findOptionsWidget=this._register(new Ub(e,this._state,n,s))}_start(e){super._start(e),2===e.shouldFocus?this._widget.focusReplaceInput():1===e.shouldFocus&&this._widget.focusFindInput()}highlightFindOptions(){this._state.isRevealed?this._widget.highlightFindOptions():this._findOptionsWidget.highlightFindOptions()}}
Kb=Nn([iC,En(1,X_),En(2,Lo),En(3,tC),En(4,Mg),En(5,zu)],Kb)
class $b extends Error{constructor(e){super(),this.name=$b.Name,this.message=e}}function qb(e,t,i){const n=Ks.ordered(e)
if(0===n.length)return bt.wrapError(new $b)
let s
return pa(n.map(n=>{if(Tn(s))return()=>ca(s=>n.provideDocumentRangeFormattingEdits(e,t,i,s)).then(e=>{s=e},yt)})).then(()=>s)}function Gb(e,t){const i=Us.ordered(e)
if(0===i.length)return qb(e,e.getFullModelRange(),t)
let n
return pa(i.map(i=>{if(Tn(n))return()=>ca(n=>i.provideDocumentFormattingEdits(e,t,n)).then(e=>{n=e},yt)})).then(()=>n)}function jb(e,t,i,n){const[s]=$s.ordered(e)
return s?s.autoFormatTriggerCharacters.indexOf(i)<0?bt.as(void 0):ca(r=>s.provideOnTypeFormattingEdits(e,t,i,n,r)).then(e=>e,yt):bt.as(void 0)}$b.Name="NOPRO",No.registerLanguageCommand("_executeFormatRangeProvider",function(e,i){const{resource:n,range:s,options:r}=i
if(!(n instanceof X&&t.isIRange(s)))throw Et()
const o=e.get(Zr).getModel(n)
if(!o)throw Et("resource")
return qb(o,t.lift(s),r)}),No.registerLanguageCommand("_executeFormatDocumentProvider",function(e,t){const{resource:i,options:n}=t
if(!(i instanceof X))throw Et("resource")
const s=e.get(Zr).getModel(i)
if(!s)throw Et("resource")
return Gb(s,n)}),No.registerDefaultLanguageCommand("_executeFormatOnTypeProvider",function(e,t,i){const{ch:n,options:s}=i
if("string"!=typeof n)throw Et("ch")
return jb(e,t,n,s)})
class Yb{static execute(e,t){const i=new Yb(t,e.getSelection())
"number"==typeof i._newEol&&e.getModel().setEOL(i._newEol),e.pushUndoStop(),e.executeCommand("formatEditsCommand",i),e.pushUndoStop()}constructor(e,t){this._initialSelection=t,this._edits=[],this._newEol=void 0
for(let t of e)"number"==typeof t.eol&&(this._newEol=t.eol),t.range&&"string"==typeof t.text&&this._edits.push(t)}getEditOperations(e,i){for(let n of this._edits){null!==Yb.trimEdit(n,e)&&i.addEditOperation(t.lift(n.range),n.text)}var n=!1
Array.isArray(this._edits)&&1===this._edits.length&&this._initialSelection.isEmpty()&&(this._edits[0].range.startColumn===this._initialSelection.endColumn&&this._edits[0].range.startLineNumber===this._initialSelection.endLineNumber?(n=!0,this._selectionId=i.trackSelection(this._initialSelection,!0)):this._edits[0].range.endColumn===this._initialSelection.startColumn&&this._edits[0].range.endLineNumber===this._initialSelection.startLineNumber&&(n=!0,this._selectionId=i.trackSelection(this._initialSelection,!1))),n||(this._selectionId=i.trackSelection(this._initialSelection))}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}static fixLineTerminators(e,t){e.text=e.text.replace(/\r\n|\r|\n/g,t.getEOL())}static trimEdit(e,t){return this.fixLineTerminators(e,t),this._trimEdit(t.validateRange(e.range),e.text,e.forceMoveMarkers,t)}static _trimEdit(e,i,n,s){let r=s.getValueInRange(e),o=Pe(i,r)
if(o===r.length&&o===i.length)return null
if(o>0){let n=s.modifyPosition(e.getStartPosition(),o)
e=new t(n.lineNumber,n.column,e.endLineNumber,e.endColumn),i=i.substring(o),r=r.substr(o)}let a=Fe(i,r)
if(a>0){let n=s.modifyPosition(e.getEndPosition(),-a)
e=new t(e.startLineNumber,e.startColumn,n.lineNumber,n.column),i=i.substring(0,i.length-a),r=r.substring(0,r.length-a)}return{text:i,range:e,forceMoveMarkers:n}}}var Zb,Xb,Jb=Ir("editorWorkerService")
class Qb{constructor(e,t){if(this.flags=t,0!=(1&this.flags)){var i=e.getModel()
this.modelVersionId=i?he("{0}#{1}",i.uri.toString(),i.getVersionId()):null}0!=(4&this.flags)&&(this.position=e.getPosition()),0!=(2&this.flags)&&(this.selection=e.getSelection()),0!=(8&this.flags)&&(this.scrollLeft=e.getScrollLeft(),this.scrollTop=e.getScrollTop())}_equals(e){if(!(e instanceof Qb))return!1
var t=e
return this.modelVersionId===t.modelVersionId&&(this.scrollLeft===t.scrollLeft&&this.scrollTop===t.scrollTop&&(!(!this.position&&t.position||this.position&&!t.position||this.position&&t.position&&!this.position.equals(t.position))&&!(!this.selection&&t.selection||this.selection&&!t.selection||this.selection&&t.selection&&!this.selection.equalsRange(t.selection))))}validate(e){return this._equals(new Qb(e,this.flags))}}(Xb=Zb||(Zb={}))[Xb.Ignore=0]="Ignore",Xb[Xb.Info=1]="Info",Xb[Xb.Warning=2]="Warning",Xb[Xb.Error=3]="Error",function(e){const t="error",i="warning",n="warn",s="info",r=Object.create(null)
r[e.Error]=Jt("sev.error","Error"),r[e.Warning]=Jt("sev.warning","Warning"),r[e.Info]=Jt("sev.info","Info"),e.fromValue=function(r){return r?Oe(t,r)?e.Error:Oe(i,r)||Oe(n,r)?e.Warning:Oe(s,r)?e.Info:e.Ignore:e.Ignore},e.toString=function(e){return r[e]||ae},e.compare=function(e,t){return t-e}}(Zb||(Zb={}))
var ew=Zb
new Jr("close.message",Jt("close","Close"),null,!0,()=>bt.as(!0)),new Jr("later.message",Jt("later","Later"),null,!0,()=>bt.as(!0)),new Jr("cancel.message",Jt("cancel","Cancel"),null,!0,()=>bt.as(!0))
const tw=Ir("messageService")
Ir("choiceService")
function iw(e){if(!(e=e.filter(e=>e.range)).length)return
let{range:i}=e[0]
for(let n=1;n<e.length;n++)i=t.plusRange(i,e[n].range)
const{startLineNumber:n,endLineNumber:s}=i
n===s?1===e.length?vC(Jt("hint11","Made 1 formatting edit on line {0}",n)):vC(Jt("hintn1","Made {0} formatting edits on line {1}",e.length,n)):1===e.length?vC(Jt("hint1n","Made 1 formatting edit between lines {0} and {1}",n,s)):vC(Jt("hintnn","Made {0} formatting edits between lines {1} and {2}",e.length,n,s))}let nw=ow=class{constructor(e,t){this.editor=e,this.workerService=t,this.callOnDispose=[],this.callOnModel=[],this.callOnDispose.push(e.onDidChangeConfiguration(()=>this.update())),this.callOnDispose.push(e.onDidChangeModel(()=>this.update())),this.callOnDispose.push(e.onDidChangeModelLanguage(()=>this.update())),this.callOnDispose.push($s.onDidChange(this.update,this))}update(){if(this.callOnModel=ei(this.callOnModel),!this.editor.getConfiguration().contribInfo.formatOnType)return
if(!this.editor.getModel())return
var e=this.editor.getModel(),[t]=$s.ordered(e)
if(!t||!t.autoFormatTriggerCharacters)return
let i=new en
for(let e of t.autoFormatTriggerCharacters)i.add(e.charCodeAt(0))
this.callOnModel.push(this.editor.onDidType(e=>{let t=e.charCodeAt(e.length-1)
i.has(t)&&this.trigger(String.fromCharCode(t))}))}trigger(e){if(this.editor.getSelections().length>1)return
var t=this.editor.getModel(),i=this.editor.getPosition(),n=!1,s=this.editor.onDidChangeModelContent(e=>{if(e.isFlush)return n=!0,void s.dispose()
for(let t=0,r=e.changes.length;t<r;t++){if(e.changes[t].range.endLineNumber<=i.lineNumber)return n=!0,void s.dispose()}})
let r=t.getOptions()
jb(t,i,e,{tabSize:r.tabSize,insertSpaces:r.insertSpaces}).then(e=>this.workerService.computeMoreMinimalEdits(t.uri,e)).then(e=>{s.dispose(),n||Tn(e)||(Yb.execute(this.editor,e),iw(e))},e=>{throw s.dispose(),e})}getId(){return ow.ID}dispose(){this.callOnDispose=ei(this.callOnDispose),this.callOnModel=ei(this.callOnModel)}}
nw.ID="editor.contrib.autoFormat",nw=ow=Nn([Po,En(1,Jb)],nw)
let sw=aw=class{constructor(e,t){this.editor=e,this.workerService=t,this.callOnDispose=[],this.callOnModel=[],this.callOnDispose.push(e.onDidChangeConfiguration(()=>this.update())),this.callOnDispose.push(e.onDidChangeModel(()=>this.update())),this.callOnDispose.push(e.onDidChangeModelLanguage(()=>this.update())),this.callOnDispose.push(Ks.onDidChange(this.update,this))}update(){if(this.callOnModel=ei(this.callOnModel),!this.editor.getConfiguration().contribInfo.formatOnPaste)return
if(!this.editor.getModel())return
let e=this.editor.getModel(),[t]=Ks.ordered(e)
t&&t.provideDocumentRangeFormattingEdits&&this.callOnModel.push(this.editor.onDidPaste(e=>{this.trigger(e)}))}trigger(e){if(this.editor.getSelections().length>1)return
const t=this.editor.getModel(),{tabSize:i,insertSpaces:n}=t.getOptions(),s=new Qb(this.editor,5)
qb(t,e,{tabSize:i,insertSpaces:n}).then(e=>this.workerService.computeMoreMinimalEdits(t.uri,e)).then(e=>{s.validate(this.editor)&&!Tn(e)&&(Yb.execute(this.editor,e),iw(e))})}getId(){return aw.ID}dispose(){this.callOnDispose=ei(this.callOnDispose),this.callOnModel=ei(this.callOnModel)}}
sw.ID="editor.contrib.formatOnPaste",sw=aw=Nn([Po,En(1,Jb)],sw)
class rw extends To{run(e,t){const i=e.get(Jb),n=e.get(tw),s=this._getFormattingEdits(t)
if(!s)return bt.as(void 0)
const r=new Qb(t,5)
return s.then(e=>i.computeMoreMinimalEdits(t.getModel().uri,e)).then(e=>{r.validate(t)&&!Tn(e)&&(Yb.execute(t,e),iw(e),t.focus())},e=>{if(!(e instanceof Error&&e.name===$b.Name))throw e
n.show(ew.Info,Jt("no.provider","Sorry, but there is no formatter for '{0}'-files installed.",t.getModel().getLanguageIdentifier().language))})}}Oo(class extends rw{constructor(){super({id:"editor.action.formatDocument",label:Jt("formatDocument.label","Format Document"),alias:"Format Document",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:1572,linux:{primary:3111}},menuOpts:{when:Vo.hasDocumentFormattingProvider,group:"1_modification",order:1.3}})}_getFormattingEdits(e){const t=e.getModel(),{tabSize:i,insertSpaces:n}=t.getOptions()
return Gb(t,{tabSize:i,insertSpaces:n})}})
var ow,aw
function lw(e,t,i,n){const s=i.ordered(e).map((i,s)=>ca(s=>n(i,e,t,s)).then(void 0,e=>(yt(e),null)))
return r=s,bt.join(r).then(e=>{let t=[]
for(let i of e)Array.isArray(i)?t.push(...i):i&&t.push(i)
return t})
var r}function hw(e,t){return lw(e,t,Ws,(e,t,i,n)=>e.provideDefinition(t,i,n))}function dw(e,t){return lw(e,t,Vs,(e,t,i,n)=>e.provideImplementation(t,i,n))}function uw(e,t){return lw(e,t,Bs,(e,t,i,n)=>e.provideTypeDefinition(t,i,n))}Oo(class extends rw{constructor(){super({id:"editor.action.formatSelection",label:Jt("formatSelection.label","Format Selection"),alias:"Format Code",precondition:_o.and(Vo.writable,Vo.hasNonEmptySelection),kbOpts:{kbExpr:Vo.textFocus,primary:Wr(2089,2084)},menuOpts:{when:_o.and(Vo.hasDocumentSelectionFormattingProvider,Vo.hasNonEmptySelection),group:"1_modification",order:1.31}})}_getFormattingEdits(e){const t=e.getModel(),{tabSize:i,insertSpaces:n}=t.getOptions()
return qb(t,e.getSelection(),{tabSize:i,insertSpaces:n})}}),Tr.registerCommand("editor.action.format",e=>{const t=e.get(Eo).getFocusedCodeEditor()
if(t)return(new class extends rw{constructor(){super({})}_getFormattingEdits(e){const t=e.getModel(),i=e.getSelection(),{tabSize:n,insertSpaces:s}=t.getOptions()
return i.isEmpty()?Gb(t,{tabSize:n,insertSpaces:s}):qb(t,i,{tabSize:n,insertSpaces:s})}}).run(e,t)}),No.registerDefaultLanguageCommand("_executeDefinitionProvider",hw),No.registerDefaultLanguageCommand("_executeImplementationProvider",dw),No.registerDefaultLanguageCommand("_executeTypeDefinitionProvider",uw)
const cw=Ir("telemetryService"),gw=Ir("configurationService")
var mw,pw
function fw(e,t,i,n){const s=t.split("."),r=s.pop()
let o=e
for(let e=0;e<s.length;e++){let i=s[e],r=o[i]
switch(typeof r){case"undefined":r=o[i]=Object.create(null)
break
case"object":break
default:return void n(`Ignoring ${t} as ${s.slice(0,e+1).join(".")} is ${JSON.stringify(r)}`)}o=r}"object"==typeof o?o[r]=i:n(`Ignoring ${t} as ${s.join(".")} is ${JSON.stringify(o)}`)}function _w(e,t){!function e(t,i){const n=i.shift()
if(0===i.length)return void delete t[n]
if(-1!==Object.keys(t).indexOf(n)){const s=t[n]
"object"!=typeof s||Array.isArray(s)||(e(s,i),0===Object.keys(s).length&&delete t[n])}}(e,t.split("."))}function Cw(e,t,i){const n=function(e,t){let i=e
for(let e=0;e<t.length;e++){if("object"!=typeof i||null===i)return
i=i[t[e]]}return i}(e,t.split("."))
return void 0===n?i:n}function bw(e,t,i){Object.keys(t).forEach(n=>{n in e?ot(e[n])&&ot(t[n])?bw(e[n],t[n],i):i&&(e[n]=t[n]):e[n]=t[n]})}(pw=mw||(mw={}))[pw.USER=1]="USER",pw[pw.WORKSPACE=2]="WORKSPACE",pw[pw.WORKSPACE_FOLDER=3]="WORKSPACE_FOLDER",pw[pw.DEFAULT=4]="DEFAULT",pw[pw.MEMORY=5]="MEMORY"
const ww=Ir("fileService")
var vw,Sw,yw,xw,Lw,Nw,Ew,kw;(Sw=vw||(vw={}))[Sw.File=0]="File",Sw[Sw.Dir=1]="Dir",Sw[Sw.Symlink=2]="Symlink",(xw=yw||(yw={}))[xw.CREATE=0]="CREATE",xw[xw.DELETE=1]="DELETE",xw[xw.MOVE=2]="MOVE",xw[xw.COPY=3]="COPY",xw[xw.IMPORT=4]="IMPORT",(Nw=Lw||(Lw={}))[Nw.UPDATED=0]="UPDATED",Nw[Nw.ADDED=1]="ADDED",Nw[Nw.DELETED=2]="DELETED",(kw=Ew||(Ew={}))[kw.FILE_IS_BINARY=0]="FILE_IS_BINARY",kw[kw.FILE_IS_DIRECTORY=1]="FILE_IS_DIRECTORY",kw[kw.FILE_NOT_FOUND=2]="FILE_NOT_FOUND",kw[kw.FILE_NOT_MODIFIED_SINCE=3]="FILE_NOT_MODIFIED_SINCE",kw[kw.FILE_MODIFIED_SINCE=4]="FILE_MODIFIED_SINCE",kw[kw.FILE_MOVE_CONFLICT=5]="FILE_MOVE_CONFLICT",kw[kw.FILE_READ_ONLY=6]="FILE_READ_ONLY",kw[kw.FILE_TOO_LARGE=7]="FILE_TOO_LARGE",kw[kw.FILE_INVALID_PATH=8]="FILE_INVALID_PATH"
const Iw=314572800
"object"==typeof process&&process.arch
var Mw,Dw,Tw,Ow
function Rw(e,t,i){if(!e)return null
if("string"==typeof e&&(e=X.file(e)),"file"!==e.scheme&&"untitled"!==e.scheme)return e.authority+e.path
const n=t?t.getWorkspaceFolder(e):null
if(n){const i=t.getWorkspace().folders.length>1
let s
if(s=function(e,t,i){const n=e===t
return!i||n?n:!(!e||!t)&&Oe(e,t)}(n.uri.fsPath,e.fsPath,!I)?"":Yn(ge(e.fsPath.substr(n.uri.fsPath.length),Kn),!0),i){const e=qn(n.uri.fsPath)
s=s?Xn(e,s):e}return s}if(Aw(e.fsPath))return Yn(function(e){if(Aw(e))return e.charAt(0).toUpperCase()+e.slice(1)
return e}(e.fsPath),!0)
let s=Yn(e.fsPath,!0)
return!E&&i&&(s=function(e,t){e&&(k||I)&&Jn(e,t,!I)&&(e=`~${e.substr(t.length)}`)
return e}(s,i.userHome)),s}function Aw(e){return E&&e&&":"===e[1]}(Dw=Mw||(Mw={}))[Dw.FILE=0]="FILE",Dw[Dw.FOLDER=1]="FOLDER",Dw[Dw.ROOT_FOLDER=2]="ROOT_FOLDER",(Ow=Tw||(Tw={}))[Ow.TEXT=0]="TEXT",Ow[Ow.VARIABLE=1]="VARIABLE",Ow[Ow.SEPARATOR=2]="SEPARATOR"
Ir("workspacesMainService"),Ir("workspacesService"),Jt("codeWorkspace","Code Workspace")
const Pw=Ir("contextService")
var Fw,Ww;(Ww=Fw||(Fw={}))[Ww.EMPTY=1]="EMPTY",Ww[Ww.FOLDER=2]="FOLDER",Ww[Ww.WORKSPACE=3]="WORKSPACE"
class Vw{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toResource(e){return this.uri.with({path:Xn(this.uri.path,e)})}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}const Bw={badgeBackground:Td.fromHex("#4D4D4D"),badgeForeground:Td.fromHex("#FFFFFF")}
function Hw(e){return de(e).replace(/\$\(((.+?)(~(.*?))?)\)/g,(e,t,i,n,s)=>`<span class="octicon octicon-${i} ${s?`octicon-animation-${s}`:""}"></span>`)}class zw{constructor(e){this.domNode=document.createElement("span"),this.domNode.className="monaco-highlighted-label",this.didEverRender=!1,e.appendChild(this.domNode)}get element(){return this.domNode}set(e,t=[]){e||(e=""),this.didEverRender&&this.text===e&&Hn(this.highlights,t)||(Array.isArray(t)||(t=[]),this.text=e,this.highlights=t,this.render())}render(){Ga(this.domNode)
let e,t=[],i=0
for(let n=0;n<this.highlights.length;n++)(e=this.highlights[n]).end!==e.start&&(i<e.start&&(t.push("<span>"),t.push(Hw(this.text.substring(i,e.start))),t.push("</span>"),i=e.end),t.push('<span class="highlight">'),t.push(Hw(this.text.substring(e.start,e.end))),t.push("</span>"),i=e.end)
i<this.text.length&&(t.push("<span>"),t.push(Hw(this.text.substring(i))),t.push("</span>")),this.domNode.innerHTML=t.join(""),this.didEverRender=!0}dispose(){this.text=null,this.highlights=null}}class Uw{constructor(e){this._element=e}get element(){return this._element}set textContent(e){this.disposed||e===this._textContent||(this._textContent=e,this._element.textContent=e)}set className(e){this.disposed||e===this._className||(this._className=e,this._element.className=e)}set title(e){this.disposed||e===this._title||(this._title=e,this._element.title=e)}set empty(e){this.disposed||e===this._empty||(this._empty=e,this._element.style.marginLeft=e?"0":null)}dispose(){this.disposed=!0}}class Kw{constructor(e,t){this.domNode=new Uw(Tl(e,Al(".monaco-icon-label")))
const i=new Uw(Tl(this.domNode.element,Al(".monaco-icon-label-description-container")))
t&&t.supportHighlights?this.labelNode=new zw(Tl(i.element,Al("a.label-name"))):this.labelNode=new Uw(Tl(i.element,Al("a.label-name"))),this.descriptionNode=new Uw(Tl(i.element,Al("span.label-description")))}get element(){return this.domNode.element}onClick(e){return ti([il(this.labelElement,kl.CLICK,t=>e(t)),il(this.descriptionNode.element,kl.CLICK,t=>e(t))])}get labelElement(){const e=this.labelNode
return e.element}setValue(e,t,i){const n=["monaco-icon-label"]
i&&(i.extraClasses&&n.push(...i.extraClasses),i.italic&&n.push("italic")),this.domNode.className=n.join(" "),this.domNode.title=i&&i.title?i.title:""
const s=this.labelNode
s instanceof zw?s.set(e||"",i?i.matches:void 0):s.textContent=e||"",this.descriptionNode.textContent=t||"",this.descriptionNode.empty=!t}dispose(){this.domNode.dispose(),this.labelNode.dispose(),this.descriptionNode.dispose()}}var $w,qw;(qw=$w||($w={}))[qw.ON_MOUSE_DOWN=0]="ON_MOUSE_DOWN",qw[qw.ON_MOUSE_UP=1]="ON_MOUSE_UP"
class Gw{constructor(){this._arr=[]}set(e,t){this._arr.push({keybinding:Vr(e,W),callback:t})}dispatch(e){for(let t=this._arr.length-1;t>=0;t--){let i=this._arr[t]
if(e.equals(i.keybinding))return i.callback}return null}}class jw{constructor(e={clickBehavior:$w.ON_MOUSE_UP,keyboardSupport:!0}){this.options=e,this.downKeyBindingDispatcher=new Gw,this.upKeyBindingDispatcher=new Gw,("boolean"!=typeof e.keyboardSupport||e.keyboardSupport)&&(this.downKeyBindingDispatcher.set(16,(e,t)=>this.onUp(e,t)),this.downKeyBindingDispatcher.set(18,(e,t)=>this.onDown(e,t)),this.downKeyBindingDispatcher.set(15,(e,t)=>this.onLeft(e,t)),this.downKeyBindingDispatcher.set(17,(e,t)=>this.onRight(e,t)),k&&(this.downKeyBindingDispatcher.set(2064,(e,t)=>this.onLeft(e,t)),this.downKeyBindingDispatcher.set(300,(e,t)=>this.onDown(e,t)),this.downKeyBindingDispatcher.set(302,(e,t)=>this.onUp(e,t))),this.downKeyBindingDispatcher.set(11,(e,t)=>this.onPageUp(e,t)),this.downKeyBindingDispatcher.set(12,(e,t)=>this.onPageDown(e,t)),this.downKeyBindingDispatcher.set(14,(e,t)=>this.onHome(e,t)),this.downKeyBindingDispatcher.set(13,(e,t)=>this.onEnd(e,t)),this.downKeyBindingDispatcher.set(10,(e,t)=>this.onSpace(e,t)),this.downKeyBindingDispatcher.set(9,(e,t)=>this.onEscape(e,t)),this.upKeyBindingDispatcher.set(3,this.onEnter.bind(this)),this.upKeyBindingDispatcher.set(2051,this.onEnter.bind(this)))}onMouseDown(e,t,i,n="mouse"){if(this.options.clickBehavior===$w.ON_MOUSE_DOWN&&(i.leftButton||i.middleButton)){if(i.target){if(i.target.tagName&&"input"===i.target.tagName.toLowerCase())return!1
if(function(e,t,i){for(;e;){if(Xa(e,t))return e
if(i&&Xa(e,i))return null
e=e.parentNode}return null}(i.target,"monaco-action-bar","row"))return!1}return this.onLeftClick(e,t,i,n)}return!1}onClick(e,t,i){return k&&i.ctrlKey?(i.preventDefault(),i.stopPropagation(),!1):(!i.target||!i.target.tagName||"input"!==i.target.tagName.toLowerCase())&&((this.options.clickBehavior!==$w.ON_MOUSE_DOWN||!i.leftButton&&!i.middleButton)&&this.onLeftClick(e,t,i))}onLeftClick(e,t,i,n="mouse"){const s={origin:n,originalEvent:i}
e.getInput()===t?(e.clearFocus(s),e.clearSelection(s)):(i&&i.browserEvent&&"mousedown"===i.browserEvent.type||i.preventDefault(),i.stopPropagation(),e.DOMFocus(),e.setSelection([t],s),e.setFocus(t,s),e.isExpanded(t)?e.collapse(t).done(null,St):e.expand(t).done(null,St))
return!0}onContextMenu(e,t,i){return(!i.target||!i.target.tagName||"input"!==i.target.tagName.toLowerCase())&&(i&&(i.preventDefault(),i.stopPropagation()),!1)}onTap(e,t,i){const n=i.initialTarget
return(!n||!n.tagName||"input"!==n.tagName.toLowerCase())&&this.onLeftClick(e,t,i,"touch")}onKeyDown(e,t){return this.onKey(this.downKeyBindingDispatcher,e,t)}onKeyUp(e,t){return this.onKey(this.upKeyBindingDispatcher,e,t)}onKey(e,t,i){const n=e.dispatch(i.toKeybinding())
return!(!n||!n(t,i))&&(i.preventDefault(),i.stopPropagation(),!0)}onUp(e,t){const i={origin:"keyboard",originalEvent:t}
return e.getHighlight()?e.clearHighlight(i):(e.focusPrevious(1,i),e.reveal(e.getFocus()).done(null,St)),!0}onPageUp(e,t){const i={origin:"keyboard",originalEvent:t}
return e.getHighlight()?e.clearHighlight(i):(e.focusPreviousPage(i),e.reveal(e.getFocus()).done(null,St)),!0}onDown(e,t){const i={origin:"keyboard",originalEvent:t}
return e.getHighlight()?e.clearHighlight(i):(e.focusNext(1,i),e.reveal(e.getFocus()).done(null,St)),!0}onPageDown(e,t){const i={origin:"keyboard",originalEvent:t}
return e.getHighlight()?e.clearHighlight(i):(e.focusNextPage(i),e.reveal(e.getFocus()).done(null,St)),!0}onHome(e,t){const i={origin:"keyboard",originalEvent:t}
return e.getHighlight()?e.clearHighlight(i):(e.focusFirst(i),e.reveal(e.getFocus()).done(null,St)),!0}onEnd(e,t){const i={origin:"keyboard",originalEvent:t}
return e.getHighlight()?e.clearHighlight(i):(e.focusLast(i),e.reveal(e.getFocus()).done(null,St)),!0}onLeft(e,t){const i={origin:"keyboard",originalEvent:t}
if(e.getHighlight())e.clearHighlight(i)
else{const t=e.getFocus()
e.collapse(t).then(n=>{if(t&&!n)return e.focusParent(i),e.reveal(e.getFocus())}).done(null,St)}return!0}onRight(e,t){const i={origin:"keyboard",originalEvent:t}
if(e.getHighlight())e.clearHighlight(i)
else{const t=e.getFocus()
e.expand(t).then(n=>{if(t&&!n)return e.focusFirstChild(i),e.reveal(e.getFocus())}).done(null,St)}return!0}onEnter(e,t){const i={origin:"keyboard",originalEvent:t}
if(e.getHighlight())return!1
const n=e.getFocus()
return n&&e.setSelection([n],i),!0}onSpace(e,t){if(e.getHighlight())return!1
const i=e.getFocus()
return i&&e.toggleExpansion(i),!0}onEscape(e,t){const i={origin:"keyboard",originalEvent:t}
return e.getHighlight()?(e.clearHighlight(i),!0):e.getSelection().length?(e.clearSelection(i),!0):!!e.getFocus()&&(e.clearFocus(i),!0)}}class Yw{getDragURI(e,t){return null}onDragStart(e,t,i){}onDragOver(e,t,i,n){return null}drop(e,t,i,n){}}class Zw{isVisible(e,t){return!0}}class Xw{getAriaLabel(e,t){return null}}class Jw extends It{constructor(e){super(),this._item=e}get item(){return this._item}dispose(){this.emit("unlock"),super.dispose()}}class Qw{constructor(){this.locks=Object.create({})}isLocked(e){return!!this.locks[e.id]}run(e,t){var i,n,s=this.getLock(e)
return s?new bt((n,r)=>{i=s.addOneTimeListener("unlock",()=>this.run(e,t).then(n,r))},()=>{i.dispose()}):new bt((i,s)=>{if(e.isDisposed())return s(new Error("Item is disposed."))
var r=this.locks[e.id]=new Jw(e)
return n=t().then(t=>(delete this.locks[e.id],r.dispose(),t)).then(i,s)},()=>n.cancel())}getLock(e){var t
for(t in this.locks){var i=this.locks[t]
if(e.intersects(i.item))return i}return null}}class ev extends It{constructor(){super(),this._isDisposed=!1,this.items={}}register(e){$r(!this.isRegistered(e.id),"item already registered: "+e.id),this.items[e.id]={item:e,disposable:this.addEmitter(e)}}deregister(e){$r(this.isRegistered(e.id),"item not registered: "+e.id),this.items[e.id].disposable.dispose(),delete this.items[e.id]}isRegistered(e){return this.items.hasOwnProperty(e)}getItem(e){const t=this.items[e]
return t?t.item:null}dispose(){super.dispose(),this.items=null,this._isDisposed=!0}isDisposed(){return this._isDisposed}}class tv extends It{constructor(e,t,i,n,s){super(),this.registry=t,this.context=i,this.lock=n,this.element=s,this.id=e,this.registry.register(this),this.doesHaveChildren=this.context.dataSource.hasChildren(this.context.tree,this.element),this.needsChildrenRefresh=!0,this.parent=null,this.previous=null,this.next=null,this.firstChild=null,this.lastChild=null,this.userContent=null,this.traits={},this.depth=0,this.expanded=this.context.dataSource.shouldAutoexpand&&this.context.dataSource.shouldAutoexpand(this.context.tree,s),this.emit("item:create",{item:this}),this.visible=this._isVisible(),this.height=this._getHeight(),this._isDisposed=!1}getElement(){return this.element}hasChildren(){return this.doesHaveChildren}getDepth(){return this.depth}isVisible(){return this.visible}setVisible(e){this.visible=e}isExpanded(){return this.expanded}_setExpanded(e){this.expanded=e}reveal(e=null){var t={item:this,relativeTop:e}
this.emit("item:reveal",t)}expand(){return this.isExpanded()||!this.doesHaveChildren||this.lock.isLocked(this)?bt.as(!1):this.lock.run(this,()=>{var e={item:this}
return this.emit("item:expanding",e),(this.needsChildrenRefresh?this.refreshChildren(!1,!0,!0):bt.as(null)).then(()=>(this._setExpanded(!0),this.emit("item:expanded",e),!0))}).then(e=>!this.isDisposed()&&(this.context.options.autoExpandSingleChildren&&e&&null!==this.firstChild&&this.firstChild===this.lastChild&&this.firstChild.isVisible()?this.firstChild.expand().then(()=>!0):e))}collapse(e=!1){if(e){var t=bt.as(null)
return this.forEachChild(e=>{t=t.then(()=>e.collapse(!0))}),t.then(()=>this.collapse(!1))}return!this.isExpanded()||this.lock.isLocked(this)?bt.as(!1):this.lock.run(this,()=>{var e={item:this}
return this.emit("item:collapsing",e),this._setExpanded(!1),this.emit("item:collapsed",e),bt.as(!0)})}addTrait(e){var t={item:this,trait:e}
this.traits[e]=!0,this.emit("item:addTrait",t)}removeTrait(e){var t={item:this,trait:e}
delete this.traits[e],this.emit("item:removeTrait",t)}hasTrait(e){return this.traits[e]||!1}getAllTraits(){var e,t=[]
for(e in this.traits)this.traits.hasOwnProperty(e)&&this.traits[e]&&t.push(e)
return t}getHeight(){return this.height}refreshChildren(e,t=!1,i=!1){if(!i&&!this.isExpanded())return this.needsChildrenRefresh=!0,bt.as(this)
this.needsChildrenRefresh=!1
var n=()=>{var i={item:this,isNested:t}
return this.emit("item:childrenRefreshing",i),(this.doesHaveChildren?this.context.dataSource.getChildren(this.context.tree,this.element):bt.as([])).then(t=>{if(this.isDisposed()||this.registry.isDisposed())return bt.as(null)
if(!Array.isArray(t))return bt.wrapError(new Error("Please return an array of children."))
t=t?t.slice(0):[],t=this.sort(t)
for(var i={};null!==this.firstChild;)i[this.firstChild.id]=this.firstChild,this.removeChild(this.firstChild)
for(var n=0,s=t.length;n<s;n++){var r=t[n],o=this.context.dataSource.getId(this.context.tree,r),a=i[o]||new tv(o,this.registry,this.context,this.lock,r)
a.element=r,e&&(a.needsChildrenRefresh=e),delete i[o],this.addChild(a)}for(var l in i)i.hasOwnProperty(l)&&i[l].dispose()
return e?Ct.join(this.mapEachChild(t=>t.doRefresh(e,!0))):bt.as(null)}).then(null,St).then(()=>this.emit("item:childrenRefreshed",i))}
return t?n():this.lock.run(this,n)}doRefresh(e,t=!1){var i={item:this}
return this.doesHaveChildren=this.context.dataSource.hasChildren(this.context.tree,this.element),this.height=this._getHeight(),this.setVisible(this._isVisible()),this.emit("item:refresh",i),this.refreshChildren(e,t)}refresh(e){return this.doRefresh(e)}getNavigator(){return new nv(this)}intersects(e){return this.isAncestorOf(e)||e.isAncestorOf(this)}getHierarchy(){var e=[],t=this
do{e.push(t),t=t.parent}while(t)
return e.reverse(),e}isAncestorOf(e){for(;e;){if(e.id===this.id)return!0
e=e.parent}return!1}addChild(e,t=this.lastChild){var i=null===this.firstChild,n=null===t,s=t===this.lastChild
i?(this.firstChild=this.lastChild=e,e.next=e.previous=null):n?(this.firstChild.previous=e,e.next=this.firstChild,e.previous=null,this.firstChild=e):s?(this.lastChild.next=e,e.next=null,e.previous=this.lastChild,this.lastChild=e):(e.previous=t,e.next=t.next,t.next.previous=e,t.next=e),e.parent=this,e.depth=this.depth+1}removeChild(e){var t=this.firstChild===e,i=this.lastChild===e
t&&i?this.firstChild=this.lastChild=null:t?(e.next.previous=null,this.firstChild=e.next):i?(e.previous.next=null,this.lastChild=e.previous):(e.next.previous=e.previous,e.previous.next=e.next),e.parent=null,e.depth=null}forEachChild(e){for(var t,i=this.firstChild;i;)t=i.next,e(i),i=t}mapEachChild(e){var t=[]
return this.forEachChild(i=>{t.push(e(i))}),t}sort(e){return this.context.sorter?e.sort((e,t)=>this.context.sorter.compare(this.context.tree,e,t)):e}_getHeight(){return this.context.renderer.getHeight(this.context.tree,this.element)}_isVisible(){return this.context.filter.isVisible(this.context.tree,this.element)}isDisposed(){return this._isDisposed}dispose(){this.forEachChild(e=>e.dispose()),this.parent=null,this.previous=null,this.next=null,this.firstChild=null,this.lastChild=null
var e={item:this}
this.emit("item:dispose",e),this.registry.deregister(this),super.dispose(),this._isDisposed=!0}}class iv extends tv{constructor(e,t,i,n,s){super(e,t,i,n,s)}isVisible(){return!1}setVisible(e){}isExpanded(){return!0}_setExpanded(e){}render(){}_getHeight(){return 0}_isVisible(){return!1}}class nv{static lastDescendantOf(e){return e?e instanceof iv||e.isVisible()&&e.isExpanded()&&null!==e.lastChild?nv.lastDescendantOf(e.lastChild):e:null}constructor(e,t=!0){this.item=e,this.start=t?e:null}current(){return this.item||null}next(){if(this.item)do{if((this.item instanceof iv||this.item.isVisible()&&this.item.isExpanded())&&this.item.firstChild)this.item=this.item.firstChild
else if(this.item===this.start)this.item=null
else{for(;this.item&&this.item!==this.start&&!this.item.next;)this.item=this.item.parent
this.item===this.start&&(this.item=null),this.item=this.item?this.item.next:null}}while(this.item&&!this.item.isVisible())
return this.item||null}previous(){if(this.item)do{var e=nv.lastDescendantOf(this.item.previous)
e?this.item=e:this.item.parent&&this.item.parent!==this.start&&this.item.parent.isVisible()?this.item=this.item.parent:this.item=null}while(this.item&&!this.item.isVisible())
return this.item||null}parent(){if(this.item){var e=this.item.parent
e&&e!==this.start&&e.isVisible()?this.item=e:this.item=null}return this.item||null}first(){return this.item=this.start,this.next(),this.item||null}last(){return nv.lastDescendantOf(this.start)}}function sv(e,t){for(var i=e.getHierarchy(),n=i[function(e,t,i=((e,t)=>e===t)){let n=0
for(let s=0,r=Math.min(e.length,t.length);s<r&&i(e[s],t[s]);s++)n++
return n}(i,t.getHierarchy())-1],s=n.getNavigator(),r=null,o=null,a=0,l=[];n&&(null===r||null===o);)l.push(n),n===e&&(r=a),n===t&&(o=a),a++,n=s.next()
if(null===r||null===o)return[]
var h=Math.min(r,o),d=Math.max(r,o)
return l.slice(h,d+1)}class rv extends It{constructor(e){super(),this.context=e,this.input=null,this.traitsToItems={}}setInput(e){var t={item:this.input}
this.emit("clearingInput",t),this.setSelection([]),this.setFocus(),this.setHighlight(),this.lock=new Qw,this.input&&this.input.dispose(),this.registry&&(this.registry.dispose(),this.registryDisposable.dispose()),this.registry=new ev,this.registryDisposable=ti([this.addEmitter(this.registry),this.registry.addListener("item:dispose",e=>{e.item.getAllTraits().forEach(t=>delete this.traitsToItems[t][e.item.id])})])
var i=this.context.dataSource.getId(this.context.tree,e)
return this.input=new iv(i,this.registry,this.context,this.lock,e),t={item:this.input},this.emit("setInput",t),this.refresh(this.input)}getInput(){return this.input?this.input.getElement():null}refresh(e=null,t=!0){var i=this.getItem(e)
if(!i)return bt.as(null)
var n={item:i,recursive:t}
return this.emit("refreshing",n),i.refresh(t).then(()=>{this.emit("refreshed",n)})}expand(e){var t=this.getItem(e)
return t?t.expand():bt.as(!1)}expandAll(e){if(!e){var t
e=[]
for(var i=this.getNavigator();t=i.next();)e.push(t)}for(var n=[],s=0,r=e.length;s<r;s++)n.push(this.expand(e[s]))
return Ct.join(n)}collapse(e,t=!1){var i=this.getItem(e)
return i?i.collapse(t):bt.as(!1)}collapseAll(e=null,t=!1){e||(e=[this.input],t=!0)
for(var i=[],n=0,s=e.length;n<s;n++)i.push(this.collapse(e[n],t))
return Ct.join(i)}toggleExpansion(e,t=!1){return this.isExpanded(e)?this.collapse(e,t):this.expand(e)}toggleExpansionAll(e){for(var t=[],i=0,n=e.length;i<n;i++)t.push(this.toggleExpansion(e[i]))
return Ct.join(t)}isExpanded(e){var t=this.getItem(e)
return!!t&&t.isExpanded()}getExpandedElements(){for(var e,t=[],i=this.getNavigator();e=i.next();)e.isExpanded()&&t.push(e.getElement())
return t}reveal(e,t=null){return this.resolveUnknownParentChain(e).then(e=>{var t=bt.as(null)
return e.forEach(e=>{t=t.then(()=>this.expand(e))}),t}).then(()=>{var i=this.getItem(e)
if(i)return i.reveal(t)})}resolveUnknownParentChain(e){return this.context.dataSource.getParent(this.context.tree,e).then(e=>e?this.resolveUnknownParentChain(e).then(t=>(t.push(e),t)):bt.as([]))}setHighlight(e,t){this.setTraits("highlighted",e?[e]:[])
var i={highlight:this.getHighlight(),payload:t}
this.emit("highlight",i)}getHighlight(e){var t=this.getElementsWithTrait("highlighted",e)
return 0===t.length?null:t[0]}isHighlighted(e){var t=this.getItem(e)
return!!t&&t.hasTrait("highlighted")}select(e,t){this.selectAll([e],t)}selectRange(e,t,i){var n=this.getItem(e),s=this.getItem(t)
n&&s&&this.selectAll(sv(n,s),i)}deselectRange(e,t,i){var n=this.getItem(e),s=this.getItem(t)
n&&s&&this.deselectAll(sv(n,s),i)}selectAll(e,t){this.addTraits("selected",e)
var i={selection:this.getSelection(),payload:t}
this.emit("selection",i)}deselect(e,t){this.deselectAll([e],t)}deselectAll(e,t){this.removeTraits("selected",e)
var i={selection:this.getSelection(),payload:t}
this.emit("selection",i)}setSelection(e,t){this.setTraits("selected",e)
var i={selection:this.getSelection(),payload:t}
this.emit("selection",i)}toggleSelection(e,t){this.toggleTrait("selected",e)
var i={selection:this.getSelection(),payload:t}
this.emit("selection",i)}isSelected(e){var t=this.getItem(e)
return!!t&&t.hasTrait("selected")}getSelection(e){return this.getElementsWithTrait("selected",e)}selectNext(e=1,t=!0,i){for(var n,s=this.getSelection(),r=s.length>0?s[0]:this.input,o=this.getNavigator(r,!1),a=0;a<e&&(n=o.next());a++)r=n
t?this.setSelection([r],i):this.select(r,i)}selectPrevious(e=1,t=!0,i){var n=this.getSelection(),s=null,r=null
if(0===n.length){for(var o=this.getNavigator(this.input);s=o.next();)r=s
s=r}else{s=n[0]
o=this.getNavigator(s,!1)
for(var a=0;a<e&&(r=o.previous());a++)s=r}t?this.setSelection([s],i):this.select(s,i)}selectParent(e,t=!0){var i=this.getSelection(),n=i.length>0?i[0]:this.input,s=this.getNavigator(n,!1).parent()
s&&(t?this.setSelection([s],e):this.select(s,e))}setFocus(e,t){this.setTraits("focused",e?[e]:[])
var i={focus:this.getFocus(),payload:t}
this.emit("focus",i)}isFocused(e){var t=this.getItem(e)
return!!t&&t.hasTrait("focused")}getFocus(e){var t=this.getElementsWithTrait("focused",e)
return 0===t.length?null:t[0]}focusNext(e=1,t){for(var i,n=this.getFocus()||this.input,s=this.getNavigator(n,!1),r=0;r<e&&(i=s.next());r++)n=i
this.setFocus(n,t)}focusPrevious(e=1,t){for(var i,n=this.getFocus()||this.input,s=this.getNavigator(n,!1),r=0;r<e&&(i=s.previous());r++)n=i
this.setFocus(n,t)}focusParent(e){var t=this.getFocus()||this.input,i=this.getNavigator(t,!1).parent()
i&&this.setFocus(i,e)}focusFirstChild(e){const t=this.getItem(this.getFocus()||this.input),i=this.getNavigator(t,!1),n=i.next()
i.parent()===t&&this.setFocus(n,e)}focusFirst(e,t){this.focusNth(0,e,t)}focusNth(e,t,i){for(var n=this.getParent(i),s=this.getNavigator(n),r=s.first(),o=0;o<e;o++)r=s.next()
r&&this.setFocus(r,t)}focusLast(e,t){var i,n=this.getParent(t)
t?i=n.lastChild:i=this.getNavigator(n).last()
i&&this.setFocus(i,e)}getParent(e){if(e){var t=this.getItem(e)
if(t&&t.parent)return t.parent}return this.getItem(this.input)}getNavigator(e=null,t=!0){return new nv(this.getItem(e),t)}getItem(e=null){return null===e?this.input:e instanceof tv?e:"string"==typeof e?this.registry.getItem(e):this.registry.getItem(this.context.dataSource.getId(this.context.tree,e))}addTraits(e,t){for(var i,n=this.traitsToItems[e]||{},s=0,r=t.length;s<r;s++)(i=this.getItem(t[s]))&&(i.addTrait(e),n[i.id]=i)
this.traitsToItems[e]=n}removeTraits(e,t){var i,n,s=this.traitsToItems[e]||{}
if(0===t.length){for(n in s)s.hasOwnProperty(n)&&(i=s[n]).removeTrait(e)
delete this.traitsToItems[e]}else for(var r=0,o=t.length;r<o;r++)(i=this.getItem(t[r]))&&(i.removeTrait(e),delete s[i.id])}hasTrait(e,t){var i=this.getItem(t)
return i&&i.hasTrait(e)}toggleTrait(e,t){var i=this.getItem(t)
i&&(i.hasTrait(e)?this.removeTraits(e,[t]):this.addTraits(e,[t]))}setTraits(e,t){if(0===t.length)this.removeTraits(e,t)
else{for(var i,n={},s=0,r=t.length;s<r;s++)(i=this.getItem(t[s]))&&(n[i.id]=i)
var o,a=this.traitsToItems[e]||{},l=[]
for(o in a)a.hasOwnProperty(o)&&(n.hasOwnProperty(o)?delete n[o]:l.push(a[o]))
for(s=0,r=l.length;s<r;s++)(i=l[s]).removeTrait(e),delete a[i.id]
for(o in n)n.hasOwnProperty(o)&&((i=n[o]).addTrait(e),a[o]=i)
this.traitsToItems[e]=a}}getElementsWithTrait(e,t){var i,n=[],s=this.traitsToItems[e]||{}
for(i in s)s.hasOwnProperty(i)&&(s[i].isVisible()||t)&&n.push(s[i].getElement())
return n}dispose(){this.registry&&(this.registry.dispose(),this.registry=null),super.dispose()}}const ov={Add:0,Remove:1,Change:2}
class av{constructor(e,t,i,n){this.originalStart=e,this.originalLength=t,this.modifiedStart=i,this.modifiedLength=n}getChangeType(){return 0===this.originalLength?ov.Add:0===this.modifiedLength?ov.Remove:ov.Change}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}function lv(e){return{getLength:()=>e.length,getElementHash:t=>e[t]}}class hv{static Assert(e,t){if(!e)throw new Error(t)}}class dv{static Copy(e,t,i,n,s){for(let r=0;r<s;r++)i[n+r]=e[t+r]}}let uv=1447
class cv{constructor(){this.m_changes=[],this.m_originalStart=Number.MAX_VALUE,this.m_modifiedStart=Number.MAX_VALUE,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new av(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=Number.MAX_VALUE,this.m_modifiedStart=Number.MAX_VALUE}AddOriginalElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_originalCount++}AddModifiedElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}const gv=Object.prototype.hasOwnProperty
class mv{constructor(e,t,i=null){this.OriginalSequence=e,this.ModifiedSequence=t,this.ContinueProcessingPredicate=i,this.m_originalIds=[],this.m_modifiedIds=[],this.m_forwardHistory=[],this.m_reverseHistory=[],this.ComputeUniqueIdentifiers()}ComputeUniqueIdentifiers(){let e=this.OriginalSequence.getLength(),t=this.ModifiedSequence.getLength()
this.m_originalIds=new Array(e),this.m_modifiedIds=new Array(t)
let i,n={},s=1
for(i=0;i<e;i++){let e=this.OriginalSequence.getElementHash(i)
gv.call(n,e)?this.m_originalIds[i]=n[e]:(this.m_originalIds[i]=s++,n[e]=this.m_originalIds[i])}for(i=0;i<t;i++){let e=this.ModifiedSequence.getElementHash(i)
gv.call(n,e)?this.m_modifiedIds[i]=n[e]:(this.m_modifiedIds[i]=s++,n[e]=this.m_modifiedIds[i])}}ElementsAreEqual(e,t){return this.m_originalIds[e]===this.m_modifiedIds[t]}OriginalElementsAreEqual(e,t){return this.m_originalIds[e]===this.m_originalIds[t]}ModifiedElementsAreEqual(e,t){return this.m_modifiedIds[e]===this.m_modifiedIds[t]}ComputeDiff(e){return this._ComputeDiff(0,this.OriginalSequence.getLength()-1,0,this.ModifiedSequence.getLength()-1,e)}_ComputeDiff(e,t,i,n,s){let r=this.ComputeDiffRecursive(e,t,i,n,[!1])
return s?this.ShiftChanges(r):r}ComputeDiffRecursive(e,t,i,n,s){for(s[0]=!1;e<=t&&i<=n&&this.ElementsAreEqual(e,i);)e++,i++
for(;t>=e&&n>=i&&this.ElementsAreEqual(t,n);)t--,n--
let r
if(e>t||i>n)return i<=n?(hv.Assert(e===t+1,"originalStart should only be one more than originalEnd"),r=[new av(e,0,i,n-i+1)]):e<=t?(hv.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),r=[new av(e,t-e+1,i,0)]):(hv.Assert(e===t+1,"originalStart should only be one more than originalEnd"),hv.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),r=[]),r
let o=[0],a=[0],l=this.ComputeRecursionPoint(e,t,i,n,o,a,s),h=o[0],d=a[0]
if(null!==l)return l
if(!s[0]){let r=this.ComputeDiffRecursive(e,h,i,d,s),o=[]
return o=s[0]?[new av(h+1,t-(h+1)+1,d+1,n-(d+1)+1)]:this.ComputeDiffRecursive(h+1,t,d+1,n,s),this.ConcatenateChanges(r,o)}return[new av(e,t-e+1,i,n-i+1)]}WALKTRACE(e,t,i,n,s,r,o,a,l,h,d,u,c,g,m,p,f,_){let C,b=null,w=null,v=new cv,S=t,y=i,x=c[0]-p[0]-n,L=Number.MIN_VALUE,N=this.m_forwardHistory.length-1
do{(C=x+e)===S||C<y&&l[C-1]<l[C+1]?(g=(d=l[C+1])-x-n,d<L&&v.MarkNextChange(),L=d,v.AddModifiedElement(d+1,g),x=C+1-e):(g=(d=l[C-1]+1)-x-n,d<L&&v.MarkNextChange(),L=d-1,v.AddOriginalElement(d,g+1),x=C-1-e),N>=0&&(e=(l=this.m_forwardHistory[N])[0],S=1,y=l.length-1)}while(--N>=-1)
if(b=v.getReverseChanges(),_[0]){let e=c[0]+1,t=p[0]+1
if(null!==b&&b.length>0){let i=b[b.length-1]
e=Math.max(e,i.getOriginalEnd()),t=Math.max(t,i.getModifiedEnd())}w=[new av(e,u-e+1,t,m-t+1)]}else{v=new cv,S=r,y=o,x=c[0]-p[0]-a,L=Number.MAX_VALUE,N=f?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2
do{(C=x+s)===S||C<y&&h[C-1]>=h[C+1]?(g=(d=h[C+1]-1)-x-a,d>L&&v.MarkNextChange(),L=d+1,v.AddOriginalElement(d+1,g+1),x=C+1-s):(g=(d=h[C-1])-x-a,d>L&&v.MarkNextChange(),L=d,v.AddModifiedElement(d+1,g+1),x=C-1-s),N>=0&&(s=(h=this.m_reverseHistory[N])[0],S=1,y=h.length-1)}while(--N>=-1)
w=v.getChanges()}return this.ConcatenateChanges(b,w)}ComputeRecursionPoint(e,t,i,n,s,r,o){let a,l,h,d=0,u=0,c=0,g=0
e--,i--,s[0]=0,r[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[]
let m,p,f=t-e+(n-i),_=f+1,C=new Array(_),b=new Array(_),w=n-i,v=t-e,S=e-i,y=t-n,x=(v-w)%2==0
for(C[w]=e,b[v]=t,o[0]=!1,h=1;h<=f/2+1;h++){let f=0,L=0
for(d=this.ClipDiagonalBound(w-h,h,w,_),u=this.ClipDiagonalBound(w+h,h,w,_),m=d;m<=u;m+=2){for(l=(a=m===d||m<u&&C[m-1]<C[m+1]?C[m+1]:C[m-1]+1)-(m-w)-S,p=a;a<t&&l<n&&this.ElementsAreEqual(a+1,l+1);)a++,l++
if(C[m]=a,a+l>f+L&&(f=a,L=l),!x&&Math.abs(m-v)<=h-1&&a>=b[m])return s[0]=a,r[0]=l,p<=b[m]&&uv>0&&h<=uv+1?this.WALKTRACE(w,d,u,S,v,c,g,y,C,b,a,t,s,l,n,r,x,o):null}let N=(f-e+(L-i)-h)/2
if(null!==this.ContinueProcessingPredicate&&!this.ContinueProcessingPredicate(f,this.OriginalSequence,N))return o[0]=!0,s[0]=f,r[0]=L,N>0&&uv>0&&h<=uv+1?this.WALKTRACE(w,d,u,S,v,c,g,y,C,b,a,t,s,l,n,r,x,o):[new av(++e,t-e+1,++i,n-i+1)]
for(c=this.ClipDiagonalBound(v-h,h,v,_),g=this.ClipDiagonalBound(v+h,h,v,_),m=c;m<=g;m+=2){for(l=(a=m===c||m<g&&b[m-1]>=b[m+1]?b[m+1]-1:b[m-1])-(m-v)-y,p=a;a>e&&l>i&&this.ElementsAreEqual(a,l);)a--,l--
if(b[m]=a,x&&Math.abs(m-w)<=h&&a<=C[m])return s[0]=a,r[0]=l,p>=C[m]&&uv>0&&h<=uv+1?this.WALKTRACE(w,d,u,S,v,c,g,y,C,b,a,t,s,l,n,r,x,o):null}if(h<=uv){let e=new Array(u-d+2)
e[0]=w-d+1,dv.Copy(C,d,e,1,u-d+1),this.m_forwardHistory.push(e),(e=new Array(g-c+2))[0]=v-c+1,dv.Copy(b,c,e,1,g-c+1),this.m_reverseHistory.push(e)}}return this.WALKTRACE(w,d,u,S,v,c,g,y,C,b,a,t,s,l,n,r,x,o)}ShiftChanges(e){let t
do{t=!1
for(let t=0;t<e.length;t++){const i=e[t],n=t<e.length-1?e[t+1].originalStart:this.OriginalSequence.getLength(),s=t<e.length-1?e[t+1].modifiedStart:this.ModifiedSequence.getLength(),r=i.originalLength>0,o=i.modifiedLength>0
for(;i.originalStart+i.originalLength<n&&i.modifiedStart+i.modifiedLength<s&&(!r||this.OriginalElementsAreEqual(i.originalStart,i.originalStart+i.originalLength))&&(!o||this.ModifiedElementsAreEqual(i.modifiedStart,i.modifiedStart+i.modifiedLength));)i.originalStart++,i.modifiedStart++}let i=new Array,n=[null]
for(let s=0;s<e.length;s++)s<e.length-1&&this.ChangesOverlap(e[s],e[s+1],n)?(t=!0,i.push(n[0]),s++):i.push(e[s])
e=i}while(t)
for(let t=e.length-1;t>=0;t--){const i=e[t]
let n=0,s=0
if(t>0){const i=e[t-1]
i.originalLength>0&&(n=i.originalStart+i.originalLength),i.modifiedLength>0&&(s=i.modifiedStart+i.modifiedLength)}const r=i.originalLength>0,o=i.modifiedLength>0
let a=0,l=this._boundaryScore(i.originalStart,i.originalLength,i.modifiedStart,i.modifiedLength)
for(let e=1;;e++){let t=i.originalStart-e,h=i.modifiedStart-e
if(t<n||h<s)break
if(r&&!this.OriginalElementsAreEqual(t,t+i.originalLength))break
if(o&&!this.ModifiedElementsAreEqual(h,h+i.modifiedLength))break
let d=this._boundaryScore(t,i.originalLength,h,i.modifiedLength)
d>l&&(l=d,a=e)}i.originalStart-=a,i.modifiedStart-=a}return e}_OriginalIsBoundary(e){return e<=0||e>=this.OriginalSequence.getLength()-1||/^\s*$/.test(this.OriginalSequence.getElementHash(e))}_OriginalRegionIsBoundary(e,t){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0
if(t>0){let i=e+t
if(this._OriginalIsBoundary(i-1)||this._OriginalIsBoundary(i))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this.ModifiedSequence.getLength()-1||/^\s*$/.test(this.ModifiedSequence.getElementHash(e))}_ModifiedRegionIsBoundary(e,t){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0
if(t>0){let i=e+t
if(this._ModifiedIsBoundary(i-1)||this._ModifiedIsBoundary(i))return!0}return!1}_boundaryScore(e,t,i,n){return(this._OriginalRegionIsBoundary(e,t)?1:0)+(this._ModifiedRegionIsBoundary(i,n)?1:0)}ConcatenateChanges(e,t){let i=[],n=null
return 0===e.length||0===t.length?t.length>0?t:e:this.ChangesOverlap(e[e.length-1],t[0],i)?(n=new Array(e.length+t.length-1),dv.Copy(e,0,n,0,e.length-1),n[e.length-1]=i[0],dv.Copy(t,1,n,e.length,t.length-1),n):(n=new Array(e.length+t.length),dv.Copy(e,0,n,0,e.length),dv.Copy(t,0,n,e.length,t.length),n)}ChangesOverlap(e,t,i){if(hv.Assert(e.originalStart<=t.originalStart,"Left change is not less than or equal to right change"),hv.Assert(e.modifiedStart<=t.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=t.originalStart||e.modifiedStart+e.modifiedLength>=t.modifiedStart){let n=e.originalStart,s=e.originalLength,r=e.modifiedStart,o=e.modifiedLength
return e.originalStart+e.originalLength>=t.originalStart&&(s=t.originalStart+t.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=t.modifiedStart&&(o=t.modifiedStart+t.modifiedLength-e.modifiedStart),i[0]=new av(n,s,r,o),!0}return i[0]=null,!1}ClipDiagonalBound(e,t,i,n){if(e>=0&&e<n)return e
let s=n-i-1,r=t%2==0
if(e<0)return r===(i%2==0)?0:1
return r===(s%2==0)?n-1:n-2}}class pv{constructor(e){this.elements=e}update(e){}getData(){return this.elements}}class fv{constructor(e){this.elements=e}update(e){}getData(){return this.elements}}class _v{constructor(){this.types=[],this.files=[]}update(e){e.dataTransfer.types&&(this.types=[],Array.prototype.push.apply(this.types,e.dataTransfer.types)),e.dataTransfer.files&&(this.files=[],Array.prototype.push.apply(this.files,e.dataTransfer.files),this.files=this.files.filter(e=>e.size||e.type))}getData(){return{types:this.types,files:this.files}}}class Cv extends It{constructor(){super(),this.heightMap=[],this.indexes={}}getTotalHeight(){var e=this.heightMap[this.heightMap.length-1]
return e?e.top+e.height:0}onInsertItems(e,t=null){var i,n,s,r,o,a=0
if(null===t)s=0,o=0
else{if(s=this.indexes[t]+1,!(n=this.heightMap[s-1]))return void console.error("view item doesnt exist")
o=n.top+n.height}for(var l=this.heightMap.splice.bind(this.heightMap,s,0),h=[];i=e.next();)(n=this.createViewItem(i)).top=o+a,this.emit("viewItem:create",{item:n.model}),this.indexes[i.id]=s++,h.push(n),a+=n.height
for(l.apply(this.heightMap,h),r=s;r<this.heightMap.length;r++)(n=this.heightMap[r]).top+=a,this.indexes[n.model.id]=r
for(r=h.length-1;r>=0;r--)this.onInsertItem(h[r])
for(r=this.heightMap.length-1;r>=s;r--)this.onRefreshItem(this.heightMap[r])
return a}onInsertItem(e){}onRemoveItems(e){for(var t,i,n,s=null,r=0;t=e.next();){if(n=this.indexes[t],!(i=this.heightMap[n]))return void console.error("view item doesnt exist")
r-=i.height,delete this.indexes[t],this.onRemoveItem(i),null===s&&(s=n)}if(0!==r)for(this.heightMap.splice(s,n-s+1),n=s;n<this.heightMap.length;n++)(i=this.heightMap[n]).top+=r,this.indexes[i.model.id]=n,this.onRefreshItem(i)}onRemoveItem(e){}onRefreshItemSet(e){var t=e.sort((e,t)=>this.indexes[e.id]-this.indexes[t.id])
this.onRefreshItems(new rb(t))}onRefreshItems(e){for(var t,i,n,s,r=null,o=0;t=e.next();){for(s=this.indexes[t.id];0!==o&&null!==r&&r<s;r++)(i=this.heightMap[r]).top+=o,this.onRefreshItem(i)
i=this.heightMap[s],n=t.getHeight(),i.top+=o,o+=n-i.height,i.height=n,this.onRefreshItem(i,!0),r=s+1}if(0!==o&&null!==r)for(;r<this.heightMap.length;r++)(i=this.heightMap[r]).top+=o,this.onRefreshItem(i)}onRefreshItem(e,t=!1){}itemsCount(){return this.heightMap.length}itemAt(e){return this.heightMap[this.indexAt(e)].model.id}withItemsInRange(e,t,i){e=this.indexAt(e),t=this.indexAt(t)
for(var n=e;n<=t;n++)i(this.heightMap[n].model.id)}indexAt(e){for(var t,i,n=0,s=this.heightMap.length;n<s;)if(t=Math.floor((n+s)/2),e<(i=this.heightMap[t]).top)s=t
else{if(!(e>=i.top+i.height))return t
if(n===t)break
n=t}return this.heightMap.length}indexAfter(e){return Math.min(this.indexAt(e)+1,this.heightMap.length)}itemAtIndex(e){return this.heightMap[e]}itemAfter(e){return this.heightMap[this.indexes[e.model.id]+1]||null}createViewItem(e){throw new Error("not implemented")}dispose(){this.heightMap=null,this.indexes=null}}class bv{constructor(e,t,i){this._posx=e,this._posy=t,this._target=i}preventDefault(){}stopPropagation(){}get posx(){return this._posx}get posy(){return this._posy}get target(){return this._target}}class wv extends bv{constructor(e){super(e.posx,e.posy,e.target),this.originalEvent=e}preventDefault(){this.originalEvent.preventDefault()}stopPropagation(){this.originalEvent.stopPropagation()}}class vv extends bv{constructor(e,t,i){super(e,t,i.target),this.originalEvent=i}preventDefault(){this.originalEvent.preventDefault()}stopPropagation(){this.originalEvent.stopPropagation()}}var Sv,yv,xv,Lv;(yv=Sv||(Sv={}))[yv.COPY=0]="COPY",yv[yv.MOVE=1]="MOVE",(Lv=xv||(xv={}))[Lv.BUBBLE_DOWN=0]="BUBBLE_DOWN",Lv[Lv.BUBBLE_UP=1]="BUBBLE_UP"
xv.BUBBLE_UP,xv.BUBBLE_UP,Sv.COPY
class Nv{constructor(e){this.context=e,this._cache={"":[]}}alloc(e){var t=this.cache(e).pop()
if(!t){var i=document.createElement("div")
i.className="content"
var n=document.createElement("div")
n.appendChild(i),t={element:n,templateId:e,templateData:this.context.renderer.renderTemplate(this.context.tree,e,i)}}return t}release(e,t){!function(e){try{e.parentElement.removeChild(e)}catch(e){}}(t.element),this.cache(e).push(t)}cache(e){return this._cache[e]||(this._cache[e]=[])}garbageCollect(){this._cache&&Object.keys(this._cache).forEach(e=>{this._cache[e].forEach(t=>{this.context.renderer.disposeTemplate(this.context.tree,e,t.templateData),t.element=null,t.templateData=null}),delete this._cache[e]})}dispose(){this.garbageCollect(),this._cache=null,this.context=null}}class Ev{constructor(e,t){this.context=e,this.model=t,this.id=this.model.id,this.row=null,this.top=0,this.height=t.getHeight(),this._styles={},t.getAllTraits().forEach(e=>this._styles[e]=!0),t.isExpanded()&&this.addClass("expanded")}set expanded(e){e?this.addClass("expanded"):this.removeClass("expanded")}set loading(e){e?this.addClass("loading"):this.removeClass("loading")}set draggable(e){this._draggable=e,this.render(!0)}get draggable(){return this._draggable}set dropTarget(e){e?this.addClass("drop-target"):this.removeClass("drop-target")}get element(){return this.row&&this.row.element}get templateId(){return this._templateId||(this._templateId=this.context.renderer.getTemplateId&&this.context.renderer.getTemplateId(this.context.tree,this.model.getElement()))}addClass(e){this._styles[e]=!0,this.render(!0)}removeClass(e){delete this._styles[e],this.render(!0)}render(e=!1){if(!this.model||!this.element)return
var t=["monaco-tree-row"]
t.push.apply(t,Object.keys(this._styles)),this.model.hasChildren()&&t.push("has-children"),this.element.className=t.join(" "),this.element.draggable=this.draggable,this.element.style.height=this.height+"px",this.element.setAttribute("role","treeitem")
const i=this.context.accessibilityProvider,n=i.getAriaLabel(this.context.tree,this.model.getElement())
if(n&&this.element.setAttribute("aria-label",n),i.getPosInSet&&i.getSetSize&&(this.element.setAttribute("aria-setsize",i.getSetSize()),this.element.setAttribute("aria-posinset",i.getPosInSet(this.context.tree,this.model.getElement()))),this.model.hasTrait("focused")){const e=et(this.model.id)
this.element.setAttribute("aria-selected","true"),this.element.setAttribute("id",e)}else this.element.setAttribute("aria-selected","false"),this.element.removeAttribute("id")
this.model.hasChildren()?this.element.setAttribute("aria-expanded",String(!!this.model.isExpanded())):this.element.removeAttribute("aria-expanded"),this.element.setAttribute("aria-level",String(this.model.getDepth())),this.context.options.paddingOnRow?this.element.style.paddingLeft=this.context.options.twistiePixels+(this.model.getDepth()-1)*this.context.options.indentPixels+"px":(this.element.style.paddingLeft=(this.model.getDepth()-1)*this.context.options.indentPixels+"px",this.row.element.firstElementChild.style.paddingLeft=this.context.options.twistiePixels+"px")
var s=this.context.dnd.getDragURI(this.context.tree,this.model.getElement())
s!==this.uri&&(this.unbindDragStart&&(this.unbindDragStart.dispose(),this.unbindDragStart=null),s?(this.uri=s,this.draggable=!0,this.unbindDragStart=il(this.element,"dragstart",e=>{this.onDragStart(e)})):this.uri=null),e||this.context.renderer.renderElement(this.context.tree,this.model.getElement(),this.templateId,this.row.templateData)}insertInDOM(e,t){if(this.row||(this.row=this.context.cache.alloc(this.templateId),this.element[Iv.BINDING]=this),!this.element.parentElement){if(null===t)e.appendChild(this.element)
else try{e.insertBefore(this.element,t)}catch(t){console.warn("Failed to locate previous tree element"),e.appendChild(this.element)}this.render()}}removeFromDOM(){this.row&&(this.unbindDragStart&&(this.unbindDragStart.dispose(),this.unbindDragStart=null),this.uri=null,this.element[Iv.BINDING]=null,this.context.cache.release(this.templateId,this.row),this.row=null)}dispose(){this.row=null,this.model=null}}class kv extends Ev{constructor(e,t,i){super(e,t),this.row={element:i,templateData:null,templateId:null}}render(){if(this.model&&this.element){var e=["monaco-tree-wrapper"]
e.push.apply(e,Object.keys(this._styles)),this.model.hasChildren()&&e.push("has-children"),this.element.className=e.join(" ")}}insertInDOM(e,t){}removeFromDOM(){}}class Iv extends Cv{constructor(e,t){super(),this.lastClickTimeStamp=0,this.isRefreshing=!1,this.refreshingPreviousChildrenIds={},this._onDOMFocus=new ci,this._onDOMBlur=new ci,Iv.counter++,this.instance=Iv.counter,this.context={dataSource:e.dataSource,renderer:e.renderer,controller:e.controller,dnd:e.dnd,filter:e.filter,sorter:e.sorter,tree:e.tree,accessibilityProvider:e.accessibilityProvider,options:e.options,cache:new Nv(e)},this.modelListeners=[],this.viewListeners=[],this.dragAndDropListeners=[],this.model=null,this.items={},this.domNode=document.createElement("div"),this.domNode.className=`monaco-tree no-focused-item monaco-tree-instance-${this.instance}`,this.domNode.tabIndex=e.options.preventRootFocus?-1:0,this.styleElement=xl(this.domNode),this.domNode.setAttribute("role","tree"),this.context.options.ariaLabel&&this.domNode.setAttribute("aria-label",this.context.options.ariaLabel),this.context.options.alwaysFocused&&Ja(this.domNode,"focused"),this.context.options.paddingOnRow||Ja(this.domNode,"no-row-padding"),this.wrapper=document.createElement("div"),this.wrapper.className="monaco-tree-wrapper",this.scrollableElement=new Tf(this.wrapper,{alwaysConsumeMouseWheel:!0,horizontal:hi.Hidden,vertical:void 0!==e.options.verticalScrollMode?e.options.verticalScrollMode:hi.Auto,useShadows:e.options.useShadows}),this.scrollableElement.onScroll(e=>{this.render(e.scrollTop,e.height),this.emit("scroll",e)}),xa?(this.wrapper.style.msTouchAction="none",this.wrapper.style.msContentZooming="none"):this.wrapperGesture=new vm(this.wrapper),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-tree-rows",e.options.showTwistie&&(this.rowsContainer.className+=" show-twisties")
var i=Dl(this.domNode)
i.addFocusListener(()=>this.onFocus()),i.addBlurListener(()=>this.onBlur()),this.viewListeners.push(i),this.viewListeners.push(il(this.domNode,"keydown",e=>this.onKeyDown(e))),this.viewListeners.push(il(this.domNode,"keyup",e=>this.onKeyUp(e))),this.viewListeners.push(il(this.domNode,"mousedown",e=>this.onMouseDown(e))),this.viewListeners.push(il(this.domNode,"mouseup",e=>this.onMouseUp(e))),this.viewListeners.push(il(this.wrapper,"click",e=>this.onClick(e))),this.viewListeners.push(il(this.wrapper,"auxclick",e=>this.onClick(e))),this.viewListeners.push(il(this.domNode,"contextmenu",e=>this.onContextMenu(e))),this.viewListeners.push(il(this.wrapper,gm.Tap,e=>this.onTap(e))),this.viewListeners.push(il(this.wrapper,gm.Change,e=>this.onTouchChange(e))),xa&&(this.viewListeners.push(il(this.wrapper,"MSPointerDown",e=>this.onMsPointerDown(e))),this.viewListeners.push(il(this.wrapper,"MSGestureTap",e=>this.onMsGestureTap(e))),this.viewListeners.push(cl(this.wrapper,"MSGestureChange",e=>this.onThrottledMsGestureChange(e),(e,t)=>{t.stopPropagation(),t.preventDefault()
var i={translationY:t.translationY,translationX:t.translationX}
return e&&(i.translationY+=e.translationY,i.translationX+=e.translationX),i}))),this.viewListeners.push(il(window,"dragover",e=>this.onDragOver(e))),this.viewListeners.push(il(this.wrapper,"drop",e=>this.onDrop(e))),this.viewListeners.push(il(window,"dragend",e=>this.onDragEnd(e))),this.viewListeners.push(il(window,"dragleave",e=>this.onDragOver(e))),this.wrapper.appendChild(this.rowsContainer),this.domNode.appendChild(this.scrollableElement.getDomNode()),t.appendChild(this.domNode),this.lastRenderTop=0,this.lastRenderHeight=0,this.didJustPressContextMenuKey=!1,this.currentDropTarget=null,this.currentDropTargets=[],this.shouldInvalidateDropReaction=!1,this.dragAndDropScrollInterval=null,this.dragAndDropScrollTimeout=null,this.onHiddenScrollTop=null,this.onRowsChanged(),this.layout(),this.setupMSGesture(),this.applyStyles(e.options)}get onDOMFocus(){return this._onDOMFocus.event}get onDOMBlur(){return this._onDOMBlur.event}applyStyles(e){const t=[]
e.listFocusBackground&&t.push(`.monaco-tree.monaco-tree-instance-${this.instance}.focused .monaco-tree-rows > .monaco-tree-row.focused:not(.highlighted) { background-color: ${e.listFocusBackground}; }`),e.listFocusForeground&&t.push(`.monaco-tree.monaco-tree-instance-${this.instance}.focused .monaco-tree-rows > .monaco-tree-row.focused:not(.highlighted) { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&t.push(`.monaco-tree.monaco-tree-instance-${this.instance}.focused .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) { background-color: ${e.listActiveSelectionBackground}; }`),e.listActiveSelectionForeground&&t.push(`.monaco-tree.monaco-tree-instance-${this.instance}.focused .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) { color: ${e.listActiveSelectionForeground}; }`),e.listFocusAndSelectionBackground&&t.push(`\n\t\t\t\t.monaco-tree-drag-image,\n\t\t\t\t.monaco-tree.monaco-tree-instance-${this.instance}.focused .monaco-tree-rows > .monaco-tree-row.focused.selected:not(.highlighted) { background-color: ${e.listFocusAndSelectionBackground}; }\n\t\t\t`),e.listFocusAndSelectionForeground&&t.push(`\n\t\t\t\t.monaco-tree-drag-image,\n\t\t\t\t.monaco-tree.monaco-tree-instance-${this.instance}.focused .monaco-tree-rows > .monaco-tree-row.focused.selected:not(.highlighted) { color: ${e.listFocusAndSelectionForeground}; }\n\t\t\t`),e.listInactiveSelectionBackground&&t.push(`.monaco-tree.monaco-tree-instance-${this.instance} .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) { background-color: ${e.listInactiveSelectionBackground}; }`),e.listInactiveSelectionForeground&&t.push(`.monaco-tree.monaco-tree-instance-${this.instance} .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&t.push(`.monaco-tree.monaco-tree-instance-${this.instance} .monaco-tree-rows > .monaco-tree-row:hover:not(.highlighted):not(.selected):not(.focused) { background-color: ${e.listHoverBackground}; }`),e.listHoverForeground&&t.push(`.monaco-tree.monaco-tree-instance-${this.instance} .monaco-tree-rows > .monaco-tree-row:hover:not(.highlighted):not(.selected):not(.focused) { color: ${e.listHoverForeground}; }`),e.listDropBackground&&t.push(`\n\t\t\t\t.monaco-tree.monaco-tree-instance-${this.instance} .monaco-tree-wrapper.drop-target,\n\t\t\t\t.monaco-tree.monaco-tree-instance-${this.instance} .monaco-tree-rows > .monaco-tree-row.drop-target { background-color: ${e.listDropBackground} !important; color: inherit !important; }\n\t\t\t`),e.listFocusOutline&&t.push(`\n\t\t\t\t.monaco-tree-drag-image\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{ border: 1px solid ${e.listFocusOutline}; background: #000; }\n\t\t\t\t.monaco-tree.monaco-tree-instance-${this.instance} .monaco-tree-rows > .monaco-tree-row \t\t\t\t\t\t\t\t\t\t\t\t\t\t{ border: 1px solid transparent; }\n\t\t\t\t.monaco-tree.monaco-tree-instance-${this.instance}.focused .monaco-tree-rows > .monaco-tree-row.focused:not(.highlighted) \t\t\t\t\t\t{ border: 1px dotted ${e.listFocusOutline}; }\n\t\t\t\t.monaco-tree.monaco-tree-instance-${this.instance}.focused .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) \t\t\t\t\t\t{ border: 1px solid ${e.listFocusOutline}; }\n\t\t\t\t.monaco-tree.monaco-tree-instance-${this.instance} .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted)  \t\t\t\t\t\t\t{ border: 1px solid ${e.listFocusOutline}; }\n\t\t\t\t.monaco-tree.monaco-tree-instance-${this.instance} .monaco-tree-rows > .monaco-tree-row:hover:not(.highlighted):not(.selected):not(.focused)  \t{ border: 1px dashed ${e.listFocusOutline}; }\n\t\t\t\t.monaco-tree.monaco-tree-instance-${this.instance} .monaco-tree-wrapper.drop-target,\n\t\t\t\t.monaco-tree.monaco-tree-instance-${this.instance} .monaco-tree-rows > .monaco-tree-row.drop-target\t\t\t\t\t\t\t\t\t\t\t\t{ border: 1px dashed ${e.listFocusOutline}; }\n\t\t\t`),this.styleElement.innerHTML=t.join("\n")}createViewItem(e){return new Ev(this.context,e)}getHTMLElement(){return this.domNode}focus(){this.domNode.focus()}isFocused(){return document.activeElement===this.domNode}blur(){this.domNode.blur()}onVisible(){this.scrollTop=this.onHiddenScrollTop,this.onHiddenScrollTop=null,this.setupMSGesture()}setupMSGesture(){window.MSGesture&&(this.msGesture=new MSGesture,setTimeout(()=>this.msGesture.target=this.wrapper,100))}onHidden(){this.onHiddenScrollTop=this.scrollTop}isTreeVisible(){return null===this.onHiddenScrollTop}layout(e){this.isTreeVisible()&&(this.viewHeight=e||vl(this.wrapper))}render(e,t){var i,n,s=e,r=e+t,o=this.lastRenderTop+this.lastRenderHeight
for(i=this.indexAfter(r)-1,n=this.indexAt(Math.max(o,s));i>=n;i--)this.insertItemInDOM(this.itemAtIndex(i))
for(i=Math.min(this.indexAt(this.lastRenderTop),this.indexAfter(r))-1,n=this.indexAt(s);i>=n;i--)this.insertItemInDOM(this.itemAtIndex(i))
for(i=this.indexAt(this.lastRenderTop),n=Math.min(this.indexAt(s),this.indexAfter(o));i<n;i++)this.removeItemFromDOM(this.itemAtIndex(i))
for(i=Math.max(this.indexAfter(r),this.indexAt(this.lastRenderTop)),n=this.indexAfter(o);i<n;i++)this.removeItemFromDOM(this.itemAtIndex(i))
var a=this.itemAtIndex(this.indexAt(s))
a&&(this.rowsContainer.style.top=a.top-s+"px"),this.lastRenderTop=s,this.lastRenderHeight=r-s}setModel(e){this.releaseModel(),this.model=e,this.modelListeners.push(this.model.addBulkListener(e=>this.onModelEvents(e)))}onModelEvents(e){for(var t=[],i=0,n=e.length;i<n;i++){var s=e[i],r=s.data
switch(s.type){case"refreshing":this.onRefreshing()
break
case"refreshed":this.onRefreshed()
break
case"clearingInput":this.onClearingInput(r)
break
case"setInput":this.onSetInput(r)
break
case"item:childrenRefreshing":this.onItemChildrenRefreshing(r)
break
case"item:childrenRefreshed":this.onItemChildrenRefreshed(r)
break
case"item:refresh":t.push(r.item)
break
case"item:expanding":this.onItemExpanding(r)
break
case"item:expanded":this.onItemExpanded(r)
break
case"item:collapsing":this.onItemCollapsing(r)
break
case"item:reveal":this.onItemReveal(r)
break
case"item:addTrait":this.onItemAddTrait(r)
break
case"item:removeTrait":this.onItemRemoveTrait(r)
break
case"focus":this.onModelFocusChange()}}t.length>0&&this.onItemsRefresh(t)}onRefreshing(){this.isRefreshing=!0}onRefreshed(){this.isRefreshing=!1,this.onRowsChanged()}onRowsChanged(e=this.scrollTop){this.isRefreshing||(this.scrollTop=e)}focusNextPage(e){var t=this.indexAt(this.scrollTop+this.viewHeight)
t=0===t?0:t-1
var i=this.itemAtIndex(t).model.getElement()
if(this.model.getFocus()!==i)this.model.setFocus(i,e)
else{var n=this.scrollTop
this.scrollTop+=this.viewHeight,this.scrollTop!==n&&setTimeout(()=>{this.focusNextPage(e)},0)}}focusPreviousPage(e){var t
t=0===this.scrollTop?this.indexAt(this.scrollTop):this.indexAfter(this.scrollTop-1)
var i=this.itemAtIndex(t).model.getElement()
if(this.model.getFocus()!==i)this.model.setFocus(i,e)
else{var n=this.scrollTop
this.scrollTop-=this.viewHeight,this.scrollTop!==n&&setTimeout(()=>{this.focusPreviousPage(e)},0)}}get viewHeight(){return this.scrollableElement.getScrollDimensions().height}set viewHeight(e){this.scrollableElement.setScrollDimensions({height:e,scrollHeight:this.getTotalHeight()})}get scrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}set scrollTop(e){this.scrollableElement.setScrollDimensions({scrollHeight:this.getTotalHeight()}),this.scrollableElement.setScrollPosition({scrollTop:e})}getScrollPosition(){const e=this.getTotalHeight()-this.viewHeight
return e<=0?0:this.scrollTop/e}setScrollPosition(e){const t=this.getTotalHeight()-this.viewHeight
this.scrollTop=t*e}onClearingInput(e){var t=e.item
t&&(this.onRemoveItems(new ab(t.getNavigator(),e=>e&&e.id)),this.onRowsChanged())}onSetInput(e){this.context.cache.garbageCollect(),this.inputItem=new kv(this.context,e.item,this.wrapper),this.emit("viewItem:create",{item:this.inputItem.model})}onItemChildrenRefreshing(e){var t=e.item,i=this.items[t.id]
if(i&&(i.loadingTimer=setTimeout(()=>{i.loadingTimer=0,i.loading=!0},Iv.LOADING_DECORATION_DELAY)),!e.isNested){for(var n,s=[],r=t.getNavigator();n=r.next();)s.push(n.id)
this.refreshingPreviousChildrenIds[t.id]=s}}onItemChildrenRefreshed(e){var t=e.item,i=this.items[t.id]
if(i&&(i.loadingTimer&&(clearTimeout(i.loadingTimer),i.loadingTimer=0),i.loading=!1),!e.isNested){for(var n,s=this.refreshingPreviousChildrenIds[t.id],r=[],o=t.getNavigator();n=o.next();)r.push(n)
let e,i,a=Math.abs(s.length-r.length)>1e3
if(!a)i=(e=new mv({getLength:()=>s.length,getElementHash:e=>s[e]},{getLength:()=>r.length,getElementHash:e=>r[e].id},null).ComputeDiff(!1)).some(e=>{if(e.modifiedLength>0)for(var t=e.modifiedStart,i=e.modifiedStart+e.modifiedLength;t<i;t++)if(this.items.hasOwnProperty(r[t].id))return!0
return!1})
if(!a&&!i&&e.length<50)for(let i=0,n=e.length;i<n;i++){const n=e[i]
if(n.originalLength>0&&this.onRemoveItems(new rb(s,n.originalStart,n.originalStart+n.originalLength)),n.modifiedLength>0){let e=r[n.modifiedStart-1]||t
e=e.getDepth()>0?e:null,this.onInsertItems(new rb(r,n.modifiedStart,n.modifiedStart+n.modifiedLength),e?e.id:null)}}else(a||e.length)&&(this.onRemoveItems(new rb(s)),this.onInsertItems(new rb(r),t.getDepth()>0?t.id:null));(a||e.length)&&this.onRowsChanged()}}onItemsRefresh(e){this.onRefreshItemSet(e.filter(e=>this.items.hasOwnProperty(e.id))),this.onRowsChanged()}onItemExpanding(e){var t=this.items[e.item.id]
t&&(t.expanded=!0)}onItemExpanded(e){var t=e.item,i=this.items[t.id]
if(i){i.expanded=!0
var n=this.onInsertItems(t.getNavigator(),t.id),s=this.scrollTop
i.top+i.height<=this.scrollTop&&(s+=n),this.onRowsChanged(s)}}onItemCollapsing(e){var t=e.item,i=this.items[t.id]
i&&(i.expanded=!1,this.onRemoveItems(new ab(t.getNavigator(),e=>e&&e.id)),this.onRowsChanged())}getRelativeTop(e){if(e&&e.isVisible()){var t=this.items[e.id]
if(t)return(t.top-this.scrollTop)/(this.viewHeight-t.height)}return-1}onItemReveal(e){var t=e.item,i=e.relativeTop,n=this.items[t.id]
if(n)if(null!==i){i=(i=i<0?0:i)>1?1:i
var s=n.height-this.viewHeight
this.scrollTop=s*i+n.top}else{var r=n.top+n.height,o=this.scrollTop+this.viewHeight
n.top<this.scrollTop?this.scrollTop=n.top:r>=o&&(this.scrollTop=r-this.viewHeight)}}onItemAddTrait(e){var t=e.item,i=e.trait,n=this.items[t.id]
n&&n.addClass(i),"highlighted"===i&&(Ja(this.domNode,i),n&&(this.highlightedItemWasDraggable=!!n.draggable,n.draggable&&(n.draggable=!1)))}onItemRemoveTrait(e){var t=e.item,i=e.trait,n=this.items[t.id]
n&&n.removeClass(i),"highlighted"===i&&(Qa(this.domNode,i),this.highlightedItemWasDraggable&&(n.draggable=!0),this.highlightedItemWasDraggable=!1)}onModelFocusChange(){const e=this.model&&this.model.getFocus()
el(this.domNode,"no-focused-item",!e),e?this.domNode.setAttribute("aria-activedescendant",et(this.context.dataSource.getId(this.context.tree,e))):this.domNode.removeAttribute("aria-activedescendant")}onInsertItem(e){e.onDragStart=(t=>{this.onDragStart(e,t)}),e.needsRender=!0,this.refreshViewItem(e),this.items[e.id]=e}onRefreshItem(e,t=!1){e.needsRender=e.needsRender||t,this.refreshViewItem(e)}onRemoveItem(e){this.removeItemFromDOM(e),e.dispose(),this.emit("viewItem:dispose",{item:this.inputItem.model}),delete this.items[e.id]}refreshViewItem(e){e.render(),this.shouldBeRendered(e)?this.insertItemInDOM(e):this.removeItemFromDOM(e)}onClick(e){if(!this.lastPointerType||"mouse"===this.lastPointerType){var t=new Ka(e),i=this.getItemAround(t.target)
i&&(xa&&Date.now()-this.lastClickTimeStamp<300&&(t.detail=2),this.lastClickTimeStamp=Date.now(),this.context.controller.onClick(this.context.tree,i.model.getElement(),t))}}onMouseDown(e){if(this.didJustPressContextMenuKey=!1,this.context.controller.onMouseDown&&(!this.lastPointerType||"mouse"===this.lastPointerType)){var t=new Ka(e)
if(!(t.ctrlKey&&M&&k)){var i=this.getItemAround(t.target)
i&&this.context.controller.onMouseDown(this.context.tree,i.model.getElement(),t)}}}onMouseUp(e){if(this.context.controller.onMouseUp&&(!this.lastPointerType||"mouse"===this.lastPointerType)){var t=new Ka(e)
if(!(t.ctrlKey&&M&&k)){var i=this.getItemAround(t.target)
i&&this.context.controller.onMouseUp(this.context.tree,i.model.getElement(),t)}}}onTap(e){var t=this.getItemAround(e.initialTarget)
t&&this.context.controller.onTap(this.context.tree,t.model.getElement(),e)}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}onContextMenu(e){var t,i
if(e instanceof KeyboardEvent||this.didJustPressContextMenuKey){this.didJustPressContextMenuKey=!1
var n=new Wa(e)
if(!(i=this.model.getFocus()))return
var s=this.context.dataSource.getId(this.context.tree,i),r=Cl(this.items[s].element)
t=new vv(r.left+r.width,r.top,n)}else{var o=new Ka(e),a=this.getItemAround(o.target)
if(!a)return
i=a.model.getElement(),t=new wv(o)}this.context.controller.onContextMenu(this.context.tree,i,t)}onKeyDown(e){var t=new Wa(e)
this.didJustPressContextMenuKey=58===t.keyCode||t.shiftKey&&68===t.keyCode,this.didJustPressContextMenuKey&&(t.preventDefault(),t.stopPropagation()),t.target&&t.target.tagName&&"input"===t.target.tagName.toLowerCase()||this.context.controller.onKeyDown(this.context.tree,t)}onKeyUp(e){this.didJustPressContextMenuKey&&this.onContextMenu(e),this.didJustPressContextMenuKey=!1,this.context.controller.onKeyUp(this.context.tree,new Wa(e))}onDragStart(e,t){if(!this.model.getHighlight()){var i,n=e.model.getElement(),s=this.model.getSelection()
if(i=s.indexOf(n)>-1?s:[n],t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setData("URL",e.uri),t.dataTransfer.setDragImage){let e
e=this.context.dnd.getDragLabel?this.context.dnd.getDragLabel(this.context.tree,i):String(i.length)
const n=document.createElement("div")
n.className="monaco-tree-drag-image",n.textContent=e,document.body.appendChild(n),t.dataTransfer.setDragImage(n,-10,-10),setTimeout(()=>document.body.removeChild(n),0)}this.currentDragAndDropData=new pv(i),Iv.currentExternalDragAndDropData=new fv(i),this.context.dnd.onDragStart(this.context.tree,this.currentDragAndDropData,new $a(t))}}setupDragAndDropScrollInterval(){var e=_l(this.wrapper).top
this.dragAndDropScrollInterval||(this.dragAndDropScrollInterval=window.setInterval(()=>{if(void 0!==this.dragAndDropMouseY){var t=this.dragAndDropMouseY-e,i=0,n=this.viewHeight-35
t<35?i=Math.max(-14,.2*(t-35)):t>n&&(i=Math.min(14,.2*(t-n))),this.scrollTop+=i}},10),this.cancelDragAndDropScrollTimeout(),this.dragAndDropScrollTimeout=window.setTimeout(()=>{this.cancelDragAndDropScrollInterval(),this.dragAndDropScrollTimeout=null},1e3))}cancelDragAndDropScrollInterval(){this.dragAndDropScrollInterval&&(window.clearInterval(this.dragAndDropScrollInterval),this.dragAndDropScrollInterval=null),this.cancelDragAndDropScrollTimeout()}cancelDragAndDropScrollTimeout(){this.dragAndDropScrollTimeout&&(window.clearTimeout(this.dragAndDropScrollTimeout),this.dragAndDropScrollTimeout=null)}onDragOver(e){var t,i=new $a(e),n=this.getItemAround(i.target)
if(!n||0===i.posx&&0===i.posy&&i.browserEvent.type===kl.DRAG_LEAVE)return this.currentDropTarget&&(this.currentDropTargets.forEach(e=>e.dropTarget=!1),this.currentDropTargets=[],this.currentDropPromise&&(this.currentDropPromise.cancel(),this.currentDropPromise=null)),this.cancelDragAndDropScrollInterval(),this.currentDropTarget=null,this.currentDropElement=null,this.dragAndDropMouseY=null,!1
if(this.setupDragAndDropScrollInterval(),this.dragAndDropMouseY=i.posy,!this.currentDragAndDropData)if(Iv.currentExternalDragAndDropData)this.currentDragAndDropData=Iv.currentExternalDragAndDropData
else{if(!i.dataTransfer.types)return!1
this.currentDragAndDropData=new _v}this.currentDragAndDropData.update(i)
var s,r=n.model
do{if(t=r?r.getElement():this.model.getInput(),!(s=this.context.dnd.onDragOver(this.context.tree,this.currentDragAndDropData,t,i))||s.bubble!==xv.BUBBLE_UP)break
r=r&&r.parent}while(r)
if(!r)return this.currentDropElement=null,!1
var o=s&&s.accept
o?(this.currentDropElement=r.getElement(),i.preventDefault(),i.dataTransfer.dropEffect=s.effect===Sv.COPY?"copy":"move"):this.currentDropElement=null
var a,l,h=r.id===this.inputItem.id?this.inputItem:this.items[r.id]
if((this.shouldInvalidateDropReaction||this.currentDropTarget!==h||(a=this.currentDropElementReaction,l=s,!(!a&&!l||a&&l&&a.accept===l.accept&&a.bubble===l.bubble&&a.effect===l.effect)))&&(this.shouldInvalidateDropReaction=!1,this.currentDropTarget&&(this.currentDropTargets.forEach(e=>e.dropTarget=!1),this.currentDropTargets=[],this.currentDropPromise&&(this.currentDropPromise.cancel(),this.currentDropPromise=null)),this.currentDropTarget=h,this.currentDropElementReaction=s,o)){if(this.currentDropTarget&&(this.currentDropTarget.dropTarget=!0,this.currentDropTargets.push(this.currentDropTarget)),s.bubble===xv.BUBBLE_DOWN)for(var d,u=r.getNavigator();d=u.next();)(n=this.items[d.id])&&(n.dropTarget=!0,this.currentDropTargets.push(n))
s.autoExpand&&(this.currentDropPromise=bt.timeout(500).then(()=>this.context.tree.expand(this.currentDropElement)).then(()=>this.shouldInvalidateDropReaction=!0))}return!0}onDrop(e){if(this.currentDropElement){var t=new $a(e)
t.preventDefault(),this.currentDragAndDropData.update(t),this.context.dnd.drop(this.context.tree,this.currentDragAndDropData,this.currentDropElement,t),this.onDragEnd(e)}this.cancelDragAndDropScrollInterval()}onDragEnd(e){this.currentDropTarget&&(this.currentDropTargets.forEach(e=>e.dropTarget=!1),this.currentDropTargets=[]),this.currentDropPromise&&(this.currentDropPromise.cancel(),this.currentDropPromise=null),this.cancelDragAndDropScrollInterval(),this.currentDragAndDropData=null,Iv.currentExternalDragAndDropData=null,this.currentDropElement=null,this.currentDropTarget=null,this.dragAndDropMouseY=null}onFocus(){this.context.options.alwaysFocused||Ja(this.domNode,"focused"),this._onDOMFocus.fire()}onBlur(){this.context.options.alwaysFocused||Qa(this.domNode,"focused"),this.domNode.removeAttribute("aria-activedescendant"),this._onDOMBlur.fire()}onMsPointerDown(e){if(this.msGesture){var t=e.pointerType
t!==(e.MSPOINTER_TYPE_MOUSE||"mouse")?t===(e.MSPOINTER_TYPE_TOUCH||"touch")&&(this.lastPointerType="touch",e.stopPropagation(),e.preventDefault(),this.msGesture.addPointer(e.pointerId)):this.lastPointerType="mouse"}}onThrottledMsGestureChange(e){this.scrollTop-=e.translationY}onMsGestureTap(e){e.initialTarget=document.elementFromPoint(e.clientX,e.clientY),this.onTap(e)}insertItemInDOM(e){var t=null,i=this.itemAfter(e)
i&&i.element&&(t=i.element),e.insertInDOM(this.rowsContainer,t)}removeItemFromDOM(e){e&&e.removeFromDOM()}shouldBeRendered(e){return e.top<this.lastRenderTop+this.lastRenderHeight&&e.top+e.height>this.lastRenderTop}getItemAround(e){var t=this.inputItem
do{if(e[Iv.BINDING]&&(t=e[Iv.BINDING]),e===this.wrapper||e===this.domNode)return t
if(e===document.body)return null}while(e=e.parentElement)}releaseModel(){this.model&&(this.modelListeners=ei(this.modelListeners),this.model=null)}dispose(){this.scrollableElement.dispose(),this.releaseModel(),this.modelListeners=null,this.viewListeners=ei(this.viewListeners),this._onDOMFocus.dispose(),this._onDOMBlur.dispose(),this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode),this.domNode=null,this.wrapperGesture&&(this.wrapperGesture.dispose(),this.wrapperGesture=null),this.context.cache&&(this.context.cache.dispose(),this.context.cache=null),super.dispose()}}Iv.BINDING="monaco-tree-row",Iv.LOADING_DECORATION_DELAY=800,Iv.counter=0,Iv.currentExternalDragAndDropData=null
class Mv{constructor(e,t,i={}){if(this.tree=e,this.configuration=t,this.options=i,!t.dataSource)throw new Error("You must provide a Data Source to the tree.")
this.dataSource=t.dataSource,this.renderer=t.renderer,this.controller=t.controller||new jw({clickBehavior:$w.ON_MOUSE_UP,keyboardSupport:"boolean"!=typeof i.keyboardSupport||i.keyboardSupport}),this.dnd=t.dnd||new Yw,this.filter=t.filter||new Zw,this.sorter=t.sorter||null,this.accessibilityProvider=t.accessibilityProvider||new Xw}}const Dv={listFocusBackground:Td.fromHex("#073655"),listActiveSelectionBackground:Td.fromHex("#0E639C"),listActiveSelectionForeground:Td.fromHex("#FFFFFF"),listFocusAndSelectionBackground:Td.fromHex("#094771"),listFocusAndSelectionForeground:Td.fromHex("#FFFFFF"),listInactiveSelectionBackground:Td.fromHex("#3F3F46"),listHoverBackground:Td.fromHex("#2A2D2E"),listDropBackground:Td.fromHex("#383B3D")}
class Tv extends It{constructor(e,t,i={}){super(),this.toDispose=[],this._onDispose=new ci,this._onHighlightChange=new ci,this.toDispose.push(this._onDispose,this._onHighlightChange),this.container=e,this.configuration=t,this.options=i,Vn(this.options,Dv,!1),this.options.twistiePixels="number"==typeof this.options.twistiePixels?this.options.twistiePixels:32,this.options.showTwistie=!1!==this.options.showTwistie,this.options.indentPixels="number"==typeof this.options.indentPixels?this.options.indentPixels:12,this.options.alwaysFocused=!0===this.options.alwaysFocused,this.options.useShadows=!1!==this.options.useShadows,this.options.paddingOnRow=!1!==this.options.paddingOnRow,this.context=new Mv(this,t,i),this.model=new rv(this.context),this.view=new Iv(this.context,this.container),this.view.setModel(this.model),this.addEmitter(this.model),this.addEmitter(this.view),this.toDispose.push(this.model.addListener("highlight",()=>this._onHighlightChange.fire()))}style(e){this.view.applyStyles(e)}get onDOMFocus(){return this.view&&this.view.onDOMFocus}get onDOMBlur(){return this.view&&this.view.onDOMBlur}get onHighlightChange(){return this._onHighlightChange&&this._onHighlightChange.event}get onDispose(){return this._onDispose&&this._onDispose.event}getHTMLElement(){return this.view.getHTMLElement()}layout(e){this.view.layout(e)}DOMFocus(){this.view.focus()}isDOMFocused(){return this.view.isFocused()}DOMBlur(){this.view.blur()}onVisible(){this.view.onVisible()}onHidden(){this.view.onHidden()}setInput(e){return this.model.setInput(e)}getInput(){return this.model.getInput()}refresh(e=null,t=!0){return this.model.refresh(e,t)}expand(e){return this.model.expand(e)}expandAll(e){return this.model.expandAll(e)}collapse(e,t=!1){return this.model.collapse(e,t)}collapseAll(e=null,t=!1){return this.model.collapseAll(e,t)}toggleExpansion(e,t=!1){return this.model.toggleExpansion(e,t)}toggleExpansionAll(e){return this.model.toggleExpansionAll(e)}isExpanded(e){return this.model.isExpanded(e)}getExpandedElements(){return this.model.getExpandedElements()}reveal(e,t=null){return this.model.reveal(e,t)}getRelativeTop(e){let t=this.model.getItem(e)
return this.view.getRelativeTop(t)}getScrollPosition(){return this.view.getScrollPosition()}setScrollPosition(e){this.view.setScrollPosition(e)}getContentHeight(){return this.view.getTotalHeight()}setHighlight(e,t){this.model.setHighlight(e,t)}getHighlight(){return this.model.getHighlight()}isHighlighted(e){return this.model.isFocused(e)}clearHighlight(e){this.model.setHighlight(null,e)}select(e,t){this.model.select(e,t)}selectRange(e,t,i){this.model.selectRange(e,t,i)}deselectRange(e,t,i){this.model.deselectRange(e,t,i)}selectAll(e,t){this.model.selectAll(e,t)}deselect(e,t){this.model.deselect(e,t)}deselectAll(e,t){this.model.deselectAll(e,t)}setSelection(e,t){this.model.setSelection(e,t)}toggleSelection(e,t){this.model.toggleSelection(e,t)}isSelected(e){return this.model.isSelected(e)}getSelection(){return this.model.getSelection()}clearSelection(e){this.model.setSelection([],e)}selectNext(e,t,i){this.model.selectNext(e,t,i)}selectPrevious(e,t,i){this.model.selectPrevious(e,t,i)}selectParent(e,t){this.model.selectParent(e,t)}setFocus(e,t){this.model.setFocus(e,t)}isFocused(e){return this.model.isFocused(e)}getFocus(){return this.model.getFocus()}focusNext(e,t){this.model.focusNext(e,t)}focusPrevious(e,t){this.model.focusPrevious(e,t)}focusParent(e){this.model.focusParent(e)}focusFirstChild(e){this.model.focusFirstChild(e)}focusFirst(e,t){this.model.focusFirst(e,t)}focusNth(e,t){this.model.focusNth(e,t)}focusLast(e,t){this.model.focusLast(e,t)}focusNextPage(e){this.view.focusNextPage(e)}focusPreviousPage(e){this.view.focusPreviousPage(e)}clearFocus(e){this.model.setFocus(null,e)}addTraits(e,t){this.model.addTraits(e,t)}removeTraits(e,t){this.model.removeTraits(e,t)}toggleTrait(e,t){this.model.hasTrait(e,t)?this.model.removeTraits(e,[t]):this.model.addTraits(e,[t])}hasTrait(e,t){return this.model.hasTrait(e,t)}getNavigator(e,t){return new lb(this.model.getNavigator(e,t),e=>e&&e.getElement())}dispose(){this._onDispose.fire(),null!==this.model&&(this.model.dispose(),this.model=null),null!==this.view&&(this.view.dispose(),this.view=null),this.toDispose=ei(this.toDispose),super.dispose()}}class Ov{constructor(e){this.model=e,this.currentOpenStackElement=null,this.past=[],this.future=[]}pushStackElement(){null!==this.currentOpenStackElement&&(this.past.push(this.currentOpenStackElement),this.currentOpenStackElement=null)}clear(){this.currentOpenStackElement=null,this.past=[],this.future=[]}pushEditOperation(e,t,i){this.future=[],this.currentOpenStackElement||(this.currentOpenStackElement={beforeVersionId:this.model.getAlternativeVersionId(),beforeCursorState:e,editOperations:[],afterCursorState:null,afterVersionId:-1})
var n={operations:this.model.applyEdits(t)}
this.currentOpenStackElement.editOperations.push(n)
try{this.currentOpenStackElement.afterCursorState=i?i(n.operations):null}catch(e){St(e),this.currentOpenStackElement.afterCursorState=null}return this.currentOpenStackElement.afterVersionId=this.model.getVersionId(),this.currentOpenStackElement.afterCursorState}undo(){if(this.pushStackElement(),this.past.length>0){var e=this.past.pop()
try{for(var t=e.editOperations.length-1;t>=0;t--)e.editOperations[t]={operations:this.model.applyEdits(e.editOperations[t].operations)}}catch(e){return this.clear(),null}return this.future.push(e),{selections:e.beforeCursorState,recordedVersionId:e.beforeVersionId}}return null}redo(){if(this.future.length>0){if(this.currentOpenStackElement)throw new Error("How is this possible?")
var e=this.future.pop()
try{for(var t=0;t<e.editOperations.length;t++)e.editOperations[t]={operations:this.model.applyEdits(e.editOperations[t].operations)}}catch(e){return this.clear(),null}return this.past.push(e),{selections:e.afterCursorState,recordedVersionId:e.afterVersionId}}return null}}class Rv extends wd{constructor(e,t,i){super(e,t,i),this._commandManager=new Ov(this),this._isUndoing=!1,this._isRedoing=!1,this._hasEditableRange=!1,this._editableRangeId=null,this._trimAutoWhitespaceLines=null}static createFromString(e,t=vn.DEFAULT_CREATION_OPTIONS,i=null){return new Rv(dn.fromString(e),t,i)}onDidChangeRawContent(e){return this._eventEmitter.addListener(cn.ModelRawContentChanged2,e)}onDidChangeContent(e){return this._eventEmitter.addListener(cn.ModelContentChanged,e)}dispose(){this._commandManager=null,super.dispose()}_resetValue(e){super._resetValue(e),this._commandManager=new Ov(this),this._hasEditableRange=!1,this._editableRangeId=null,this._trimAutoWhitespaceLines=null}pushStackElement(){this._commandManager.pushStackElement()}pushEditOperations(e,t,i){try{return this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(e,t,i)}finally{this._eventEmitter.endDeferredEmit()}}_pushEditOperations(e,i,n){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){let n=i.map(e=>({range:this.validateRange(e.range),text:e.text})),s=!0
for(let t=0,i=e.length;t<i;t++){let i=e[t],r=!1
for(let e=0,t=n.length;e<t;e++){let t=n[e].range,s=t.startLineNumber>i.endLineNumber,o=i.startLineNumber>t.endLineNumber
if(!s&&!o){r=!0
break}}if(!r){s=!1
break}}if(s)for(let e=0,s=this._trimAutoWhitespaceLines.length;e<s;e++){let s=this._trimAutoWhitespaceLines[e],r=this.getLineMaxColumn(s),o=!0
for(let e=0,t=n.length;e<t;e++){let t=n[e].range,i=n[e].text
if(!(s<t.startLineNumber||s>t.endLineNumber)&&!(s===t.startLineNumber&&t.startColumn===r&&t.isEmpty()&&i&&i.length>0&&"\n"===i.charAt(0))){o=!1
break}}o&&i.push({identifier:null,range:new t(s,1,s,r),text:null,forceMoveMarkers:!1,isAutoWhitespaceEdit:!1})}this._trimAutoWhitespaceLines=null}return this._commandManager.pushEditOperation(e,i,n)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let i=!1,n=e[0].range,s=e[e.length-1].range,r=new t(n.startLineNumber,n.startColumn,s.endLineNumber,s.endColumn),o=n.startLineNumber,a=n.startColumn,l=[]
for(let t=0,n=e.length;t<n;t++){let n=e[t],s=n.range
i=i||n.forceMoveMarkers
for(let e=o;e<s.startLineNumber;e++)e===o?l.push(this._lines[e-1].text.substring(a-1)):(l.push("\n"),l.push(this._lines[e-1].text))
if(s.startLineNumber===o?l.push(this._lines[s.startLineNumber-1].text.substring(a-1,s.startColumn-1)):(l.push("\n"),l.push(this._lines[s.startLineNumber-1].text.substring(0,s.startColumn-1))),n.lines)for(let e=0,t=n.lines.length;e<t;e++)0!==e&&l.push("\n"),l.push(n.lines[e])
o=n.range.endLineNumber,a=n.range.endColumn}return{sortIndex:0,identifier:e[0].identifier,range:r,rangeOffset:this.getOffsetAt(r.getStartPosition()),rangeLength:this.getValueLengthInRange(r),lines:l.join("").split("\n"),forceMoveMarkers:i,isAutoWhitespaceEdit:!1}}static _sortOpsAscending(e,i){let n=t.compareRangesUsingEnds(e.range,i.range)
return 0===n?e.sortIndex-i.sortIndex:n}static _sortOpsDescending(e,i){let n=t.compareRangesUsingEnds(e.range,i.range)
return 0===n?i.sortIndex-e.sortIndex:-n}applyEdits(e){try{return this._eventEmitter.beginDeferredEmit(),this._acquireDecorationsTracker(),this._applyEdits(e)}finally{this._releaseDecorationsTracker(),this._eventEmitter.endDeferredEmit()}}_applyEdits(e){if(0===e.length)return[]
let t=this._mightContainRTL,i=this._mightContainNonBasicASCII,n=!0,s=[]
for(let r=0;r<e.length;r++){let o=e[r]
n&&o._isTracked&&(n=!1)
let a=this.validateRange(o.range)
!t&&o.text&&(t=ze(o.text)),!i&&o.text&&(i=!qe(o.text)),s[r]={sortIndex:r,identifier:o.identifier,range:a,rangeOffset:this.getOffsetAt(a.getStartPosition()),rangeLength:this.getValueLengthInRange(a),lines:o.text?o.text.split(/\r\n|\r|\n/):null,forceMoveMarkers:o.forceMoveMarkers,isAutoWhitespaceEdit:o.isAutoWhitespaceEdit||!1}}s.sort(Rv._sortOpsAscending)
for(let e=0,t=s.length-1;e<t;e++){let t=s[e].range.getEndPosition()
if(s[e+1].range.getStartPosition().isBefore(t))throw new Error("Overlapping ranges are not allowed!")}n&&(s=this._reduceOperations(s))
let r=this.getEditableRange(),o=r.getStartPosition(),a=r.getEndPosition()
for(let e=0;e<s.length;e++){let t=s[e].range
if(!o.isBeforeOrEqual(t.getStartPosition())||!t.getEndPosition().isBeforeOrEqual(a))throw new Error("Editing outside of editable range not allowed!")}let l=Rv._getInverseEditRanges(s),h=[],d=[]
for(let e=0;e<s.length;e++){let t=s[e],i=l[e]
if(h[e]={identifier:t.identifier,range:i,text:this.getValueInRange(t.range),forceMoveMarkers:t.forceMoveMarkers},this._options.trimAutoWhitespace&&t.isAutoWhitespaceEdit&&t.range.isEmpty())for(let e=i.startLineNumber;e<=i.endLineNumber;e++){let n=""
e===i.startLineNumber&&-1!==Le(n=this.getLineContent(t.range.startLineNumber))||d.push({lineNumber:e,oldContent:n})}}if(this._mightContainRTL=t,this._mightContainNonBasicASCII=i,this._doApplyEdits(s),this._trimAutoWhitespaceLines=null,this._options.trimAutoWhitespace&&d.length>0){d.sort((e,t)=>t.lineNumber-e.lineNumber),this._trimAutoWhitespaceLines=[]
for(let e=0,t=d.length;e<t;e++){let t=d[e].lineNumber
if(e>0&&d[e-1].lineNumber===t)continue
let i=d[e].oldContent,n=this.getLineContent(t)
0!==n.length&&n!==i&&-1===Le(n)&&this._trimAutoWhitespaceLines.push(t)}}return h}static _getInverseEditRanges(e){let i,n,s=[],r=null
for(let o=0,a=e.length;o<a;o++){let a,l,h,d=e[o]
if(r?r.range.endLineNumber===d.range.startLineNumber?(a=i,l=n+(d.range.startColumn-r.range.endColumn)):(a=i+(d.range.startLineNumber-r.range.endLineNumber),l=d.range.startColumn):(a=d.range.startLineNumber,l=d.range.startColumn),d.lines&&d.lines.length>0){let e=d.lines.length,i=d.lines[0],n=d.lines[e-1]
h=1===e?new t(a,l,a,l+i.length):new t(a,l,a+e-1,n.length+1)}else h=new t(a,l,a,l)
i=h.endLineNumber,n=h.endColumn,s.push(h),r=d}return s}_doApplyEdits(e){e.sort(Rv._sortOpsDescending)
let i=[],n=[],s=[]
const r=()=>{if(0===s.length)return
s.reverse()
let e=s[0].lineNumber,t=0
for(let n=1,r=s.length;n<r;n++){const r=s[n].lineNumber
r!==e&&(this._invalidateLine(e-1),this._lines[e-1].applyEdits(s.slice(t,n)),this._lineStarts.changeValue(e-1,this._lines[e-1].text.length+this._EOL.length),i.push(new mn(e,this._lines[e-1].text)),e=r,t=n)}this._invalidateLine(e-1),this._lines[e-1].applyEdits(s.slice(t,s.length)),this._lineStarts.changeValue(e-1,this._lines[e-1].text.length+this._EOL.length),i.push(new mn(e,this._lines[e-1].text)),s=[]}
for(let a=0,l=e.length;a<l;a++){const l=e[a],h=l.range.startLineNumber,d=l.range.startColumn,u=l.range.endLineNumber,c=l.range.endColumn
if(h===u&&d===c&&(!l.lines||0===l.lines.length))continue
const g=u-h,m=l.lines?l.lines.length-1:0,p=Math.min(g,m)
for(let e=p;e>=0;e--){const t=h+e;(o={lineNumber:t,startColumn:t===h?d:1,endColumn:t===u?c:this.getLineMaxColumn(t),text:l.lines?l.lines[e]:""}).startColumn===o.endColumn&&0===o.text.length||s.push(o)}if(p<g){r()
const e=h+p,t=this._lines[u-1].split(c)
this._invalidateLine(e-1)
const n=u-e
this._lines.splice(e,n),this._lineStarts.removeValues(e,n),this._lines[e-1].append(t),this._lineStarts.changeValue(e-1,this._lines[e-1].text.length+this._EOL.length),i.push(new mn(e,this._lines[e-1].text)),i.push(new pn(e+1,e+n))}if(p<m){r()
const e=h+p
let t=e===h?d:1
l.lines&&(t+=l.lines[p].length)
let n=this._lines[e-1].split(t)
this._lineStarts.changeValue(e-1,this._lines[e-1].text.length+this._EOL.length),i.push(new mn(e,this._lines[e-1].text)),this._invalidateLine(e-1)
let s=[],o=[],a=new Uint32Array(m-p)
for(let e=p+1;e<=m;e++)s.push(this._createModelLine(l.lines[e])),o.push(l.lines[e]),a[e-p-1]=l.lines[e].length+this._EOL.length
this._lines=Fn(this._lines,h+p,s),o[o.length-1]+=n.text,this._lineStarts.insertValues(h+p,a),this._lines[h+m-1].append(n),this._lineStarts.changeValue(h+m-1,this._lines[h+m-1].text.length+this._EOL.length),i.push(new fn(e+1,h+m,o.join("\n")))}const f=l.lines?l.lines.join(this.getEOL()):""
n.push({range:new t(h,d,u,c),rangeLength:l.rangeLength,text:f}),this._adjustDecorationsForEdit(l.rangeOffset,l.rangeLength,f.length,l.forceMoveMarkers)}var o
if(r(),0!==i.length||0!==n.length){this._increaseVersionId(),this._emitModelRawContentChangedEvent(new Cn(i,this.getVersionId(),this._isUndoing,this._isRedoing))
const e={changes:n,eol:this._EOL,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1}
this._eventEmitter.emit(cn.ModelContentChanged,e)}this._resetIndentRanges()}_undo(){this._isUndoing=!0
let e=this._commandManager.undo()
return this._isUndoing=!1,e?(this._overwriteAlternativeVersionId(e.recordedVersionId),e.selections):null}undo(){try{return this._eventEmitter.beginDeferredEmit(),this._acquireDecorationsTracker(),this._undo()}finally{this._releaseDecorationsTracker(),this._eventEmitter.endDeferredEmit()}}_redo(){this._isRedoing=!0
let e=this._commandManager.redo()
return this._isRedoing=!1,e?(this._overwriteAlternativeVersionId(e.recordedVersionId),e.selections):null}redo(){try{return this._eventEmitter.beginDeferredEmit(),this._acquireDecorationsTracker(),this._redo()}finally{this._releaseDecorationsTracker(),this._eventEmitter.endDeferredEmit()}}setEditableRange(e){this._commandManager.clear(),(this._hasEditableRange||e)&&this.changeDecorations(t=>{this._hasEditableRange&&(t.removeDecoration(this._editableRangeId),this._editableRangeId=null,this._hasEditableRange=!1),e&&(this._hasEditableRange=!0,this._editableRangeId=t.addDecoration(e,Rv._DECORATION_OPTION))})}hasEditableRange(){return this._hasEditableRange}getEditableRange(){return this._hasEditableRange?this.getDecorationRange(this._editableRangeId):this.getFullModelRange()}}Rv._DECORATION_OPTION=Ld.register({stickiness:d.AlwaysGrowsWhenTypingAtEdges})
var Av=0
class Pv extends Rv{onDidChangeDecorations(e){return this._eventEmitter.addListener(cn.ModelDecorationsChanged,e)}onDidChangeOptions(e){return this._eventEmitter.addListener(cn.ModelOptionsChanged,e)}onWillDispose(e){return this._eventEmitter.addListener(cn.ModelDispose,e)}onDidChangeLanguage(e){return this._eventEmitter.addListener(cn.ModelLanguageChanged,e)}onDidChangeLanguageConfiguration(e){return this._eventEmitter.addListener(cn.ModelLanguageConfigurationChanged,e)}static createFromString(e,t=vn.DEFAULT_CREATION_OPTIONS,i=null,n=null){return new Pv(dn.fromString(e),t,i,n)}constructor(e,t,i,n=null){super(e,t,i),Av++,this.id="$model"+Av,this._associatedResource=void 0===n||null===n?X.parse("inmemory://model/"+Av):n,this._attachedEditorCount=0}destroy(){this.dispose()}dispose(){this._isDisposing=!0,this._eventEmitter.emit(cn.ModelDispose),super.dispose(),this._isDisposing=!1}onBeforeAttached(){this._attachedEditorCount++,this._warmUpTokens()}onBeforeDetached(){this._attachedEditorCount--}_shouldAutoTokenize(){return this.isAttachedToEditor()}isAttachedToEditor(){return this._attachedEditorCount>0}get uri(){return this._associatedResource}}let Fv=class extends Jf{constructor(e,t,i,n,s,r,o){super(e,t,i,n,s,r,o)}_getContributions(){return[].concat(nC.getEditorContributions()).concat(No.getEditorContributions())}_getActions(){return No.getEditorActions()}}
Fv=Nn([En(2,Er),En(3,Eo),En(4,Dr),En(5,Lo),En(6,Mg)],Fv)
let Wv=class extends Fv{constructor(e,t,i,n,s,r,o,a){super(e,i.getRawConfiguration(),n,s,r,o,a),this._parentEditor=i,this._overwriteOptions=t,super.updateOptions(this._overwriteOptions),this._register(i.onDidChangeConfiguration(e=>this._onParentConfigurationChanged(e)))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawConfiguration()),super.updateOptions(this._overwriteOptions)}updateOptions(e){Vn(this._overwriteOptions,e,!0),super.updateOptions(this._overwriteOptions)}}
Wv=Nn([En(3,Er),En(4,Eo),En(5,Dr),En(6,Lo),En(7,Mg)],Wv)
const Vv=new Td(new Id(0,122,204)),Bv={showArrow:!0,showFrame:!0,className:"",frameColor:Vv,arrowColor:Vv},Hv="vs.editor.contrib.zoneWidget"
class zv{constructor(e,t,i,n,s,r){this.domNode=e,this.afterLineNumber=t,this.afterColumn=i,this.heightInLines=n,this._onDomNodeTop=s,this._onComputedHeight=r}onDomNodeTop(e){this._onDomNodeTop(e)}onComputedHeight(e){this._onComputedHeight(e)}}class Uv{constructor(e,t){this._id=e,this._domNode=t}getId(){return this._id}getDomNode(){return this._domNode}getPosition(){return null}}class Kv{constructor(e){this._editor=e,this._ruleName=Kv._IdGenerator.nextId(),this._decorations=[]}dispose(){this.hide(),Nl(this._ruleName)}set color(e){this._color!==e&&(this._color=e,this._updateStyle())}set height(e){this._height!==e&&(this._height=e,this._updateStyle())}_updateStyle(){Nl(this._ruleName),function(e,t,i=Ll){i&&t&&i.sheet.insertRule(e+"{"+t+"}",0)}(`.monaco-editor ${this._ruleName}`,`border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px; margin-left: -${this._height}px; `)}show(e){this._decorations=this._editor.deltaDecorations(this._decorations,[{range:t.fromPositions(e),options:{className:this._ruleName,stickiness:d.NeverGrowsWhenTypingAtEdges}}])}hide(){this._editor.deltaDecorations(this._decorations,[])}}Kv._IdGenerator=new dC(".arrow-decoration-")
class $v{constructor(e,t={}){this._positionMarkerId=[],this._disposables=[],this._isShowing=!1,this.editor=e,this.options=Wn(t),Vn(this.options,Bv,!1),this.domNode=document.createElement("div"),this.options.isAccessible||(this.domNode.setAttribute("aria-hidden","true"),this.domNode.setAttribute("role","presentation")),this._disposables.push(this.editor.onDidLayoutChange(e=>{const t=this._getWidth(e)
this.domNode.style.width=t+"px",this._onWidth(t)}))}dispose(){ei(this._disposables),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._viewZone&&this.editor.changeViewZones(e=>{e.removeZone(this._viewZone.id),this._viewZone=null}),this.editor.deltaDecorations(this._positionMarkerId,[])}create(){Ja(this.domNode,"zone-widget"),Ja(this.domNode,this.options.className),this.container=document.createElement("div"),Ja(this.container,"zone-widget-container"),this.domNode.appendChild(this.container),this.options.showArrow&&(this._arrow=new Kv(this.editor),this._disposables.push(this._arrow)),this._fillContainer(this.container),this._initSash(),this._applyStyles()}style(e){e.frameColor&&(this.options.frameColor=e.frameColor),e.arrowColor&&(this.options.arrowColor=e.arrowColor),this._applyStyles()}_applyStyles(){if(this.container){let e=this.options.frameColor.toString()
this.container.style.borderTopColor=e,this.container.style.borderBottomColor=e}if(this._arrow){let e=this.options.arrowColor.toString()
this._arrow.color=e}}_getWidth(e=this.editor.getLayoutInfo()){return e.width-e.minimapWidth-e.verticalScrollbarWidth}_onViewZoneTop(e){this.domNode.style.top=e+"px"}_onViewZoneHeight(e){this.domNode.style.height=`${e}px`
let t=e-this._decoratingElementsHeight()
this.container.style.height=`${t}px`,this._doLayout(t,this._getWidth()),this._resizeSash.layout()}get position(){const[e]=this._positionMarkerId
if(e)return this.editor.getModel().getDecorationRange(e).getStartPosition()}show(e,i){const n=t.isIRange(e)?e:new t(e.lineNumber,e.column,e.lineNumber,e.column)
this._isShowing=!0,this._showImpl(n,i),this._isShowing=!1,this._positionMarkerId=this.editor.deltaDecorations(this._positionMarkerId,[{range:n,options:Ld.EMPTY}])}hide(){this._viewZone&&(this.editor.changeViewZones(e=>{e.removeZone(this._viewZone.id)}),this._viewZone=null),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._arrow&&this._arrow.hide()}_decoratingElementsHeight(){let e=this.editor.getConfiguration().lineHeight,t=0
this.options.showArrow&&(t+=2*Math.round(e/3))
this.options.showFrame&&(t+=2*Math.round(e/9))
return t}_showImpl(e,t){const i={lineNumber:e.startLineNumber,column:e.startColumn},n=this._getWidth()
this.domNode.style.width=`${n}px`
const s=document.createElement("div")
s.style.overflow="hidden"
const r=this.editor.getConfiguration().lineHeight,o=this.editor.getLayoutInfo().height/r*.8
t>=o&&(t=o)
let a=0,l=0
if(this.options.showArrow&&(a=Math.round(r/3),this._arrow.height=a,this._arrow.show(i)),this.options.showFrame&&(l=Math.round(r/9)),this.editor.changeViewZones(e=>{this._viewZone&&e.removeZone(this._viewZone.id),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this.domNode.style.top="-1000px",this._viewZone=new zv(s,i.lineNumber,i.column,t,e=>this._onViewZoneTop(e),e=>this._onViewZoneHeight(e)),this._viewZone.id=e.addZone(this._viewZone),this._overlayWidget=new Uv(Hv+this._viewZone.id,this.domNode),this.editor.addOverlayWidget(this._overlayWidget)}),this.options.showFrame){const e=this.options.frameWidth?this.options.frameWidth:l
this.container.style.borderTopWidth=e+"px",this.container.style.borderBottomWidth=e+"px"}let h=t*r-this._decoratingElementsHeight()
this.container.style.top=a+"px",this.container.style.height=h+"px",this.container.style.overflow="hidden",this._doLayout(h,n),this.editor.setSelection(e)
const d=Math.min(this.editor.getModel().getLineCount(),Math.max(1,e.endLineNumber+1))
this.revealLine(d)}revealLine(e){this.editor.revealLine(e,0)}setCssClass(e,t){t&&this.container.classList.remove(t),Ja(this.container,e)}_onWidth(e){}_doLayout(e,t){}_relayout(e){this._viewZone.heightInLines!==e&&this.editor.changeViewZones(t=>{this._viewZone.heightInLines=e,t.layoutZone(this._viewZone.id)})}_initSash(){let e
this._resizeSash=new KC(this.domNode,this,{orientation:zC.HORIZONTAL}),this.options.isResizeable||(this._resizeSash.hide(),this._resizeSash.disable()),this._disposables.push(this._resizeSash.addListener("start",t=>{this._viewZone&&(e={startY:t.startY,heightInLines:this._viewZone.heightInLines})})),this._disposables.push(this._resizeSash.addListener("end",()=>{e=void 0})),this._disposables.push(this._resizeSash.addListener("change",t=>{if(e){let i=(t.currentY-e.startY)/this.editor.getConfiguration().lineHeight,n=i<0?Math.ceil(i):Math.floor(i),s=e.heightInLines+n
s>5&&s<35&&this._relayout(s)}}))}getHorizontalSashLeft(){return 0}getHorizontalSashTop(){return parseInt(this.domNode.style.height)-this._decoratingElementsHeight()/2}getHorizontalSashWidth(){const e=this.editor.getLayoutInfo()
return e.width-e.minimapWidth}}var qv,Gv;(Gv=qv||(qv={})).inPeekEditor=new xo("inReferenceSearchEditor",!0),Gv.notInPeekEditor=Gv.inPeekEditor.toNegated()
const jv={headerBackgroundColor:Td.white,primaryHeadingColor:Td.fromHex("#333333"),secondaryHeadingColor:Td.fromHex("#6c6c6cb3")}
class Yv extends $v{constructor(e,t={}){super(e,t),this._onDidClose=new ci,Vn(this.options,jv,!1)}dispose(){super.dispose(),this._onDidClose.fire(this)}get onDidClose(){return this._onDidClose.event}style(e){let t=this.options
e.headerBackgroundColor&&(t.headerBackgroundColor=e.headerBackgroundColor),e.primaryHeadingColor&&(t.primaryHeadingColor=e.primaryHeadingColor),e.secondaryHeadingColor&&(t.secondaryHeadingColor=e.secondaryHeadingColor),super.style(e)}_applyStyles(){super._applyStyles()
let e=this.options
this._headElement&&(this._headElement.style.backgroundColor=e.headerBackgroundColor.toString()),this._primaryHeading&&(this._primaryHeading.style.color=e.primaryHeadingColor.toString()),this._secondaryHeading&&(this._secondaryHeading.style.color=e.secondaryHeadingColor.toString()),this._bodyElement&&(this._bodyElement.style.borderColor=e.frameColor.toString())}_fillContainer(e){this.setCssClass("peekview-widget"),this._headElement=U_(".head").getHTMLElement(),this._bodyElement=U_(".body").getHTMLElement(),this._fillHead(this._headElement),this._fillBody(this._bodyElement),e.appendChild(this._headElement),e.appendChild(this._bodyElement)}_fillHead(e){var t=U_(".peekview-title").on(kl.CLICK,e=>this._onTitleClick(e)).appendTo(this._headElement).getHTMLElement()
this._primaryHeading=U_("span.filename").appendTo(t).getHTMLElement(),this._secondaryHeading=U_("span.dirname").appendTo(t).getHTMLElement(),this._metaHeading=U_("span.meta").appendTo(t).getHTMLElement()
const i=U_(".peekview-actions").appendTo(this._headElement),n=this._getActionBarOptions()
this._actionbarWidget=new Z_(i,n),this._actionbarWidget.push(new Jr("peekview.close",Jt("label.close","Close"),"close-peekview-action",!0,()=>(this.dispose(),null)),{label:!1,icon:!0})}_getActionBarOptions(){return{}}_onTitleClick(e){}setTitle(e,t){U_(this._primaryHeading).safeInnerHtml(e),this._primaryHeading.setAttribute("aria-label",e),t?U_(this._secondaryHeading).safeInnerHtml(t):Ga(this._secondaryHeading)}setMetaTitle(e){e?U_(this._metaHeading).safeInnerHtml(e):Ga(this._metaHeading)}_doLayout(e,t){if(!this._isShowing&&e<0)this.dispose()
else{var i=Math.ceil(1.2*this.editor.getConfiguration().lineHeight),n=e-(i+2)
this._doLayoutHead(i,t),this._doLayoutBody(n,t)}}_doLayoutHead(e,t){this._headElement.style.height=he("{0}px",e),this._headElement.style.lineHeight=this._headElement.style.height}_doLayoutBody(e,t){this._bodyElement.style.height=he("{0}px",e)}}class Zv{constructor(e,t,i){this._parent=e,this._range=t,this._eventBus=i,this._id=uC.nextId()}get id(){return this._id}get model(){return this._parent}get parent(){return this._parent}get uri(){return this._parent.uri}get name(){return this._parent.name}get directory(){return this._parent.directory}get range(){return this._range}set range(e){this._range=e,this._eventBus.emit("ref/changed",this)}getAriaMessage(){return Jt("aria.oneReference","symbol in {0} on line {1} at column {2}",qn(this.uri.fsPath),this.range.startLineNumber,this.range.startColumn)}}class Xv{constructor(e){this._modelReference=e}get _model(){return this._modelReference.object.textEditorModel}preview(e,i=8){const n=this._model
if(!n)return
const{startLineNumber:s,startColumn:r,endLineNumber:o,endColumn:a}=e,l=n.getWordUntilPosition({lineNumber:s,column:r-i}),h=new t(s,l.startColumn,s,r),d=new t(o,a,o,Number.MAX_VALUE)
return{before:n.getValueInRange(h).replace(/^\s+/,ae),inside:n.getValueInRange(e),after:n.getValueInRange(d).replace(/\s+$/,ae)}}dispose(){this._modelReference&&(this._modelReference.dispose(),this._modelReference=null)}}class Jv{constructor(e,t){this._parent=e,this._uri=t,this._children=[]}get id(){return this._uri.toString()}get parent(){return this._parent}get children(){return this._children}get uri(){return this._uri}get name(){return qn(this.uri.fsPath)}get directory(){return $n(this.uri.fsPath)}get preview(){return this._preview}get failure(){return this._loadFailure}getAriaMessage(){const e=this.children.length
return 1===e?Jt("aria.fileReferences.1","1 symbol in {0}, full path {1}",qn(this.uri.fsPath),this.uri.fsPath):Jt("aria.fileReferences.N","{0} symbols in {1}, full path {2}",e,qn(this.uri.fsPath),this.uri.fsPath)}resolve(e){return this._resolved?bt.as(this):e.createModelReference(this._uri).then(e=>{if(!e.object)throw e.dispose(),new Error
return this._preview=new Xv(e),this._resolved=!0,this},e=>(this._children=[],this._resolved=!0,this._loadFailure=e,this))}dispose(){this._preview&&(this._preview.dispose(),this._preview=null)}}class Qv{constructor(e){var i,n
let s
this._groups=[],this._references=[],this._eventBus=new It,this.onDidChangeReferenceRange=(i=this._eventBus,n="ref/changed",function(e,t,s){const r=i.addListener(n,function(){e.apply(t,arguments)})
return Array.isArray(s)&&s.push(r),r}),e.sort(Qv._compareReferences)
for(let i of e)if(s&&s.uri.toString()===i.uri.toString()||(s=new Jv(this,i.uri),this.groups.push(s)),0===s.children.length||!t.equalsRange(i.range,s.children[s.children.length-1].range)){let e=new Zv(s,i.range,this._eventBus)
this._references.push(e),s.children.push(e)}}get empty(){return 0===this._groups.length}get references(){return this._references}get groups(){return this._groups}getAriaMessage(){return this.empty?Jt("aria.result.0","No results found"):1===this.references.length?Jt("aria.result.1","Found 1 symbol in {0}",this.references[0].uri.fsPath):1===this.groups.length?Jt("aria.result.n1","Found {0} symbols in {1}",this.references.length,this.groups[0].uri.fsPath):Jt("aria.result.nm","Found {0} symbols in {1} files",this.references.length,this.groups.length)}nextReference(e){var t=e.parent.children.indexOf(e),i=e.parent.children.length,n=e.parent.parent.groups.length
return t+1<i||1===n?e.parent.children[(t+1)%i]:(t=((t=e.parent.parent.groups.indexOf(e.parent))+1)%n,e.parent.parent.groups[t].children[0])}nearestReference(e,t){const i=this._references.map((i,n)=>({idx:n,prefixLen:Pe(i.uri.toString(),e.toString()),offsetDist:100*Math.abs(i.range.startLineNumber-t.lineNumber)+Math.abs(i.range.startColumn-t.column)})).sort((e,t)=>e.prefixLen>t.prefixLen?-1:e.prefixLen<t.prefixLen?1:e.offsetDist<t.offsetDist?-1:e.offsetDist>t.offsetDist?1:0)[0]
if(i)return this._references[i.idx]}dispose(){this._groups=ei(this._groups)}static _compareReferences(e,i){const n=e.uri.toString(),s=i.uri.toString()
return n<s?-1:n>s?1:t.compareRangesUsingStarts(e.range,i.range)}}const eS=Ir("textModelService")
function tS(e,t,i){function n(e){const n=Object.create(null)
for(let i in t){const s=t[i]
"string"==typeof s?n[i]=e.getColor(s):"function"==typeof s&&(n[i]=s(e))}"function"==typeof i?i(n):i.style(n)}return n(e.getTheme()),e.onThemeChange(n)}function iS(e,t,i){return tS(t,{listFocusBackground:i&&i.listFocusBackground||Ic,listFocusForeground:i&&i.listFocusForeground||Mc,listActiveSelectionBackground:i&&i.listActiveSelectionBackground||Lg(Dc,.1),listActiveSelectionForeground:i&&i.listActiveSelectionForeground||Tc,listFocusAndSelectionBackground:i&&i.listFocusAndSelectionBackground||Dc,listFocusAndSelectionForeground:i&&i.listFocusAndSelectionForeground||Tc,listInactiveSelectionBackground:i&&i.listInactiveSelectionBackground||Oc,listInactiveSelectionForeground:i&&i.listInactiveSelectionForeground||Rc,listInactiveFocusBackground:i&&i.listInactiveFocusBackground||Ac,listInactiveFocusForeground:i&&i.listInactiveFocusForeground||Pc,listHoverBackground:i&&i.listHoverBackground||Fc,listHoverForeground:i&&i.listHoverForeground||Wc,listDropBackground:i&&i.listDropBackground||Vc,listFocusOutline:i&&i.listFocusOutline||mc,listSelectionOutline:i&&i.listSelectionOutline||mc,listHoverOutline:i&&i.listHoverOutline||mc,listInactiveFocusOutline:i&&i.listInactiveFocusOutline},e)}const nS=Ir("environmentService")
class sS{constructor(e,t){this._editor=e,this._model=t,this._decorations=new Map,this._decorationIgnoreSet=new Set,this._callOnDispose=[],this._callOnModelChange=[],this._callOnDispose.push(this._editor.onDidChangeModel(()=>this._onModelChanged())),this._onModelChanged()}dispose(){this._callOnModelChange=ei(this._callOnModelChange),this._callOnDispose=ei(this._callOnDispose),this.removeDecorations()}_onModelChanged(){this._callOnModelChange=ei(this._callOnModelChange)
const e=this._editor.getModel()
if(e)for(const t of this._model.groups)if(t.uri.toString()===e.uri.toString())return void this._addDecorations(t)}_addDecorations(e){this._callOnModelChange.push(this._editor.getModel().onDidChangeDecorations(e=>this._onDecorationChanged())),this._editor.changeDecorations(t=>{const i=[],n=[]
for(let t=0,s=e.children.length;t<s;t++){let s=e.children[t]
this._decorationIgnoreSet.has(s.id)||(i.push({range:s.range,options:sS.DecorationOptions}),n.push(t))}const s=t.deltaDecorations([],i)
for(let t=0;t<s.length;t++)this._decorations.set(s[t],e.children[n[t]])})}_onDecorationChanged(){const e=[]
this._decorations.forEach((i,n)=>{const s=this._editor.getModel().getDecorationRange(n)
if(!s)return
let r=!1
if(t.equalsRange(s,i.range))return
t.spansMultipleLines(s)?r=!0:i.range.endColumn-i.range.startColumn!==s.endColumn-s.startColumn&&(r=!0)
r?(this._decorationIgnoreSet.add(i.id),e.push(n)):i.range=s}),this._editor.changeDecorations(t=>{for(let t=0,i=e.length;t<i;t++)this._decorations.delete(e[t])
t.deltaDecorations(e,[])})}removeDecorations(){this._editor.changeDecorations(e=>{this._decorations.forEach((t,i)=>{e.removeDecoration(i)}),this._decorations.clear()})}}sS.DecorationOptions=Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,className:"reference-decoration"})
let rS=class{constructor(e){this._textModelResolverService=e}getId(e,t){return t instanceof Qv?"root":t instanceof Jv?t.id:t instanceof Zv?t.id:void 0}hasChildren(e,t){return t instanceof Qv||t instanceof Jv&&!t.failure}getChildren(e,t){return t instanceof Qv?bt.as(t.groups):t instanceof Jv?t.resolve(this._textModelResolverService).then(i=>t.failure?e.refresh(t).then(()=>i.children):i.children):bt.as([])}getParent(e,t){var i=null
return t instanceof Jv?i=t.parent:t instanceof Zv&&(i=t.parent),bt.as(i)}}
rS=Nn([En(0,eS)],rS)
class oS extends jw{onTap(e,t,i){if(t instanceof Jv)return i.preventDefault(),i.stopPropagation(),this._expandCollapse(e,t)
var n=super.onTap(e,t,i)
return e.emit(oS.Events.FOCUSED,t),n}onMouseDown(e,t,i){if(i.leftButton){if(t instanceof Jv)return i.preventDefault(),i.stopPropagation(),this._expandCollapse(e,t)
var n=super.onClick(e,t,i)
return i.ctrlKey||i.metaKey?e.emit(oS.Events.OPEN_TO_SIDE,t):2===i.detail?e.emit(oS.Events.SELECTED,t):e.emit(oS.Events.FOCUSED,t),n}return!1}onClick(e,t,i){return!i.leftButton&&super.onClick(e,t,i)}_expandCollapse(e,t){return e.isExpanded(t)?e.collapse(t).done(null,St):e.expand(t).done(null,St),!0}onEscape(e,t){return!1}onEnter(e,t){var i=e.getFocus()
if(i instanceof Jv)return this._expandCollapse(e,i)
var n=super.onEnter(e,t)
return t.ctrlKey||t.metaKey?e.emit(oS.Events.OPEN_TO_SIDE,i):e.emit(oS.Events.SELECTED,i),n}onUp(e,t){return super.onUp(e,t),this._fakeFocus(e,t),!0}onPageUp(e,t){return super.onPageUp(e,t),this._fakeFocus(e,t),!0}onLeft(e,t){return super.onLeft(e,t),this._fakeFocus(e,t),!0}onDown(e,t){return super.onDown(e,t),this._fakeFocus(e,t),!0}onPageDown(e,t){return super.onPageDown(e,t),this._fakeFocus(e,t),!0}onRight(e,t){return super.onRight(e,t),this._fakeFocus(e,t),!0}_fakeFocus(e,t){var i=e.getFocus()
e.setSelection([i]),e.emit(oS.Events.FOCUSED,i)}}oS.Events={FOCUSED:"events/custom/focused",SELECTED:"events/custom/selected",OPEN_TO_SIDE:"events/custom/opentoside"}
let aS=class{constructor(e,t,i,n){this._contextService=t,this._environmentService=i
const s=document.createElement("div")
Ja(s,"reference-file"),e.appendChild(s),this.file=new class extends Kw{constructor(e,t,i,n){super(e),this.setFile(t,i,n)}setFile(e,t,i){const n=$n(e.fsPath)
this.setValue(qn(e.fsPath),n&&"."!==n?Rw(n,t,i):"",{title:e.fsPath})}}(s,X.parse("no:file"),this._contextService,this._environmentService),this.badge=new class{constructor(e,t){this.options=t||Object.create(null),Vn(this.options,Bw,!1),this.badgeBackground=this.options.badgeBackground,this.badgeForeground=this.options.badgeForeground,this.badgeBorder=this.options.badgeBorder,this.element=Tl(e,Al(".monaco-count-badge")),this.titleFormat=this.options.titleFormat||"",this.setCount(this.options.count||0)}setCount(e){this.count=e,this.render()}setTitleFormat(e){this.titleFormat=e,this.render()}render(){this.element.textContent=""+this.count,this.element.title=he(this.titleFormat,this.count),this.applyStyles()}style(e){this.badgeBackground=e.badgeBackground,this.badgeForeground=e.badgeForeground,this.badgeBorder=e.badgeBorder,this.applyStyles()}applyStyles(){if(this.element){const e=this.badgeBackground?this.badgeBackground.toString():null,t=this.badgeForeground?this.badgeForeground.toString():null,i=this.badgeBorder?this.badgeBorder.toString():null
this.element.style.backgroundColor=e,this.element.style.color=t,this.element.style.borderWidth=i?"1px":null,this.element.style.borderStyle=i?"solid":null,this.element.style.borderColor=i}}}(U_(".count").appendTo(s).getHTMLElement())
const r=(o=this.badge,tS(n,{badgeBackground:a&&a.badgeBackground||qc,badgeForeground:a&&a.badgeForeground||Gc,badgeBorder:gc},o))
var o,a
this.dispose=(()=>{this.file.dispose(),r.dispose()})}set(e){this.file.setFile(e.uri,this._contextService,this._environmentService)
const t=e.children.length
this.badge.setCount(t),e.failure?this.badge.setTitleFormat(Jt("referencesFailre","Failed to resolve file.")):t>1?this.badge.setTitleFormat(Jt("referencesCount","{0} references",t)):this.badge.setTitleFormat(Jt("referenceCount","{0} reference",t))}}
aS=Nn([En(1,Pw),En(2,Mr(nS)),En(3,Mg)],aS)
let lS=class e{constructor(e,t,i){this._contextService=e,this._themeService=t,this._environmentService=i}getHeight(e,t){return 22}getTemplateId(t,i){if(i instanceof Jv)return e._ids.FileReferences
if(i instanceof Zv)return e._ids.OneReference
throw i}renderTemplate(t,i,n){if(i===e._ids.FileReferences)return new aS(n,this._contextService,this._environmentService,this._themeService)
if(i===e._ids.OneReference)return new class{constructor(e){const t=document.createElement("div")
this.before=document.createElement("span"),this.inside=document.createElement("span"),this.after=document.createElement("span"),Ja(this.inside,"referenceMatch"),Ja(t,"reference"),t.appendChild(this.before),t.appendChild(this.inside),t.appendChild(this.after),e.appendChild(t)}set(e){const{before:t,inside:i,after:n}=e.parent.preview.preview(e.range)
this.before.innerHTML=de(t),this.inside.innerHTML=de(i),this.after.innerHTML=de(n)}}(n)
throw i}renderElement(e,t,i,n){if(t instanceof Jv)n.set(t)
else{if(!(t instanceof Zv))throw i
n.set(t)}}disposeTemplate(e,t,i){i instanceof aS&&i.dispose()}}
lS._ids={FileReferences:"FileReferences",OneReference:"OneReference"},lS=Nn([En(0,Pw),En(1,Mg),En(2,Mr(nS))],lS)
class hS{getAriaLabel(e,t){return t instanceof Jv?t.getAriaMessage():t instanceof Zv?t.getAriaMessage():void 0}}class dS{constructor(e,t){let i
this._disposables=[],this._onDidChangePercentages=new ci,this._ratio=t,this._sash=new KC(e,{getVerticalSashLeft:()=>this._width*this._ratio,getVerticalSashHeight:()=>this._height}),this._disposables.push(this._sash.addListener("start",e=>{i=e.startX-this._width*this.ratio})),this._disposables.push(this._sash.addListener("change",e=>{let t=e.currentX-i
t>20&&t+20<this._width&&(this._ratio=t/this._width,this._sash.layout(),this._onDidChangePercentages.fire(this))}))}dispose(){this._sash.dispose(),this._onDidChangePercentages.dispose(),ei(this._disposables)}get onDidChangePercentages(){return this._onDidChangePercentages.event}set width(e){this._width=e,this._sash.layout()}set height(e){this._height=e,this._sash.layout()}get percentages(){let e=100*this._ratio
return[`${e}%`,`${100-e}%`]}get ratio(){return this._ratio}}const uS=hc("peekViewTitle.background",{dark:"#1E1E1E",light:"#FFFFFF",hc:"#0C141F"},Jt("peekViewTitleBackground","Background color of the peek view title area.")),cS=hc("peekViewTitleLabel.foreground",{dark:"#FFFFFF",light:"#333333",hc:"#FFFFFF"},Jt("peekViewTitleForeground","Color of the peek view title.")),gS=hc("peekViewTitleDescription.foreground",{dark:"#ccccccb3",light:"#6c6c6cb3",hc:"#FFFFFF99"},Jt("peekViewTitleInfoForeground","Color of the peek view title info.")),mS=hc("peekView.border",{dark:"#007acc",light:"#007acc",hc:gc},Jt("peekViewBorder","Color of the peek view borders and arrow.")),pS=hc("peekViewResult.background",{dark:"#252526",light:"#F3F3F3",hc:Td.black},Jt("peekViewResultsBackground","Background color of the peek view result list.")),fS=hc("peekViewResult.lineForeground",{dark:"#bbbbbb",light:"#646465",hc:Td.white},Jt("peekViewResultsMatchForeground","Foreground color for line nodes in the peek view result list.")),_S=hc("peekViewResult.fileForeground",{dark:Td.white,light:"#1E1E1E",hc:Td.white},Jt("peekViewResultsFileForeground","Foreground color for file nodes in the peek view result list.")),CS=hc("peekViewResult.selectionBackground",{dark:"#3399ff33",light:"#3399ff33",hc:null},Jt("peekViewResultsSelectionBackground","Background color of the selected entry in the peek view result list.")),bS=hc("peekViewResult.selectionForeground",{dark:Td.white,light:"#6C6C6C",hc:Td.white},Jt("peekViewResultsSelectionForeground","Foreground color of the selected entry in the peek view result list.")),wS=hc("peekViewEditor.background",{dark:"#001F33",light:"#F2F8FC",hc:Td.black},Jt("peekViewEditorBackground","Background color of the peek view editor.")),vS=hc("peekViewEditorGutter.background",{dark:wS,light:wS,hc:wS},Jt("peekViewEditorGutterBackground","Background color of the gutter in the peek view editor.")),SS=hc("peekViewResult.matchHighlightBackground",{dark:"#ea5c004d",light:"#ea5c004d",hc:null},Jt("peekViewResultsMatchHighlight","Match highlight color in the peek view result list.")),yS=hc("peekViewEditor.matchHighlightBackground",{dark:"#ff8f0099",light:"#f5d802de",hc:null},Jt("peekViewEditorMatchHighlight","Match highlight color in the peek view editor."))
Wg((e,t)=>{let i=e.getColor(SS)
i&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree .referenceMatch { background-color: ${i}; }`)
let n=e.getColor(yS)
n&&t.addRule(`.monaco-editor .reference-zone-widget .preview .reference-decoration { background-color: ${n}; }`)
let s=e.getColor(mc)
s&&(t.addRule(`.monaco-editor .reference-zone-widget .ref-tree .referenceMatch { border: 1px dotted ${s}; box-sizing: border-box; }`),t.addRule(`.monaco-editor .reference-zone-widget .preview .reference-decoration { border: 2px solid ${s}; box-sizing: border-box; }`))
let r=e.getColor(pS)
r&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree { background-color: ${r}; }`)
let o=e.getColor(fS)
o&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree { color: ${o}; }`)
let a=e.getColor(_S)
a&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree .reference-file { color: ${a}; }`)
let l=e.getColor(CS)
l&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree .monaco-tree.focused .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) { background-color: ${l}; }`)
let h=e.getColor(bS)
h&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree .monaco-tree.focused .monaco-tree-rows > .monaco-tree-row.selected:not(.highlighted) { color: ${h} !important; }`)
let d=e.getColor(wS)
d&&t.addRule(".monaco-editor .reference-zone-widget .preview .monaco-editor .monaco-editor-background,.monaco-editor .reference-zone-widget .preview .monaco-editor .inputarea.ime-input {"+`\tbackground-color: ${d};`+"}")
let u=e.getColor(vS)
u&&t.addRule(".monaco-editor .reference-zone-widget .preview .monaco-editor .margin {"+`\tbackground-color: ${u};`+"}")})
const xS=new xo("referenceSearchVisible",!1)
let LS=NS=class{constructor(e,t,i,n,s,r,o,a,l,h,d,u){this._editorService=i,this._textModelResolverService=n,this._telemetryService=s,this._messageService=r,this._instantiationService=o,this._contextService=a,this._storageService=l,this._themeService=h,this._configurationService=d,this._environmentService=u,this._requestIdPool=0,this._disposables=[],this._ignoreModelChangeEvent=!1,this._editor=e,this._referenceSearchVisible=xS.bindTo(t)}static get(e){return e.getContribution(NS.ID)}getId(){return NS.ID}dispose(){this._widget&&(this._widget.dispose(),this._widget=null),this._editor=null}toggleWidget(i,n,s){let r
if(this._widget&&(r=this._widget.position),this.closeWidget(),r&&i.containsPosition(r))return null
this._referenceSearchVisible.set(!0),this._disposables.push(this._editor.onDidChangeModelLanguage(()=>{this.closeWidget()})),this._disposables.push(this._editor.onDidChangeModel(()=>{this._ignoreModelChangeEvent||this.closeWidget()}))
const o="peekViewLayout",a=JSON.parse(this._storageService.get(o,void 0,"{}"))
this._widget=new class extends Yv{constructor(e,t,i,n,s,r,o){super(e,{showFrame:!1,showArrow:!0,isResizeable:!0,isAccessible:!0}),this.layoutData=t,this._textModelResolverService=i,this._contextService=n,this._themeService=s,this._instantiationService=r,this._environmentService=o,this._disposeOnNewModel=[],this._callOnDispose=[],this._onDidSelectReference=new ci,this._applyTheme(s.getTheme()),this._callOnDispose.push(s.onThemeChange(this._applyTheme.bind(this))),this.create()}_applyTheme(e){let t=e.getColor(mS)||Td.transparent
this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(uS)||Td.transparent,primaryHeadingColor:e.getColor(cS),secondaryHeadingColor:e.getColor(gS)})}dispose(){this.setModel(null),this._callOnDispose=ei(this._callOnDispose),ei(this._preview,this._previewNotAvailableMessage,this._tree,this._sash,this._previewModelReference),super.dispose()}get onDidSelectReference(){return this._onDidSelectReference.event}show(e){this.editor.revealRangeInCenterIfOutsideViewport(e,0),super.show(e,this.layoutData.heightInLines||18)}focus(){this._tree.DOMFocus()}_onTitleClick(e){this._preview&&this._preview.getModel()&&this._onDidSelectReference.fire({element:this._getFocusedReference(),kind:e.ctrlKey||e.metaKey?"side":"open",source:"title"})}_fillBody(e){var t=U_(e)
this.setCssClass("reference-zone-widget"),t.div({class:"messages"},e=>{this._messageContainer=e.hide()}),t.div({class:"preview inline"},e=>{this._preview=this._instantiationService.createInstance(Wv,e.getHTMLElement(),{scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}},this.editor),this._previewContainer=e.hide(),this._previewNotAvailableMessage=Pv.createFromString(Jt("missingPreviewMessage","no preview available"))}),this._sash=new dS(e,this.layoutData.ratio||.8),this._sash.onDidChangePercentages(()=>{let[e,t]=this._sash.percentages
this._previewContainer.style({width:e}),this._treeContainer.style({width:t}),this._preview.layout(),this._tree.layout(),this.layoutData.ratio=this._sash.ratio}),t.div({class:"ref-tree inline"},e=>{var t={dataSource:this._instantiationService.createInstance(rS),renderer:this._instantiationService.createInstance(lS),controller:new oS,accessibilityProvider:new hS},i={allowHorizontalScroll:!1,twistiePixels:20,ariaLabel:Jt("treeAriaLabel","References")}
this._tree=new Tv(e.getHTMLElement(),t,i),this._callOnDispose.push(iS(this._tree,this._themeService)),this._treeContainer=e.hide()})}_doLayoutBody(e,t){super._doLayoutBody(e,t)
const i=e+"px"
this._sash.height=e,this._sash.width=t
const[n,s]=this._sash.percentages
this._previewContainer.style({height:i,width:n}),this._treeContainer.style({height:i,width:s}),this._tree.layout(e),this._preview.layout(),this.layoutData={heightInLines:this._viewZone.heightInLines,ratio:this._sash.ratio}}_onWidth(e){this._sash.width=e,this._preview.layout()}setSelection(e){return this._revealReference(e)}setModel(e){if(this._disposeOnNewModel=ei(this._disposeOnNewModel),this._model=e,this._model)return this._onNewModel()}_onNewModel(){if(this._model.empty)return this.setTitle(""),this._messageContainer.innerHtml(Jt("noResults","No results")).show(),bt.as(void 0)
this._messageContainer.hide(),this._decorationsManager=new sS(this._preview,this._model),this._disposeOnNewModel.push(this._decorationsManager),this._disposeOnNewModel.push(this._model.onDidChangeReferenceRange(e=>this._tree.refresh(e))),this._disposeOnNewModel.push(this._tree.addListener(oS.Events.FOCUSED,e=>{e instanceof Zv&&(this._revealReference(e),this._onDidSelectReference.fire({element:e,kind:"show",source:"tree"}))})),this._disposeOnNewModel.push(this._tree.addListener(oS.Events.SELECTED,e=>{e instanceof Zv&&this._onDidSelectReference.fire({element:e,kind:"goto",source:"tree"})})),this._disposeOnNewModel.push(this._tree.addListener(oS.Events.OPEN_TO_SIDE,e=>{e instanceof Zv&&this._onDidSelectReference.fire({element:e,kind:"side",source:"tree"})})),this._disposeOnNewModel.push(this._preview.onMouseDown(e=>{2===e.event.detail&&this._onDidSelectReference.fire({element:this._getFocusedReference(),kind:e.event.ctrlKey||e.event.metaKey?"side":"open",source:"editor"})})),Ja(this.container,"results-loaded"),this._treeContainer.show(),this._previewContainer.show(),this._preview.layout(),this._tree.layout(),this.focus()
const e=1===this._model.groups.length?this._model.groups[0]:this._model
return this._tree.setInput(e)}_getFocusedReference(){const e=this._tree.getFocus()
return e instanceof Zv?e:e instanceof Jv&&e.children.length>0?e.children[0]:void 0}_revealReference(e){e.uri.scheme!==ru.inMemory?this.setTitle(e.name,Rw(e.directory,this._contextService,this._environmentService)):this.setTitle(Jt("peekView.alternateTitle","References"))
const i=this._textModelResolverService.createModelReference(e.uri)
return bt.join([i,this._tree.reveal(e)]).then(i=>{const n=i[0]
if(!this._model)return void n.dispose()
ei(this._previewModelReference)
const s=n.object
if(s){this._previewModelReference=n
let i=this._preview.getModel()===s.textEditorModel
this._preview.setModel(s.textEditorModel)
var r=t.lift(e.range).collapseToStart()
this._preview.setSelection(r),this._preview.revealRangeInCenter(r,i?0:1)}else this._preview.setModel(this._previewNotAvailableMessage),n.dispose()
this._tree.setSelection([e]),this._tree.setFocus(e)},St)}}(this._editor,a,this._textModelResolverService,this._contextService,this._themeService,this._instantiationService,this._environmentService),this._widget.setTitle(Jt("labelLoading","Loading...")),this._widget.show(i),this._disposables.push(this._widget.onDidClose(()=>{n.cancel(),this._storageService.store(o,JSON.stringify(this._widget.layoutData)),this._widget=null,this.closeWidget()})),this._disposables.push(this._widget.onDidSelectReference(e=>{let{element:t,kind:i}=e
switch(i){case"open":if("editor"===e.source&&this._configurationService.getValue("editor.stablePeek"))break
case"side":this._openReference(t,"side"===i)
break
case"goto":s.onGoto?s.onGoto(t):this._gotoReference(t)}}))
const l=++this._requestIdPool,h=function(e){const t=(new Date).getTime()
return pi((i=e,(e,t=null,n)=>{const s=i(i=>(s.dispose(),e.call(t,i)),null,n)
return s}),e=>(new Date).getTime()-t)
var i}(function(e){const t=new ci
let i=!1
return e.then(null,()=>null).then(()=>{i?t.fire():setTimeout(()=>t.fire(),0)}),i=!0,t.event}(n.then(t=>{if(l!==this._requestIdPool||!this._widget)return
this._model&&this._model.dispose(),this._model=t
const n=Date.now()
return this._disposables.push({dispose:()=>{this._telemetryService.publicLog("zoneWidgetShown",{mode:"reference search",elapsedTime:Date.now()-n})}}),this._widget.setModel(this._model).then(()=>{this._widget.setMetaTitle(s.getMetaTitle(this._model))
let t=this._editor.getModel().uri,n=new e(i.startLineNumber,i.startColumn),r=this._model.nearestReference(t,n)
if(r)return this._widget.setSelection(r)})},e=>{this._messageService.show(ew.Error,e)}))),d=this._editor.getModel().getLanguageIdentifier().language
h(e=>this._telemetryService.publicLog("findReferences",{duration:e,mode:d}))}closeWidget(){this._widget&&(this._widget.dispose(),this._widget=null),this._referenceSearchVisible.reset(),this._disposables=ei(this._disposables),this._model&&(this._model.dispose(),this._model=null),this._editor.focus(),this._requestIdPool+=1}_gotoReference(e){this._widget.hide(),this._ignoreModelChangeEvent=!0
const{uri:t,range:i}=e
this._editorService.openEditor({resource:t,options:{selection:i}}).done(e=>{this._ignoreModelChangeEvent=!1,e&&e.getControl()===this._editor?(this._widget.show(i),this._widget.focus()):this.closeWidget()},e=>{this._ignoreModelChangeEvent=!1,St(e)})}_openReference(e,t){const{uri:i,range:n}=e
this._editorService.openEditor({resource:i,options:{selection:n}},t),t||this.closeWidget()}}
var NS
LS.ID="editor.contrib.referencesController",LS=NS=Nn([iC,En(1,Lo),En(2,ao),En(3,eS),En(4,cw),En(5,tw),En(6,Er),En(7,Pw),En(8,zu),En(9,Mg),En(10,gw),En(11,Mr(nS))],LS)
let ES=MS=class{constructor(e,t){this._messageListeners=[],this._editor=e,this._visible=MS.CONTEXT_SNIPPET_MODE.bindTo(t)}static get(e){return e.getContribution(MS._id)}getId(){return MS._id}dispose(){this._visible.reset()}isVisible(){return this._visible.get()}showMessage(e,i){let n
vC(e),this._visible.set(!0),ei(this._messageWidget),this._messageListeners=ei(this._messageListeners),this._messageWidget=new IS(this._editor,i,e),this._messageListeners.push(this._editor.onDidBlurEditorText(()=>this.closeMessage())),this._messageListeners.push(this._editor.onDidChangeCursorPosition(()=>this.closeMessage())),this._messageListeners.push(this._editor.onDidDispose(()=>this.closeMessage())),this._messageListeners.push(this._editor.onDidChangeModel(()=>this.closeMessage())),this._messageListeners.push(function(e,t,...i){const n=setTimeout(e,t,...i)
return{dispose(){clearTimeout(n)}}}(()=>this.closeMessage(),3e3)),this._messageListeners.push(this._editor.onMouseMove(e=>{e.target.position&&(n?n.containsPosition(e.target.position)||this.closeMessage():n=new t(i.lineNumber-3,1,e.target.position.lineNumber+3,1))}))}closeMessage(){this._visible.reset(),this._messageListeners=ei(this._messageListeners),this._messageListeners.push(IS.fadeOut(this._messageWidget))}}
ES._id="editor.contrib.messageController",ES.CONTEXT_SNIPPET_MODE=new xo("messageVisible",!1),ES=MS=Nn([Po,En(1,Lo)],ES)
const kS=Do.bindToContribution(ES.get)
No.registerEditorCommand(new kS({id:"leaveEditorMessage",precondition:ES.CONTEXT_SNIPPET_MODE,handler:e=>e.closeMessage(),kbOpts:{weight:No.commandWeight(30),primary:9}}))
class IS{constructor(e,{lineNumber:t,column:i},n){this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._editor=e,this._editor.revealLinesInCenterIfOutsideViewport(t,t,0),this._position={lineNumber:t,column:1},this._domNode=document.createElement("div"),this._domNode.style.paddingLeft=`${e.getOffsetForColumn(t,i)-6}px`,this._domNode.classList.add("monaco-editor-overlaymessage")
const s=document.createElement("div")
s.classList.add("message"),s.textContent=n,this._domNode.appendChild(s)
const r=document.createElement("div")
r.classList.add("anchor"),this._domNode.appendChild(r),this._editor.addContentWidget(this),this._domNode.classList.add("fadeIn")}static fadeOut(e){let t
const i=()=>{e.dispose(),clearTimeout(t),e.getDomNode().removeEventListener("animationend",i)}
return t=setTimeout(i,110),e.getDomNode().addEventListener("animationend",i),e.getDomNode().classList.add("fadeOut"),{dispose:i}}dispose(){this._editor.removeContentWidget(this)}getId(){return"messageoverlay"}getDomNode(){return this._domNode}getPosition(){return{position:this._position,preference:[pm.ABOVE]}}}var MS
Wg((e,t)=>{let i=e.getColor(yc)
if(i){let n=e.type===Rg?2:1
t.addRule(`.monaco-editor .monaco-editor-overlaymessage .anchor { border-top-color: ${i}; }`),t.addRule(`.monaco-editor .monaco-editor-overlaymessage .message { border: ${n}px solid ${i}; }`)}let n=e.getColor(Sc)
n&&t.addRule(`.monaco-editor .monaco-editor-overlaymessage .message { background-color: ${n}; }`)})
const DS=Ir("progressService")
Object.freeze({report(){}})
var TS,OS;(OS=TS||(TS={}))[OS.Scm=1]="Scm",OS[OS.Window=10]="Window"
Ir("progressService2")
class RS{constructor(e=!1,t=!1,i=!0,n=!0){this.openToSide=e,this.openInPeek=t,this.filterCurrent=i,this.showMessage=n}}class AS extends To{constructor(e,t){super(t),this._configuration=e}run(e,i){const n=e.get(tw),s=e.get(ao),r=e.get(DS),o=i.getModel(),a=i.getPosition(),l=this._getDeclarationsAtPosition(o,a).then(e=>{if(o.isDisposed()||i.getModel()!==o)return
let n=-1,r=[]
for(let i=0;i<e.length;i++){let s=e[i]
if(!s||!s.range)continue
let{uri:l,range:h}=s,d=r.push({uri:l,range:h})
this._configuration.filterCurrent&&l.toString()===o.uri.toString()&&t.containsPosition(h,a)&&-1===n&&(n=d-1)}if(0===r.length){if(this._configuration.showMessage){const e=o.getWordAtPosition(a)
ES.get(i).showMessage(this._getNoResultFoundMessage(e),a)}}else if(1===r.length&&-1!==n){let[e]=r
this._openReference(s,e,!1)}else this._onResult(s,i,new Qv(r))},e=>{n.show(ew.Error,e)})
return r.showWhile(l,250),l}_getDeclarationsAtPosition(e,t){return hw(e,t)}_getNoResultFoundMessage(e){return e&&e.word?Jt("noResultWord","No definition found for '{0}'",e.word):Jt("generic.noResults","No definition found")}_getMetaTitle(e){return e.references.length>1&&Jt("meta.title"," – {0} definitions",e.references.length)}_onResult(e,t,i){if(vC(i.getAriaMessage()),this._configuration.openInPeek)this._openInPeek(e,t,i)
else{let n=i.nearestReference(t.getModel().uri,t.getPosition())
this._openReference(e,n,this._configuration.openToSide).then(t=>{t&&i.references.length>1?this._openInPeek(e,t,i):i.dispose()})}}_openReference(e,i,n){let{uri:s,range:r}=i
return e.openEditor({resource:s,options:{selection:t.collapseToStart(r),revealIfVisible:!n}},n).then(e=>e&&e.getControl())}_openInPeek(e,t,i){let n=LS.get(t)
n?n.toggleWidget(t.getSelection(),bt.as(i),{getMetaTitle:e=>this._getMetaTitle(e),onGoto:t=>(n.closeWidget(),this._openReference(e,t,!1))}):i.dispose()}}const PS=D?2118:70
let FS=$S=class extends AS{constructor(){super(new RS,{id:$S.ID,label:Jt("actions.goToDecl.label","Go to Definition"),alias:"Go to Definition",precondition:_o.and(Vo.hasDefinitionProvider,Vo.isInEmbeddedEditor.toNegated()),kbOpts:{kbExpr:Vo.textFocus,primary:PS},menuOpts:{group:"navigation",order:1.1}})}}
FS.ID="editor.action.goToDeclaration",FS=$S=Nn([Oo],FS)
let WS=qS=class extends AS{constructor(){super(new RS(!0),{id:qS.ID,label:Jt("actions.goToDeclToSide.label","Open Definition to the Side"),alias:"Open Definition to the Side",precondition:_o.and(Vo.hasDefinitionProvider,Vo.isInEmbeddedEditor.toNegated()),kbOpts:{kbExpr:Vo.textFocus,primary:Wr(2089,PS)}})}}
WS.ID="editor.action.openDeclarationToTheSide",WS=qS=Nn([Oo],WS)
Oo(class extends AS{constructor(){super(new RS(void 0,!0,!1),{id:"editor.action.previewDeclaration",label:Jt("actions.previewDecl.label","Peek Definition"),alias:"Peek Definition",precondition:_o.and(Vo.hasDefinitionProvider,qv.notInPeekEditor,Vo.isInEmbeddedEditor.toNegated()),kbOpts:{kbExpr:Vo.textFocus,primary:582,linux:{primary:3140}},menuOpts:{group:"navigation",order:1.2}})}})
class VS extends AS{_getDeclarationsAtPosition(e,t){return dw(e,t)}_getNoResultFoundMessage(e){return e&&e.word?Jt("goToImplementation.noResultWord","No implementation found for '{0}'",e.word):Jt("goToImplementation.generic.noResults","No implementation found")}_getMetaTitle(e){return e.references.length>1&&Jt("meta.implementations.title"," – {0} implementations",e.references.length)}}let BS=GS=class extends VS{constructor(){super(new RS,{id:GS.ID,label:Jt("actions.goToImplementation.label","Go to Implementation"),alias:"Go to Implementation",precondition:_o.and(Vo.hasImplementationProvider,Vo.isInEmbeddedEditor.toNegated()),kbOpts:{kbExpr:Vo.textFocus,primary:2118}})}}
BS.ID="editor.action.goToImplementation",BS=GS=Nn([Oo],BS)
let HS=jS=class extends VS{constructor(){super(new RS(!1,!0,!1),{id:jS.ID,label:Jt("actions.peekImplementation.label","Peek Implementation"),alias:"Peek Implementation",precondition:_o.and(Vo.hasImplementationProvider,Vo.isInEmbeddedEditor.toNegated()),kbOpts:{kbExpr:Vo.textFocus,primary:3142}})}}
HS.ID="editor.action.peekImplementation",HS=jS=Nn([Oo],HS)
class zS extends AS{_getDeclarationsAtPosition(e,t){return uw(e,t)}_getNoResultFoundMessage(e){return e&&e.word?Jt("goToTypeDefinition.noResultWord","No type definition found for '{0}'",e.word):Jt("goToTypeDefinition.generic.noResults","No type definition found")}_getMetaTitle(e){return e.references.length>1&&Jt("meta.typeDefinitions.title"," – {0} type definitions",e.references.length)}}let US=YS=class extends zS{constructor(){super(new RS,{id:YS.ID,label:Jt("actions.goToTypeDefinition.label","Go to Type Definition"),alias:"Go to Type Definition",precondition:_o.and(Vo.hasTypeDefinitionProvider,Vo.isInEmbeddedEditor.toNegated()),kbOpts:{kbExpr:Vo.textFocus,primary:0},menuOpts:{group:"navigation",order:1.4}})}}
US.ID="editor.action.goToTypeDefinition",US=YS=Nn([Oo],US)
let KS=ZS=class extends zS{constructor(){super(new RS(!1,!0,!1),{id:ZS.ID,label:Jt("actions.peekTypeDefinition.label","Peek Type Definition"),alias:"Peek Type Definition",precondition:_o.and(Vo.hasTypeDefinitionProvider,Vo.isInEmbeddedEditor.toNegated()),kbOpts:{kbExpr:Vo.textFocus,primary:0}})}}
var $S,qS,GS,jS,YS,ZS
KS.ID="editor.action.peekTypeDefinition",KS=ZS=Nn([Oo],KS)
var XS=Ir("modeService")
function JS(e,t){return!!e[t]}class QS{constructor(e,t){this.target=e.target,this.hasTriggerModifier=JS(e.event,t.triggerModifier),this.hasSideBySideModifier=JS(e.event,t.triggerSideBySideModifier),this.isNoneOrSingleMouseDown=xa||e.event.detail<=1}}class ey{constructor(e,t){this.keyCodeIsTriggerKey=e.keyCode===t.triggerKey,this.keyCodeIsSideBySideKey=e.keyCode===t.triggerSideBySideKey,this.hasTriggerModifier=JS(e,t.triggerModifier)}}class ty{constructor(e,t,i,n){this.triggerKey=e,this.triggerModifier=t,this.triggerSideBySideKey=i,this.triggerSideBySideModifier=n}equals(e){return this.triggerKey===e.triggerKey&&this.triggerModifier===e.triggerModifier&&this.triggerSideBySideKey===e.triggerSideBySideKey&&this.triggerSideBySideModifier===e.triggerSideBySideModifier}}function iy(e){return"altKey"===e?k?new ty(57,"metaKey",6,"altKey"):new ty(5,"ctrlKey",6,"altKey"):k?new ty(6,"altKey",57,"metaKey"):new ty(6,"altKey",5,"ctrlKey")}class ny extends ni{constructor(e){super(),this._onMouseMoveOrRelevantKeyDown=this._register(new ci),this.onMouseMoveOrRelevantKeyDown=this._onMouseMoveOrRelevantKeyDown.event,this._onExecute=this._register(new ci),this.onExecute=this._onExecute.event,this._onCancel=this._register(new ci),this.onCancel=this._onCancel.event,this._editor=e,this._opts=iy(this._editor.getConfiguration().multiCursorModifier),this.lastMouseMoveEvent=null,this.hasTriggerKeyOnMouseDown=!1,this._register(this._editor.onDidChangeConfiguration(e=>{if(e.multiCursorModifier){const e=iy(this._editor.getConfiguration().multiCursorModifier)
if(this._opts.equals(e))return
this._opts=e,this.lastMouseMoveEvent=null,this.hasTriggerKeyOnMouseDown=!1,this._onCancel.fire()}})),this._register(this._editor.onMouseMove(e=>this.onEditorMouseMove(new QS(e,this._opts)))),this._register(this._editor.onMouseDown(e=>this.onEditorMouseDown(new QS(e,this._opts)))),this._register(this._editor.onMouseUp(e=>this.onEditorMouseUp(new QS(e,this._opts)))),this._register(this._editor.onKeyDown(e=>this.onEditorKeyDown(new ey(e,this._opts)))),this._register(this._editor.onKeyUp(e=>this.onEditorKeyUp(new ey(e,this._opts)))),this._register(this._editor.onMouseDrag(()=>this.resetHandler())),this._register(this._editor.onDidChangeCursorSelection(e=>this.onDidChangeCursorSelection(e))),this._register(this._editor.onDidChangeModel(e=>this.resetHandler())),this._register(this._editor.onDidChangeModelContent(()=>this.resetHandler())),this._register(this._editor.onDidScrollChange(e=>{(e.scrollTopChanged||e.scrollLeftChanged)&&this.resetHandler()}))}onDidChangeCursorSelection(e){e.selection&&e.selection.startColumn!==e.selection.endColumn&&this.resetHandler()}onEditorMouseMove(e){this.lastMouseMoveEvent=e,this._onMouseMoveOrRelevantKeyDown.fire([e,null])}onEditorMouseDown(e){this.hasTriggerKeyOnMouseDown=e.hasTriggerModifier}onEditorMouseUp(e){this.hasTriggerKeyOnMouseDown&&this._onExecute.fire(e)}onEditorKeyDown(e){this.lastMouseMoveEvent&&(e.keyCodeIsTriggerKey||e.keyCodeIsSideBySideKey&&e.hasTriggerModifier)?this._onMouseMoveOrRelevantKeyDown.fire([this.lastMouseMoveEvent,e]):e.hasTriggerModifier&&this._onCancel.fire()}onEditorKeyUp(e){e.keyCodeIsTriggerKey&&this._onCancel.fire()}resetHandler(){this.lastMouseMoveEvent=null,this.hasTriggerKeyOnMouseDown=!1,this._onCancel.fire()}}let sy=ry=class{constructor(e,t,i){this.textModelResolverService=t,this.modeService=i,this.toUnhook=[],this.decorations=[],this.editor=e,this.throttler=new class{constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){const e=()=>{this.queuedPromise=null
const e=this.queue(this.queuedPromiseFactory)
return this.queuedPromiseFactory=null,e}
this.queuedPromise=new bt((t,i,n)=>{this.activePromise.then(e,e,n).done(t)},()=>{this.activePromise.cancel()})}return new bt((e,t,i)=>{this.queuedPromise.then(e,t,i)},()=>{})}return this.activePromise=e(),new bt((e,t,i)=>{this.activePromise.done(t=>{this.activePromise=null,e(t)},e=>{this.activePromise=null,t(e)},i)},()=>{this.activePromise.cancel()})}}
let n=new ny(e)
this.toUnhook.push(n),this.toUnhook.push(n.onMouseMoveOrRelevantKeyDown(([e,t])=>{this.startFindDefinition(e,t)})),this.toUnhook.push(n.onExecute(e=>{this.isEnabled(e)&&this.gotoDefinition(e.target,e.hasSideBySideModifier).done(()=>{this.removeDecorations()},e=>{this.removeDecorations(),St(e)})})),this.toUnhook.push(n.onCancel(()=>{this.removeDecorations(),this.currentWordUnderMouse=null}))}startFindDefinition(e,i){if(!this.isEnabled(e,i))return this.currentWordUnderMouse=null,void this.removeDecorations()
let n=e.target.position,s=n?this.editor.getModel().getWordAtPosition(n):null
if(!s)return this.currentWordUnderMouse=null,void this.removeDecorations()
if(this.currentWordUnderMouse&&this.currentWordUnderMouse.startColumn===s.startColumn&&this.currentWordUnderMouse.endColumn===s.endColumn&&this.currentWordUnderMouse.word===s.word)return
this.currentWordUnderMouse=s
let r=new Qb(this.editor,15)
this.throttler.queue(()=>r.validate(this.editor)?this.findDefinition(e.target):bt.as(null)).then(e=>{if(e&&e.length&&r.validate(this.editor))if(e.length>1)this.addDecoration(new t(n.lineNumber,s.startColumn,n.lineNumber,s.endColumn),(new Mh).appendText(Jt("multipleResults","Click to show {0} definitions.",e.length)))
else{let i=e[0]
if(!i.uri)return
this.textModelResolverService.createModelReference(i.uri).then(e=>{if(!e.object||!e.object.textEditorModel)return void e.dispose()
const{object:{textEditorModel:r}}=e,{startLineNumber:o}=i.range
if(0===r.getLineMaxColumn(o))return void e.dispose()
const a=r.getLineFirstNonWhitespaceColumn(o),l=Math.min(r.getLineCount(),o+ry.MAX_SOURCE_PREVIEW_LINES)
let h=o+1,d=a
for(;h<l;h++){let e=r.getLineFirstNonWhitespaceColumn(h)
if(d=Math.min(d,e),a===e)break}const u=new t(o,1,h+1,1),c=r.getValueInRange(u).replace(new RegExp(`^\\s{${d-1}}`,"gm"),"").trim()
this.addDecoration(new t(n.lineNumber,s.startColumn,n.lineNumber,s.endColumn),(new Mh).appendCodeblock(this.modeService.getModeIdByFilenameOrFirstLine(r.uri.fsPath),c)),e.dispose()})}else this.removeDecorations()}).done(void 0,St)}addDecoration(e,t){const i={range:e,options:{inlineClassName:"goto-definition-link",hoverMessage:t}}
this.decorations=this.editor.deltaDecorations(this.decorations,[i])}removeDecorations(){this.decorations.length>0&&(this.decorations=this.editor.deltaDecorations(this.decorations,[]))}isEnabled(e,t){return this.editor.getModel()&&e.isNoneOrSingleMouseDown&&e.target.type===bm.CONTENT_TEXT&&(e.hasTriggerModifier||t&&t.keyCodeIsTriggerKey)&&Ws.has(this.editor.getModel())}findDefinition(e){return this.editor.getModel()?hw(this.editor.getModel(),e.position):bt.as(null)}gotoDefinition(e,t){this.editor.setPosition(e.position)
const i=new AS(new RS(t,!1,!0,!1),{alias:void 0,label:void 0,id:void 0,precondition:void 0})
return this.editor.invokeWithinContext(e=>i.run(e,this.editor))}getId(){return ry.ID}dispose(){this.toUnhook=ei(this.toUnhook)}}
var ry,oy
sy.ID="editor.contrib.gotodefinitionwithmouse",sy.MAX_SOURCE_PREVIEW_LINES=8,sy=ry=Nn([iC,En(1,eS),En(2,XS)],sy),Wg((e,t)=>{let i=e.getColor(gg)
i&&t.addRule(`.monaco-editor .goto-definition-link { color: ${i} !important; }`)}),function(e){const t="";(oy||(oy={})).makeKey=function(e){let i=[t]
return e.source?i.push(e.source.replace("¦","¦")):i.push(t),e.code?i.push(e.code.replace("¦","¦")):i.push(t),void 0!==e.severity&&null!==e.severity?i.push(ew.toString(e.severity)):i.push(t),e.message?i.push(e.message.replace("¦","¦")):i.push(t),void 0!==e.startLineNumber&&null!==e.startLineNumber?i.push(e.startLineNumber.toString()):i.push(t),void 0!==e.startColumn&&null!==e.startColumn?i.push(e.startColumn.toString()):i.push(t),void 0!==e.endLineNumber&&null!==e.endLineNumber?i.push(e.endLineNumber.toString()):i.push(t),void 0!==e.endColumn&&null!==e.endColumn?i.push(e.endColumn.toString()):i.push(t),i.push(t),i.join("¦")}}()
const ay=Ir("markerService")
class ly{constructor(e,t){this.lines=0,this.longestLineLength=0,this._disposables=[],this._editor=t,this._domNode=document.createElement("span"),this._domNode.className="descriptioncontainer",this._domNode.setAttribute("aria-live","assertive"),this._domNode.setAttribute("role","alert"),this._scrollable=new Tf(this._domNode,{horizontal:hi.Auto,vertical:hi.Hidden,useShadows:!1,horizontalScrollbarSize:3}),Ja(this._scrollable.getDomNode(),"block"),e.appendChild(this._scrollable.getDomNode()),this._disposables.push(this._scrollable.onScroll(e=>this._domNode.style.left=`-${e.scrollLeft}px`)),this._disposables.push(this._scrollable)}dispose(){ei(this._disposables)}update({source:e,message:t}){if(e){this.lines=0,this.longestLineLength=0
const i=new Array(e.length+3+1).join(" "),n=t.split(/\r\n|\r|\n/g)
for(let s=0;s<n.length;s++){let r=n[s]
this.lines+=1,this.longestLineLength=Math.max(r.length,this.longestLineLength),0===s?t=`[${e}] ${r}`:t+=`\n${i}${r}`}}else this.lines=1,this.longestLineLength=t.length
this._domNode.innerText=t,this._editor.applyFontInfo(this._domNode)
const i=Math.floor(this._editor.getConfiguration().fontInfo.typicalFullwidthCharacterWidth*this.longestLineLength)
this._scrollable.setScrollDimensions({scrollWidth:i})}layout(e,t){this._scrollable.setScrollDimensions({width:t})}}class hy extends To{constructor(e,t){super(t),this._isNext=e}run(e,t){e.get(cw)
const i=dy.get(t)
if(!i)return
let n=i.getOrCreateModel()
n&&(this._isNext?n.next():n.previous(),n.reveal())}}let dy=wy=class{constructor(e,t,i,n){this._markerService=t,this._contextKeyService=i,this._themeService=n,this._callOnClose=[],this._editor=e,this._markersNavigationVisible=uy.bindTo(this._contextKeyService)}static get(e){return e.getContribution(wy.ID)}getId(){return wy.ID}dispose(){this._cleanUp()}_cleanUp(){this._markersNavigationVisible.reset(),this._callOnClose=ei(this._callOnClose),this._zone=null,this._model=null}getOrCreateModel(){if(this._model)return this._model
const i=this._getMarkers()
return this._model=new class{constructor(e,t){this._editor=e,this._markers=null,this._nextIdx=-1,this._toUnbind=[],this._ignoreSelectionChange=!1,this._onCurrentMarkerChanged=new ci,this._onMarkerSetChanged=new ci,this.setMarkers(t),this._toUnbind.push(this._editor.onDidDispose(()=>this.dispose())),this._toUnbind.push(this._editor.onDidChangeCursorPosition(()=>{this._ignoreSelectionChange||(this._nextIdx=-1)}))}get onCurrentMarkerChanged(){return this._onCurrentMarkerChanged.event}get onMarkerSetChanged(){return this._onMarkerSetChanged.event}setMarkers(e){this._markers=e||[],this._markers.sort((e,i)=>ew.compare(e.severity,i.severity)||t.compareRangesUsingStarts(e,i)),this._nextIdx=-1,this._onMarkerSetChanged.fire(this)}withoutWatchingEditorPosition(e){this._ignoreSelectionChange=!0
try{e()}finally{this._ignoreSelectionChange=!1}}_initIdx(e){let i=!1
const n=this._editor.getPosition()
for(let s=0;s<this._markers.length;s++){let r=t.lift(this._markers[s])
if(r.isEmpty()){const e=this._editor.getModel().getWordAtPosition(r.getStartPosition())
e&&(r=new t(r.startLineNumber,e.startColumn,r.startLineNumber,e.endColumn))}if(r.containsPosition(n)||n.isBeforeOrEqual(r.getStartPosition())){this._nextIdx=s+(e?0:-1),i=!0
break}}i||(this._nextIdx=e?0:this._markers.length-1),this._nextIdx<0&&(this._nextIdx=this._markers.length-1)}move(e){if(!this.canNavigate())return void this._onCurrentMarkerChanged.fire(void 0);-1===this._nextIdx?this._initIdx(e):e?(this._nextIdx+=1,this._nextIdx>=this._markers.length&&(this._nextIdx=0)):(this._nextIdx-=1,this._nextIdx<0&&(this._nextIdx=this._markers.length-1))
const t=this._markers[this._nextIdx]
this._onCurrentMarkerChanged.fire(t)}canNavigate(){return this._markers.length>0}next(){this.move(!0)}previous(){this.move(!1)}findMarkerAtPosition(e){for(const i of this._markers)if(t.containsPosition(i,e))return i}get total(){return this._markers.length}indexOf(e){return 1+this._markers.indexOf(e)}reveal(){-1!==this._nextIdx&&this.withoutWatchingEditorPosition(()=>{const t=new e(this._markers[this._nextIdx].startLineNumber,this._markers[this._nextIdx].startColumn)
this._editor.setPosition(t),this._editor.revealPositionInCenter(t,0)})}dispose(){this._toUnbind=ei(this._toUnbind)}}(this._editor,i),this._zone=new class extends $v{constructor(e,t,i){super(e,{showArrow:!0,showFrame:!0,isAccessible:!0}),this._model=t,this._themeService=i,this._callOnDispose=[],this._severity=ew.Warning,this._backgroundColor=Td.white,this._applyTheme(i.getTheme()),this._callOnDispose.push(i.onThemeChange(this._applyTheme.bind(this))),this.create(),this._wireModelAndView()}_applyTheme(e){this._backgroundColor=e.getColor(by)
let t=fy
this._severity===ew.Warning?t=_y:this._severity===ew.Info&&(t=Cy)
let i=e.getColor(t)
this.style({arrowColor:i,frameColor:i})}_applyStyles(){this._parentContainer&&(this._parentContainer.style.backgroundColor=this._backgroundColor.toString()),super._applyStyles()}dispose(){this._callOnDispose=ei(this._callOnDispose),super.dispose()}focus(){this._parentContainer.focus()}_fillContainer(e){this._parentContainer=e,Ja(e,"marker-widget"),this._parentContainer.tabIndex=0,this._parentContainer.setAttribute("role","tooltip"),this._container=document.createElement("div"),e.appendChild(this._container),this._title=document.createElement("div"),this._title.className="block title",this._container.appendChild(this._title),this._message=new ly(this._container,this.editor),this._disposables.push(this._message)}show(e,t){super.show(e,t),1!==this.editor.getConfiguration().accessibilitySupport&&this.focus()}_wireModelAndView(){this._model.onCurrentMarkerChanged(this.showAtMarker,this,this._callOnDispose),this._model.onMarkerSetChanged(this._onMarkersChanged,this,this._callOnDispose)}showAtMarker(t){t&&(this._container.classList.remove("stale"),this._title.innerHTML=Jt("title.wo_source","({0}/{1})",this._model.indexOf(t),this._model.total),this._message.update(t),this._model.withoutWatchingEditorPosition(()=>{this._severity=t.severity,this._applyTheme(this._themeService.getTheme()),this.show(new e(t.startLineNumber,t.startColumn),this.computeRequiredHeight())}))}_onMarkersChanged(){const e=this._model.findMarkerAtPosition(this.position)
e?(this._container.classList.remove("stale"),this._message.update(e)):this._container.classList.add("stale"),this._relayout()}_doLayout(e,t){this._message.layout(e,t)}_relayout(){super._relayout(this.computeRequiredHeight())}computeRequiredHeight(){return 1+this._message.lines}}(this._editor,this._model,this._themeService),this._markersNavigationVisible.set(!0),this._callOnClose.push(this._model),this._callOnClose.push(this._zone),this._callOnClose.push(this._editor.onDidChangeModel(()=>this._cleanUp())),this._model.onCurrentMarkerChanged(e=>!e&&this._cleanUp(),void 0,this._callOnClose),this._markerService.onMarkerChanged(this._onMarkerChanged,this,this._callOnClose),this._model}closeMarkersNavigation(){this._cleanUp(),this._editor.focus()}_onMarkerChanged(e){e.some(e=>this._editor.getModel().uri.toString()===e.toString())&&this._model.setMarkers(this._getMarkers())}_getMarkers(){return this._markerService.read({resource:this._editor.getModel().uri})}}
dy.ID="editor.contrib.markerController",dy=wy=Nn([iC,En(1,ay),En(2,Lo),En(3,Mg)],dy)
Oo(class extends hy{constructor(){super(!0,{id:"editor.action.marker.next",label:Jt("markerAction.next.label","Go to Next Error or Warning"),alias:"Go to Next Error or Warning",precondition:Vo.writable,kbOpts:{kbExpr:Vo.focus,primary:66}})}})
Oo(class extends hy{constructor(){super(!1,{id:"editor.action.marker.prev",label:Jt("markerAction.previous.label","Go to Previous Error or Warning"),alias:"Go to Previous Error or Warning",precondition:Vo.writable,kbOpts:{kbExpr:Vo.focus,primary:1090}})}})
const uy=new xo("markersNavigationVisible",!1),cy=Do.bindToContribution(dy.get)
No.registerEditorCommand(new cy({id:"closeMarkersNavigation",precondition:uy,handler:e=>e.closeMarkersNavigation(),kbOpts:{weight:No.commandWeight(50),kbExpr:Vo.focus,primary:9,secondary:[1033]}}))
let gy=Eg(Jg,Qg),my=Eg(em,tm),py=Eg(im,nm)
const fy=hc("editorMarkerNavigationError.background",{dark:gy,light:gy,hc:gy},Jt("editorMarkerNavigationError","Editor marker navigation widget error color.")),_y=hc("editorMarkerNavigationWarning.background",{dark:my,light:my,hc:my},Jt("editorMarkerNavigationWarning","Editor marker navigation widget warning color.")),Cy=hc("editorMarkerNavigationInfo.background",{dark:py,light:py,hc:py},Jt("editorMarkerNavigationInfo","Editor marker navigation widget info color.")),by=hc("editorMarkerNavigation.background",{dark:"#2D2D30",light:Td.white,hc:"#0C141F"},Jt("editorMarkerNavigationBackground","Editor marker navigation widget background."))
var wy
const vy=Ir("openerService"),Sy=Object.freeze({_serviceBrand:void 0,open:()=>bt.as(void 0)})
function yy(e,t){const i=[],n=As.ordered(e).map((n,s)=>ca(i=>n.provideHover(e,t,i)).then(e=>{if(e){let t=void 0!==e.range,n=void 0!==e.contents&&e.contents&&e.contents.length>0
t&&n&&(i[s]=e)}},e=>{yt(e)}))
return bt.join(n).then(()=>(s=i,s?s.filter(e=>!!e):s))
var s}No.registerDefaultLanguageCommand("_executeHoverProvider",yy)
class xy{constructor(e,t,i,n){this._computer=e,this._state=0,this._firstWaitScheduler=new Ca(()=>this._triggerAsyncComputation(),this._getHoverTimeMillis()/2),this._secondWaitScheduler=new Ca(()=>this._triggerSyncComputation(),this._getHoverTimeMillis()/2),this._loadingMessageScheduler=new Ca(()=>this._showLoadingMessage(),3*this._getHoverTimeMillis()),this._asyncComputationPromise=null,this._asyncComputationPromiseDone=!1,this._completeCallback=t,this._errorCallback=i,this._progressCallback=n}getComputer(){return this._computer}_getHoverTimeMillis(){return this._computer.getHoverTimeMillis?this._computer.getHoverTimeMillis():xy.HOVER_TIME}_triggerAsyncComputation(){this._state=2,this._secondWaitScheduler.schedule(),this._computer.computeAsync?(this._asyncComputationPromiseDone=!1,this._asyncComputationPromise=this._computer.computeAsync().then(e=>{this._asyncComputationPromiseDone=!0,this._withAsyncResult(e)},e=>this._onError(e))):this._asyncComputationPromiseDone=!0}_triggerSyncComputation(){this._computer.computeSync&&this._computer.onResult(this._computer.computeSync(),!0),this._asyncComputationPromiseDone?(this._state=0,this._onComplete(this._computer.getResult())):(this._state=3,this._onProgress(this._computer.getResult()))}_showLoadingMessage(){3===this._state&&this._onProgress(this._computer.getResultWithLoadingMessage())}_withAsyncResult(e){e&&this._computer.onResult(e,!1),3===this._state&&(this._state=0,this._onComplete(this._computer.getResult()))}_onComplete(e){this._completeCallback&&this._completeCallback(e)}_onError(e){this._errorCallback?this._errorCallback(e):St(e)}_onProgress(e){this._progressCallback&&this._progressCallback(e)}start(){0===this._state&&(this._state=1,this._firstWaitScheduler.schedule(),this._loadingMessageScheduler.schedule())}cancel(){this._loadingMessageScheduler.cancel(),1===this._state&&this._firstWaitScheduler.cancel(),2===this._state&&(this._secondWaitScheduler.cancel(),this._asyncComputationPromise&&(this._asyncComputationPromise.cancel(),this._asyncComputationPromise=null)),3===this._state&&this._asyncComputationPromise&&(this._asyncComputationPromise.cancel(),this._asyncComputationPromise=null),this._state=0}}xy.HOVER_TIME=300
class Ly extends ff{constructor(e,t){super(),this.disposables=[],this.allowEditorOverflow=!0,this._id=e,this._editor=t,this._isVisible=!1,this._containerDomNode=document.createElement("div"),this._containerDomNode.className="monaco-editor-hover hidden",this._containerDomNode.tabIndex=0,this._domNode=document.createElement("div"),this._domNode.className="monaco-editor-hover-content",this.scrollbar=new Rf(this._domNode,{}),this.disposables.push(this.scrollbar),this._containerDomNode.appendChild(this.scrollbar.getDomNode()),this.onkeydown(this._containerDomNode,e=>{e.equals(9)&&this.hide()}),this._register(this._editor.onDidChangeConfiguration(e=>{e.fontInfo&&this.updateFont()})),this._editor.onDidLayoutChange(e=>this.updateMaxHeight()),this.updateMaxHeight(),this._editor.addContentWidget(this),this._showAtPosition=null}get isVisible(){return this._isVisible}set isVisible(e){this._isVisible=e,el(this._containerDomNode,"hidden",!this._isVisible)}getId(){return this._id}getDomNode(){return this._containerDomNode}showAt(t,i){this._showAtPosition=new e(t.lineNumber,t.column),this.isVisible=!0,this._editor.layoutContentWidget(this),this._editor.render(),this._stoleFocus=i,i&&this._containerDomNode.focus()}hide(){this.isVisible&&(this.isVisible=!1,this._editor.layoutContentWidget(this),this._stoleFocus&&this._editor.focus())}getPosition(){return this.isVisible?{position:this._showAtPosition,preference:[pm.ABOVE,pm.BELOW]}:null}dispose(){this._editor.removeContentWidget(this),this.disposables=ei(this.disposables),super.dispose()}updateFont(){Array.prototype.slice.call(this._domNode.getElementsByClassName("code")).forEach(e=>this._editor.applyFontInfo(e))}updateContents(e){this._domNode.textContent="",this._domNode.appendChild(e),this.updateFont(),this._editor.layoutContentWidget(this),this.scrollbar.scanDomNode()}updateMaxHeight(){const e=Math.max(this._editor.getLayoutInfo().height/4,250),{fontSize:t,lineHeight:i}=this._editor.getConfiguration().fontInfo
this._domNode.style.fontSize=`${t}px`,this._domNode.style.lineHeight=`${i}px`,this._domNode.style.maxHeight=`${e}px`}}class Ny extends ff{constructor(e,t){super(),this._id=e,this._editor=t,this._isVisible=!1,this._domNode=document.createElement("div"),this._domNode.className="monaco-editor-hover hidden",this._domNode.setAttribute("aria-hidden","true"),this._domNode.setAttribute("role","presentation"),this._showAtLineNumber=-1,this._register(this._editor.onDidChangeConfiguration(e=>{e.fontInfo&&this.updateFont()})),this._editor.addOverlayWidget(this)}get isVisible(){return this._isVisible}set isVisible(e){this._isVisible=e,el(this._domNode,"hidden",!this._isVisible)}getId(){return this._id}getDomNode(){return this._domNode}showAt(e){this._showAtLineNumber=e,this.isVisible||(this.isVisible=!0)
const t=this._editor.getLayoutInfo(),i=this._editor.getTopForLineNumber(this._showAtLineNumber),n=this._editor.getScrollTop(),s=this._editor.getConfiguration().lineHeight,r=i-n-(this._domNode.clientHeight-s)/2
this._domNode.style.left=`${t.glyphMarginLeft+t.glyphMarginWidth}px`,this._domNode.style.top=`${Math.max(Math.round(r),0)}px`}hide(){this.isVisible&&(this.isVisible=!1)}getPosition(){return null}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}updateFont(){const e=Array.prototype.slice.call(this._domNode.getElementsByTagName("code")),t=Array.prototype.slice.call(this._domNode.getElementsByClassName("code"));[...e,...t].forEach(e=>this._editor.applyFontInfo(e))}updateContents(e){this._domNode.textContent="",this._domNode.appendChild(e),this.updateFont()}}class Ey{constructor(e,t,i){this.presentationIndex=i,this._onColorFlushed=new ci,this.onColorFlushed=this._onColorFlushed.event,this._onDidChangeColor=new ci,this.onDidChangeColor=this._onDidChangeColor.event,this._onDidChangePresentation=new ci,this.onDidChangePresentation=this._onDidChangePresentation.event,this.originalColor=e,this._color=e,this._colorPresentations=t}get color(){return this._color}set color(e){this._color.equals(e)||(this._color=e,this._onDidChangeColor.fire(e))}get presentation(){return this.colorPresentations[this.presentationIndex]}get colorPresentations(){return this._colorPresentations}set colorPresentations(e){this._colorPresentations=e,this.presentationIndex>e.length-1&&(this.presentationIndex=0),this._onDidChangePresentation.fire(this.presentation)}selectNextColorPresentation(){this.presentationIndex=(this.presentationIndex+1)%this.colorPresentations.length,this.flushColor(),this._onDidChangePresentation.fire(this.presentation)}guessColorPresentation(e,t){for(let e=0;e<this.colorPresentations.length;e++)if(t===this.colorPresentations[e].label){this.presentationIndex=e,this._onDidChangePresentation.fire(this.presentation)
break}}flushColor(){this._onColorFlushed.fire(this._color)}}const ky=Al
class Iy extends ni{constructor(e,t){super(),this.model=t,this.domNode=ky(".colorpicker-header"),Tl(e,this.domNode),this.pickedColorNode=Tl(this.domNode,ky(".picked-color"))
const i=Tl(this.domNode,ky(".original-color"))
i.style.backgroundColor=Td.Format.CSS.format(this.model.originalColor),this._register(Wg((e,t)=>{this.backgroundColor=e.getColor(ug)||Td.white})),this._register(il(this.pickedColorNode,kl.CLICK,()=>this.model.selectNextColorPresentation())),this._register(il(i,kl.CLICK,()=>{this.model.color=this.model.originalColor,this.model.flushColor()})),this._register(t.onDidChangeColor(this.onDidChangeColor,this)),this._register(t.onDidChangePresentation(this.onDidChangePresentation,this)),this.pickedColorNode.style.backgroundColor=Td.Format.CSS.format(t.color),el(this.pickedColorNode,"light",t.color.rgba.a<.5?this.backgroundColor.isLighter():t.color.isLighter())}onDidChangeColor(e){this.pickedColorNode.style.backgroundColor=Td.Format.CSS.format(e),el(this.pickedColorNode,"light",e.rgba.a<.5?this.backgroundColor.isLighter():e.isLighter()),this.onDidChangePresentation()}onDidChangePresentation(){this.pickedColorNode.textContent=this.model.presentation.label}}class My extends ni{constructor(e,t,i){super(),this.container=e,this.model=t,this.pixelRatio=i,this.domNode=ky(".colorpicker-body"),Tl(e,this.domNode),this.saturationBox=new Dy(this.domNode,this.model,this.pixelRatio),this._register(this.saturationBox),this._register(this.saturationBox.onDidChange(this.onDidSaturationValueChange,this)),this._register(this.saturationBox.onColorFlushed(this.flushColor,this)),this.opacityStrip=new Oy(this.domNode,this.model),this._register(this.opacityStrip),this._register(this.opacityStrip.onDidChange(this.onDidOpacityChange,this)),this._register(this.opacityStrip.onColorFlushed(this.flushColor,this)),this.hueStrip=new Ry(this.domNode,this.model),this._register(this.hueStrip),this._register(this.hueStrip.onDidChange(this.onDidHueChange,this)),this._register(this.hueStrip.onColorFlushed(this.flushColor,this))}flushColor(){this.model.flushColor()}onDidSaturationValueChange({s:e,v:t}){const i=this.model.color.hsva
this.model.color=new Td(new Dd(i.h,e,t,i.a))}onDidOpacityChange(e){const t=this.model.color.hsva
this.model.color=new Td(new Dd(t.h,t.s,t.v,e))}onDidHueChange(e){const t=this.model.color.hsva,i=360*(1-e)
this.model.color=new Td(new Dd(360===i?0:i,t.s,t.v,t.a))}layout(){this.saturationBox.layout(),this.opacityStrip.layout(),this.hueStrip.layout()}}class Dy extends ni{constructor(e,t,i){super(),this.model=t,this.pixelRatio=i,this._onDidChange=new ci,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new ci,this.onColorFlushed=this._onColorFlushed.event,this.domNode=ky(".saturation-wrap"),Tl(e,this.domNode),this.canvas=document.createElement("canvas"),this.canvas.className="saturation-box",Tl(this.domNode,this.canvas),this.selection=ky(".saturation-selection"),Tl(this.domNode,this.selection),this.layout(),this._register(il(this.domNode,kl.MOUSE_DOWN,e=>this.onMouseDown(e))),this._register(this.model.onDidChangeColor(this.onDidChangeColor,this)),this.monitor=null}onMouseDown(e){this.monitor=this._register(new ym)
const t=Cl(this.domNode)
e.target!==this.selection&&this.onDidChangePosition(e.offsetX,e.offsetY),this.monitor.startMonitoring(Sm,e=>this.onDidChangePosition(e.posx-t.left,e.posy-t.top),()=>null)
const i=il(document,kl.MOUSE_UP,()=>{this._onColorFlushed.fire(),i.dispose(),this.monitor.stopMonitoring(!0),this.monitor=null},!0)}onDidChangePosition(e,t){const i=Math.max(0,Math.min(1,e/this.width)),n=Math.max(0,Math.min(1,1-t/this.height))
this.paintSelection(i,n),this._onDidChange.fire({s:i,v:n})}layout(){this.width=this.domNode.offsetWidth,this.height=this.domNode.offsetHeight,this.canvas.width=this.width*this.pixelRatio,this.canvas.height=this.height*this.pixelRatio,this.paint()
const e=this.model.color.hsva
this.paintSelection(e.s,e.v)}paint(){const e=this.model.color.hsva,t=new Td(new Dd(e.h,1,1,1)),i=this.canvas.getContext("2d"),n=i.createLinearGradient(0,0,this.canvas.width,0)
n.addColorStop(0,"rgba(255, 255, 255, 1)"),n.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),n.addColorStop(1,"rgba(255, 255, 255, 0)")
const s=i.createLinearGradient(0,0,0,this.canvas.height)
s.addColorStop(0,"rgba(0, 0, 0, 0)"),s.addColorStop(1,"rgba(0, 0, 0, 1)"),i.rect(0,0,this.canvas.width,this.canvas.height),i.fillStyle=Td.Format.CSS.format(t),i.fill(),i.fillStyle=n,i.fill(),i.fillStyle=s,i.fill()}paintSelection(e,t){this.selection.style.left=`${e*this.width}px`,this.selection.style.top=`${this.height-t*this.height}px`}onDidChangeColor(){this.monitor&&this.monitor.isMonitoring()||this.paint()}}class Ty extends ni{constructor(e,t){super(),this.model=t,this._onDidChange=new ci,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new ci,this.onColorFlushed=this._onColorFlushed.event,this.domNode=Tl(e,ky(".strip")),this.overlay=Tl(this.domNode,ky(".overlay")),this.slider=Tl(this.domNode,ky(".slider")),this.slider.style.top="0px",this._register(il(this.domNode,kl.MOUSE_DOWN,e=>this.onMouseDown(e))),this.layout()}layout(){this.height=this.domNode.offsetHeight-this.slider.offsetHeight
const e=this.getValue(this.model.color)
this.updateSliderPosition(e)}onMouseDown(e){const t=this._register(new ym),i=Cl(this.domNode)
Ja(this.domNode,"grabbing"),e.target!==this.slider&&this.onDidChangeTop(e.offsetY),t.startMonitoring(Sm,e=>this.onDidChangeTop(e.posy-i.top),()=>null)
const n=il(document,kl.MOUSE_UP,()=>{this._onColorFlushed.fire(),n.dispose(),t.stopMonitoring(!0),Qa(this.domNode,"grabbing")},!0)}onDidChangeTop(e){const t=Math.max(0,Math.min(1,1-e/this.height))
this.updateSliderPosition(t),this._onDidChange.fire(t)}updateSliderPosition(e){this.slider.style.top=`${(1-e)*this.height}px`}}class Oy extends Ty{constructor(e,t){super(e,t),Ja(this.domNode,"opacity-strip"),this._register(t.onDidChangeColor(this.onDidChangeColor,this)),this.onDidChangeColor(this.model.color)}onDidChangeColor(e){const{r:t,g:i,b:n}=e.rgba,s=new Td(new Id(t,i,n,1)),r=new Td(new Id(t,i,n,0))
this.overlay.style.background=`linear-gradient(to bottom, ${s} 0%, ${r} 100%)`}getValue(e){return e.hsva.a}}class Ry extends Ty{constructor(e,t){super(e,t),Ja(this.domNode,"hue-strip")}getValue(e){return 1-e.hsva.h/360}}class Ay extends ff{constructor(e,t,i){super(),this.model=t,this.pixelRatio=i,this._register(va(()=>this.layout()))
const n=ky(".colorpicker-widget")
e.appendChild(n)
const s=new Iy(n,this.model)
this.body=new My(n,this.model,this.pixelRatio),this._register(s),this._register(this.body)}getId(){return Ay.ID}layout(){this.body.layout()}}function Py(e,t,i){return ca(n=>i.provideColorPresentations(e,t,n))}Ay.ID="editor.contrib.colorPickerWidget"
let Fy=Wy=class{constructor(e,t,i){this._editor=e,this._codeEditorService=t,this._configurationService=i,this._globalToDispose=[],this._localToDispose=[],this._decorationsIds=[],this._colorDatas=new Map,this._colorDecoratorIds=[],this._decorationsTypes={},this._globalToDispose.push(e.onDidChangeModel(e=>{this._isEnabled=this.isEnabled(),this.onModelChanged()})),this._globalToDispose.push(e.onDidChangeModelLanguage(e=>this.onModelChanged())),this._globalToDispose.push(Gs.onDidChange(e=>this.onModelChanged())),this._globalToDispose.push(e.onDidChangeConfiguration(e=>{let t=this._isEnabled
this._isEnabled=this.isEnabled(),t!==this._isEnabled&&(this._isEnabled?this.onModelChanged():this.removeAllDecorations())})),this._timeoutPromise=null,this._computePromise=null,this._isEnabled=this.isEnabled(),this.onModelChanged()}isEnabled(){const e=this._editor.getModel()
if(!e)return!1
const t=e.getLanguageIdentifier()
let i=this._configurationService.getConfiguration(t.language)
if(i){let e=i.colorDecorators
if(e&&void 0!==e.enable&&!e.enable)return e.enable}return this._editor.getConfiguration().contribInfo.colorDecorators}getId(){return Wy.ID}static get(e){return e.getContribution(this.ID)}dispose(){this.stop(),this.removeAllDecorations(),this._globalToDispose=ei(this._globalToDispose)}onModelChanged(){if(this.stop(),!this._isEnabled)return
const e=this._editor.getModel()
Gs.has(e)&&(this._localToDispose.push(this._editor.onDidChangeModelContent(e=>{this._timeoutPromise||(this._timeoutPromise=bt.timeout(Wy.RECOMPUTE_TIME),this._timeoutPromise.then(()=>{this._timeoutPromise=null,this.beginCompute()}))})),this.beginCompute())}beginCompute(){this._computePromise=function(e){const t=[],i=Gs.ordered(e).reverse().map(i=>ca(t=>i.provideDocumentColors(e,t)).then(e=>{if(Array.isArray(e))for(let n of e)t.push({colorInfo:n,provider:i})}))
return bt.join(i).then(()=>t)}(this._editor.getModel()).then(e=>{this.updateDecorations(e),this.updateColorDecorators(e),this._computePromise=null})}stop(){this._timeoutPromise&&(this._timeoutPromise.cancel(),this._timeoutPromise=null),this._computePromise&&(this._computePromise.cancel(),this._computePromise=null),this._localToDispose=ei(this._localToDispose)}updateDecorations(e){const t=e.map(e=>({range:{startLineNumber:e.colorInfo.range.startLineNumber,startColumn:e.colorInfo.range.startColumn,endLineNumber:e.colorInfo.range.endLineNumber,endColumn:e.colorInfo.range.endColumn},options:{}}))
this._decorationsIds=this._editor.deltaDecorations(this._decorationsIds,t),this._colorDatas=new Map,this._decorationsIds.forEach((t,i)=>this._colorDatas.set(t,e[i]))}updateColorDecorators(e){let t=[],i={}
for(let n=0;n<e.length&&t.length<500;n++){const{red:s,green:r,blue:o,alpha:a}=e[n].colorInfo.color,l=new Id(Math.round(255*s),Math.round(255*r),Math.round(255*o),a)
let h=iu(l).toString(16),d=`rgba(${l.r}, ${l.g}, ${l.b}, ${l.a})`,u="colorBox-"+h
this._decorationsTypes[u]||i[u]||this._codeEditorService.registerDecorationType(u,{before:{contentText:" ",border:"solid 0.1em #000",margin:"0.1em 0.2em 0 0.2em",width:"0.8em",height:"0.8em",backgroundColor:d},dark:{before:{border:"solid 0.1em #eee"}}}),i[u]=!0,t.push({range:{startLineNumber:e[n].colorInfo.range.startLineNumber,startColumn:e[n].colorInfo.range.startColumn,endLineNumber:e[n].colorInfo.range.endLineNumber,endColumn:e[n].colorInfo.range.endColumn},options:this._codeEditorService.resolveDecorationOptions(u,!0)})}for(let e in this._decorationsTypes)i[e]||this._codeEditorService.removeDecorationType(e)
this._colorDecoratorIds=this._editor.deltaDecorations(this._colorDecoratorIds,t)}removeAllDecorations(){this._decorationsIds=this._editor.deltaDecorations(this._decorationsIds,[]),this._colorDecoratorIds=this._editor.deltaDecorations(this._colorDecoratorIds,[])
for(let e in this._decorationsTypes)this._codeEditorService.removeDecorationType(e)}getColorData(e){const i=this._editor.getModel().getDecorationsInRange(t.fromPositions(e,e)).filter(e=>this._colorDatas.has(e.id))
return 0===i.length?null:this._colorDatas.get(i[0].id)}}
var Wy
Fy.ID="editor.contrib.colorDetector",Fy.RECOMPUTE_TIME=1e3,Fy=Wy=Nn([iC,En(1,Eo),En(2,gw)],Fy)
const Vy=Al
class By{constructor(e,t,i){this.range=e,this.color=t,this.provider=i}}class Hy{constructor(e){this._editor=e,this._range=null}setRange(e){this._range=e,this._result=[]}clearResult(){this._result=[]}computeAsync(){const t=this._editor.getModel()
return As.has(t)?yy(t,new e(this._range.startLineNumber,this._range.startColumn)):bt.as(null)}computeSync(){const e=this._range.startLineNumber
if(e>this._editor.getModel().getLineCount())return[]
const i=Fy.get(this._editor),n=this._editor.getModel().getLineMaxColumn(e)
let s=!1
return this._editor.getLineDecorations(e).map(r=>{const o=r.range.startLineNumber===e?r.range.startColumn:1,a=r.range.endLineNumber===e?r.range.endColumn:n
if(o>this._range.startColumn||this._range.endColumn>a)return null
const l=new t(this._range.startLineNumber,o,this._range.startLineNumber,a),h=i.getColorData(r.range.getStartPosition())
if(!s&&h){s=!0
const{color:e,range:t}=h.colorInfo
return new By(t,e,h.provider)}{if(Dh(r.options.hoverMessage))return null
let e
return r.options.hoverMessage&&(e=Array.isArray(r.options.hoverMessage)?[...r.options.hoverMessage]:[r.options.hoverMessage]),{contents:e,range:l}}}).filter(e=>!!e)}onResult(e,t){this._result=t?e.concat(this._result.sort((e,t)=>e instanceof By?-1:t instanceof By?1:0)):this._result.concat(e)}getResult(){return this._result.slice(0)}getResultWithLoadingMessage(){return this._result.slice(0).concat([this._getLoadingMessage()])}_getLoadingMessage(){return{range:this._range,contents:[(new Mh).appendText(Jt("modesContentHover.loading","Loading..."))]}}}class zy extends Ly{constructor(e,t){super(zy.ID,e),this.renderDisposable=Qt,this._computer=new Hy(this._editor),this._highlightDecorations=[],this._isChangingDecorations=!1,this._markdownRenderer=t,this._hoverOperation=new xy(this._computer,e=>this._withResult(e,!0),null,e=>this._withResult(e,!1)),this.toDispose=[],this.toDispose.push(nl(this.getDomNode(),kl.FOCUS,()=>{this._colorPicker&&Ja(this.getDomNode(),"colorpicker-hover")})),this.toDispose.push(nl(this.getDomNode(),kl.BLUR,()=>{Qa(this.getDomNode(),"colorpicker-hover")}))}dispose(){this.renderDisposable.dispose(),this.renderDisposable=Qt,this._hoverOperation.cancel(),this.toDispose=ei(this.toDispose),super.dispose()}onModelDecorationsChanged(){this._isChangingDecorations||this.isVisible&&(this._hoverOperation.cancel(),this._computer.clearResult(),this._colorPicker||this._hoverOperation.start())}startShowingAt(e,t){if(!this._lastRange||!this._lastRange.equalsRange(e)){if(this._hoverOperation.cancel(),this.isVisible)if(this._showAtPosition.lineNumber!==e.startLineNumber)this.hide()
else{for(var i=[],n=0,s=this._messages.length;n<s;n++){var r=this._messages[n],o=r.range
o.startColumn<=e.startColumn&&o.endColumn>=e.endColumn&&i.push(r)}if(i.length>0){if(function(e,t){if(!e&&t||e&&!t||e.length!==t.length)return!1
for(let i=0;i<e.length;i++){const n=e[i],s=t[i]
if(n instanceof By)return!1
if(s instanceof By)return!1
if(!Oh(n.contents,s.contents))return!1}return!0}(i,this._messages))return
this._renderMessages(e,i)}else this.hide()}this._lastRange=e,this._computer.setRange(e),this._shouldFocus=t,this._hoverOperation.start()}}hide(){this._lastRange=null,this._hoverOperation.cancel(),super.hide(),this._isChangingDecorations=!0,this._highlightDecorations=this._editor.deltaDecorations(this._highlightDecorations,[]),this._isChangingDecorations=!1,this.renderDisposable.dispose(),this.renderDisposable=Qt,this._colorPicker=null}isColorPickerVisible(){return!!this._colorPicker}_withResult(e,t){this._messages=e,this._lastRange&&this._messages.length>0?this._renderMessages(this._lastRange,this._messages):t&&this.hide()}_renderMessages(i,n){this.renderDisposable.dispose(),this._colorPicker=null
var s=Number.MAX_VALUE,r=n[0].range,o=document.createDocumentFragment()
let a=!1
n.forEach(n=>{if(n.range)if(s=Math.min(s,n.range.startColumn),r=t.plusRange(r,n.range),n instanceof By){a=!0
const{red:r,green:l,blue:h,alpha:d}=n.color,u=new Id(255*r,255*l,255*h,d),c=new Td(u),g=this._editor.getModel()
let m=new t(n.range.startLineNumber,n.range.startColumn,n.range.endLineNumber,n.range.endColumn),p={range:n.range,color:n.color}
const f=new Ey(c,[],0),_=new Ay(o,f,this._editor.getConfiguration().pixelRatio)
Py(g,p,n.provider).then(r=>{f.colorPresentations=r
const a=this._editor.getModel().getValueInRange(n.range)
f.guessColorPresentation(c,a)
const l=()=>{let e,i
f.presentation.textEdit?(e=[f.presentation.textEdit],i=(i=new t(f.presentation.textEdit.range.startLineNumber,f.presentation.textEdit.range.startColumn,f.presentation.textEdit.range.endLineNumber,f.presentation.textEdit.range.endColumn)).setEndPosition(i.endLineNumber,i.startColumn+f.presentation.textEdit.text.length)):(e=[{identifier:null,range:m,text:f.presentation.label,forceMoveMarkers:!1}],i=m.setEndPosition(m.endLineNumber,m.startColumn+f.presentation.label.length)),g.pushEditOperations([],e,()=>[]),f.presentation.additionalTextEdits&&(e=[...f.presentation.additionalTextEdits],g.pushEditOperations([],e,()=>[]),this.hide()),this._editor.pushUndoStop(),m=i},h=e=>Py(g,{range:m,color:{red:e.rgba.r/255,green:e.rgba.g/255,blue:e.rgba.b/255,alpha:e.rgba.a}},n.provider).then(e=>{f.colorPresentations=e}),d=f.onColorFlushed(e=>{h(e).then(l)}),u=f.onDidChangeColor(h)
this._colorPicker=_,this.showAt(new e(i.startLineNumber,s),this._shouldFocus),this.updateContents(o),this._colorPicker.layout(),this.renderDisposable=ti([d,u,_])})}else n.contents.filter(e=>!Dh(e)).forEach(e=>{const t=this._markdownRenderer.render(e)
o.appendChild(Vy("div.hover-row",null,t))})}),a||(this.showAt(new e(i.startLineNumber,s),this._shouldFocus),this.updateContents(o)),this._isChangingDecorations=!0,this._highlightDecorations=this._editor.deltaDecorations(this._highlightDecorations,[{range:r,options:zy._DECORATION_OPTIONS}]),this._isChangingDecorations=!1}}zy.ID="editor.contrib.modesContentHoverWidget",zy._DECORATION_OPTIONS=Ld.register({className:"hoverHighlight"})
class Uy{constructor(e){this._editor=e,this._lineNumber=-1}setLineNumber(e){this._lineNumber=e,this._result=[]}clearResult(){this._result=[]}computeSync(){const e=e=>({value:e})
let t=this._editor.getLineDecorations(this._lineNumber),i=[]
for(let n=0,s=t.length;n<s;n++){let s=t[n]
if(!s.options.glyphMarginClassName)continue
let r=s.options.glyphMarginHoverMessage
Dh(r)||(Array.isArray(r)?i=i.concat(r.map(e)):i.push(e(r)))}return i}onResult(e,t){this._result=this._result.concat(e)}getResult(){return this._result}getResultWithLoadingMessage(){return this.getResult()}}class Ky extends Ny{constructor(e,t){super(Ky.ID,e),this._lastLineNumber=-1,this._markdownRenderer=t,this._computer=new Uy(this._editor),this._hoverOperation=new xy(this._computer,e=>this._withResult(e),null,e=>this._withResult(e))}dispose(){this._hoverOperation.cancel(),super.dispose()}onModelDecorationsChanged(){this.isVisible&&(this._hoverOperation.cancel(),this._computer.clearResult(),this._hoverOperation.start())}startShowingAt(e){this._lastLineNumber!==e&&(this._hoverOperation.cancel(),this.hide(),this._lastLineNumber=e,this._computer.setLineNumber(e),this._hoverOperation.start())}hide(){this._lastLineNumber=-1,this._hoverOperation.cancel(),super.hide()}_withResult(e){this._messages=e,this._messages.length>0?this._renderMessages(this._lastLineNumber,this._messages):this.hide()}_renderMessages(e,t){const i=document.createDocumentFragment()
t.forEach(e=>{const t=this._markdownRenderer.render(e.value)
i.appendChild(Al("div.hover-row",null,t))}),this.updateContents(i),this.showAt(e)}}Ky.ID="editor.contrib.modesGlyphHoverWidget"
let $y=class{constructor(e,t,i=Sy){this._modeService=t,this._openerService=i,this._options={actionCallback:e=>{this._openerService.open(X.parse(e)).then(void 0,St)},codeBlockRenderer:(t,i)=>{const n=t?this._modeService.getModeIdForLanguageName(t):e.getModel().getLanguageIdentifier().language
return this._modeService.getOrCreateMode(n).then(e=>wh(i,n)).then(t=>`<span style="font-family: ${e.getConfiguration().fontInfo.fontFamily}">${t}</span>`)}}}render(e,t){return e?pC(e,t?Object.assign({},t,this._options):this._options):document.createElement("span")}}
$y=Nn([En(1,XS),En(2,Mr(vy))],$y)
let qy=Gy=class{constructor(e,t,i){if(this._editor=e,this._toUnhook=[],this._isMouseDown=!1,e.getConfiguration().contribInfo.hover){this._toUnhook.push(this._editor.onMouseDown(e=>this._onEditorMouseDown(e))),this._toUnhook.push(this._editor.onMouseUp(e=>this._onEditorMouseUp(e))),this._toUnhook.push(this._editor.onMouseMove(e=>this._onEditorMouseMove(e))),this._toUnhook.push(this._editor.onMouseLeave(e=>this._hideWidgets())),this._toUnhook.push(this._editor.onKeyDown(e=>this._onKeyDown(e))),this._toUnhook.push(this._editor.onDidChangeModel(()=>this._hideWidgets())),this._toUnhook.push(this._editor.onDidChangeModelDecorations(()=>this._onModelDecorationsChanged())),this._toUnhook.push(this._editor.onDidScrollChange(e=>{(e.scrollTopChanged||e.scrollLeftChanged)&&this._hideWidgets()}))
const n=new $y(e,i,t)
this._contentWidget=new zy(e,n),this._glyphWidget=new Ky(e,n)}}static get(e){return e.getContribution(Gy.ID)}_onModelDecorationsChanged(){this._contentWidget.onModelDecorationsChanged(),this._glyphWidget.onModelDecorationsChanged()}_onEditorMouseDown(e){this._isMouseDown=!0
var t=e.target.type
t!==bm.CONTENT_WIDGET||e.target.detail!==zy.ID?t===bm.OVERLAY_WIDGET&&e.target.detail===Ky.ID||(t!==bm.OVERLAY_WIDGET&&e.target.detail!==Ky.ID&&(this._hoverClicked=!1),this._hideWidgets()):this._hoverClicked=!0}_onEditorMouseUp(e){this._isMouseDown=!1}_onEditorMouseMove(e){var t=e.target.type,i=k?"metaKey":"ctrlKey"
this._isMouseDown&&this._hoverClicked&&this._contentWidget.isColorPickerVisible()||(t!==bm.CONTENT_WIDGET||e.target.detail!==zy.ID||e.event[i])&&(t!==bm.OVERLAY_WIDGET||e.target.detail!==Ky.ID||e.event[i])&&(this._editor.getConfiguration().contribInfo.hover&&t===bm.CONTENT_TEXT?(this._glyphWidget.hide(),this._contentWidget.startShowingAt(e.target.range,!1)):t===bm.GUTTER_GLYPH_MARGIN?(this._contentWidget.hide(),this._glyphWidget.startShowingAt(e.target.position.lineNumber)):this._hideWidgets())}_onKeyDown(e){5!==e.keyCode&&6!==e.keyCode&&57!==e.keyCode&&this._hideWidgets()}_hideWidgets(){this._isMouseDown&&this._hoverClicked&&this._contentWidget.isColorPickerVisible()||(this._glyphWidget.hide(),this._contentWidget.hide())}showContentHover(e,t){this._contentWidget.startShowingAt(e,t)}getId(){return Gy.ID}dispose(){this._toUnhook=ei(this._toUnhook),this._glyphWidget&&(this._glyphWidget.dispose(),this._glyphWidget=null),this._contentWidget&&(this._contentWidget.dispose(),this._contentWidget=null)}}
qy.ID="editor.contrib.hover",qy=Gy=Nn([iC,En(1,vy),En(2,XS)],qy)
var Gy
Oo(class extends To{constructor(){super({id:"editor.action.showHover",label:Jt("showHover","Show Hover"),alias:"Show Hover",precondition:null,kbOpts:{kbExpr:Vo.textFocus,primary:Wr(2089,2087)}})}run(e,i){let n=qy.get(i)
if(!n)return
const s=i.getPosition(),r=new t(s.lineNumber,s.column,s.lineNumber,s.column)
n.showContentHover(r,!0)}}),Wg((e,t)=>{let i=e.getColor(dg)
i&&t.addRule(`.monaco-editor .hoverHighlight { background-color: ${i}; }`)
let n=e.getColor(ug)
n&&t.addRule(`.monaco-editor .monaco-editor-hover { background-color: ${n}; }`)
let s=e.getColor(cg)
s&&(t.addRule(`.monaco-editor .monaco-editor-hover { border: 1px solid ${s}; }`),t.addRule(`.monaco-editor .monaco-editor-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${s.transparent(.5)}; }`))
let r=e.getColor(pc)
r&&t.addRule(`.monaco-editor .monaco-editor-hover a { color: ${r}; }`)
let o=e.getColor(fc)
o&&t.addRule(`.monaco-editor .monaco-editor-hover code { background-color: ${o}; }`)})
let jy=Yy=class{constructor(e,t){this.editor=e,this.editorWorkerService=t,this.requestIdPool=0,this.currentRequest=bt.as(null),this.decorationRemover=bt.as(null),this.decorationIds=[]}static get(e){return e.getContribution(Yy.ID)}dispose(){}getId(){return Yy.ID}run(e,i){this.currentRequest.cancel()
var n=this.editor.getSelection(),s=this.editor.getModel().uri
if(n.startLineNumber!==n.endLineNumber)return null
var r=new Qb(this.editor,5)
return this.editorWorkerService.canNavigateValueSet(s)?(this.currentRequest=this.editorWorkerService.navigateValueSet(s,n,i),this.currentRequest=this.currentRequest.then(e=>e&&e.range&&e.value?e:null)):this.currentRequest=bt.as(null),this.currentRequest.then(i=>{if(i&&i.range&&i.value&&r.validate(this.editor)){var s=t.lift(i.range),o=i.range,a=i.value.length-(n.endColumn-n.startColumn)
o={startLineNumber:o.startLineNumber,startColumn:o.startColumn,endLineNumber:o.endLineNumber,endColumn:o.startColumn+i.value.length},a>1&&(n=new At(n.startLineNumber,n.startColumn,n.endLineNumber,n.endColumn+a-1))
var l=new class{constructor(e,t,i){this._editRange=e,this._originalSelection=t,this._text=i}getEditOperations(e,t){t.addTrackedEditOperation(this._editRange,this._text)}computeCursorState(e,t){var i=t.getInverseEditOperations()[0].range
return this._originalSelection.isEmpty()?new At(i.endLineNumber,Math.min(this._originalSelection.positionColumn,i.endColumn),i.endLineNumber,Math.min(this._originalSelection.positionColumn,i.endColumn)):new At(i.endLineNumber,i.endColumn-this._text.length,i.endLineNumber,i.endColumn)}}(s,n,i.value)
this.editor.pushUndoStop(),this.editor.executeCommand(e,l),this.editor.pushUndoStop(),this.decorationIds=this.editor.deltaDecorations(this.decorationIds,[{range:o,options:Yy.DECORATION}]),this.decorationRemover.cancel(),this.decorationRemover=bt.timeout(350),this.decorationRemover.then(()=>{this.editor.changeDecorations(e=>{this.decorationIds=e.deltaDecorations(this.decorationIds,[])})})}})}}
jy.ID="editor.contrib.inPlaceReplaceController",jy.DECORATION=Ld.register({className:"valueSetReplacement"}),jy=Yy=Nn([Po,En(1,Jb)],jy)
Oo(class extends To{constructor(){super({id:"editor.action.inPlaceReplace.up",label:Jt("InPlaceReplaceAction.previous.label","Replace with Previous Value"),alias:"Replace with Previous Value",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:3154}})}run(e,t){let i=jy.get(t)
if(i)return i.run(this.id,!0)}})
var Yy
Oo(class extends To{constructor(){super({id:"editor.action.inPlaceReplace.down",label:Jt("InPlaceReplaceAction.next.label","Replace with Next Value"),alias:"Replace with Next Value",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:3156}})}run(e,t){let i=jy.get(t)
if(i)return i.run(this.id,!1)}}),Wg((e,t)=>{let i=e.getColor(Yg)
i&&t.addRule(`.monaco-editor.vs .valueSetReplacement { outline: solid 2px ${i}; }`)})
class Zy{constructor(e,t){this.selection=e,this.descending=t}getEditOperations(e,i){let n=function(e,i,n){let s=Xy(e,i,n)
if(!s)return null
return C_.replace(new t(s.startLineNumber,1,s.endLineNumber,e.getLineMaxColumn(s.endLineNumber)),s.after.join("\n"))}(e,this.selection,this.descending)
n&&i.addEditOperation(n.range,n.text),this.selectionId=i.trackSelection(this.selection)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}static canRun(e,t,i){let n=Xy(e,t,i)
if(!n)return!1
for(let e=0,t=n.before.length;e<t;e++)if(n.before[e]!==n.after[e])return!0
return!1}}function Xy(e,t,i){let n=t.startLineNumber,s=t.endLineNumber
if(1===t.endColumn&&s--,n>=s)return null
let r=[]
for(let t=n;t<=s;t++)r.push(e.getLineContent(t))
let o=r.slice(0)
return o.sort((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase())),!0===i&&(o=o.reverse()),{startLineNumber:n,endLineNumber:s,before:r,after:o}}class Jy{constructor(e,t){this._selection=e,this._isCopyingDown=t}getEditOperations(e,i){var n=this._selection
this._startLineNumberDelta=0,this._endLineNumberDelta=0,n.startLineNumber<n.endLineNumber&&1===n.endColumn&&(this._endLineNumberDelta=1,n=n.setEndPosition(n.endLineNumber-1,e.getLineMaxColumn(n.endLineNumber-1)))
for(var s=[],r=n.startLineNumber;r<=n.endLineNumber;r++)s.push(e.getLineContent(r))
var o=s.join("\n")
""===o&&this._isCopyingDown&&(this._startLineNumberDelta++,this._endLineNumberDelta++),this._isCopyingDown?i.addEditOperation(new t(n.startLineNumber,1,n.startLineNumber,1),o+"\n"):i.addEditOperation(new t(n.endLineNumber,e.getLineMaxColumn(n.endLineNumber),n.endLineNumber,e.getLineMaxColumn(n.endLineNumber)),"\n"+o),this._selectionId=i.trackSelection(n),this._selectionDirection=this._selection.getDirection()}computeCursorState(e,t){var i=t.getTrackedSelection(this._selectionId)
if(0!==this._startLineNumberDelta||0!==this._endLineNumberDelta){var n=i.startLineNumber,s=i.startColumn,r=i.endLineNumber,o=i.endColumn
0!==this._startLineNumberDelta&&(n+=this._startLineNumberDelta,s=1),0!==this._endLineNumberDelta&&(r+=this._endLineNumberDelta,o=1),i=At.createWithDirection(n,s,r,o,this._selectionDirection)}return i}}class Qy{static createFromSelection(e){var t=e.endLineNumber
return e.startLineNumber<e.endLineNumber&&1===e.endColumn&&(t-=1),new Qy(e.startLineNumber,t,e.positionColumn)}constructor(e,t,i){this.startLineNumber=e,this.endLineNumber=t,this.restoreCursorToColumn=i}getEditOperations(e,i){if(1!==e.getLineCount()||1!==e.getLineMaxColumn(1)){var n=this.startLineNumber,s=this.endLineNumber,r=1,o=e.getLineMaxColumn(s)
s<e.getLineCount()?(s+=1,o=1):n>1&&(n-=1,r=e.getLineMaxColumn(n)),i.addTrackedEditOperation(new t(n,r,s,o),null)}}computeCursorState(e,t){var i=t.getInverseEditOperations()[0].range
return new At(i.endLineNumber,this.restoreCursorToColumn,i.endLineNumber,this.restoreCursorToColumn)}}function ex(e,t){let i=0
for(let n=0;n<e.length;n++)"\t"===e.charAt(n)?i+=t:i++
return i}function tx(e,t,i){e=e<0?0:e
let n=""
if(!i){let i=Math.floor(e/t)
e%=t
for(let e=0;e<i;e++)n+="\t"}for(let t=0;t<e;t++)n+=" "
return n}class ix{constructor(e,t,i){this._selection=e,this._isMovingDown=t,this._autoIndent=i,this._moveEndLineSelectionShrink=!1}getEditOperations(e,i){var n=e.getLineCount()
if(this._isMovingDown&&this._selection.endLineNumber===n)return
if(!this._isMovingDown&&1===this._selection.startLineNumber)return
this._moveEndPositionDown=!1
var s=this._selection
s.startLineNumber<s.endLineNumber&&1===s.endColumn&&(this._moveEndPositionDown=!0,s=s.setEndPosition(s.endLineNumber-1,e.getLineMaxColumn(s.endLineNumber-1)))
let r=e.getOptions().tabSize,o=e.getOptions().insertSpaces,a=this.buildIndentConverter(r),l={getLineTokens:t=>e.getLineTokens(t),getLanguageIdentifier:()=>e.getLanguageIdentifier(),getLanguageIdAtPosition:(t,i)=>e.getLanguageIdAtPosition(t,i),getLineContent:null}
if(s.startLineNumber===s.endLineNumber&&1===e.getLineMaxColumn(s.startLineNumber)){var h=s.startLineNumber,d=this._isMovingDown?h+1:h-1
1===e.getLineMaxColumn(d)?i.addEditOperation(new t(1,1,1,1),null):(i.addEditOperation(new t(h,1,h,1),e.getLineContent(d)),i.addEditOperation(new t(d,1,d,e.getLineMaxColumn(d)),null)),s=new At(d,1,d,1)}else{var u,c
if(this._isMovingDown){u=s.endLineNumber+1,c=e.getLineContent(u),i.addEditOperation(new t(u-1,e.getLineMaxColumn(u-1),u,e.getLineMaxColumn(u)),null)
let n=c
if(this.shouldAutoIndent(e,s)){let h=this.matchEnterRule(e,a,r,u,s.startLineNumber-1)
if(null!==h){let t=tx(h+ex(Ne(e.getLineContent(u)),r),r,o)
n=t+this.trimLeft(c)}else{l.getLineContent=(t=>t===s.startLineNumber?e.getLineContent(u):e.getLineContent(t))
let t=cr.getGoodIndentForLine(l,e.getLanguageIdAtPosition(u,1),s.startLineNumber,a)
if(null!==t){let i=Ne(e.getLineContent(u)),s=ex(t,r)
if(s!==ex(i,r)){let e=tx(s,r,o)
n=e+this.trimLeft(c)}}}i.addEditOperation(new t(s.startLineNumber,1,s.startLineNumber,1),n+"\n")
let d=this.matchEnterRule(e,a,r,s.startLineNumber,s.startLineNumber,n)
if(null!==d)0!==d&&this.getIndentEditsOfMovingBlock(e,i,s,r,o,d)
else{l.getLineContent=(t=>t===s.startLineNumber?n:t>=s.startLineNumber+1&&t<=s.endLineNumber+1?e.getLineContent(t-1):e.getLineContent(t))
let t=cr.getGoodIndentForLine(l,e.getLanguageIdAtPosition(u,1),s.startLineNumber+1,a)
if(null!==t){const n=Ne(e.getLineContent(s.startLineNumber)),a=ex(t,r),l=ex(n,r)
if(a!==l){const t=a-l
this.getIndentEditsOfMovingBlock(e,i,s,r,o,t)}}}}else i.addEditOperation(new t(s.startLineNumber,1,s.startLineNumber,1),n+"\n")}else if(u=s.startLineNumber-1,c=e.getLineContent(u),i.addEditOperation(new t(u,1,u+1,1),null),i.addEditOperation(new t(s.endLineNumber,e.getLineMaxColumn(s.endLineNumber),s.endLineNumber,e.getLineMaxColumn(s.endLineNumber)),"\n"+c),this.shouldAutoIndent(e,s)){l.getLineContent=(t=>t===u?e.getLineContent(s.startLineNumber):e.getLineContent(t))
let t=this.matchEnterRule(e,a,r,s.startLineNumber,s.startLineNumber-2)
if(null!==t)0!==t&&this.getIndentEditsOfMovingBlock(e,i,s,r,o,t)
else{let t=cr.getGoodIndentForLine(l,e.getLanguageIdAtPosition(s.startLineNumber,1),u,a)
if(null!==t){let n=Ne(e.getLineContent(s.startLineNumber)),a=ex(t,r),l=ex(n,r)
if(a!==l){let t=a-l
this.getIndentEditsOfMovingBlock(e,i,s,r,o,t)}}}}}this._selectionId=i.trackSelection(s)}buildIndentConverter(e){return{shiftIndent:t=>{let i=$o.shiftIndentCount(t,t.length+1,e),n=""
for(let e=0;e<i;e++)n+="\t"
return n},unshiftIndent:t=>{let i=$o.unshiftIndentCount(t,t.length+1,e),n=""
for(let e=0;e<i;e++)n+="\t"
return n}}}matchEnterRule(e,i,n,s,r,o){let a=r
for(;a>=1;){let t
if(Ee(t=a===r&&void 0!==o?o:e.getLineContent(a))>=0)break
a--}if(a<1||s>e.getLineCount())return null
let l=e.getLineMaxColumn(a),h=cr.getEnterAction(e,new t(a,l,a,l))
if(h){let t=h.indentation,r=h.enterAction
r.indentAction===Sn.None?t=h.indentation+r.appendText:r.indentAction===Sn.Indent?t=h.indentation+r.appendText:r.indentAction===Sn.IndentOutdent?t=h.indentation:r.indentAction===Sn.Outdent&&(t=i.unshiftIndent(h.indentation)+r.appendText)
let o=e.getLineContent(s)
if(this.trimLeft(o).indexOf(this.trimLeft(t))>=0){let r=Ne(e.getLineContent(s)),o=Ne(t)
return 2&cr.getIndentMetadata(e,s)&&(o=i.unshiftIndent(o)),ex(o,n)-ex(r,n)}}return null}trimLeft(e){return e.replace(/^\s+/,"")}shouldAutoIndent(e,t){if(!this._autoIndent)return!1
if(!e.isCheapToTokenize(t.startLineNumber))return!1
let i=e.getLanguageIdAtPosition(t.startLineNumber,1)
return i===e.getLanguageIdAtPosition(t.endLineNumber,1)&&null!==cr.getIndentRulesSupport(i)}getIndentEditsOfMovingBlock(e,i,n,s,r,o){for(let a=n.startLineNumber;a<=n.endLineNumber;a++){let l=Ne(e.getLineContent(a)),h=tx(ex(l,s)+o,s,r)
h!==l&&(i.addEditOperation(new t(a,1,a,l.length+1),h),a===n.endLineNumber&&n.endColumn<=l.length+1&&""===h&&(this._moveEndLineSelectionShrink=!0))}}computeCursorState(e,t){var i=t.getTrackedSelection(this._selectionId)
return this._moveEndPositionDown&&(i=i.setEndPosition(i.endLineNumber+1,1)),this._moveEndLineSelectionShrink&&i.startLineNumber<i.endLineNumber&&(i=i.setEndPosition(i.endLineNumber,2)),i}}class nx extends To{constructor(e,t){super(t),this.down=e}run(e,t){for(var i=[],n=t.getSelections(),s=0;s<n.length;s++)i.push(new Jy(n[s],this.down))
t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}}Oo(class extends nx{constructor(){super(!1,{id:"editor.action.copyLinesUpAction",label:Jt("lines.copyUp","Copy Line Up"),alias:"Copy Line Up",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:1552,linux:{primary:3600}}})}})
Oo(class extends nx{constructor(){super(!0,{id:"editor.action.copyLinesDownAction",label:Jt("lines.copyDown","Copy Line Down"),alias:"Copy Line Down",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:1554,linux:{primary:3602}}})}})
class sx extends To{constructor(e,t){super(t),this.down=e}run(e,t){for(var i=[],n=t.getSelections(),s=t.getConfiguration().autoIndent,r=0;r<n.length;r++)i.push(new ix(n[r],this.down,s))
t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}}Oo(class extends sx{constructor(){super(!1,{id:"editor.action.moveLinesUpAction",label:Jt("lines.moveUp","Move Line Up"),alias:"Move Line Up",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:528,linux:{primary:528}}})}})
Oo(class extends sx{constructor(){super(!0,{id:"editor.action.moveLinesDownAction",label:Jt("lines.moveDown","Move Line Down"),alias:"Move Line Down",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:530,linux:{primary:530}}})}})
class rx extends To{constructor(e,t){super(t),this.descending=e}run(e,t){if(Zy.canRun(t.getModel(),t.getSelection(),this.descending)){var i=new Zy(t.getSelection(),this.descending)
t.pushUndoStop(),t.executeCommands(this.id,[i]),t.pushUndoStop()}}}Oo(class extends rx{constructor(){super(!1,{id:"editor.action.sortLinesAscending",label:Jt("lines.sortAscending","Sort Lines Ascending"),alias:"Sort Lines Ascending",precondition:Vo.writable})}})
Oo(class extends rx{constructor(){super(!0,{id:"editor.action.sortLinesDescending",label:Jt("lines.sortDescending","Sort Lines Descending"),alias:"Sort Lines Descending",precondition:Vo.writable})}})
let ox=dx=class extends To{constructor(){super({id:dx.ID,label:Jt("lines.trimTrailingWhitespace","Trim Trailing Whitespace"),alias:"Trim Trailing Whitespace",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:Wr(2089,2102)}})}run(i,n,s){let r=[]
"auto-save"===s.reason&&(r=n.getSelections().map(t=>new e(t.positionLineNumber,t.positionColumn)))
var o=new class{constructor(e,t){this.selection=e,this.cursors=t}getEditOperations(e,i){let n=function(e,i){i.sort((e,t)=>e.lineNumber===t.lineNumber?e.column-t.column:e.lineNumber-t.lineNumber)
for(let e=i.length-2;e>=0;e--)i[e].lineNumber===i[e+1].lineNumber&&i.splice(e,1)
let n=[],s=0,r=0,o=i.length
for(let a=1,l=e.getLineCount();a<=l;a++){let l=e.getLineContent(a),h=l.length+1,d=0
if(r<o&&i[r].lineNumber===a&&(d=i[r].column,r++,d===h))continue
if(0===l.length)continue
let u=Ee(l),c=0
if(-1===u)c=1
else{if(u===l.length-1)continue
c=u+2}c=Math.max(d,c),n[s++]=C_.delete(new t(a,c,a,h))}return n}(e,this.cursors)
for(let e=0,t=n.length;e<t;e++){let t=n[e]
i.addEditOperation(t.range,t.text)}this.selectionId=i.trackSelection(this.selection)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}}(n.getSelection(),r)
n.pushUndoStop(),n.executeCommands(this.id,[o]),n.pushUndoStop()}}
ox.ID="editor.action.trimTrailingWhitespace",ox=dx=Nn([Oo],ox)
class ax extends To{_getLinesToRemove(e){var t=e.getSelections().map(e=>{var t=e.endLineNumber
return e.startLineNumber<e.endLineNumber&&1===e.endColumn&&(t-=1),{startLineNumber:e.startLineNumber,endLineNumber:t,positionColumn:e.positionColumn}})
t.sort((e,t)=>e.startLineNumber-t.startLineNumber)
for(var i=[],n=t[0],s=1;s<t.length;s++)n.endLineNumber+1===t[s].startLineNumber?n.endLineNumber=t[s].endLineNumber:(i.push(n),n=t[s])
return i.push(n),i}}Oo(class extends ax{constructor(){super({id:"editor.action.deleteLines",label:Jt("lines.delete","Delete Line"),alias:"Delete Line",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:3113}})}run(e,t){var i=this._getLinesToRemove(t).map(e=>new Qy(e.startLineNumber,e.endLineNumber,e.positionColumn))
t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}})
Oo(class extends To{constructor(){super({id:"editor.action.indentLines",label:Jt("lines.indent","Indent Line"),alias:"Indent Line",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:2137}})}run(e,t){t.pushUndoStop(),t.executeCommands(this.id,Go.indent(t._getCursorConfiguration(),t.getModel(),t.getSelections())),t.pushUndoStop()}})
Oo(class extends To{constructor(){super({id:"editor.action.outdentLines",label:Jt("lines.outdent","Outdent Line"),alias:"Outdent Line",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:2135}})}run(e,t){ia.Outdent.runEditorCommand(null,t,null)}})
Oo(class extends To{constructor(){super({id:"editor.action.insertLineBefore",label:Jt("lines.insertBefore","Insert Line Above"),alias:"Insert Line Above",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:3075}})}run(e,t){t.pushUndoStop(),t.executeCommands(this.id,Go.lineInsertBefore(t._getCursorConfiguration(),t.getModel(),t.getSelections()))}})
Oo(class extends To{constructor(){super({id:"editor.action.insertLineAfter",label:Jt("lines.insertAfter","Insert Line Below"),alias:"Insert Line Below",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:2051}})}run(e,t){t.pushUndoStop(),t.executeCommands(this.id,Go.lineInsertAfter(t._getCursorConfiguration(),t.getModel(),t.getSelections()))}})
class lx extends To{run(e,i){const n=i.getSelection()
let s=this._getRangesToDelete(i),r=[]
for(let e=0,i=s.length-1;e<i;e++){let i=s[e],n=s[e+1]
null===t.intersectRanges(i,n)?r.push(i):s[e+1]=t.plusRange(i,n)}r.push(s[s.length-1])
let o=this._getEndCursorState(n,r),a=r.map(e=>(o.push(new At(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)),C_.replace(e,"")))
i.pushUndoStop(),i.executeEdits(this.id,a,o),i.pushUndoStop()}}Oo(class extends lx{constructor(){super({id:"deleteAllLeft",label:Jt("lines.deleteAllLeft","Delete All Left"),alias:"Delete All Left",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:null,mac:{primary:2049}}})}_getEndCursorState(e,t){let i,n=[]
for(let s=0,r=t.length;s<r;s++){let r=t[s],o=new At(t[s].startLineNumber,t[s].startColumn,t[s].startLineNumber,t[s].startColumn)
r.intersectRanges(e)?i=o:n.push(o)}return i&&n.unshift(i),n}_getRangesToDelete(e){let i=e.getSelections()
return i.sort(t.compareRangesUsingStarts),i=i.map(e=>e.isEmpty()?new t(e.startLineNumber,1,e.startLineNumber,e.startColumn):e)}})
Oo(class extends lx{constructor(){super({id:"deleteAllRight",label:Jt("lines.deleteAllRight","Delete All Right"),alias:"Delete All Right",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:null,mac:{primary:297,secondary:[2068]}}})}_getEndCursorState(e,t){let i,n=[]
for(let s=0,r=t.length,o=0;s<r;s++){let r=t[s],a=new At(r.startLineNumber-o,r.startColumn,r.startLineNumber-o,r.startColumn)
r.intersectRanges(e)?i=a:n.push(a)}return i&&n.unshift(i),n}_getRangesToDelete(e){let i=e.getModel(),n=e.getSelections().map(e=>{if(e.isEmpty()){const n=i.getLineMaxColumn(e.startLineNumber)
return e.startColumn===n?new t(e.startLineNumber,e.startColumn,e.startLineNumber+1,1):new t(e.startLineNumber,e.startColumn,e.startLineNumber,n)}return e})
return n.sort(t.compareRangesUsingStarts),n}})
Oo(class extends To{constructor(){super({id:"editor.action.joinLines",label:Jt("lines.joinLines","Join Lines"),alias:"Join Lines",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:0,mac:{primary:296}}})}run(e,i){let n=i.getSelections(),s=i.getSelection()
n.sort(t.compareRangesUsingStarts)
let r=[],o=n.reduce((e,t)=>e.isEmpty()?e.endLineNumber===t.startLineNumber?(s.equalsSelection(e)&&(s=t),t):t.startLineNumber>e.endLineNumber+1?(r.push(e),t):new At(e.startLineNumber,e.startColumn,t.endLineNumber,t.endColumn):t.startLineNumber>e.endLineNumber?(r.push(e),t):new At(e.startLineNumber,e.startColumn,t.endLineNumber,t.endColumn))
r.push(o)
let a=i.getModel(),l=[],h=[],d=s,u=0
for(let e=0,i=r.length;e<i;e++){let i,n,o,c=r[e],g=c.startLineNumber,m=1,p=a.getLineContent(c.endLineNumber).length-c.endColumn
if(c.isEmpty()||c.startLineNumber===c.endLineNumber){let e=c.getStartPosition()
e.lineNumber<a.getLineCount()?(i=g+1,n=a.getLineMaxColumn(i)):(i=e.lineNumber,n=a.getLineMaxColumn(e.lineNumber))}else i=c.endLineNumber,n=a.getLineMaxColumn(i)
let f=a.getLineContent(g)
for(let e=g+1;e<=i;e++){let t=a.getLineContent(e),i=a.getLineFirstNonWhitespaceColumn(e)
if(i>=1){let e=!0
""===f&&(e=!1),!e||" "!==f.charAt(f.length-1)&&"\t"!==f.charAt(f.length-1)||(e=!1,f=f.replace(/[\s\uFEFF\xA0]+$/g," "))
let n=t.substr(i-1)
f+=(e?" ":"")+n,o=e?n.length+1:n.length}else o=0}let _,C=new t(g,m,i,n)
C.isEmpty()||(c.isEmpty()?(l.push(C_.replace(C,f)),_=new At(C.startLineNumber-u,f.length-o+1,g-u,f.length-o+1)):c.startLineNumber===c.endLineNumber?(l.push(C_.replace(C,f)),_=new At(c.startLineNumber-u,c.startColumn,c.endLineNumber-u,c.endColumn)):(l.push(C_.replace(C,f)),_=new At(c.startLineNumber-u,c.startColumn,c.startLineNumber-u,f.length-p)),null!==t.intersectRanges(C,s)?d=_:h.push(_)),u+=C.endLineNumber-C.startLineNumber}h.unshift(d),i.pushUndoStop(),i.executeEdits(this.id,l,h),i.pushUndoStop()}})
Oo(class extends To{constructor(){super({id:"editor.action.transpose",label:Jt("editor.transpose","Transpose characters around the cursor"),alias:"Transpose characters around the cursor",precondition:Vo.writable})}run(e,i){let n=i.getSelections(),s=i.getModel(),r=[]
for(let e=0,i=n.length;e<i;e++){let i=n[e]
if(!i.isEmpty())continue
let o=i.getStartPosition(),a=s.getLineMaxColumn(o.lineNumber)
if(o.column>=a){if(o.lineNumber===s.getLineCount())continue
let e=new t(o.lineNumber,Math.max(1,o.column-1),o.lineNumber+1,1),i=s.getValueInRange(e).split("").reverse().join("")
r.push(new Ho(new At(o.lineNumber,Math.max(1,o.column-1),o.lineNumber+1,1),i))}else{let e=new t(o.lineNumber,Math.max(1,o.column-1),o.lineNumber,o.column+1),i=s.getValueInRange(e).split("").reverse().join("")
r.push(new Ko(e,i,new At(o.lineNumber,o.column+1,o.lineNumber,o.column+1)))}}i.pushUndoStop(),i.executeCommands(this.id,r),i.pushUndoStop()}})
class hx extends To{run(e,i){let n=i.getSelections(),s=i.getModel(),r=[]
for(let e=0,i=n.length;e<i;e++){let i=n[e]
if(i.isEmpty()){let e=i.getStartPosition(),n=s.getWordAtPosition(e)
if(!n)continue
let o=new t(e.lineNumber,n.startColumn,e.lineNumber,n.endColumn),a=s.getValueInRange(o)
r.push(new Ko(o,this._modifyText(a),new At(e.lineNumber,e.column,e.lineNumber,e.column)))}else{let e=s.getValueInRange(i)
r.push(new Ko(i,this._modifyText(e),i))}}i.pushUndoStop(),i.executeCommands(this.id,r),i.pushUndoStop()}}Oo(class extends hx{constructor(){super({id:"editor.action.transformToUppercase",label:Jt("editor.transformToUppercase","Transform to Uppercase"),alias:"Transform to Uppercase",precondition:Vo.writable})}_modifyText(e){return e.toLocaleUpperCase()}})
var dx
Oo(class extends hx{constructor(){super({id:"editor.action.transformToLowercase",label:Jt("editor.transformToLowercase","Transform to Lowercase"),alias:"Transform to Lowercase",precondition:Vo.writable})}_modifyText(e){return e.toLocaleLowerCase()}})
class ux{constructor(e,t){this._link=e,this._provider=t}get range(){return this._link.range}get url(){return this._link.url}resolve(){if(this._link.url)try{return bt.as(X.parse(this._link.url))}catch(e){return bt.wrapError(new Error("invalid"))}return"function"==typeof this._provider.resolveLink?ca(e=>this._provider.resolveLink(this._link,e)).then(e=>(this._link=e||this._link,this._link.url?this.resolve():bt.wrapError(new Error("missing")))):bt.wrapError(new Error("missing"))}}function cx(e){let i=[]
const n=qs.ordered(e).reverse().map(n=>ca(t=>n.provideLinks(e,t)).then(e=>{if(Array.isArray(e)){const s=e.map(e=>new ux(e,n))
i=function(e,i){var n,s,r,o,a,l,h=[]
for(n=0,r=0,s=e.length,o=i.length;n<s&&r<o;)a=e[n],l=i[r],t.areIntersectingOrTouching(a.range,l.range)?n++:t.compareRangesUsingStarts(a.range,l.range)<0?(h.push(a),n++):(h.push(l),r++)
for(;n<s;n++)h.push(e[n])
for(;r<o;r++)h.push(i[r])
return h}(i,s)}},yt))
return bt.join(n).then(()=>i)}Tr.registerCommand("_executeLinkProvider",(e,...t)=>{const[i]=t
if(!(i instanceof X))return
const n=e.get(Zr).getModel(i)
return n?cx(n):void 0})
const gx=(new Mh).appendText(k?Jt("links.navigate.mac","Cmd + click to follow link"):Jt("links.navigate","Ctrl + click to follow link")),mx=(new Mh).appendText(k?Jt("links.command.mac","Cmd + click to execute command"):Jt("links.command","Ctrl + click to execute command")),px=(new Mh).appendText(Jt("links.navigate.al","Alt + click to follow link")),fx=(new Mh).appendText(Jt("links.command.al","Alt + click to execute command")),_x={meta:Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,inlineClassName:"detected-link",hoverMessage:gx}),metaActive:Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,inlineClassName:"detected-link-active",hoverMessage:gx}),alt:Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,inlineClassName:"detected-link",hoverMessage:px}),altActive:Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,inlineClassName:"detected-link-active",hoverMessage:px}),altCommand:Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,inlineClassName:"detected-link",hoverMessage:fx}),altCommandActive:Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,inlineClassName:"detected-link-active",hoverMessage:fx}),metaCommand:Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,inlineClassName:"detected-link",hoverMessage:mx}),metaCommandActive:Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,inlineClassName:"detected-link-active",hoverMessage:mx})}
class Cx{static decoration(e,t){return{range:e.range,options:Cx._getOptions(e,t,!1)}}static _getOptions(e,t,i){return/^command:/i.test(e.url)?t?i?_x.metaCommandActive:_x.metaCommand:i?_x.altCommandActive:_x.altCommand:t?i?_x.metaActive:_x.meta:i?_x.altActive:_x.alt}constructor(e,t){this.link=e,this.decorationId=t}activate(e,t){e.changeDecorationOptions(this.decorationId,Cx._getOptions(this.link,t,!0))}deactivate(e,t){e.changeDecorationOptions(this.decorationId,Cx._getOptions(this.link,t,!1))}}let bx=wx=class{constructor(e,t,i,n){this.editor=e,this.openerService=t,this.messageService=i,this.editorWorkerService=n,this.listenersToRemove=[]
let s=new ny(e)
this.listenersToRemove.push(s),this.listenersToRemove.push(s.onMouseMoveOrRelevantKeyDown(([e,t])=>{this._onEditorMouseMove(e,t)})),this.listenersToRemove.push(s.onExecute(e=>{this.onEditorMouseUp(e)})),this.listenersToRemove.push(s.onCancel(e=>{this.cleanUpActiveLinkDecoration()})),this.enabled=e.getConfiguration().contribInfo.links,this.listenersToRemove.push(e.onDidChangeConfiguration(t=>{let i=e.getConfiguration().contribInfo.links
this.enabled!==i&&(this.enabled=i,this.updateDecorations([]),this.stop(),this.beginCompute())})),this.listenersToRemove.push(e.onDidChangeModelContent(e=>this.onChange())),this.listenersToRemove.push(e.onDidChangeModel(e=>this.onModelChanged())),this.listenersToRemove.push(e.onDidChangeModelLanguage(e=>this.onModelModeChanged())),this.listenersToRemove.push(qs.onDidChange(e=>this.onModelModeChanged())),this.timeoutPromise=null,this.computePromise=null,this.currentOccurrences={},this.activeLinkDecorationId=null,this.beginCompute()}static get(e){return e.getContribution(wx.ID)}getId(){return wx.ID}isComputing(){return bt.is(this.computePromise)}onModelChanged(){this.currentOccurrences={},this.activeLinkDecorationId=null,this.stop(),this.beginCompute()}onModelModeChanged(){this.stop(),this.beginCompute()}onChange(){this.timeoutPromise||(this.timeoutPromise=bt.timeout(wx.RECOMPUTE_TIME),this.timeoutPromise.then(()=>{this.timeoutPromise=null,this.beginCompute()}))}beginCompute(){this.editor.getModel()&&this.enabled&&qs.has(this.editor.getModel())&&(this.computePromise=cx(this.editor.getModel()).then(e=>{this.updateDecorations(e),this.computePromise=null}))}updateDecorations(e){const t="altKey"===this.editor.getConfiguration().multiCursorModifier
this.editor.changeDecorations(i=>{var n=[]
let s=Object.keys(this.currentOccurrences)
for(let e=0,t=s.length;e<t;e++){let t=s[e],i=this.currentOccurrences[t]
n.push(i.decorationId)}var r=[]
if(e)for(var o=0;o<e.length;o++)r.push(Cx.decoration(e[o],t))
var a=i.deltaDecorations(n,r)
this.currentOccurrences={},this.activeLinkDecorationId=null
for(let t=0,i=a.length;t<i;t++){var l=new Cx(e[t],a[t])
this.currentOccurrences[l.decorationId]=l}})}_onEditorMouseMove(e,t){const i="altKey"===this.editor.getConfiguration().multiCursorModifier
if(this.isEnabled(e,t)){this.cleanUpActiveLinkDecoration()
var n=this.getLinkOccurrence(e.target.position)
n&&this.editor.changeDecorations(e=>{n.activate(e,i),this.activeLinkDecorationId=n.decorationId})}else this.cleanUpActiveLinkDecoration()}cleanUpActiveLinkDecoration(){const e="altKey"===this.editor.getConfiguration().multiCursorModifier
if(this.activeLinkDecorationId){var t=this.currentOccurrences[this.activeLinkDecorationId]
t&&this.editor.changeDecorations(i=>{t.deactivate(i,e)}),this.activeLinkDecorationId=null}}onEditorMouseUp(e){if(this.isEnabled(e)){var t=this.getLinkOccurrence(e.target.position)
t&&this.openLinkOccurrence(t,e.hasSideBySideModifier)}}openLinkOccurrence(e,t){if(!this.openerService)return
const{link:i}=e
i.resolve().then(e=>this.openerService.open(e,{openToSide:t}),e=>{"invalid"===e?this.messageService.show(ew.Warning,Jt("invalid.url","Sorry, failed to open this link because it is not well-formed: {0}",i.url)):"missing"===e?this.messageService.show(ew.Warning,Jt("missing.url","Sorry, failed to open this link because its target is missing.")):St(e)}).done(null,St)}getLinkOccurrence(e){for(var t=this.editor.getModel().getDecorationsInRange({startLineNumber:e.lineNumber,startColumn:e.column,endLineNumber:e.lineNumber,endColumn:e.column},0,!0),i=0;i<t.length;i++){var n=t[i],s=this.currentOccurrences[n.id]
if(s)return s}return null}isEnabled(e,t){return e.target.type===bm.CONTENT_TEXT&&(e.hasTriggerModifier||t&&t.keyCodeIsTriggerKey)}stop(){this.timeoutPromise&&(this.timeoutPromise.cancel(),this.timeoutPromise=null),this.computePromise&&(this.computePromise.cancel(),this.computePromise=null)}dispose(){this.listenersToRemove=ei(this.listenersToRemove),this.stop()}}
bx.ID="editor.linkDetector",bx.RECOMPUTE_TIME=1e3,bx=wx=Nn([iC,En(1,vy),En(2,tw),En(3,Jb)],bx)
var wx
Oo(class extends To{constructor(){super({id:"editor.action.openLink",label:Jt("label","Open Link"),alias:"Open Link",precondition:null})}run(e,t){let i=bx.get(t)
if(!i)return
let n=i.getLinkOccurrence(t.getPosition())
n&&i.openLinkOccurrence(n,!1)}}),Wg((e,t)=>{let i=e.getColor(gg)
i&&t.addRule(`.monaco-editor .detected-link-active { color: ${i} !important; }`)})
Oo(class extends To{constructor(){super({id:"editor.action.insertCursorAbove",label:Jt("mutlicursor.insertAbove","Add Cursor Above"),alias:"Add Cursor Above",precondition:null,kbOpts:{kbExpr:Vo.textFocus,primary:2576,linux:{primary:1552,secondary:[3088]}}})}run(e,t,i){const n=t._getCursors(),s=n.context
s.config.readOnly||(s.model.pushStackElement(),n.setStates(i.source,br.Explicit,fr.ensureInEditableRange(s,Nr.addCursorUp(s,n.getAll()))),n.reveal(!0,1,0))}})
Oo(class extends To{constructor(){super({id:"editor.action.insertCursorBelow",label:Jt("mutlicursor.insertBelow","Add Cursor Below"),alias:"Add Cursor Below",precondition:null,kbOpts:{kbExpr:Vo.textFocus,primary:2578,linux:{primary:1554,secondary:[3090]}}})}run(e,t,i){const n=t._getCursors(),s=n.context
s.config.readOnly||(s.model.pushStackElement(),n.setStates(i.source,br.Explicit,fr.ensureInEditableRange(s,Nr.addCursorDown(s,n.getAll()))),n.reveal(!0,2,0))}})
Oo(class extends To{constructor(){super({id:"editor.action.insertCursorAtEndOfEachLineSelected",label:Jt("mutlicursor.insertAtEndOfEachLineSelected","Add Cursors to Line Ends"),alias:"Add Cursors to Line Ends",precondition:null,kbOpts:{kbExpr:Vo.textFocus,primary:1575}})}getCursorsForSelection(e,t){if(e.isEmpty())return[]
let i=t.getModel(),n=[]
for(let t=e.startLineNumber;t<e.endLineNumber;t++){let e=i.getLineMaxColumn(t)
n.push(new At(t,e,t,e))}return e.endColumn>1&&n.push(new At(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)),n}run(e,t){let i=t.getSelections().map(e=>this.getCursorsForSelection(e,t)).reduce((e,t)=>e.concat(t))
i.length>0&&t.setSelections(i)}})
class vx{constructor(e,t,i){this.selections=e,this.revealRange=t,this.revealScrollType=i}}class Sx{constructor(e,t,i,n,s,r,o){this._editor=e,this.findController=t,this.isDisconnectedFromFindController=i,this.searchText=n,this.wholeWord=s,this.matchCase=r,this.currentMatch=o}static create(e,t){const i=t.getState()
if(!e.isFocused()&&i.isRevealed&&i.searchString.length>0)return new Sx(e,t,!1,i.searchString,i.wholeWord,i.matchCase,null)
let n,s,r=!1
const o=e.getSelections()
1===o.length&&o[0].isEmpty()?(r=!0,n=!0,s=!0):(n=i.wholeWord,s=i.matchCase)
const a=e.getSelection()
let l,h=null
if(a.isEmpty()){const t=e.getModel().getWordAtPosition(a.getStartPosition())
if(!t)return null
l=t.word,h=new At(a.startLineNumber,t.startColumn,a.startLineNumber,t.endColumn)}else l=e.getModel().getValueInRange(a).replace(/\r\n/g,"\n")
return new Sx(e,t,r,l,n,s,h)}addSelectionToNextFindMatch(){const e=this._getNextMatch()
if(!e)return null
const t=this._editor.getSelections()
return new vx(t.concat(e),e,0)}moveSelectionToNextFindMatch(){const e=this._getNextMatch()
if(!e)return null
const t=this._editor.getSelections()
return new vx(t.slice(0,t.length-1).concat(e),e,0)}_getNextMatch(){if(this.currentMatch){const e=this.currentMatch
return this.currentMatch=null,e}this.findController.highlightFindOptions()
const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findNextMatch(this.searchText,t.getEndPosition(),!1,this.matchCase,this.wholeWord?this._editor.getConfiguration().wordSeparators:null,!1)
return i?new At(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}addSelectionToPreviousFindMatch(){const e=this._getPreviousMatch()
if(!e)return null
const t=this._editor.getSelections()
return new vx(t.concat(e),e,0)}moveSelectionToPreviousFindMatch(){const e=this._getPreviousMatch()
if(!e)return null
const t=this._editor.getSelections()
return new vx(t.slice(0,t.length-1).concat(e),e,0)}_getPreviousMatch(){if(this.currentMatch){const e=this.currentMatch
return this.currentMatch=null,e}this.findController.highlightFindOptions()
const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findPreviousMatch(this.searchText,t.getStartPosition(),!1,this.matchCase,this.wholeWord?this._editor.getConfiguration().wordSeparators:null,!1)
return i?new At(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}selectAll(){return this.findController.highlightFindOptions(),this._editor.getModel().findMatches(this.searchText,!0,!1,this.matchCase,this.wholeWord?this._editor.getConfiguration().wordSeparators:null,!1,1073741824)}}let yx=Ix=class extends ni{constructor(e){super(),this._editor=e,this._ignoreSelectionChange=!1,this._session=null,this._sessionDispose=[]}static get(e){return e.getContribution(Ix.ID)}dispose(){this._endSession(),super.dispose()}getId(){return Ix.ID}_beginSessionIfNeeded(e){if(!this._session){const t=Sx.create(this._editor,e)
if(!t)return
this._session=t
const i={searchString:this._session.searchText}
this._session.isDisconnectedFromFindController&&(i.wholeWordOverride=1,i.matchCaseOverride=1,i.isRegexOverride=2),e.getState().change(i,!1),this._sessionDispose=[this._editor.onDidChangeCursorSelection(e=>{this._ignoreSelectionChange||this._endSession()}),this._editor.onDidBlurEditorText(()=>{this._endSession()}),e.getState().addChangeListener(e=>{(e.matchCase||e.wholeWord)&&this._endSession()})]}}_endSession(){if(this._sessionDispose=ei(this._sessionDispose),this._session&&this._session.isDisconnectedFromFindController){const e={wholeWordOverride:0,matchCaseOverride:0,isRegexOverride:0}
this._session.findController.getState().change(e,!1)}this._session=null}_setSelections(e){this._ignoreSelectionChange=!0,this._editor.setSelections(e),this._ignoreSelectionChange=!1}_expandEmptyToWord(e,t){if(!t.isEmpty())return t
const i=e.getWordAtPosition(t.getStartPosition())
return i?new At(t.startLineNumber,i.startColumn,t.startLineNumber,i.endColumn):t}_applySessionResult(e){e&&(this._setSelections(e.selections),e.revealRange&&this._editor.revealRangeInCenterIfOutsideViewport(e.revealRange,e.revealScrollType))}getSession(e){return this._session}addSelectionToNextFindMatch(e){if(!this._session){const t=this._editor.getSelections()
if(t.length>1){const i=e.getState().matchCase
if(!Ex(this._editor.getModel(),t,i)){const e=this._editor.getModel()
let i=[]
for(let n=0,s=t.length;n<s;n++)i[n]=this._expandEmptyToWord(e,t[n])
return void this._editor.setSelections(i)}}}this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToNextFindMatch())}addSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToPreviousFindMatch())}moveSelectionToNextFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToNextFindMatch())}moveSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToPreviousFindMatch())}selectAll(e){let t=null
const i=e.getState()
if(!this._editor.isFocused()&&i.isRevealed&&i.searchString.length>0&&i.isRegex)t=this._editor.getModel().findMatches(i.searchString,!0,i.isRegex,i.matchCase,i.wholeWord?this._editor.getConfiguration().wordSeparators:null,!1,1073741824)
else{if(this._beginSessionIfNeeded(e),!this._session)return
t=this._session.selectAll()}if(t.length>0){const e=this._editor.getSelection()
for(let i=0,n=t.length;i<n;i++){const n=t[i]
if(n.range.intersectRanges(e)){t[i]=t[0],t[0]=n
break}}this._setSelections(t.map(e=>new At(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn)))}}}
yx.ID="editor.contrib.multiCursorController",yx=Ix=Nn([Po],yx)
class xx extends To{run(e,t){const i=yx.get(t)
if(!i)return
const n=mb.get(t)
if(!n)return null
this._run(i,n)}}Oo(class extends xx{constructor(){super({id:"editor.action.addSelectionToNextFindMatch",label:Jt("addSelectionToNextFindMatch","Add Selection To Next Find Match"),alias:"Add Selection To Next Find Match",precondition:null,kbOpts:{kbExpr:Vo.focus,primary:2082}})}_run(e,t){e.addSelectionToNextFindMatch(t)}})
Oo(class extends xx{constructor(){super({id:"editor.action.addSelectionToPreviousFindMatch",label:Jt("addSelectionToPreviousFindMatch","Add Selection To Previous Find Match"),alias:"Add Selection To Previous Find Match",precondition:null})}_run(e,t){e.addSelectionToPreviousFindMatch(t)}})
Oo(class extends xx{constructor(){super({id:"editor.action.moveSelectionToNextFindMatch",label:Jt("moveSelectionToNextFindMatch","Move Last Selection To Next Find Match"),alias:"Move Last Selection To Next Find Match",precondition:null,kbOpts:{kbExpr:Vo.focus,primary:Wr(2089,2082)}})}_run(e,t){e.moveSelectionToNextFindMatch(t)}})
Oo(class extends xx{constructor(){super({id:"editor.action.moveSelectionToPreviousFindMatch",label:Jt("moveSelectionToPreviousFindMatch","Move Last Selection To Previous Find Match"),alias:"Move Last Selection To Previous Find Match",precondition:null})}_run(e,t){e.moveSelectionToPreviousFindMatch(t)}})
Oo(class extends xx{constructor(){super({id:"editor.action.selectHighlights",label:Jt("selectAllOccurrencesOfFindMatch","Select All Occurrences of Find Match"),alias:"Select All Occurrences of Find Match",precondition:null,kbOpts:{kbExpr:Vo.focus,primary:3114}})}_run(e,t){e.selectAll(t)}})
Oo(class extends xx{constructor(){super({id:"editor.action.changeAll",label:Jt("changeAll.label","Change All Occurrences"),alias:"Change All Occurrences",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:2108},menuOpts:{group:"1_modification",order:1.2}})}_run(e,t){e.selectAll(t)}})
class Lx{constructor(e,t,i,n){this.lastWordUnderCursor=e,this.searchText=t,this.matchCase=i,this.wordSeparators=n}static softEquals(e,t){return!e&&!t||!(!e||!t)&&(e.searchText===t.searchText&&e.matchCase===t.matchCase&&e.wordSeparators===t.wordSeparators)}}let Nx=Mx=class extends ni{constructor(e){super(),this.editor=e,this._isEnabled=e.getConfiguration().contribInfo.selectionHighlight,this.decorations=[],this.updateSoon=this._register(new Ca(()=>this._update(),300)),this.state=null,this._register(e.onDidChangeConfiguration(t=>{this._isEnabled=e.getConfiguration().contribInfo.selectionHighlight})),this._register(e.onDidChangeCursorSelection(e=>{this._isEnabled&&(e.selection.isEmpty()?e.reason===br.Explicit?(!this.state||this.state.lastWordUnderCursor&&this.state.lastWordUnderCursor.containsPosition(e.selection.getStartPosition())||this._setState(null),this.updateSoon.schedule()):this._setState(null):this._update())})),this._register(e.onDidChangeModel(e=>{this._setState(null)})),this._register(mb.get(e).getState().addChangeListener(e=>{this._update()}))}getId(){return Mx.ID}_update(){this._setState(Mx._createState(this._isEnabled,this.editor))}static _createState(e,t){if(!e)return null
const i=t.getModel()
if(!i)return null
const n=t.getSelection()
if(n.startLineNumber!==n.endLineNumber)return null
const s=yx.get(t)
if(!s)return null
const r=mb.get(t)
if(!r)return null
let o=s.getSession(r)
if(!o){const e=t.getSelections()
if(e.length>1){const i=r.getState().matchCase
if(!Ex(t.getModel(),e,i))return null}o=Sx.create(t,r)}if(!o)return null
let a=null
const l=Fs.has(i)
if(o.currentMatch){if(l)return null
if(!t.getConfiguration().contribInfo.occurrencesHighlight)return null
a=o.currentMatch}if(/^[ \t]+$/.test(o.searchText))return null
if(o.searchText.length>200)return null
const h=r.getState(),d=h.matchCase
if(h.isRevealed){let e=h.searchString
d||(e=e.toLowerCase())
let t=o.searchText
if(d||(t=t.toLowerCase()),e===t&&o.matchCase===h.matchCase&&o.wholeWord===h.wholeWord&&!h.isRegex)return null}return new Lx(a,o.searchText,o.matchCase,o.wholeWord?t.getConfiguration().wordSeparators:null)}_setState(e){if(Lx.softEquals(this.state,e))return void(this.state=e)
if(this.state=e,!this.state)return void(this.decorations.length>0&&(this.decorations=this.editor.deltaDecorations(this.decorations,[])))
const i=this.editor.getModel(),n=Fs.has(i)
let s=i.findMatches(this.state.searchText,!0,!1,this.state.matchCase,this.state.wordSeparators,!1).map(e=>e.range)
s.sort(t.compareRangesUsingStarts)
let r=this.editor.getSelections()
r.sort(t.compareRangesUsingStarts)
let o=[]
for(let e=0,i=0,n=s.length,a=r.length;e<n;){const n=s[e]
if(i>=a)o.push(n),e++
else{const s=t.compareRangesUsingStarts(n,r[i])
s<0?(o.push(n),e++):s>0?i++:(e++,i++)}}const a=o.map(e=>({range:e,options:n?Mx._SELECTION_HIGHLIGHT:Mx._SELECTION_HIGHLIGHT_OVERVIEW}))
this.decorations=this.editor.deltaDecorations(this.decorations,a)}dispose(){this._setState(null),super.dispose()}}
function Ex(e,t,i){const n=kx(e,t[0],!i)
for(let s=1,r=t.length;s<r;s++){const r=t[s]
if(r.isEmpty())return!1
if(n!==kx(e,r,!i))return!1}return!0}function kx(e,t,i){const n=e.getValueInRange(t)
return i?n.toLowerCase():n}var Ix,Mx
Nx.ID="editor.contrib.selectionHighlighter",Nx._SELECTION_HIGHLIGHT_OVERVIEW=Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,className:"selectionHighlight",overviewRuler:{color:Dg(xg),darkColor:Dg(xg),position:i.Center}}),Nx._SELECTION_HIGHLIGHT=Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,className:"selectionHighlight"}),Nx=Mx=Nn([Po],Nx)
const Dx=(e,t,i)=>{const n=e=>s.fire(e),s=new ci({onFirstListenerAdd:()=>{e.addEventListener(t,n,i)},onLastListenerRemove:()=>{e.removeEventListener(t,n,i)}})
return s.event}
function Tx(e){return pi(e,e=>(e.preventDefault(),e.stopPropagation(),e))}const Ox={Visible:new xo("parameterHintsVisible",!1),MultipleSignatures:new xo("parameterHintsMultipleSignatures",!1)}
function Rx(e,t){let i
return pa(Rs.ordered(e).map(n=>()=>{if(!i)return ca(i=>n.provideSignatureHelp(e,t,i)).then(e=>{i=e},yt)})).then(()=>i)}No.registerDefaultLanguageCommand("_executeSignatureHelpProvider",Rx)
const Ax=Al
class Px extends ni{constructor(e){super(),this._onHint=this._register(new ci),this.onHint=this._onHint.event,this._onCancel=this._register(new ci),this.onCancel=this._onCancel.event,this.editor=e,this.enabled=!1,this.triggerCharactersListeners=[],this.throttledDelayer=new Ca(()=>this.doTrigger(),Px.DELAY),this.active=!1,this._register(this.editor.onDidChangeConfiguration(()=>this.onEditorConfigurationChange())),this._register(this.editor.onDidChangeModel(e=>this.onModelChanged())),this._register(this.editor.onDidChangeModelLanguage(e=>this.onModelChanged())),this._register(this.editor.onDidChangeCursorSelection(e=>this.onCursorChange(e))),this._register(Rs.onDidChange(this.onModelChanged,this)),this.onEditorConfigurationChange(),this.onModelChanged()}cancel(e=!1){this.active=!1,this.throttledDelayer.cancel(),e||this._onCancel.fire(void 0)}trigger(e=Px.DELAY){if(Rs.has(this.editor.getModel()))return this.cancel(!0),this.throttledDelayer.schedule(e)}doTrigger(){Rx(this.editor.getModel(),this.editor.getPosition()).then(null,St).then(e=>{if(!e||!e.signatures||0===e.signatures.length)return this.cancel(),this._onCancel.fire(void 0),!1
this.active=!0
const t={hints:e}
return this._onHint.fire(t),!0})}isTriggered(){return this.active||this.throttledDelayer.isScheduled()}onModelChanged(){this.active&&this.cancel(),this.triggerCharactersListeners=ei(this.triggerCharactersListeners)
const e=this.editor.getModel()
if(!e)return
const t=new en
for(const i of Rs.ordered(e))if(Array.isArray(i.signatureHelpTriggerCharacters))for(const e of i.signatureHelpTriggerCharacters)t.add(e.charCodeAt(0))
this.triggerCharactersListeners.push(this.editor.onDidType(e=>{this.enabled&&t.has(e.charCodeAt(e.length-1))&&this.trigger()}))}onCursorChange(e){"mouse"===e.source?this.cancel():this.isTriggered()&&this.trigger()}onEditorConfigurationChange(){this.enabled=this.editor.getConfiguration().contribInfo.parameterHints,this.enabled||this.cancel()}dispose(){this.cancel(!0),this.triggerCharactersListeners=ei(this.triggerCharactersListeners),super.dispose()}}Px.DELAY=120
let Fx=class e{constructor(e,t,i,n){this.editor=e,this.allowEditorOverflow=!0,this.markdownRenderer=new $y(e,n,i),this.model=new Px(e),this.keyVisible=Ox.Visible.bindTo(t),this.keyMultipleSignatures=Ox.MultipleSignatures.bindTo(t),this.visible=!1,this.disposables=[],this.disposables.push(this.model.onHint(e=>{this.show(),this.hints=e.hints,this.currentSignature=e.hints.activeSignature,this.render()})),this.disposables.push(this.model.onCancel(()=>{this.hide()})),this.element=Ax(".editor-widget.parameter-hints-widget")
const s=Tl(this.element,Ax(".wrapper")),r=Tl(s,Ax(".buttons")),o=Tl(r,Ax(".button.previous")),a=Tl(r,Ax(".button.next"))
Tx(Dx(o,"click"))(this.previous,this,this.disposables),Tx(Dx(a,"click"))(this.next,this,this.disposables),this.overloads=Tl(s,Ax(".overloads"))
const l=Ax(".body")
this.scrollbar=new Rf(l,{}),this.disposables.push(this.scrollbar),s.appendChild(this.scrollbar.getDomNode()),this.signature=Tl(l,Ax(".signature")),this.docs=Tl(l,Ax(".docs")),this.currentSignature=0,this.editor.addContentWidget(this),this.hide(),this.disposables.push(this.editor.onDidChangeCursorSelection(e=>{this.visible&&this.editor.layoutContentWidget(this)}))
const h=()=>{const e=this.editor.getConfiguration().fontInfo
this.element.style.fontSize=`${e.fontSize}px`}
h(),_i(this.editor.onDidChangeConfiguration.bind(this.editor)).filter(e=>e.fontInfo).on(h,null,this.disposables),this.disposables.push(this.editor.onDidLayoutChange(e=>this.updateMaxHeight())),this.updateMaxHeight()}show(){this.model&&!this.visible&&(this.keyVisible.set(!0),this.visible=!0,bt.timeout(100).done(()=>Ja(this.element,"visible")),this.editor.layoutContentWidget(this))}hide(){this.model&&this.visible&&(this.keyVisible.reset(),this.visible=!1,this.hints=null,this.announcedLabel=null,Qa(this.element,"visible"),this.editor.layoutContentWidget(this))}getPosition(){return this.visible?{position:this.editor.getPosition(),preference:[pm.ABOVE,pm.BELOW]}:null}render(){const e=this.hints.signatures.length>1
el(this.element,"multiple",e),this.keyMultipleSignatures.set(e),this.signature.innerHTML="",this.docs.innerHTML=""
const t=this.hints.signatures[this.currentSignature]
if(!t)return
const i=Tl(this.signature,Ax(".code")),n=t.parameters.length>0,s=this.editor.getConfiguration().fontInfo;(i.style.fontSize=`${s.fontSize}px`,i.style.fontFamily=s.fontFamily,n)?this.renderParameters(i,t,this.hints.activeParameter):Tl(i,Ax("span")).textContent=t.label
const r=t.parameters[this.hints.activeParameter]
if(r&&r.documentation){const e=Ax("span.documentation")
"string"==typeof r.documentation?(Qa(this.docs,"markdown-docs"),e.textContent=r.documentation):(Ja(this.docs,"markdown-docs"),e.appendChild(this.markdownRenderer.render(r.documentation))),Tl(this.docs,Ax("p",null,e))}el(this.signature,"has-docs",!!t.documentation),"string"==typeof t.documentation?Tl(this.docs,Ax("p",null,t.documentation)):Tl(this.docs,this.markdownRenderer.render(t.documentation))
let o=String(this.currentSignature+1)
if(this.hints.signatures.length<10&&(o+=`/${this.hints.signatures.length}`),this.overloads.textContent=o,r){const e=r.label
this.announcedLabel!==e&&(vC(Jt("hint","{0}, hint",e)),this.announcedLabel=e)}this.editor.layoutContentWidget(this),this.scrollbar.scanDomNode()}renderParameters(e,t,i){let n,s=t.label.length,r=0
for(let o=t.parameters.length-1;o>=0;o--){const a=t.parameters[o]
let l=0,h=0;(r=t.label.lastIndexOf(a.label,s-1))>=0&&(l=r,h=r+a.label.length),(n=document.createElement("span")).textContent=t.label.substring(h,s),Ol(e,n),(n=document.createElement("span")).className=`parameter ${o===i?"active":""}`,n.textContent=t.label.substring(l,h),Ol(e,n),s=l}(n=document.createElement("span")).textContent=t.label.substring(0,s),Ol(e,n)}next(){const e=this.hints.signatures.length
return e<2?(this.cancel(),!1):(this.currentSignature=(this.currentSignature+1)%e,this.render(),!0)}previous(){const e=this.hints.signatures.length
return e<2?(this.cancel(),!1):(this.currentSignature=(this.currentSignature-1+e)%e,this.render(),!0)}cancel(){this.model.cancel()}getDomNode(){return this.element}getId(){return e.ID}trigger(){this.model.trigger(0)}updateMaxHeight(){const e=Math.max(this.editor.getLayoutInfo().height/4,250)
this.element.style.maxHeight=`${e}px`}dispose(){this.disposables=ei(this.disposables),this.model=null}}
Fx.ID="editor.widget.parameterHintsWidget",Fx=Nn([En(1,Lo),En(2,vy),En(3,XS)],Fx),Wg((e,t)=>{let i=e.getColor(cg)
if(i){let n=e.type===Rg?2:1
t.addRule(`.monaco-editor .parameter-hints-widget { border: ${n}px solid ${i}; }`),t.addRule(`.monaco-editor .parameter-hints-widget.multiple .body { border-left: 1px solid ${i.transparent(.5)}; }`),t.addRule(`.monaco-editor .parameter-hints-widget .signature.has-docs { border-bottom: 1px solid ${i.transparent(.5)}; }`)}let n=e.getColor(ug)
n&&t.addRule(`.monaco-editor .parameter-hints-widget { background-color: ${n}; }`)
const s=e.getColor(pc)
s&&t.addRule(`.monaco-editor .parameter-hints-widget a { color: ${s}; }`)
let r=e.getColor(fc)
r&&t.addRule(`.monaco-editor .parameter-hints-widget code { background-color: ${r}; }`)})
let Wx=Hx=class{constructor(e,t){this.editor=e,this.widget=t.createInstance(Fx,this.editor)}static get(e){return e.getContribution(Hx.ID)}getId(){return Hx.ID}cancel(){this.widget.cancel()}previous(){this.widget.previous()}next(){this.widget.next()}trigger(){this.widget.trigger()}dispose(){this.widget=ei(this.widget)}}
Wx.ID="editor.controller.parameterHints",Wx=Hx=Nn([iC,En(1,Er)],Wx)
Oo(class extends To{constructor(){super({id:"editor.action.triggerParameterHints",label:Jt("parameterHints.trigger.label","Trigger Parameter Hints"),alias:"Trigger Parameter Hints",precondition:Vo.hasSignatureHelpProvider,kbOpts:{kbExpr:Vo.textFocus,primary:3082}})}run(e,t){let i=Wx.get(t)
i&&i.trigger()}})
const Vx=No.commandWeight(75),Bx=Do.bindToContribution(Wx.get)
var Hx
No.registerEditorCommand(new Bx({id:"closeParameterHints",precondition:Ox.Visible,handler:e=>e.cancel(),kbOpts:{weight:Vx,kbExpr:Vo.textFocus,primary:9,secondary:[1033]}})),No.registerEditorCommand(new Bx({id:"showPrevParameterHint",precondition:_o.and(Ox.Visible,Ox.MultipleSignatures),handler:e=>e.previous(),kbOpts:{weight:Vx,kbExpr:Vo.textFocus,primary:16,secondary:[528],mac:{primary:16,secondary:[528,302]}}})),No.registerEditorCommand(new Bx({id:"showNextParameterHint",precondition:_o.and(Ox.Visible,Ox.MultipleSignatures),handler:e=>e.next(),kbOpts:{weight:Vx,kbExpr:Vo.textFocus,primary:18,secondary:[530],mac:{primary:18,secondary:[530,300]}}}))
class zx{constructor(e){this._disposables=[],this._onClick=new ci,this.onClick=this._onClick.event,this._futureFixes=new ha,this._domNode=document.createElement("div"),this._domNode.className="lightbulb-glyph",this._editor=e,this._editor.addContentWidget(this),this._disposables.push(this._editor.onDidChangeModel(e=>this._futureFixes.cancel())),this._disposables.push(this._editor.onDidChangeModelLanguage(e=>this._futureFixes.cancel())),this._disposables.push(nl(this._domNode,"click",e=>{const{top:t,height:i}=Cl(this._domNode),{lineHeight:n}=this._editor.getConfiguration()
let s=Math.floor(n/3)
this._position.position.lineNumber<this._model.position.lineNumber&&(s+=n),this._onClick.fire({x:e.posx,y:t+i+s})})),this._disposables.push(il(this._domNode,"mouseenter",e=>{if(1!=(1&e.buttons))return
this.hide(),Ja(this._domNode,"hidden")
const t=new ym
t.startMonitoring(Sm,()=>{},()=>{t.dispose(),Qa(this._domNode,"hidden")})})),this._disposables.push(this._editor.onDidChangeConfiguration(e=>{e.contribInfo&&!this._editor.getConfiguration().contribInfo.lightbulbEnabled&&this.hide()}))}dispose(){ei(this._disposables),this._editor.removeContentWidget(this)}getId(){return"LightBulbWidget"}getDomNode(){return this._domNode}getPosition(){return this._position}set model(e){!this._position||e.position&&this._position.position.lineNumber===e.position.lineNumber?this._futureFixes&&this._futureFixes.cancel():this.hide(),this._futureFixes=new ha
const{token:t}=this._futureFixes
this._model=e,this._model.fixes.done(e=>{!t.isCancellationRequested&&e&&e.length>0?this._show():this.hide()},e=>{this.hide()})}get model(){return this._model}set title(e){this._domNode.title=e}get title(){return this._domNode.title}_show(){const e=this._editor.getConfiguration()
if(!e.contribInfo.lightbulbEnabled)return
const{lineNumber:t}=this._model.position,i=this._editor.getModel(),n=i.getOptions().tabSize,s=zt(i.getLineContent(t),n)
let r=t
e.fontInfo.spaceWidth*s>22||(t>1?r-=1:r+=1),this._position={position:{lineNumber:r,column:1},preference:zx._posPref},this._editor.layoutContentWidget(this)}hide(){this._position=null,this._model=null,this._futureFixes.cancel(),this._editor.layoutContentWidget(this)}}function Ux(e,t){const i=[],n=zs.all(e).map(n=>ca(i=>n.provideCodeActions(e,t,i)).then(e=>{if(Array.isArray(e))for(const t of e)t&&i.push(t)},e=>{yt(e)}))
return bt.join(n).then(()=>i)}zx._posPref=[pm.EXACT],No.registerLanguageCommand("_executeCodeActionProvider",function(e,i){const{resource:n,range:s}=i
if(!(n instanceof X&&t.isIRange(s)))throw Et()
const r=e.get(Zr).getModel(n)
if(!r)throw Et()
return Ux(r,r.validateRange(s))})
class Kx{constructor(e,t,i,n=250){this._editor=e,this._markerService=t,this._signalChange=i,this._disposables=[],this._disposables.push(gi(this._markerService.onMarkerChanged,(e,t)=>e?e.concat(t):t,n/2)(e=>this._onMarkerChanges(e)),gi(this._editor.onDidChangeCursorPosition,(e,t)=>t,n)(e=>this._onCursorChange()))}dispose(){this._disposables=ei(this._disposables)}trigger(e){let t=this._getRangeOfMarker()||this._getRangeOfSelectionUnlessWhitespaceEnclosed()
t||"manual"!==e||(t=this._editor.getSelection()),this._createEventAndSignalChange(e,t)}_onMarkerChanges(e){const{uri:t}=this._editor.getModel()
for(const i of e)if(i.toString()===t.toString())return void this.trigger("auto")}_onCursorChange(){this.trigger("auto")}_getRangeOfMarker(){const e=this._editor.getSelection(),i=this._editor.getModel()
for(const n of this._markerService.read({resource:i.uri}))if(t.intersectRanges(n,e))return t.lift(n)}_getRangeOfSelectionUnlessWhitespaceEnclosed(){const e=this._editor.getModel(),t=this._editor.getSelection()
if(t.isEmpty()){const{lineNumber:i,column:n}=t.getPosition(),s=e.getLineContent(i)
if(0===s.length)return
if(1===n){if(/\s/.test(s[0]))return}else if(n===e.getLineMaxColumn(i)){if(/\s/.test(s[s.length-1]))return}else if(/\s/.test(s[n-2])&&/\s/.test(s[n-1]))return}return t}_createEventAndSignalChange(e,t){if(t){const i=this._editor.getModel(),n=i.validateRange(t),s=t instanceof At?t.getPosition():t.getStartPosition()
this._signalChange({type:e,range:n,position:s,fixes:Ux(i,n)})}else this._signalChange({type:e,range:void 0,position:void 0,fixes:void 0})}}let $x=Gx=class{constructor(t,i,n,s,r,o){this._keybindingService=o,this._disposables=[],this._editor=t,this._model=new class{constructor(e,t){this._onDidChangeFixes=new ci,this._disposables=[],this._editor=e,this._markerService=t,this._disposables.push(this._editor.onDidChangeModel(()=>this._update())),this._disposables.push(this._editor.onDidChangeModelLanguage(()=>this._update())),this._disposables.push(zs.onDidChange(this._update,this)),this._update()}dispose(){this._disposables=ei(this._disposables),ei(this._quickFixOracle)}get onDidChangeFixes(){return this._onDidChangeFixes.event}_update(){this._quickFixOracle&&(this._quickFixOracle.dispose(),this._quickFixOracle=void 0,this._onDidChangeFixes.fire(void 0)),this._editor.getModel()&&zs.has(this._editor.getModel())&&!this._editor.getConfiguration().readOnly&&(this._quickFixOracle=new Kx(this._editor,this._markerService,e=>this._onDidChangeFixes.fire(e)),this._quickFixOracle.trigger("auto"))}trigger(e){this._quickFixOracle&&this._quickFixOracle.trigger(e)}}(this._editor,i),this._quickFixContextMenu=new class{constructor(e,t,i){this._onDidExecuteCodeAction=new ci,this.onDidExecuteCodeAction=this._onDidExecuteCodeAction.event,this._editor=e,this._contextMenuService=t,this._commandService=i}show(t,i){const n=t.then(e=>e.map(e=>new Jr(e.id,e.title,void 0,!0,()=>ma(this._commandService.executeCommand(e.id,...e.arguments),()=>this._onDidExecuteCodeAction.fire(void 0)))))
this._contextMenuService.showContextMenu({getAnchor:()=>(e.isIPosition(i)&&(i=this._toCoords(i)),i),getActions:()=>n,onHide:()=>{this._visible=!1},autoSelectFirstItem:!0})}get isVisible(){return this._visible}_toCoords(e){this._editor.revealPosition(e,1),this._editor.render()
const t=this._editor.getScrolledVisiblePosition(this._editor.getPosition()),i=Cl(this._editor.getDomNode())
return{x:i.left+t.left,y:i.top+t.top+t.height}}}(t,r,s),this._lightBulbWidget=new zx(t),this._updateLightBulbTitle(),this._disposables.push(this._quickFixContextMenu.onDidExecuteCodeAction(e=>this._model.trigger("auto")),this._lightBulbWidget.onClick(this._handleLightBulbSelect,this),this._model.onDidChangeFixes(e=>this._onQuickFixEvent(e)),this._keybindingService.onDidUpdateKeybindings(this._updateLightBulbTitle,this))}static get(e){return e.getContribution(Gx.ID)}dispose(){this._model.dispose(),ei(this._disposables)}_onQuickFixEvent(e){e&&"manual"===e.type?this._quickFixContextMenu.show(e.fixes,e.position):e&&e.fixes?this._quickFixContextMenu.isVisible?this._quickFixContextMenu.show(e.fixes,e.position):this._lightBulbWidget.model=e:this._lightBulbWidget.hide()}getId(){return Gx.ID}_handleLightBulbSelect(e){this._quickFixContextMenu.show(this._lightBulbWidget.model.fixes,e)}triggerFromEditorSelection(){this._model.trigger("manual")}_updateLightBulbTitle(){const e=this._keybindingService.lookupKeybinding(qx.Id)
let t
t=e?Jt("quickFixWithKb","Show Fixes ({0})",e.getLabel()):Jt("quickFix","Show Fixes"),this._lightBulbWidget.title=t}}
$x.ID="editor.contrib.quickFixController",$x=Gx=Nn([iC,En(1,ay),En(2,Lo),En(3,Dr),En(4,J_),En(5,tC)],$x)
let qx=jx=class extends To{constructor(){super({id:jx.Id,label:Jt("quickfix.trigger.label","Quick Fix"),alias:"Quick Fix",precondition:_o.and(Vo.writable,Vo.hasCodeActionsProvider),kbOpts:{kbExpr:Vo.textFocus,primary:2132}})}run(e,t){let i=$x.get(t)
i&&i.triggerFromEditorSelection()}}
var Gx,jx
qx.Id="editor.action.quickFix",qx=jx=Nn([Oo],qx)
const Yx={getMetaTitle:e=>e.references.length>1&&Jt("meta.titleReference"," – {0} references",e.references.length)}
let Zx=Qx=class{constructor(e,t){e instanceof Wv&&qv.inPeekEditor.bindTo(t)}dispose(){}getId(){return Qx.ID}}
Zx.ID="editor.contrib.referenceController",Zx=Qx=Nn([Po,En(1,Lo)],Zx)
Oo(class extends To{constructor(){super({id:"editor.action.referenceSearch.trigger",label:Jt("references.action.label","Find All References"),alias:"Find All References",precondition:_o.and(Vo.hasReferenceProvider,qv.notInPeekEditor,Vo.isInEmbeddedEditor.toNegated()),kbOpts:{kbExpr:Vo.textFocus,primary:1094},menuOpts:{group:"navigation",order:1.5}})}run(e,t){let i=LS.get(t)
if(!i)return
let n=t.getSelection(),s=Jx(t.getModel(),n.getStartPosition()).then(e=>new Qv(e))
i.toggleWidget(n,s,Yx)}})
function Xx(e,t){var i=function(e){let t=e.get(Eo).getFocusedCodeEditor()
return t instanceof Wv?t.getParentEditor():t}(e)
if(!i)return
let n=LS.get(i)
n&&n.closeWidget()}function Jx(e,t){const i=Ds.ordered(e).map(i=>ca(n=>i.provideReferences(e,t,{includeDeclaration:!0},n)).then(e=>{if(Array.isArray(e))return e},e=>{yt(e)}))
return bt.join(i).then(e=>{let t=[]
for(let i of e)i&&t.push(...i)
return t})}var Qx
Tr.registerCommand({id:"editor.action.findReferences",handler:(i,n,s)=>{if(!(n instanceof X))throw new Error("illegal argument, uri")
if(!s)throw new Error("illegal argument, position")
return i.get(ao).openEditor({resource:n}).then(i=>{let n=i.getControl()
if(!p(n))return
let r=LS.get(n)
if(!r)return
let o=Jx(n.getModel(),e.lift(s)).then(e=>new Qv(e)),a=new t(s.lineNumber,s.column,s.lineNumber,s.column)
return bt.as(r.toggleWidget(a,o,Yx))})}}),Tr.registerCommand({id:"editor.action.showReferences",handler:(e,i,n,s)=>{if(!(i instanceof X))throw new Error("illegal argument, uri expected")
return e.get(ao).openEditor({resource:i}).then(e=>{let i=e.getControl()
if(!p(i))return
let r=LS.get(i)
return r?bt.as(r.toggleWidget(new t(n.lineNumber,n.column,n.lineNumber,n.column),bt.as(new Qv(s)),Yx)).then(()=>!0):void 0})},description:{description:"Show references at a position in a file",args:[{name:"uri",description:"The text document in which to show references",constraint:X},{name:"position",description:"The position at which to show",constraint:e.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array}]}}),jr.registerCommandAndKeybindingRule({id:"closeReferenceSearch",weight:No.commandWeight(50),primary:9,secondary:[1033],when:_o.and(xS,_o.not("config.editor.stablePeek")),handler:Xx}),jr.registerCommandAndKeybindingRule({id:"closeReferenceSearchEditor",weight:No.commandWeight(-101),primary:9,secondary:[1033],when:_o.and(qv.inPeekEditor,_o.not("config.editor.stablePeek")),handler:Xx}),No.registerDefaultLanguageCommand("_executeReferenceProvider",Jx)
const eL=Object.prototype.hasOwnProperty
function tL(e,t){for(let i in e){if(eL.call(e,i))if(!1===t({key:i,value:e[i]},function(){delete e[i]}))return}}class iL{constructor(e){this._fileService=e}start(){const e=Object.create(null)
let t
return this._fileService&&(t=this._fileService.onFileChanges(t=>{t.changes.forEach(t=>{const i=String(t.resource)
let n=e[i]
n||(e[i]=n=[]),n.push(t)})})),{stop:()=>t&&t.dispose(),hasChanged:t=>!!e[t.toString()],allChanges:()=>(i=function(e){const t=[]
for(let i in e)eL.call(e,i)&&t.push(e[i])
return t}(e),[].concat(...i))}
var i}}class nL{get _model(){return this._modelReference.object.textEditorModel}constructor(e){this._endCursorSelection=null,this._modelReference=e,this._edits=[]}addEdit(e){let i;("number"==typeof e.newEol&&(this._newEol=e.newEol),e.range||e.newText)&&(i=e.range?t.lift(e.range):this._model.getFullModelRange(),this._edits.push(C_.replaceMove(i,e.newText)))}apply(){this._edits.length>0&&(this._edits=this._edits.map((e,t)=>({value:e,index:t})).sort((e,i)=>{let n=t.compareRangesUsingStarts(e.value.range,i.value.range)
return 0===n&&(n=e.index-i.index),n}).map(e=>e.value),this._initialSelections=this._getInitialSelections(),this._model.pushStackElement(),this._model.pushEditOperations(this._initialSelections,this._edits,e=>this._getEndCursorSelections(e)),this._model.pushStackElement()),void 0!==this._newEol&&(this._model.pushStackElement(),this._model.setEOL(this._newEol),this._model.pushStackElement())}_getInitialSelections(){const e=this._edits[0].range
return[new At(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn)]}_getEndCursorSelections(e){let i=0
for(let n=0;n<e.length;n++){const s=e[n].range
for(let e=0;e<this._initialSelections.length;e++){const r=this._initialSelections[e]
if(t.areIntersectingOrTouching(s,r)){i=n
break}}}const n=e[i].range
return this._endCursorSelection=new At(n.endLineNumber,n.endColumn,n.endLineNumber,n.endColumn),[this._endCursorSelection]}getEndCursorSelection(){return this._endCursorSelection}dispose(){this._model&&(this._modelReference.dispose(),this._modelReference=null)}}class sL extends nL{constructor(e,t){super(e),this._knownInitialSelections=t}_getInitialSelections(){return this._knownInitialSelections}}class rL{constructor(e,t,i,n,s=null){this.progress=s,this._numberOfResourcesToModify=0,this._numberOfChanges=0,this._edits=Object.create(null),this._textModelResolverService=e,this._sourceModel=t,this._sourceSelections=i,this._sourceModelTask=null
for(let e of n)this._addEdit(e)}resourcesCount(){return this._numberOfResourcesToModify}changeCount(){return this._numberOfChanges}_addEdit(e){let t=this._edits[e.resource.toString()]
t||(this._edits[e.resource.toString()]=t=[],this._numberOfResourcesToModify+=1),this._numberOfChanges+=1,t.push(e)}prepare(){if(this._tasks)throw new Error("illegal state - already prepared")
this._tasks=[]
const e=[]
return this.progress&&this.progress.total(2*this._numberOfResourcesToModify),tL(this._edits,t=>{const i=this._textModelResolverService.createModelReference(X.parse(t.key)).then(e=>{const i=e.object
if(!i||!i.textEditorModel)throw new Error(`Cannot load file ${t.key}`)
const n=i.textEditorModel
let s
this._sourceModel&&n.uri.toString()===this._sourceModel.toString()?(this._sourceModelTask=new sL(e,this._sourceSelections),s=this._sourceModelTask):s=new nL(e),t.value.forEach(e=>s.addEdit(e)),this._tasks.push(s),this.progress&&this.progress.worked(1)})
e.push(i)}),bt.join(e).then(e=>this)}apply(){this._tasks.forEach(e=>this.applyTask(e))
let e=null
return this._sourceModelTask&&(e=this._sourceModelTask.getEndCursorSelection()),e}applyTask(e){e.apply(),this.progress&&this.progress.worked(1)}dispose(){this._tasks=ei(this._tasks)}}function oL(e,t,i){let n,s=[],r=new iL(i).start()
function o(){let e
for(let t of s)r.hasChanged(t.resource)&&(e||(e=[]),e.push(t.resource.fsPath))
if(e)return Jt("conflict","These files have changed in the meantime: {0}",e.join(", "))}return{progress:function(e){n=e},add:function(e){s.push(...e)},finish:function(){if(0===s.length)return bt.as(void 0)
let i,a,l=o()
if(l)return bt.wrapError(new Error(l))
t&&t.getModel()&&(i=t.getModel().uri,a=t.getSelections())
const h=new rL(e,i,a,s,n)
return h.prepare().then(e=>{let t=o()
if(t)throw new Error(t)
r.stop()
const i=h.apply()
return h.dispose(),i})},ariaMessage:function(){let e=s.length,t=function(e){let t=0
for(let i in e)eL.call(e,i)&&(t+=1)
return t}(function(e,t){const i=Object.create(null)
for(const n of e){const e=t(n)
let s=i[e]
s||(s=i[e]=[]),s.push(n)}return i}(s,e=>e.resource.toString()))
return 0===e?Jt("summary.0","Made no edits"):e>1&&t>1?Jt("summary.nm","Made {0} text edits in {1} files",e,t):Jt("summary.n0","Made {0} text edits in one file",e,t)}}}let aL=class{constructor(e,t){this.themeService=t,this._disposables=[],this.allowEditorOverflow=!0,this._currentAcceptInput=null,this._currentCancelInput=null,this._editor=e,this._editor.addContentWidget(this),this._disposables.push(e.onDidChangeConfiguration(e=>{e.fontInfo&&this.updateFont()})),this._disposables.push(t.onThemeChange(e=>this.onThemeChange(e)))}onThemeChange(e){this.updateStyles(e)}dispose(){this._disposables=ei(this._disposables),this._editor.removeContentWidget(this)}getId(){return"__renameInputWidget"}getDomNode(){return this._domNode||(this._inputField=document.createElement("input"),this._inputField.className="rename-input",this._inputField.type="text",this._inputField.setAttribute("aria-label",Jt("renameAriaLabel","Rename input. Type new name and press Enter to commit.")),this._domNode=document.createElement("div"),this._domNode.style.height=`${this._editor.getConfiguration().lineHeight}px`,this._domNode.className="monaco-editor rename-box",this._domNode.appendChild(this._inputField),this.updateFont(),this.updateStyles(this.themeService.getTheme())),this._domNode}updateStyles(e){if(!this._inputField)return
const t=e.getColor(Cc),i=e.getColor(bc),n=e.getColor(_c),s=e.getColor(wc)
this._inputField.style.backgroundColor=t?t.toString():null,this._inputField.style.color=i?i.toString():null,this._inputField.style.borderWidth=s?"1px":"0px",this._inputField.style.borderStyle=s?"solid":"none",this._inputField.style.borderColor=s?s.toString():"none",this._domNode.style.boxShadow=n?` 0 2px 8px ${n}`:null}updateFont(){if(!this._inputField)return
const e=this._editor.getConfiguration().fontInfo
this._inputField.style.fontFamily=e.fontFamily,this._inputField.style.fontWeight=e.fontWeight,this._inputField.style.fontSize=`${e.fontSize}px`}getPosition(){return this._visible?{position:this._position,preference:[pm.BELOW,pm.ABOVE]}:null}acceptInput(){this._currentAcceptInput&&this._currentAcceptInput()}cancelInput(){this._currentCancelInput&&this._currentCancelInput()}getInput(i,n,s,r){this._position=new e(i.startLineNumber,i.startColumn),this._inputField.value=n,this._inputField.setAttribute("selectionStart",s.toString()),this._inputField.setAttribute("selectionEnd",r.toString()),this._inputField.size=Math.max(1.1*(i.endColumn-i.startColumn),20)
let o,a=[]
return o=(()=>{ei(a),this._hide()}),new bt((e,s)=>{this._currentCancelInput=(()=>(this._currentAcceptInput=null,this._currentCancelInput=null,s(Nt()),!0)),this._currentAcceptInput=(()=>{0!==this._inputField.value.trim().length&&this._inputField.value!==n?(this._currentAcceptInput=null,this._currentCancelInput=null,e(this._inputField.value)):this.cancelInput()})
a.push(this._editor.onDidChangeCursorSelection(()=>{t.containsPosition(i,this._editor.getPosition())||this.cancelInput()})),a.push(this._editor.onDidBlurEditor(()=>this.cancelInput())),this._show()},this._currentCancelInput).then(e=>(o(),e),e=>(o(),bt.wrapError(e)))}_show(){this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber,0),this._visible=!0,this._editor.layoutContentWidget(this),setTimeout(()=>{this._inputField.focus(),this._inputField.setSelectionRange(parseInt(this._inputField.getAttribute("selectionStart")),parseInt(this._inputField.getAttribute("selectionEnd")))},25)}_hide(){this._visible=!1,this._editor.layoutContentWidget(this)}}
var lL=aL=Nn([En(1,Mg)],aL)
function hL(e,t,i){const n=[]
let s=!1
return pa(Ts.ordered(e).map(r=>()=>{if(!s)return ca(n=>r.provideRenameEdits(e,t,i,n)).then(e=>{if(e){if(!e.rejectReason)return s=!0,e
n.push(e.rejectReason)}else;},e=>(yt(e),bt.wrapError(new Error("provider failed"))))})).then(e=>{let t=e[0]
return n.length>0?{edits:void 0,rejectReason:n.join("\n")}:t||{edits:void 0,rejectReason:Jt("no result","No result.")}})}const dL=new xo("renameInputVisible",!1)
let uL=gL=class{constructor(e,t,i,n,s,r,o){this.editor=e,this._messageService=t,this._textModelResolverService=i,this._progressService=n,this._fileService=o,this._renameInputField=new lL(e,r),this._renameInputVisible=dL.bindTo(s)}static get(e){return e.getContribution(gL.ID)}dispose(){this._renameInputField.dispose()}getId(){return gL.ID}run(){const e=this.editor.getSelection(),i=this.editor.getModel().getWordAtPosition(e.getStartPosition())
if(!i)return
let n,s=e.startLineNumber,r=0,o=i.word.length
return n=new t(s,i.startColumn,s,i.endColumn),e.isEmpty()||e.startLineNumber!==e.endLineNumber||(r=Math.max(0,e.startColumn-i.startColumn),o=Math.min(i.endColumn,e.endColumn)-i.startColumn),this._renameInputVisible.set(!0),this._renameInputField.getInput(n,i.word,r,o).then(e=>{this._renameInputVisible.reset(),this.editor.focus()
let t=oL(this._textModelResolverService,this.editor,this._fileService)
const n=hL(this.editor.getModel(),this.editor.getPosition(),e).then(n=>{if(!n.rejectReason)return t.add(n.edits),t.finish().then(n=>{n&&this.editor.setSelection(n),vC(Jt("aria","Successfully renamed '{0}' to '{1}'. Summary: {2}",i.word,e,t.ariaMessage()))})
this._messageService.show(ew.Error,n.rejectReason)},e=>(this._messageService.show(ew.Error,Jt("rename.failed","Sorry, rename failed to execute.")),bt.wrapError(e)))
return this._progressService.showWhile(n,250),n},e=>{if(this._renameInputVisible.reset(),this.editor.focus(),!Lt(e))return bt.wrapError(e)})}acceptRenameInput(){this._renameInputField.acceptInput()}cancelRenameInput(){this._renameInputField.cancelInput()}}
uL.ID="editor.contrib.renameController",uL=gL=Nn([iC,En(1,tw),En(2,eS),En(3,DS),En(4,Lo),En(5,Mg),En(6,Mr(ww))],uL)
Oo(class extends To{constructor(){super({id:"editor.action.rename",label:Jt("rename.label","Rename Symbol"),alias:"Rename Symbol",precondition:_o.and(Vo.writable,Vo.hasRenameProvider),kbOpts:{kbExpr:Vo.textFocus,primary:60},menuOpts:{group:"1_modification",order:1.1}})}run(e,t){let i=uL.get(t)
if(i)return i.run()}})
const cL=Do.bindToContribution(uL.get)
var gL
No.registerEditorCommand(new cL({id:"acceptRenameInput",precondition:dL,handler:e=>e.acceptRenameInput(),kbOpts:{weight:No.commandWeight(99),kbExpr:Vo.focus,primary:3}})),No.registerEditorCommand(new cL({id:"cancelRenameInput",precondition:dL,handler:e=>e.cancelRenameInput(),kbOpts:{weight:No.commandWeight(99),kbExpr:Vo.focus,primary:9,secondary:[1033]}})),No.registerDefaultLanguageCommand("_executeDocumentRenameProvider",function(e,t,i){let{newName:n}=i
if("string"!=typeof n)throw Et("newName")
return hL(e,t,n)})
class mL{get range(){return new t(this.start.lineNumber,this.start.column,this.end.lineNumber,this.end.column)}}class pL extends mL{get start(){return this.hasChildren?this.children[0].start:this.parent.start}get end(){return this.hasChildren?this.children[this.children.length-1].end:this.parent.end}get hasChildren(){return this.children&&this.children.length>0}get isEmpty(){return!this.hasChildren&&!this.parent}append(e){return!!e&&(e.parent=this,this.children||(this.children=[]),e instanceof pL?e.children&&this.children.push.apply(this.children,e.children):this.children.push(e),!0)}}class fL extends mL{get start(){return this.open.start}get end(){return this.close.end}constructor(){super(),this.elements=new pL,this.elements.parent=this}}class _L{constructor(e,t,i){this.range=e,this.bracket=t,this.bracketType=i}}function CL(e){var t=new mL
return t.start=e.range.getStartPosition(),t.end=e.range.getEndPosition(),t}class bL{constructor(e,t,i){this.lineNumber=t,this.lineText=i,this.startOffset=e.startOffset,this.endOffset=e.endOffset,this.type=e.tokenType,this.languageId=e.languageId}}class wL{constructor(e){this._model=e,this._lineCount=this._model.getLineCount(),this._versionId=this._model.getVersionId(),this._lineNumber=0,this._lineText=null,this._advance()}_advance(){for(this._next=this._next?this._next.next():null;!this._next&&this._lineNumber<this._lineCount;){this._lineNumber++,this._lineText=this._model.getLineContent(this._lineNumber),this._model.forceTokenization(this._lineNumber)
let e=this._model.getLineTokens(this._lineNumber)
this._next=e.firstToken()}}next(){if(!this._next)return null
if(this._model.getVersionId()!==this._versionId)return null
let e=new bL(this._next,this._lineNumber,this._lineText)
return this._advance(),e}}class vL{constructor(e){this._rawTokenScanner=new wL(e),this._nextBuff=[],this._cachedLanguageBrackets=null,this._cachedLanguageId=-1}next(){if(this._nextBuff.length>0)return this._nextBuff.shift()
const e=this._rawTokenScanner.next()
if(!e)return null
const i=e.lineNumber,n=e.lineText,s=e.type
let r=e.startOffset
const o=e.endOffset
this._cachedLanguageId!==e.languageId&&(this._cachedLanguageId=e.languageId,this._cachedLanguageBrackets=cr.getBracketsSupport(this._cachedLanguageId))
const a=this._cachedLanguageBrackets
if(!a||Xs(s))return new _L(new t(i,r+1,i,o+1),0,null)
let l
do{if(l=ar.findNextBracketInToken(a.forwardRegex,i,n,r,o)){const e=l.startColumn-1,s=l.endColumn-1
r<e&&this._nextBuff.push(new _L(new t(i,r+1,i,e+1),0,null))
let o=n.substring(e,s)
o=o.toLowerCase()
const h=a.textIsBracket[o],d=a.textIsOpenBracket[o]
this._nextBuff.push(new _L(new t(i,e+1,i,s+1),d?1:-1,`${h.languageIdentifier.language};${h.open};${h.close}`)),r=s}}while(l)
return r<o&&this._nextBuff.push(new _L(new t(i,r+1,i,o+1),0,null)),this._nextBuff.shift()}}class SL{constructor(e){this._stack=[],this._scanner=new vL(e)}build(){for(var e=new pL;e.append(this._line()||this._any()););return e}_accept(e){var t=this._stack.pop()||this._scanner.next()
if(!t)return!1
var i=e(t)
return i?this._currentToken=t:(this._stack.push(t),this._currentToken=null),i}_peek(e){var t=!1
return this._accept(i=>(t=e(i),!1)),t}_line(){var e,t=new pL
for(this._peek(t=>(e=t.range.startLineNumber,!1));this._peek(t=>t.range.startLineNumber===e)&&t.append(this._token()||this._block()););return t.children&&0!==t.children.length?1===t.children.length?t.children[0]:t:null}_token(){return this._accept(e=>0===e.bracket)?CL(this._currentToken):null}_block(){var e
if(!this._accept(t=>(e=t.bracketType,1===t.bracket)))return null
var t=new fL
for(t.open=CL(this._currentToken);t.elements.append(this._line()););if(!this._accept(t=>-1===t.bracket&&t.bracketType===e)){var i=new pL
return i.append(t.open),i.append(t.elements),i}return t.close=CL(this._currentToken),t}_any(){return this._accept(e=>!0)?CL(this._currentToken):null}}let yL=class{constructor(e){this._modelService=e}getRangesToPosition(e,t){return bt.as(this.getRangesToPositionSync(e,t))}getRangesToPositionSync(e,t){var i=this._modelService.getModel(e),n=[]
return i&&this._doGetRangesToPosition(i,t).forEach(e=>{n.push({type:void 0,range:e})}),n}_doGetRangesToPosition(e,i){var n,s
n=function e(i,n){if(i instanceof pL&&i.isEmpty)return null
if(!t.containsPosition(i.range,n))return null
var s
if(i instanceof pL){if(i.hasChildren)for(var r=0,o=i.children.length;r<o&&!s;r++)s=e(i.children[r],n)}else i instanceof fL&&(s=e(i.open,n)||e(i.elements,n)||e(i.close,n))
return s||i}(new SL(e).build(),i)
for(var r=[];n;)s&&t.equalsRange(s,n.range)||r.push(n.range),s=n.range,n=n.parent
return r=r.reverse()}}
yL=Nn([En(0,Zr)],yL)
class xL{constructor(e){this.editor=e,this.next=null,this.previous=null,this.selection=e.getSelection()}}var LL=null,NL=!1
let EL=IL=class{constructor(e,t){this.editor=e,this._tokenSelectionSupport=t.createInstance(yL)}static get(e){return e.getContribution(IL.ID)}dispose(){}getId(){return IL.ID}run(e){var i=this.editor.getSelection(),n=this.editor.getModel()
LL&&LL.editor!==this.editor&&(LL=null)
var s=bt.as(null)
return LL||(s=this._tokenSelectionSupport.getRangesToPosition(n.uri,i.getStartPosition()).then(e=>{if(!Tn(e)){var i
e.filter(e=>{var i=this.editor.getSelection(),n=new t(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn)
return n.containsPosition(i.getStartPosition())&&n.containsPosition(i.getEndPosition())}).forEach(e=>{var n=e.range,s=new xL(this.editor)
s.selection=new t(n.startLineNumber,n.startColumn,n.endLineNumber,n.endColumn),i&&(s.next=i,i.previous=s),i=s})
var n=new xL(this.editor)
n.next=i,i&&(i.previous=n),LL=n
var s=this.editor.onDidChangeCursorPosition(e=>{NL||(LL=null,s.dispose())})}})),s.then(()=>{if(LL&&(LL=e?LL.next:LL.previous)){NL=!0
try{this.editor.setSelection(LL.selection)}finally{NL=!1}}})}}
EL.ID="editor.contrib.smartSelectController",EL=IL=Nn([Po,En(1,Er)],EL)
class kL extends To{constructor(e,t){super(t),this._forward=e}run(e,t){let i=EL.get(t)
if(i)return i.run(this._forward)}}Oo(class extends kL{constructor(){super(!0,{id:"editor.action.smartSelect.grow",label:Jt("smartSelect.grow","Expand Select"),alias:"Expand Select",precondition:null,kbOpts:{kbExpr:Vo.textFocus,primary:1553,mac:{primary:3345}}})}})
var IL,ML,DL
Oo(class extends kL{constructor(){super(!1,{id:"editor.action.smartSelect.shrink",label:Jt("smartSelect.shrink","Shrink Select"),alias:"Shrink Select",precondition:null,kbOpts:{kbExpr:Vo.textFocus,primary:1551,mac:{primary:3343}}})}}),(DL=ML||(ML={}))[DL.Dollar=0]="Dollar",DL[DL.Colon=1]="Colon",DL[DL.Comma=2]="Comma",DL[DL.CurlyOpen=3]="CurlyOpen",DL[DL.CurlyClose=4]="CurlyClose",DL[DL.Backslash=5]="Backslash",DL[DL.Forwardslash=6]="Forwardslash",DL[DL.Pipe=7]="Pipe",DL[DL.Int=8]="Int",DL[DL.VariableName=9]="VariableName",DL[DL.Format=10]="Format",DL[DL.Plus=11]="Plus",DL[DL.Dash=12]="Dash",DL[DL.QuestionMark=13]="QuestionMark",DL[DL.EOF=14]="EOF"
class TL{constructor(){this.text("")}static isDigitCharacter(e){return e>=48&&e<=57}static isVariableCharacter(e){return 95===e||e>=97&&e<=122||e>=65&&e<=90}text(e){this.value=e,this.pos=0}tokenText(e){return this.value.substr(e.pos,e.len)}next(){if(this.pos>=this.value.length)return{type:ML.EOF,pos:this.pos,len:0}
let e,t=this.pos,i=0,n=this.value.charCodeAt(t)
if("number"==typeof(e=TL._table[n]))return this.pos+=1,{type:e,pos:t,len:1}
if(TL.isDigitCharacter(n)){e=ML.Int
do{i+=1,n=this.value.charCodeAt(t+i)}while(TL.isDigitCharacter(n))
return this.pos+=i,{type:e,pos:t,len:i}}if(TL.isVariableCharacter(n)){e=ML.VariableName
do{n=this.value.charCodeAt(t+ ++i)}while(TL.isVariableCharacter(n)||TL.isDigitCharacter(n))
return this.pos+=i,{type:e,pos:t,len:i}}e=ML.Format
do{i+=1,n=this.value.charCodeAt(t+i)}while(!isNaN(n)&&void 0===TL._table[n]&&!TL.isDigitCharacter(n)&&!TL.isVariableCharacter(n))
return this.pos+=i,{type:e,pos:t,len:i}}}TL._table={36:ML.Dollar,58:ML.Colon,44:ML.Comma,123:ML.CurlyOpen,125:ML.CurlyClose,92:ML.Backslash,47:ML.Forwardslash,124:ML.Pipe,43:ML.Plus,45:ML.Dash,63:ML.QuestionMark}
class OL{constructor(){this._children=[]}appendChild(e){return e instanceof RL&&this._children[this._children.length-1]instanceof RL?this._children[this._children.length-1].value+=e.value:(e.parent=this,this._children.push(e)),this}replace(e,t){const{parent:i}=e,n=i.children.indexOf(e),s=i.children.slice(0)
s.splice(n,1,...t),i._children=s,t.forEach(e=>e.parent=i)}get children(){return this._children}get snippet(){let e=this
for(;;){if(!e)return
if(e instanceof HL)return e
e=e.parent}}toString(){return this.children.reduce((e,t)=>e+t.toString(),"")}len(){return 0}}class RL extends OL{constructor(e){super(),this.value=e}static escape(e){return e.replace(/\$|}|\\/g,"\\$&")}toString(){return this.value}toTextmateString(){return RL.escape(this.value)}len(){return this.value.length}clone(){return new RL(this.value)}}class AL extends OL{constructor(e){super(),this.index=e}static compareByIndex(e,t){return e.index===t.index?0:e.isFinalTabstop?1:t.isFinalTabstop?-1:e.index<t.index?-1:e.index>t.index?1:0}get isFinalTabstop(){return 0===this.index}get choice(){return 1===this._children.length&&this._children[0]instanceof PL?this._children[0]:void 0}toTextmateString(){return 0===this.children.length?`$${this.index}`:this.choice?`\${${this.index}|${this.choice.toTextmateString()}|}`:`\${${this.index}:${this.children.map(e=>e.toTextmateString()).join("")}}`}clone(){let e=new AL(this.index)
return e._children=this.children.map(e=>e.clone()),e}}class PL extends OL{constructor(){super(...arguments),this.options=[]}appendChild(e){return e instanceof RL&&(e.parent=this,this.options.push(e)),this}toString(){return this.options[0].value}toTextmateString(){return this.options.map(e=>e.value.replace(/\||,/g,"\\$&")).join(",")}len(){return this.options[0].len()}clone(){let e=new PL
return this.options.forEach(e.appendChild,e),e}}class FL extends OL{resolve(e){const t=this
return e.replace(this.regexp,function(){let e=""
for(const i of t._children)if(i instanceof WL){let t=arguments.length-2>i.index?arguments[i.index]:""
e+=t=i.resolve(t)}else e+=i.toString()
return e})}toString(){return""}toTextmateString(){return`/${RL.escape(this.regexp.source)}/${this.children.map(e=>e.toTextmateString())}/${this.regexp.ignoreCase?"i":""}`}clone(){let e=new FL
return e.regexp=new RegExp(this.regexp.source,this.regexp.ignoreCase?"i":""),e._children=this.children.map(e=>e.clone()),e}}class WL extends OL{constructor(e,t,i,n){super(),this.index=e,this.shorthandName=t,this.ifValue=i,this.elseValue=n}resolve(e){return"upcase"===this.shorthandName?e?e.toLocaleUpperCase():"":"downcase"===this.shorthandName?e?e.toLocaleLowerCase():"":"capitalize"===this.shorthandName?e?e[0].toLocaleUpperCase()+e.substr(1):"":Boolean(e)&&"string"==typeof this.ifValue?this.ifValue:Boolean(e)||"string"!=typeof this.elseValue?e||"":this.elseValue}toTextmateString(){let e="${"
return e+=this.index,this.shorthandName?e+=`:/${this.shorthandName}`:this.ifValue&&this.elseValue?e+=`:?${this.ifValue}:${this.elseValue}`:this.ifValue?e+=`:+${this.ifValue}`:this.elseValue&&(e+=`:-${this.elseValue}`),e+="}"}clone(){return new WL(this.index,this.shorthandName,this.ifValue,this.elseValue)}}class VL extends OL{constructor(e){super(),this.name=e}resolve(e){let t=e.resolve(this),[i]=this._children
return i instanceof FL&&1===this._children.length&&(t=i.resolve(t||"")),void 0!==t&&(this._children=[new RL(t)],!0)}toTextmateString(){return 0===this.children.length?`\${${this.name}}`:`\${${this.name}:${this.children.map(e=>e.toTextmateString()).join("")}}`}clone(){const e=new VL(this.name)
return e._children=this.children.map(e=>e.clone()),e}}function BL(e,t){const i=[...e]
for(;i.length>0;){const e=i.shift()
if(!t(e))break
i.unshift(...e.children)}}class HL extends OL{get placeholderInfo(){if(!this._placeholders){let e,t=[]
this.walk(function(i){return i instanceof AL&&(t.push(i),e=!e||e.index<i.index?i:e),!0}),this._placeholders={all:t,last:e}}return this._placeholders}get placeholders(){const{all:e}=this.placeholderInfo
return e}offset(e){let t=0,i=!1
return this.walk(n=>n===e?(i=!0,!1):(t+=n.len(),!0)),i?t:-1}fullLen(e){let t=0
return BL([e],e=>(t+=e.len(),!0)),t}enclosingPlaceholders(e){let t=[],{parent:i}=e
for(;i;)i instanceof AL&&t.push(i),i=i.parent
return t}resolveVariables(e){return this.walk(t=>(t instanceof VL&&t.resolve(e)&&(this._placeholders=void 0),!0)),this}appendChild(e){return this._placeholders=void 0,super.appendChild(e)}replace(e,t){return this._placeholders=void 0,super.replace(e,t)}toTextmateString(){return this.children.reduce((e,t)=>e+t.toTextmateString(),"")}clone(){let e=new HL
return this._children=this.children.map(e=>e.clone()),e}walk(e){BL(this.children,e)}}class zL{constructor(){this._scanner=new TL}static escape(e){return e.replace(/\$|}|\\/g,"\\$&")}text(e){return this.parse(e).toString()}parse(e,t,i){this._scanner.text(e),this._token=this._scanner.next()
const n=new HL
for(;this._parse(n););const s=new Map,r=[]
let o=0
n.walk(e=>(e instanceof AL&&(o+=1,e.isFinalTabstop?s.set(0):!s.has(e.index)&&e.children.length>0?s.set(e.index,e.children):r.push(e)),!0))
for(const e of r)if(s.has(e.index)){const t=new AL(e.index)
for(const i of s.get(e.index))t.appendChild(i.clone())
n.replace(e,[t])}return i||(i=o>0&&t),!s.has(0)&&i&&n.appendChild(new AL(0)),n}_accept(e,t){if(void 0===e||this._token.type===e){let e=!t||this._scanner.tokenText(this._token)
return this._token=this._scanner.next(),e}return!1}_backTo(e){return this._scanner.pos=e.pos+e.len,this._token=e,!1}_until(e){if(this._token.type===ML.EOF)return!1
let t=this._token
for(;this._token.type!==e;)this._token=this._scanner.next()
let i=this._scanner.value.substring(t.pos,this._token.pos)
return this._token=this._scanner.next(),i}_parse(e){return this._parseEscaped(e)||this._parseTabstopOrVariableName(e)||this._parseComplexPlaceholder(e)||this._parseComplexVariable(e)||this._parseAnything(e)}_parseEscaped(e){let t
return!!(t=this._accept(ML.Backslash,!0))&&(t=this._accept(ML.Dollar,!0)||this._accept(ML.CurlyClose,!0)||this._accept(ML.Backslash,!0)||t,e.appendChild(new RL(t)),!0)}_parseTabstopOrVariableName(e){let t
const i=this._token
return this._accept(ML.Dollar)&&(t=this._accept(ML.VariableName,!0)||this._accept(ML.Int,!0))?(e.appendChild(/^\d+$/.test(t)?new AL(Number(t)):new VL(t)),!0):this._backTo(i)}_parseComplexPlaceholder(e){let t
const i=this._token
if(!(this._accept(ML.Dollar)&&this._accept(ML.CurlyOpen)&&(t=this._accept(ML.Int,!0))))return this._backTo(i)
const n=new AL(Number(t))
if(this._accept(ML.Colon))for(;;){if(this._accept(ML.CurlyClose))return e.appendChild(n),!0
if(!this._parse(n))return e.appendChild(new RL("${"+t+":")),n.children.forEach(e.appendChild,e),!0}else{if(!(n.index>0&&this._accept(ML.Pipe)))return this._accept(ML.CurlyClose)?(e.appendChild(n),!0):this._backTo(i)
{const t=new PL
for(;;){if(this._parseChoiceElement(t)){if(this._accept(ML.Comma))continue
if(this._accept(ML.Pipe)&&this._accept(ML.CurlyClose))return n.appendChild(t),e.appendChild(n),!0}return this._backTo(i),!1}}}}_parseChoiceElement(e){const t=this._token,i=[]
for(;this._token.type!==ML.Comma&&this._token.type!==ML.Pipe;){let e
if(!(e=(e=this._accept(ML.Backslash,!0))?this._accept(ML.Comma,!0)||this._accept(ML.Pipe,!0)||e:this._accept(void 0,!0)))return this._backTo(t),!1
i.push(e)}return 0===i.length?(this._backTo(t),!1):(e.appendChild(new RL(i.join(""))),!0)}_parseComplexVariable(e){let t
const i=this._token
if(!(this._accept(ML.Dollar)&&this._accept(ML.CurlyOpen)&&(t=this._accept(ML.VariableName,!0))))return this._backTo(i)
const n=new VL(t)
if(!this._accept(ML.Colon))return this._accept(ML.Forwardslash)?this._parseTransform(n)?(e.appendChild(n),!0):(this._backTo(i),!1):this._accept(ML.CurlyClose)?(e.appendChild(n),!0):this._backTo(i)
for(;;){if(this._accept(ML.CurlyClose))return e.appendChild(n),!0
if(!this._parse(n))return e.appendChild(new RL("${"+t+":")),n.children.forEach(e.appendChild,e),!0}}_parseTransform(e){let t=new FL,i="",n=""
for(;!this._accept(ML.Forwardslash);){let e
if(e=this._accept(ML.Backslash,!0))i+=e=this._accept(ML.Forwardslash,!0)||e
else{if(this._token.type===ML.EOF)return!1
i+=this._accept(void 0,!0)}}for(;!this._accept(ML.Forwardslash);)if(!this._parseFormatString(t)&&!this._parseAnything(t))return!1
for(;!this._accept(ML.CurlyClose);){if(this._token.type===ML.EOF)return!1
n+=this._accept(void 0,!0)}try{t.regexp=new RegExp(i,n)}catch(e){return!1}return e.appendChild(t),!0}_parseFormatString(e){const t=this._token
if(!this._accept(ML.Dollar))return!1
let i=!1
this._accept(ML.CurlyOpen)&&(i=!0)
let n=this._accept(ML.Int,!0)
if(!n)return this._backTo(t),!1
if(!i)return e.appendChild(new WL(Number(n))),!0
if(this._accept(ML.CurlyClose))return e.appendChild(new WL(Number(n))),!0
if(!this._accept(ML.Colon))return this._backTo(t),!1
if(this._accept(ML.Forwardslash)){let i=this._accept(ML.VariableName,!0)
return i&&this._accept(ML.CurlyClose)?(e.appendChild(new WL(Number(n),i)),!0):(this._backTo(t),!1)}if(this._accept(ML.Plus)){let t=this._until(ML.CurlyClose)
if(t)return e.appendChild(new WL(Number(n),void 0,t,void 0)),!0}else if(this._accept(ML.Dash)){let t=this._until(ML.CurlyClose)
if(t)return e.appendChild(new WL(Number(n),void 0,void 0,t)),!0}else if(this._accept(ML.QuestionMark)){let t=this._until(ML.Colon)
if(t){let i=this._until(ML.CurlyClose)
if(i)return e.appendChild(new WL(Number(n),void 0,t,i)),!0}}else{let t=this._until(ML.CurlyClose)
if(t)return e.appendChild(new WL(Number(n),void 0,void 0,t)),!0}return this._backTo(t),!1}_parseAnything(e){return this._token.type!==ML.EOF&&(e.appendChild(new RL(this._scanner.tokenText(this._token))),this._accept(void 0),!0)}}class UL{constructor(e,t){this._model=e,this._selection=t}resolve(e){const{name:t}=e
if("SELECTION"===t||"TM_SELECTED_TEXT"===t){let t=this._model.getValueInRange(this._selection)||void 0
if(t&&this._selection.startLineNumber!==this._selection.endLineNumber){const i=Ne(this._model.getLineContent(this._selection.startLineNumber),0,this._selection.startColumn-1)
let n=i
e.snippet.walk(t=>t!==e&&(t instanceof RL&&(n=Ne(t.value.split(/\r\n|\r|\n/).pop())),!0))
const s=Pe(n,i)
t=t.replace(/(\r\n|\r|\n)(.*)/g,(e,t,i)=>`${t}${n.substr(s)}${i}`)}return t}if("TM_CURRENT_LINE"===t)return this._model.getLineContent(this._selection.positionLineNumber)
if("TM_CURRENT_WORD"===t){const e=this._model.getWordAtPosition({lineNumber:this._selection.positionLineNumber,column:this._selection.positionColumn})
return e&&e.word||void 0}if("TM_LINE_INDEX"===t)return String(this._selection.positionLineNumber-1)
if("TM_LINE_NUMBER"===t)return String(this._selection.positionLineNumber)
if("TM_FILENAME"===t)return qn(this._model.uri.fsPath)
if("TM_FILENAME_BASE"===t){const e=qn(this._model.uri.fsPath),t=e.lastIndexOf(".")
return t<=0?e:e.slice(0,t)}if("TM_DIRECTORY"===t){const e=$n(this._model.uri.fsPath)
return"."!==e?e:""}return"TM_FILEPATH"===t?this._model.uri.fsPath:void 0}}UL.VariableNames=Object.freeze({SELECTION:!0,TM_SELECTED_TEXT:!0,TM_CURRENT_LINE:!0,TM_CURRENT_WORD:!0,TM_LINE_INDEX:!0,TM_LINE_NUMBER:!0,TM_FILENAME:!0,TM_FILENAME_BASE:!0,TM_DIRECTORY:!0,TM_FILEPATH:!0})
class KL{constructor(e,t,i){this._nestingLevel=1,this._editor=e,this._snippet=t,this._offset=i,this._placeholderGroups=Dn(t.placeholders,AL.compareByIndex),this._placeholderGroupsIdx=-1}dispose(){this._placeholderDecorations&&this._editor.changeDecorations(e=>this._placeholderDecorations.forEach(t=>e.removeDecoration(t))),this._placeholderGroups.length=0}_initDecorations(){if(this._placeholderDecorations)return
this._placeholderDecorations=new Map
const e=this._editor.getModel()
this._editor.changeDecorations(i=>{for(const n of this._snippet.placeholders){const s=this._snippet.offset(n),r=this._snippet.fullLen(n),o=t.fromPositions(e.getPositionAt(this._offset+s),e.getPositionAt(this._offset+s+r)),a=n.isFinalTabstop?KL._decor.inactiveFinal:KL._decor.inactive,l=i.addDecoration(o,a)
this._placeholderDecorations.set(n,l)}})}move(e){return this._initDecorations(),!0===e&&this._placeholderGroupsIdx<this._placeholderGroups.length-1?this._placeholderGroupsIdx+=1:!1===e&&this._placeholderGroupsIdx>0&&(this._placeholderGroupsIdx-=1),this._editor.getModel().changeDecorations(e=>{const t=new Set,i=[]
for(const n of this._placeholderGroups[this._placeholderGroupsIdx]){const s=this._placeholderDecorations.get(n),r=this._editor.getModel().getDecorationRange(s)
i.push(new At(r.startLineNumber,r.startColumn,r.endLineNumber,r.endColumn)),e.changeDecorationOptions(s,n.isFinalTabstop?KL._decor.activeFinal:KL._decor.active),t.add(n)
for(const i of this._snippet.enclosingPlaceholders(n)){const n=this._placeholderDecorations.get(i)
e.changeDecorationOptions(n,i.isFinalTabstop?KL._decor.activeFinal:KL._decor.active),t.add(i)}}return this._placeholderDecorations.forEach((i,n)=>{t.has(n)||e.changeDecorationOptions(i,n.isFinalTabstop?KL._decor.inactiveFinal:KL._decor.inactive)}),i})}get isAtFirstPlaceholder(){return this._placeholderGroupsIdx<=0||0===this._placeholderGroups.length}get isAtLastPlaceholder(){return this._placeholderGroupsIdx===this._placeholderGroups.length-1}get hasPlaceholder(){return this._snippet.placeholders.length>0}get placeholderRanges(){const e=[]
return this._placeholderDecorations.forEach((t,i)=>{if(!i.isFinalTabstop){const i=this._editor.getModel().getDecorationRange(t)
i&&e.push(i)}}),e}get choice(){return this._placeholderGroups[this._placeholderGroupsIdx][0].choice}merge(e){const i=this._editor.getModel()
this._nestingLevel*=10,this._editor.changeDecorations(n=>{for(const s of this._placeholderGroups[this._placeholderGroupsIdx]){const r=e.shift()
console.assert(!r._placeholderDecorations)
for(const e of r._snippet.placeholderInfo.all)e.isFinalTabstop?e.index=s.index+(r._snippet.placeholderInfo.last.index+1)/this._nestingLevel:e.index=s.index+e.index/this._nestingLevel
this._snippet.replace(s,r._snippet.children)
const o=this._placeholderDecorations.get(s)
n.removeDecoration(o),this._placeholderDecorations.delete(s)
for(const e of r._snippet.placeholders){const s=r._snippet.offset(e),o=r._snippet.fullLen(e),a=t.fromPositions(i.getPositionAt(r._offset+s),i.getPositionAt(r._offset+s+o)),l=n.addDecoration(a,KL._decor.inactive)
this._placeholderDecorations.set(e,l)}}this._placeholderGroups=Dn(this._snippet.placeholders,AL.compareByIndex)})}}KL._decor={active:Ld.register({stickiness:d.AlwaysGrowsWhenTypingAtEdges,className:"snippet-placeholder"}),inactive:Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,className:"snippet-placeholder"}),activeFinal:Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,className:"finish-snippet-placeholder"}),inactiveFinal:Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,className:"finish-snippet-placeholder"})}
class $L{constructor(e,t,i=0,n=0){this._snippets=[],this._editor=e,this._template=t,this._overwriteBefore=i,this._overwriteAfter=n}static adjustWhitespace(e,t,i){const n=Ne(e.getLineContent(t.lineNumber),0,t.column-1),s=i.split(/\r\n|\r|\n/)
for(let t=1;t<s.length;t++){let i=Ne(s[t])
s[t]=e.normalizeIndentation(n+i)+s[t].substr(i.length)}return s.join(e.getEOL())}static adjustSelection(e,t,i,n){if(0!==i||0!==n){const{positionLineNumber:s,positionColumn:r}=t,o=r-i,a=r+n,l=e.validateRange({startLineNumber:s,startColumn:o,endLineNumber:s,endColumn:a})
t=At.createWithDirection(l.startLineNumber,l.startColumn,l.endLineNumber,l.endColumn,t.getDirection())}return t}static createEditsAndSnippets(e,i,n,s,r){const o=e.getModel(),a=[],l=[]
let h=0,d=o.getValueInRange($L.adjustSelection(o,e.getSelection(),n,0)),u=o.getValueInRange($L.adjustSelection(o,e.getSelection(),0,s))
const c=e.getSelections().map((e,t)=>({selection:e,idx:t})).sort((e,i)=>t.compareRangesUsingStarts(e.selection,i.selection))
for(const{selection:t,idx:g}of c){let c=$L.adjustSelection(o,t,n,0),m=$L.adjustSelection(o,t,0,s)
d!==o.getValueInRange(c)&&(c=t),u!==o.getValueInRange(m)&&(m=t)
const p=t.setStartPosition(c.startLineNumber,c.startColumn).setEndPosition(m.endLineNumber,m.endColumn),f=p.getStartPosition(),_=$L.adjustWhitespace(o,f,i),C=(new zL).parse(_,!0,r).resolveVariables(new UL(o,t)),b=o.getOffsetAt(f)+h
h+=C.toString().length-o.getValueLengthInRange(p),a[g]=C_.replace(p,C.toString()),l[g]=new KL(e,C,b)}return{edits:a,snippets:l}}dispose(){ei(this._snippets)}insert(){const e=this._editor.getModel(),{edits:t,snippets:i}=$L.createEditsAndSnippets(this._editor,this._template,this._overwriteBefore,this._overwriteAfter,!1)
this._snippets=i,this._editor.setSelections(e.pushEditOperations(this._editor.getSelections(),t,e=>this._snippets[0].hasPlaceholder?this._move(!0):e.map(e=>At.fromPositions(e.range.getEndPosition()))))}merge(e,t=0,i=0){const{edits:n,snippets:s}=$L.createEditsAndSnippets(this._editor,e,t,i,!0)
this._editor.setSelections(this._editor.getModel().pushEditOperations(this._editor.getSelections(),n,e=>{for(const e of this._snippets)e.merge(s)
return console.assert(0===s.length),this._snippets[0].hasPlaceholder?this._move(void 0):e.map(e=>At.fromPositions(e.range.getEndPosition()))}))}next(){const e=this._move(!0)
this._editor.setSelections(e)}prev(){const e=this._move(!1)
this._editor.setSelections(e)}_move(e){const t=[]
for(const i of this._snippets){const n=i.move(e)
t.push(...n)}return t}get isAtFirstPlaceholder(){return this._snippets[0].isAtFirstPlaceholder}get isAtLastPlaceholder(){return this._snippets[0].isAtLastPlaceholder}get hasPlaceholder(){return this._snippets[0].hasPlaceholder}get choice(){return this._snippets[0].choice}isSelectionWithinPlaceholders(){if(!this.hasPlaceholder)return!1
const e=this._editor.getSelections()
if(e.length<this._snippets.length)return!1
const i=[]
for(const e of this._snippets)i.push(...e.placeholderRanges)
if(e.length>i.length)return!1
e.sort(t.compareRangesUsingStarts),i.sort(t.compareRangesUsingStarts)
e:for(const t of e){let e
for(;e=i.shift();)if(e.containsRange(t))continue e
return!1}return!0}}const qL={Visible:new xo("suggestWidgetVisible",!1),MultipleSuggestions:new xo("suggestWidgetMultipleSuggestions",!1),MakesTextEdit:new xo("suggestionMakesTextEdit",!0),AcceptOnKey:new xo("suggestionSupportsAcceptOnKey",!0),AcceptSuggestionsOnEnter:new xo("acceptSuggestionOnEnter",!0)}
let GL,jL
function YL(e,t,i="bottom",n,s){const r=[],o="none"===i?e=>"snippet"!==e.type:()=>!0
t=t.clone()
const a=Os.orderedGroups(e)
"none"!==i&&GL&&a.unshift([GL])
const l=s||{triggerKind:xs.Invoke}
let h=!1
return pa(a.map(i=>()=>{if(!h)return bt.join(i.map(i=>{if(Tn(n)||!(n.indexOf(i)<0))return ca(n=>i.provideCompletionItems(e,t,l,n)).then(n=>{const s=r.length
if(n&&!Tn(n.suggestions))for(let s of n.suggestions)o(s)&&(ZL(s,n),r.push({position:t,container:n,suggestion:s,support:i,resolve:XL(i,s,e,t)}))
s!==r.length&&i!==GL&&(h=!0)},yt)}))})).then(()=>r.sort(tN(i)))}function ZL(e,t){"number"!=typeof e.overwriteBefore&&(e.overwriteBefore=0),("number"!=typeof e.overwriteAfter||e.overwriteAfter<0)&&(e.overwriteAfter=0)}function XL(e,t,i,n){return()=>"function"==typeof e.resolveCompletionItem?ca(s=>e.resolveCompletionItem(i,n,t,s)).then(e=>{Bn(t,e)}):bt.as(void 0)}function JL(e,t){let i=0
return"string"==typeof e.suggestion.sortText&&"string"==typeof t.suggestion.sortText&&(i=Ie(e.suggestion.sortText,t.suggestion.sortText)),0===i&&(i=Ie(e.suggestion.label,t.suggestion.label)),0===i&&e.suggestion.type!==t.suggestion.type&&("snippet"===e.suggestion.type?i=1:"snippet"===t.suggestion.type&&(i=-1)),i}function QL(e,t){if(e.suggestion.type!==t.suggestion.type){if("snippet"===e.suggestion.type)return-1
if("snippet"===t.suggestion.type)return 1}return JL(e,t)}function eN(e,t){if(e.suggestion.type!==t.suggestion.type){if("snippet"===e.suggestion.type)return 1
if("snippet"===t.suggestion.type)return-1}return JL(e,t)}function tN(e){return"top"===e?QL:"bottom"===e?eN:JL}No.registerDefaultLanguageCommand("_executeCompletionItemProvider",(e,t,i)=>{const n={incomplete:!1,suggestions:[]}
return YL(e,t).then(e=>{for(const{container:t,suggestion:i}of e)n.incomplete=n.incomplete||t.incomplete,n.suggestions.push(i)
return n})})
let iN=new class{provideCompletionItems(){return jL&&{suggestions:jL}}}
Os.register("*",iN)
let nN=rN=class{constructor(e,t){this._editor=e,this._snippetListener=[],this._inSnippet=rN.InSnippetMode.bindTo(t),this._hasNextTabstop=rN.HasNextTabstop.bindTo(t),this._hasPrevTabstop=rN.HasPrevTabstop.bindTo(t)}static get(e){return e.getContribution("snippetController2")}dispose(){this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),ei(this._session)}getId(){return"snippetController2"}insert(e,t=0,i=0,n=!0,s=!0){this._snippetListener=ei(this._snippetListener),n&&this._editor.getModel().pushStackElement(),this._session?this._session.merge(e,t,i):(this._modelVersionId=this._editor.getModel().getAlternativeVersionId(),this._session=new $L(this._editor,e,t,i),this._session.insert()),s&&this._editor.getModel().pushStackElement(),this._updateState(),this._snippetListener=[this._editor.onDidChangeModelContent(e=>e.isFlush&&this.cancel()),this._editor.onDidChangeModel(()=>this.cancel()),this._editor.onDidChangeCursorSelection(()=>this._updateState())]}_updateState(){if(this._session){if(this._modelVersionId===this._editor.getModel().getAlternativeVersionId())return this.cancel()
if(!this._session.hasPlaceholder)return this.cancel()
if(this._session.isAtLastPlaceholder||!this._session.isSelectionWithinPlaceholders())return this.cancel()
this._inSnippet.set(!0),this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder),this._hasNextTabstop.set(!this._session.isAtLastPlaceholder),this._handleChoice()}}_handleChoice(){const{choice:e}=this._session
var t,i
if(e){if(this._currentChoice!==e){this._currentChoice=e,this._editor.setSelections(this._editor.getSelections().map(e=>At.fromPositions(e.getStartPosition())))
const[n]=e.options
t=this._editor,i=e.options.map((e,t)=>({type:"value",label:e.value,insertText:e.value,sortText:tt("a",t),overwriteAfter:n.value.length})),setTimeout(()=>{jL=i,t.getContribution("editor.contrib.suggestController").triggerSuggest([iN]),jL=void 0},0)}}else this._currentChoice=void 0}finish(){for(;this._inSnippet.get();)this.next()}cancel(){this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),ei(this._snippetListener),ei(this._session),this._session=void 0,this._modelVersionId=-1}prev(){this._session.prev(),this._updateState()}next(){this._session.next(),this._updateState()}}
nN.InSnippetMode=new xo("inSnippetMode",!1),nN.HasNextTabstop=new xo("hasNextTabstop",!1),nN.HasPrevTabstop=new xo("hasPrevTabstop",!1),nN=rN=Nn([Po,En(1,Lo)],nN)
const sN=Do.bindToContribution(nN.get)
var rN
function oN(...e){return function(t,i){for(let n=0,s=e.length;n<s;n++){let s=e[n](t,i)
if(s)return s}return null}}No.registerEditorCommand(new sN({id:"jumpToNextSnippetPlaceholder",precondition:_o.and(nN.InSnippetMode,nN.HasNextTabstop),handler:e=>e.next(),kbOpts:{weight:No.commandWeight(30),kbExpr:Vo.textFocus,primary:2}})),No.registerEditorCommand(new sN({id:"jumpToPrevSnippetPlaceholder",precondition:_o.and(nN.InSnippetMode,nN.HasPrevTabstop),handler:e=>e.prev(),kbOpts:{weight:No.commandWeight(30),kbExpr:Vo.textFocus,primary:1026}})),No.registerEditorCommand(new sN({id:"leaveSnippet",precondition:nN.InSnippetMode,handler:e=>e.cancel(),kbOpts:{weight:No.commandWeight(30),kbExpr:Vo.textFocus,primary:9,secondary:[1033]}})),No.registerEditorCommand(new sN({id:"acceptSnippet",precondition:nN.InSnippetMode,handler:e=>e.finish()}))
lN.bind(void 0,!1)
const aN=lN.bind(void 0,!0)
function lN(e,t,i){if(!i||i.length<t.length)return null
let n
return(n=e?Ae(i,t):0===i.indexOf(t))?t.length>0?[{start:0,end:t.length}]:[]:null}function hN(e){return 97<=e&&e<=122}function dN(e){return 65<=e&&e<=90}function uN(e){return 48<=e&&e<=57}function cN(e){return hN(e)||dN(e)||uN(e)}function gN(e,t){return 0===t.length?t=[e]:e.end===t[0].start?t[0].start=e.start:t.unshift(e),t}function mN(e,t){for(let i=t;i<e.length;i++){let t=e.charCodeAt(i)
if(dN(t)||uN(t)||i>0&&!cN(e.charCodeAt(i-1)))return i}return e.length}function pN(e,t,i,n){if(i===e.length)return[]
if(n===t.length)return null
if(e[i]!==t[n].toLowerCase())return null
{let s=null,r=n+1
for(s=pN(e,t,i+1,n+1);!s&&(r=mN(t,r))<t.length;)s=pN(e,t,i+1,r),r++
return null===s?null:gN({start:n,end:n+1},s)}}function fN(e,t){if(!t)return null
if(0===(t=t.trim()).length)return null
if(!function(e){let t=0,i=0,n=0,s=0
for(let o=0;o<e.length;o++)dN(n=e.charCodeAt(o))&&t++,hN(n)&&i++,(32===(r=n)||9===r||10===r||13===r)&&s++
var r
return 0!==t&&0!==i||0!==s?t<=5:e.length<=30}(e))return null
if(t.length>60)return null
const i=function(e){let t=0,i=0,n=0,s=0,r=0
for(let o=0;o<e.length;o++)dN(r=e.charCodeAt(o))&&t++,hN(r)&&i++,cN(r)&&n++,uN(r)&&s++
return{upperPercent:t/e.length,lowerPercent:i/e.length,alphaPercent:n/e.length,numericPercent:s/e.length}}(t)
if(!function(e){const{upperPercent:t,lowerPercent:i,alphaPercent:n,numericPercent:s}=e
return i>.2&&t<.8&&n>.6&&s<.2}(i)){if(!function(e){const{upperPercent:t,lowerPercent:i}=e
return 0===i&&t>.6}(i))return null
t=t.toLowerCase()}let n=null,s=0
for(;s<t.length&&null===(n=pN(e.toLowerCase(),t,0,s));)s=mN(t,s+1)
return n}var _N,CN;(CN=_N||(_N={}))[CN.Contiguous=0]="Contiguous",CN[CN.Separate=1]="Separate"
const bN=oN(aN,fN,function(e,t){let i=t.toLowerCase().indexOf(e.toLowerCase())
return-1===i?null:[{start:i,end:i+e.length}]}),wN=oN(aN,fN,function(e,t){return function e(t,i,n,s){if(n===t.length)return[]
if(s===i.length)return null
if(t[n]===i[s]){let r=null
return(r=e(t,i,n+1,s+1))?gN({start:s,end:s+1},r):null}return e(t,i,n,s+1)}(e.toLowerCase(),t.toLowerCase(),0,0)}),vN=new te(1e4)
function SN(e,t,i=!1){if("string"!=typeof e||"string"!=typeof t)return null
let n=vN.get(e)
n||(n=new RegExp(pe(e),"i"),vN.set(e,n))
let s=n.exec(t)
return s?[{start:s.index,end:s.index+s[0].length}]:i?wN(e,t):bN(e,t)}function yN(){const e=[],t=[0]
for(let e=1;e<=100;e++)t.push(-e)
for(let i=0;i<=100;i++){let n=t.slice(0)
n[0]=-i,e.push(n)}return e}const xN=yN(),LN=yN(),NN=yN(),EN=!1
function kN(e,t,i,n,s){function r(e,t,i=" "){for(;e.length<t;)e=i+e
return e}let o=` |   |${n.split("").map(e=>r(e,3)).join("|")}\n`
for(let n=0;n<=i;n++)o+=0===n?" |":`${t[n-1]}|`,o+=e[n].slice(0,s+1).map(e=>r(e.toString(),3)).join("|")+"\n"
return o}function IN(e,t){if(t<0||t>=e.length)return!1
switch(e.charCodeAt(t)){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:return!0
default:return!1}}function MN(e,t){if(t<0||t>=e.length)return!1
switch(e.charCodeAt(t)){case 32:case 9:return!0
default:return!1}}function DN(e,t,i){const n=e.length>100?100:e.length,s=t.length>100?100:t.length
let r=0
for(void 0===i&&(i=n);r<i&&MN(e,r);)r+=1
if(r===n)return[-100,[]]
if(n>s)return
const o=e.toLowerCase(),a=t.toLowerCase()
let l=r,h=0
for(;l<n&&h<s;)o[l]===a[h]&&(l+=1),h+=1
if(l===n){for(l=r+1;l<=n;l++)for(h=1;h<=s;h++){let i=-1,n=a[h-1]
o[l-1]===n&&(i=h===l-r?e[l-1]===t[h-1]?7:5:n!==t[h-1]?e[l-1]===t[h-1]?7:5:IN(a,h-2)?5:1),LN[l][h]=i
let s=xN[l-1][h-1]+(i>1?1:i),d=xN[l-1][h]+-1,u=xN[l][h-1]+-1
u>=d?u>s?(xN[l][h]=u,NN[l][h]=4):u===s?(xN[l][h]=u,NN[l][h]=6):(xN[l][h]=s,NN[l][h]=2):d>s?(xN[l][h]=d,NN[l][h]=1):d===s?(xN[l][h]=d,NN[l][h]=3):(xN[l][h]=s,NN[l][h]=2)}if(EN&&(console.log(kN(xN,e,n,t,s)),console.log(kN(NN,e,n,t,s)),console.log(kN(LN,e,n,t,s))),ON=0,RN=-100,AN=r,function e(t,i,n,s,r){if(ON>=10||n<-25)return
let o=0
for(;t>AN&&i>0;){let a=LN[t][i],l=NN[t][i]
if(4===l)i-=1,r?n-=5:s.isEmpty()||(n-=1),r=!1,o=0
else{if(!(2&l))return
if(4&l&&e(t,i-1,s.isEmpty()?n:n-1,s.slice(),r),n+=a,t-=1,i-=1,s.unshift(i),r=!0,1===a){if(o+=1,t===AN)return}else n+=1+o*(a-1),o=0}}n-=i>=3?9:3*i
ON+=1
n>RN&&(RN=n,TN=s)}(n,s,0,new PN,!1),0!==ON)return[RN,TN.toArray()]}}let TN,ON=0,RN=0,AN=0
class PN{isEmpty(){return!this._data&&(!this._parent||this._parent.isEmpty())}unshift(e){this._data?this._data.unshift(e):this._data=[e]}slice(){const e=new PN
return e._parent=this,e._parentLen=this._data?this._data.length:0,e}toArray(){if(!this._data)return this._parent.toArray()
const e=[]
let t=this
for(;t;)t._parent&&t._parent._data&&e.push(t._parent._data.slice(t._parent._data.length-t._parentLen)),t=t._parent
return Array.prototype.concat.apply(this._data,e)}}class FN{constructor(e,t,i,n){this._snippetCompareFn=FN._compareCompletionItems,this._items=e,this._column=t,this._lineContext=i,"top"===n?this._snippetCompareFn=FN._compareCompletionItemsSnippetsUp:"bottom"===n&&(this._snippetCompareFn=FN._compareCompletionItemsSnippetsDown)}dispose(){const e=new Set
for(const{container:i}of this._items)e.has(i)||(e.add(i),"function"==typeof(t=i).dispose&&0===t.dispose.length&&i.dispose())
var t}get lineContext(){return this._lineContext}set lineContext(e){this._lineContext.leadingLineContent===e.leadingLineContent&&this._lineContext.characterCountDelta===e.characterCountDelta||(this._lineContext=e,this._filteredItems=void 0)}get items(){return this._ensureCachedState(),this._filteredItems}get incomplete(){return this._ensureCachedState(),this._isIncomplete}resolveIncompleteInfo(){const e=[],t=[]
for(const i of this._items)i.container.incomplete?e.indexOf(i.support)<0&&e.push(i.support):t.push(i)
return{incomplete:e,complete:t}}get stats(){return this._ensureCachedState(),this._stats}_ensureCachedState(){this._filteredItems||this._createCachedState()}_createCachedState(){this._filteredItems=[],this._isIncomplete=!1,this._stats={suggestionCount:0,snippetCount:0,textCount:0}
const{leadingLineContent:e,characterCountDelta:t}=this._lineContext
let i=""
for(let n=0;n<this._items.length;n++){const s=this._items[n],{suggestion:r,container:o}=s
this._isIncomplete=this._isIncomplete||o.incomplete
const a=r.overwriteBefore+t-(s.position.column-this._column)
if(i.length!==a&&(i=0===a?"":e.slice(-a)),0===a)s.score=-100
else if("string"==typeof r.filterText){let e=DN(i,r.filterText,r.overwriteBefore)
if(!e)continue
s.score=e[0],s.matches=[],(e=DN(i,r.label,r.overwriteBefore))&&(s.matches=e[1])}else{let e=DN(i,r.label,r.overwriteBefore)
if(!e)continue
s.score=e[0],s.matches=e[1]}switch(s.idx=n,this._filteredItems.push(s),this._stats.suggestionCount++,r.type){case"snippet":this._stats.snippetCount++
break
case"text":this._stats.textCount++}}this._filteredItems.sort(this._snippetCompareFn)}static _compareCompletionItems(e,t){return e.score>t.score?-1:e.score<t.score?1:e.idx<t.idx?-1:e.idx>t.idx?1:0}static _compareCompletionItemsSnippetsDown(e,t){if(e.suggestion.type!==t.suggestion.type){if("snippet"===e.suggestion.type)return 1
if("snippet"===t.suggestion.type)return-1}return FN._compareCompletionItems(e,t)}static _compareCompletionItemsSnippetsUp(e,t){if(e.suggestion.type!==t.suggestion.type){if("snippet"===e.suggestion.type)return-1
if("snippet"===t.suggestion.type)return 1}return FN._compareCompletionItems(e,t)}}class WN{static shouldAutoTrigger(e){const t=e.getModel()
if(!t)return!1
const i=e.getPosition()
t.tokenizeIfCheap(i.lineNumber)
const n=t.getWordAtPosition(i)
return!!n&&(n.endColumn===i.column&&!!isNaN(Number(n.word)))}static isInEditableRange(e){const t=e.getModel(),i=e.getPosition()
if(t.hasEditableRange()&&!t.getEditableRange().containsPosition(i))return!1
return!0}constructor(e,t,i){this.leadingLineContent=e.getLineContent(t.lineNumber).substr(0,t.column-1),this.leadingWord=e.getWordUntilPosition(t),this.lineNumber=t.lineNumber,this.column=t.column,this.auto=i}}function VN(e,t,i){let n=null,s=null
if("function"==typeof i.value?(n="value",s=i.value):"function"==typeof i.get&&(n="get",s=i.get),!s)throw new Error("not supported")
const r=`$memoize$${t}`
i[n]=function(...e){return this.hasOwnProperty(r)||Object.defineProperty(this,r,{configurable:!1,enumerable:!1,writable:!1,value:s.apply(this,e)}),this[r]}}function BN(e,t){if(e.start>=t.end||t.start>=e.end)return null
const i=Math.max(e.start,t.start),n=Math.min(e.end,t.end)
return n-i<=0?null:{start:i,end:n}}function HN(e){return e.end-e.start<=0}function zN(e,t){const i=[],n={start:e.start,end:Math.min(t.start,e.end)},s={start:Math.max(t.end,e.start),end:e.end}
return HN(n)||i.push(n),HN(s)||i.push(s),i}function UN(e,t){for(let i=e.start;i<e.end;i++)t(i)}function KN(e,t){const i=[]
for(let n of t){if(e.start>=n.range.end)continue
if(e.end<n.range.start)break
const t=BN(e,n.range)
t&&i.push({range:t,size:n.size})}return i}class $N{constructor(){this.groups=[],this._size=0}splice(e,t,...i){const n=i.length-t,s=KN({start:0,end:e},this.groups),r=KN({start:e+t,end:Number.POSITIVE_INFINITY},this.groups).map(e=>({range:function({start:e,end:t},i){return{start:e+i,end:t+i}}(e.range,n),size:e.size})),o=i.map((t,i)=>({range:{start:e+i,end:e+i+1},size:t.size}))
this.groups=function(...e){return function(e){const t=[]
let i=null
for(let n of e){const e=n.range.start,s=n.range.end,r=n.size
i&&r===i.size?i.range.end=s:(i={range:{start:e,end:s},size:r},t.push(i))}return t}(e.reduce((e,t)=>e.concat(t),[]))}(s,o,r),this._size=this.groups.reduce((e,t)=>e+t.size*(t.range.end-t.range.start),0)}get count(){const e=this.groups.length
return e?this.groups[e-1].range.end:0}get size(){return this._size}indexAt(e){if(e<0)return-1
let t=0,i=0
for(let n of this.groups){const s=n.range.end-n.range.start,r=i+s*n.size
if(e<r)return t+Math.floor((e-i)/n.size)
t+=s,i=r}return t}indexAfter(e){return Math.min(this.indexAt(e)+1,this.count)}positionAt(e){if(e<0)return-1
let t=0,i=0
for(let n of this.groups){const s=n.range.end-n.range.start,r=i+s
if(e<r)return t+(e-i)*n.size
t+=s*n.size,i=r}return-1}dispose(){this.groups=null}}class qN{constructor(e){this.renderers=e,this.cache=Object.create(null)}alloc(e){let t=this.getTemplateCache(e).pop()
if(!t){const i=Al(".monaco-list-row")
t={domNode:i,templateId:e,templateData:this.renderers[e].renderTemplate(i)}}return t}release(e){e&&this.releaseRow(e)}releaseRow(e){const{domNode:t,templateId:i}=e
Qa(t,"scrolling"),function(e){try{e.parentElement.removeChild(e)}catch(e){}}(t),this.getTemplateCache(i).push(e)}getTemplateCache(e){return this.cache[e]||(this.cache[e]=[])}garbageCollect(){this.cache&&Object.keys(this.cache).forEach(e=>{this.cache[e].forEach(t=>{this.renderers[e].disposeTemplate(t.templateData),t.domNode=null,t.templateData=null}),delete this.cache[e]})}dispose(){this.garbageCollect(),this.cache=null,this.renderers=null}}const GN=["click","dblclick","mouseup","mousedown","mouseover","mousemove","mouseout","contextmenu","touchstart"],jN={useShadows:!0}
class YN{constructor(e,t,i,n=jN){var s
this.delegate=t,this.items=[],this.itemId=0,this.rangeMap=new $N,this.renderers=(s=(e=>e.templateId),i.reduce((e,t)=>Bn(e,{[s(t)]:t}),Object.create(null))),this.cache=new qN(this.renderers),this.lastRenderTop=0,this.lastRenderHeight=0,this._domNode=document.createElement("div"),this._domNode.className="monaco-list",this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",this.gesture=new vm(this.rowsContainer),this.scrollableElement=new Tf(this.rowsContainer,{alwaysConsumeMouseWheel:!0,horizontal:hi.Hidden,vertical:hi.Auto,useShadows:function(e,t,i=null){const n=t(e)
return void 0===n?i:n}(n,e=>e.useShadows,jN.useShadows)}),this._domNode.appendChild(this.scrollableElement.getDomNode()),e.appendChild(this._domNode),this.disposables=[this.rangeMap,this.gesture,this.scrollableElement],this.scrollableElement.onScroll(this.onScroll,this,this.disposables),Dx(this.rowsContainer,gm.Change)(this.onTouchChange,this,this.disposables),this.layout()}get domNode(){return this._domNode}splice(e,t,i=[]){UN(this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),e=>this.removeItemFromDOM(this.items[e]))
const n=i.map(e=>({id:String(this.itemId++),element:e,size:this.delegate.getHeight(e),templateId:this.delegate.getTemplateId(e),row:null}))
this.rangeMap.splice(e,t,...n)
const s=this.items.splice(e,t,...n)
UN(this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),e=>this.insertItemInDOM(this.items[e],e))
const r=this.getContentHeight()
return this.rowsContainer.style.height=`${r}px`,this.scrollableElement.setScrollDimensions({scrollHeight:r}),s.map(e=>e.element)}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}element(e){return this.items[e].element}domElement(e){const t=this.items[e].row
return t&&t.domNode}elementHeight(e){return this.items[e].size}elementTop(e){return this.rangeMap.positionAt(e)}indexAt(e){return this.rangeMap.indexAt(e)}indexAfter(e){return this.rangeMap.indexAfter(e)}layout(e){this.scrollableElement.setScrollDimensions({height:e||vl(this._domNode)})}render(e,t){const i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),n=this.getRenderRange(e,t),s=zN(n,i),r=zN(i,n)
if(s.forEach(e=>UN(e,e=>this.insertItemInDOM(this.items[e],e))),r.forEach(e=>UN(e,e=>this.removeItemFromDOM(this.items[e]))),function(){if(Ea)return!1
if(0!==wa())return!1
if(Ta){const e=Sa()
if(Math.floor(e)!==e)return!1}return!0}()&&!E){const t=`translate3d(0px, -${e}px, 0px)`
this.rowsContainer.style.transform=t,this.rowsContainer.style.webkitTransform=t}else this.rowsContainer.style.top=`-${e}px`
this.lastRenderTop=e,this.lastRenderHeight=t}insertItemInDOM(e,t){e.row||(e.row=this.cache.alloc(e.templateId)),e.row.domNode.parentElement||this.rowsContainer.appendChild(e.row.domNode)
const i=this.renderers[e.templateId]
e.row.domNode.style.top=`${this.elementTop(t)}px`,e.row.domNode.style.height=`${e.size}px`,e.row.domNode.setAttribute("data-index",`${t}`),i.renderElement(e.element,t,e.row.templateData)}removeItemFromDOM(e){this.cache.release(e.row),e.row=null}getContentHeight(){return this.rangeMap.size}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(e){this.scrollableElement.setScrollPosition({scrollTop:e})}get scrollTop(){return this.getScrollTop()}set scrollTop(e){this.setScrollTop(e)}addListener(e,t,i){const n=t
let s=this.domNode
return GN.indexOf(e)>-1?t=(e=>this.fireScopedEvent(e,n,this.getItemIndexFromMouseEvent(e))):e===gm.Tap&&(s=this.rowsContainer,t=(e=>this.fireScopedEvent(e,n,this.getItemIndexFromGestureEvent(e)))),il(s,e,t,i)}fireScopedEvent(e,t,i){if(i<0)return
t(Bn(e,{element:this.items[i].element,index:i}))}onScroll(e){this.render(e.scrollTop,e.height)}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}getItemIndexFromMouseEvent(e){return this.getItemIndexFromEventTarget(e.target)}getItemIndexFromGestureEvent(e){return this.getItemIndexFromEventTarget(e.initialTarget)}getItemIndexFromEventTarget(e){for(;e instanceof HTMLElement&&e!==this.rowsContainer;){const t=e,i=t.getAttribute("data-index")
if(i){const e=Number(i)
if(!isNaN(e))return e}e=t.parentElement}return-1}getRenderRange(e,t){return{start:this.rangeMap.indexAt(e),end:this.rangeMap.indexAfter(e+t-1)}}dispose(){this.items=null,this._domNode&&this._domNode.parentElement&&(this._domNode.parentNode.removeChild(this._domNode),this._domNode=null),this.disposables=ei(this.disposables)}}class ZN{constructor(e){this.spliceables=e}splice(e,t,i){this.spliceables.forEach(n=>n.splice(e,t,i))}}class XN{constructor(e){this.trait=e,this.rendered=[]}get templateId(){return`template:${this.trait.trait}`}renderTemplate(e){return{container:e,elementDisposable:Qt}}renderElement(e,t,i){i.elementDisposable.dispose()
const n={index:t,templateData:i}
this.rendered.push(n),i.elementDisposable=ii(function(e){const t=this
let i,n=!1
return function(){return n?i:(n=!0,i=e.apply(t,arguments))}}(()=>this.rendered.splice(this.rendered.indexOf(n),1))),this.trait.renderIndex(t,i.container)}renderIndexes(e){this.rendered.filter(({index:t})=>e.indexOf(t)>-1).forEach(({index:e,templateData:t})=>this.trait.renderIndex(e,t.container))}splice(e,t){this.rendered.filter(({index:i})=>i>=e&&i<e+t).forEach(({templateData:e})=>e.elementDisposable.dispose())}disposeTemplate(e){e.elementDisposable.dispose()}}class JN{constructor(e){this._trait=e,this._onChange=new ci,this.indexes=[]}get onChange(){return this._onChange.event}get trait(){return this._trait}get renderer(){return new XN(this)}splice(e,t,i){const n=i.length-t,s=e+t,r=[...this.indexes.filter(t=>t<e),...i.reduce((t,i,n)=>i?[...t,n+e]:t,[]),...this.indexes.filter(e=>e>=s).map(e=>e+n)]
this.renderer.splice(e,t),this.set(r)}renderIndex(e,t){el(t,this._trait,this.contains(e))}set(e){const t=this.indexes
this.indexes=e
const i=hE(t,e)
return this.renderer.renderIndexes(i),this._onChange.fire({indexes:e}),t}get(){return this.indexes}contains(e){return this.indexes.some(t=>t===e)}dispose(){this.indexes=null,this._onChange=ei(this._onChange)}}Nn([VN],JN.prototype,"renderer",null)
class QN extends JN{constructor(e){super("focused"),this.getDomId=e}renderIndex(e,t){super.renderIndex(e,t),t.setAttribute("role","treeitem"),t.setAttribute("id",this.getDomId(e))}}class eE{constructor(){this.length=0}get templateId(){return"aria"}splice(e,t,i){this.length+=i.length-t}renderTemplate(e){return e}renderElement(e,t,i){i.setAttribute("aria-setsize",`${this.length}`),i.setAttribute("aria-posinset",`${t+1}`)}disposeTemplate(e){}}class tE{constructor(e,t,i){this.trait=e,this.view=t,this.getId=i}splice(e,t,i){if(!this.getId)return this.trait.splice(e,t,i.map(e=>!1))
const n=this.trait.get().map(e=>this.getId(this.view.element(e))),s=i.map(e=>n.indexOf(this.getId(e))>-1)
this.trait.splice(e,t,s)}}class iE{constructor(e,t){this.list=e,this.view=t,this.disposables=[]
const i=_i(Dx(t.domNode,"keydown")).map(e=>new Wa(e))
i.filter(e=>3===e.keyCode).on(this.onEnter,this,this.disposables),i.filter(e=>16===e.keyCode).on(this.onUpArrow,this,this.disposables),i.filter(e=>18===e.keyCode).on(this.onDownArrow,this,this.disposables),i.filter(e=>11===e.keyCode).on(this.onPageUpArrow,this,this.disposables),i.filter(e=>12===e.keyCode).on(this.onPageDownArrow,this,this.disposables),i.filter(e=>(k?e.metaKey:e.ctrlKey)&&31===e.keyCode).on(this.onCtrlA,this,this.disposables),i.filter(e=>9===e.keyCode).on(this.onEscape,this,this.disposables)}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus()),this.list.open(this.list.getFocus())}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(),this.list.reveal(this.list.getFocus()[0]),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(),this.list.reveal(this.list.getFocus()[0]),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(),this.list.reveal(this.list.getFocus()[0]),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(),this.list.reveal(this.list.getFocus()[0]),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(Pn(this.list.length)),this.view.domNode.focus()}onEscape(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection([]),this.view.domNode.focus()}dispose(){this.disposables=ei(this.disposables)}}function nE(e){return k?e.metaKey:e.ctrlKey}function sE(e){return e.shiftKey}function rE(e){return nE(e)||sE(e)}class oE{constructor(e,t,i={}){this.list=e,this.view=t,this.options=i,this.disposables=[],this.disposables.push(t.addListener("mousedown",e=>this.onMouseDown(e))),this.disposables.push(t.addListener("click",e=>this.onPointer(e))),this.disposables.push(t.addListener("dblclick",e=>this.onDoubleClick(e))),this.disposables.push(t.addListener("touchstart",e=>this.onMouseDown(e))),this.disposables.push(t.addListener(gm.Tap,e=>this.onPointer(e)))}get onContextMenu(){return function(...e){return(t,i=null,n)=>ti(e.map(e=>e(e=>t.call(i,e),null,n)))}(_i(Dx(this.view.domNode,"keydown")).map(e=>new Wa(e)).filter(e=>this.list.getFocus().length>0).filter(e=>58===e.keyCode||e.shiftKey&&68===e.keyCode).map(e=>{const t=this.list.getFocus()[0]
return{index:t,element:this.view.element(t),anchor:this.view.domElement(t)}}).filter(({anchor:e})=>!!e).event,_i(function(e){let t
const i=new ci({onFirstListenerAdd:()=>t=e(e=>i.fire(e)),onLastListenerRemove:()=>t.dispose()})
return i.event}(e=>this.view.addListener("contextmenu",e))).map(({element:e,index:t,clientX:i,clientY:n})=>({element:e,index:t,anchor:{x:i+1,y:n}})).event)}onMouseDown(e){this.view.domNode.focus()
let t=this.list.getFocus()[0]
if(t=void 0===t?this.list.getSelection()[0]:t,sE(e))return this.changeSelection(e,t)
const i=e.index
if(this.list.setFocus([i]),rE(e))return this.changeSelection(e,t)
this.options.selectOnMouseDown&&(this.list.setSelection([i]),this.list.open([i]))}onPointer(e){if(!rE(e)&&!this.options.selectOnMouseDown){const e=this.list.getFocus()
this.list.setSelection(e),this.list.open(e)}}onDoubleClick(e){if(rE(e))return
const t=this.list.getFocus()
this.list.setSelection(t),this.list.pin(t)}changeSelection(e,t){const i=e.index
if(sE(e)&&void 0!==t){const e=Pn(Math.min(t,i),Math.max(t,i)+1),n=this.list.getSelection(),s=function(e,t){const i=e.indexOf(t)
if(-1===i)return[]
const n=[]
let s=i-1
for(;s>=0&&e[s]===t-(i-s);)n.push(e[s--])
n.reverse(),s=i
for(;s<e.length&&e[s]===t+(s-i);)n.push(e[s++])
return n}(hE(n,[t]),t)
if(0===s.length)return
const r=hE(e,function(e,t){const i=[]
let n=0,s=0
for(;n<e.length||s<t.length;)if(n>=e.length)i.push(t[s++])
else if(s>=t.length)i.push(e[n++])
else{if(e[n]===t[s]){n++,s++
continue}e[n]<t[s]?i.push(e[n++]):s++}return i}(n,s))
this.list.setSelection(r)}else if(nE(e)){const e=this.list.getSelection(),t=e.filter(e=>e!==i)
e.length===t.length?this.list.setSelection([...t,i]):this.list.setSelection(t)}}dispose(){this.disposables=ei(this.disposables)}}Nn([VN],oE.prototype,"onContextMenu",null)
const aE={listFocusBackground:Td.fromHex("#073655"),listActiveSelectionBackground:Td.fromHex("#0E639C"),listActiveSelectionForeground:Td.fromHex("#FFFFFF"),listFocusAndSelectionBackground:Td.fromHex("#094771"),listFocusAndSelectionForeground:Td.fromHex("#FFFFFF"),listInactiveSelectionBackground:Td.fromHex("#3F3F46"),listHoverBackground:Td.fromHex("#2A2D2E"),listDropBackground:Td.fromHex("#383B3D")},lE={keyboardSupport:!0,mouseSupport:!0}
function hE(e,t){const i=[]
let n=0,s=0
for(;n<e.length||s<t.length;)if(n>=e.length)i.push(t[s++])
else if(s>=t.length)i.push(e[n++])
else{if(e[n]===t[s]){i.push(e[n]),n++,s++
continue}e[n]<t[s]?i.push(e[n++]):i.push(t[s++])}return i}const dE=(e,t)=>e-t
class uE{constructor(e,t){this._templateId=e,this.renderers=t}get templateId(){return this._templateId}renderTemplate(e){return this.renderers.map(t=>t.renderTemplate(e))}renderElement(e,t,i){this.renderers.forEach((n,s)=>n.renderElement(e,t,i[s]))}disposeTemplate(e){this.renderers.forEach((t,i)=>t.disposeTemplate(e[i]))}}class cE{constructor(e,t,i,n=lE){this.idPrefix=`list_id_${++cE.InstanceCount}`,this._onContextMenu=ui.None,this._onOpen=new ci,this._onPin=new ci,this._onDispose=new ci
const s=new eE
if(this.focus=new QN(e=>this.getElementDomId(e)),this.selection=new JN("selected"),this.eventBufferer=new mi,Vn(n,aE,!1),i=i.map(e=>new uE(e.templateId,[s,this.focus.renderer,this.selection.renderer,e])),this.view=new YN(e,t,i,n),this.view.domNode.setAttribute("role","tree"),Ja(this.view.domNode,this.idPrefix),this.view.domNode.tabIndex=0,this.styleElement=xl(this.view.domNode),this.spliceable=new ZN([s,new tE(this.focus,this.view,n.identityProvider),new tE(this.selection,this.view,n.identityProvider),this.view]),this.disposables=[this.focus,this.selection,this.view,this._onDispose],this.onDOMFocus=pi(Dx(this.view.domNode,"focus",!0),()=>null),this.onDOMBlur=pi(Dx(this.view.domNode,"blur",!0),()=>null),"boolean"!=typeof n.keyboardSupport||n.keyboardSupport){const e=new iE(this,this.view)
this.disposables.push(e)}if("boolean"!=typeof n.mouseSupport||n.mouseSupport){const e=new oE(this,this.view,n)
this.disposables.push(e),this._onContextMenu=e.onContextMenu}this.onFocusChange(this._onFocusChange,this,this.disposables),this.onSelectionChange(this._onSelectionChange,this,this.disposables),n.ariaLabel&&this.view.domNode.setAttribute("aria-label",n.ariaLabel),this.style(n)}get onFocusChange(){return pi(this.eventBufferer.wrapEvent(this.focus.onChange),e=>this.toListEvent(e))}get onSelectionChange(){return pi(this.eventBufferer.wrapEvent(this.selection.onChange),e=>this.toListEvent(e))}get onContextMenu(){return this._onContextMenu}get onOpen(){return pi(this._onOpen.event,e=>this.toListEvent({indexes:e}))}get onPin(){return pi(this._onPin.event,e=>this.toListEvent({indexes:e}))}get onDispose(){return this._onDispose.event}splice(e,t,i=[]){this.eventBufferer.bufferEvents(()=>this.spliceable.splice(e,t,i))}get length(){return this.view.length}get contentHeight(){return this.view.getContentHeight()}get scrollTop(){return this.view.getScrollTop()}set scrollTop(e){this.view.setScrollTop(e)}domFocus(){this.view.domNode.focus()}layout(e){this.view.layout(e)}setSelection(e){e=e.sort(dE),this.selection.set(e)}selectNext(e=1,t=!1){if(0===this.length)return
const i=this.selection.get()
let n=i.length>0?i[0]+e:0
this.setSelection(t?[n%this.length]:[Math.min(n,this.length-1)])}selectPrevious(e=1,t=!1){if(0===this.length)return
const i=this.selection.get()
let n=i.length>0?i[0]-e:0
t&&n<0&&(n=this.length+n%this.length),this.setSelection([Math.max(n,0)])}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(e=>this.view.element(e))}setFocus(e){e=e.sort(dE),this.focus.set(e)}focusNext(e=1,t=!1){if(0===this.length)return
const i=this.focus.get()
let n=i.length>0?i[0]+e:0
this.setFocus(t?[n%this.length]:[Math.min(n,this.length-1)])}focusPrevious(e=1,t=!1){if(0===this.length)return
const i=this.focus.get()
let n=i.length>0?i[0]-e:0
t&&n<0&&(n=(this.length+n%this.length)%this.length),this.setFocus([Math.max(n,0)])}focusNextPage(){let e=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight)
e=0===e?0:e-1
const t=this.view.element(e)
if(this.getFocusedElements()[0]!==t)this.setFocus([e])
else{const t=this.view.getScrollTop()
this.view.setScrollTop(t+this.view.renderHeight-this.view.elementHeight(e)),this.view.getScrollTop()!==t&&setTimeout(()=>this.focusNextPage(),0)}}focusPreviousPage(){let e
const t=this.view.getScrollTop()
e=0===t?this.view.indexAt(t):this.view.indexAfter(t-1)
const i=this.view.element(e)
if(this.getFocusedElements()[0]!==i)this.setFocus([e])
else{const e=t
this.view.setScrollTop(t-this.view.renderHeight),this.view.getScrollTop()!==e&&setTimeout(()=>this.focusPreviousPage(),0)}}focusLast(){0!==this.length&&this.setFocus([this.length-1])}focusFirst(){0!==this.length&&this.setFocus([0])}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(e=>this.view.element(e))}reveal(e,t){const i=this.view.getScrollTop(),n=this.view.elementTop(e),s=this.view.elementHeight(e)
if(at(t)){t=(t=t<0?0:t)>1?1:t
const e=s-this.view.renderHeight
this.view.setScrollTop(e*t+n)}else{const e=n+s,t=i+this.view.renderHeight
n<i?this.view.setScrollTop(n):e>=t&&this.view.setScrollTop(e-this.view.renderHeight)}}getElementDomId(e){return`${this.idPrefix}_${e}`}isDOMFocused(){return this.view.domNode===document.activeElement}getHTMLElement(){return this.view.domNode}open(e){this._onOpen.fire(e)}pin(e){this._onPin.fire(e)}style(e){const t=[]
e.listFocusBackground&&t.push(`.monaco-list.${this.idPrefix}:focus .monaco-list-row.focused { background-color: ${e.listFocusBackground}; }`),e.listFocusForeground&&t.push(`.monaco-list.${this.idPrefix}:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&(t.push(`.monaco-list.${this.idPrefix}:focus .monaco-list-row.selected { background-color: ${e.listActiveSelectionBackground}; }`),t.push(`.monaco-list.${this.idPrefix}:focus .monaco-list-row.selected:hover { background-color: ${e.listActiveSelectionBackground}; }`)),e.listActiveSelectionForeground&&t.push(`.monaco-list.${this.idPrefix}:focus .monaco-list-row.selected { color: ${e.listActiveSelectionForeground}; }`),e.listFocusAndSelectionBackground&&t.push(`.monaco-list.${this.idPrefix}:focus .monaco-list-row.selected.focused { background-color: ${e.listFocusAndSelectionBackground}; }`),e.listFocusAndSelectionForeground&&t.push(`.monaco-list.${this.idPrefix}:focus .monaco-list-row.selected.focused { color: ${e.listFocusAndSelectionForeground}; }`),e.listInactiveFocusBackground&&(t.push(`.monaco-list.${this.idPrefix} .monaco-list-row.focused { background-color:  ${e.listInactiveFocusBackground}; }`),t.push(`.monaco-list.${this.idPrefix} .monaco-list-row.focused:hover { background-color:  ${e.listInactiveFocusBackground}; }`)),e.listInactiveSelectionBackground&&(t.push(`.monaco-list.${this.idPrefix} .monaco-list-row.selected { background-color:  ${e.listInactiveSelectionBackground}; }`),t.push(`.monaco-list.${this.idPrefix} .monaco-list-row.selected:hover { background-color:  ${e.listInactiveSelectionBackground}; }`)),e.listInactiveSelectionForeground&&t.push(`.monaco-list.${this.idPrefix} .monaco-list-row.selected { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&t.push(`.monaco-list.${this.idPrefix} .monaco-list-row:hover { background-color:  ${e.listHoverBackground}; }`),e.listHoverForeground&&t.push(`.monaco-list.${this.idPrefix} .monaco-list-row:hover { color:  ${e.listHoverForeground}; }`),e.listSelectionOutline&&t.push(`.monaco-list.${this.idPrefix} .monaco-list-row.selected { outline: 1px dotted ${e.listSelectionOutline}; outline-offset: -1px; }`),e.listFocusOutline&&t.push(`.monaco-list.${this.idPrefix}:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),e.listInactiveFocusOutline&&t.push(`.monaco-list.${this.idPrefix} .monaco-list-row.focused { outline: 1px dotted ${e.listInactiveFocusOutline}; outline-offset: -1px; }`),e.listHoverOutline&&t.push(`.monaco-list.${this.idPrefix} .monaco-list-row:hover { outline: 1px dashed ${e.listHoverOutline}; outline-offset: -1px; }`),this.styleElement.innerHTML=t.join("\n")}toListEvent({indexes:e}){return{indexes:e,elements:e.map(e=>this.view.element(e))}}_onFocusChange(){const e=this.focus.get()
e.length>0?this.view.domNode.setAttribute("aria-activedescendant",this.getElementDomId(e[0])):this.view.domNode.removeAttribute("aria-activedescendant"),this.view.domNode.setAttribute("role","tree"),el(this.view.domNode,"element-focused",e.length>0)}_onSelectionChange(){const e=this.selection.get()
el(this.view.domNode,"selection-none",0===e.length),el(this.view.domNode,"selection-single",1===e.length),el(this.view.domNode,"selection-multiple",e.length>1)}dispose(){this._onDispose.fire(),this.disposables=ei(this.disposables)}}cE.InstanceCount=0,Nn([VN],cE.prototype,"onFocusChange",null),Nn([VN],cE.prototype,"onSelectionChange",null),Nn([VN],cE.prototype,"onOpen",null),Nn([VN],cE.prototype,"onPin",null)
const gE=hc("editorSuggestWidget.background",{dark:tg,light:tg,hc:tg},Jt("editorSuggestWidgetBackground","Background color of the suggest widget.")),mE=hc("editorSuggestWidget.border",{dark:ig,light:ig,hc:ig},Jt("editorSuggestWidgetBorder","Border color of the suggest widget.")),pE=hc("editorSuggestWidget.foreground",{dark:eg,light:eg,hc:eg},Jt("editorSuggestWidgetForeground","Foreground color of the suggest widget.")),fE=hc("editorSuggestWidget.selectedBackground",{dark:Ic,light:Ic,hc:Ic},Jt("editorSuggestWidgetSelectedBackground","Background color of the selected entry in the suggest widget.")),_E=hc("editorSuggestWidget.highlightForeground",{dark:Bc,light:Bc,hc:Bc},Jt("editorSuggestWidgetHighlightForeground","Color of the match highlights in the suggest widget.")),CE=/^(#([\da-f]{3}){1,2}|(rgb|hsl)a\(\s*(\d{1,3}%?\s*,\s*){3}(1|0?\.\d+)\)|(rgb|hsl)\(\s*\d{1,3}%?(\s*,\s*\d{1,3}%?){2}\s*\))$/i
function bE(e){return e&&e.match(CE)?e:null}function wE(e){if(!e)return!1
const t=e.suggestion
return!!t.documentation||t.detail&&t.detail!==t.label}let vE=class e{constructor(e,t,i,n,s,r,o,a){this.editor=e,this.telemetryService=t,this.allowEditorOverflow=!0,this.ignoreFocusEvents=!1,this.onDidSelectEmitter=new ci,this.onDidFocusEmitter=new ci,this.onDidHideEmitter=new ci,this.onDidShowEmitter=new ci,this.onDidSelect=this.onDidSelectEmitter.event,this.onDidFocus=this.onDidFocusEmitter.event,this.onDidHide=this.onDidHideEmitter.event,this.onDidShow=this.onDidShowEmitter.event,this.maxWidgetWidth=660,this.listWidth=330,this.storageServiceAvailable=!0,this.expandSuggestionDocs=!1
const l=r.lookupKeybinding("editor.action.triggerSuggest"),h=l?` (${l.getLabel()})`:"",d=new $y(e,o,a)
this.isAuto=!1,this.focusedItem=null,this.storageService=s,void 0===this.expandDocsSettingFromStorage()&&(this.storageService.store("expandSuggestionDocs",!1,Uu.GLOBAL),void 0===this.expandDocsSettingFromStorage()&&(this.storageServiceAvailable=!1)),this.element=Al(".editor-widget.suggest-widget"),this.editor.getConfiguration().contribInfo.iconsInSuggestions||Ja(this.element,"no-icons"),this.messageElement=Tl(this.element,Al(".message")),this.listElement=Tl(this.element,Al(".tree")),this.details=new class{constructor(e,t,i,n,s){this.widget=t,this.editor=i,this.markdownRenderer=n,this.triggerKeybindingLabel=s,this.borderWidth=1,this.disposables=[],this.el=Tl(e,Al(".details")),this.disposables.push(ii(()=>e.removeChild(this.el))),this.body=Al(".body"),this.scrollbar=new Rf(this.body,{}),Tl(this.el,this.scrollbar.getDomNode()),this.disposables.push(this.scrollbar),this.header=Tl(this.body,Al(".header")),this.close=Tl(this.header,Al("span.close")),this.close.title=Jt("readLess","Read less...{0}",s),this.type=Tl(this.header,Al("p.type")),this.docs=Tl(this.body,Al("p.docs")),this.ariaLabel=null,this.configureFont(),_i(this.editor.onDidChangeConfiguration.bind(this.editor)).filter(e=>e.fontInfo).on(this.configureFont,this,this.disposables)}get element(){return this.el}render(e){if(!e||!wE(e))return this.type.textContent="",this.docs.textContent="",Ja(this.el,"no-docs"),void(this.ariaLabel=null)
Qa(this.el,"no-docs"),"string"==typeof e.suggestion.documentation?(Qa(this.docs,"markdown-docs"),this.docs.textContent=e.suggestion.documentation):(Ja(this.docs,"markdown-docs"),this.docs.innerHTML="",this.docs.appendChild(this.markdownRenderer.render(e.suggestion.documentation))),e.suggestion.detail?(this.type.innerText=e.suggestion.detail,Pl(this.type)):(this.type.innerText="",Fl(this.type)),this.el.style.height=this.header.offsetHeight+this.docs.offsetHeight+2*this.borderWidth+"px",this.close.onmousedown=(e=>{e.preventDefault(),e.stopPropagation()}),this.close.onclick=(e=>{e.preventDefault(),e.stopPropagation(),this.widget.toggleDetails()}),this.body.scrollTop=0,this.scrollbar.scanDomNode(),this.ariaLabel=he("{0}\n{1}\n{2}",e.suggestion.label||"",e.suggestion.detail||"",e.suggestion.documentation||"")}getAriaLabel(){return this.ariaLabel}scrollDown(e=8){this.body.scrollTop+=e}scrollUp(e=8){this.body.scrollTop-=e}scrollTop(){this.body.scrollTop=0}scrollBottom(){this.body.scrollTop=this.body.scrollHeight}pageDown(){this.scrollDown(80)}pageUp(){this.scrollUp(80)}setBorderWidth(e){this.borderWidth=e}configureFont(){const e=this.editor.getConfiguration(),t=e.fontInfo.fontFamily,i=`${e.contribInfo.suggestFontSize||e.fontInfo.fontSize}px`,n=`${e.contribInfo.suggestLineHeight||e.fontInfo.lineHeight}px`
this.el.style.fontSize=i,this.type.style.fontFamily=t,this.close.style.height=n,this.close.style.width=n}dispose(){this.disposables=ei(this.disposables)}}(this.element,this,this.editor,d,h)
let u=new class{constructor(e,t,i){this.widget=e,this.editor=t,this.triggerKeybindingLabel=i}get templateId(){return"suggestion"}renderTemplate(e){const t=Object.create(null)
t.disposables=[],t.root=e,t.icon=Tl(e,Al(".icon")),t.colorspan=Tl(t.icon,Al("span.colorspan"))
const i=Tl(Tl(e,Al(".contents")),Al(".main"))
t.highlightedLabel=new zw(i),t.disposables.push(t.highlightedLabel),t.typeLabel=Tl(i,Al("span.type-label")),t.readMore=Tl(i,Al("span.readMore")),t.readMore.title=Jt("readMore","Read More...{0}",this.triggerKeybindingLabel)
const n=()=>{const e=this.editor.getConfiguration(),n=e.fontInfo.fontFamily,s=`${e.contribInfo.suggestFontSize||e.fontInfo.fontSize}px`,r=`${e.contribInfo.suggestLineHeight||e.fontInfo.lineHeight}px`
t.root.style.fontSize=s,i.style.fontFamily=n,i.style.lineHeight=r,t.icon.style.height=r,t.icon.style.width=r,t.readMore.style.height=r,t.readMore.style.width=r}
return n(),_i(this.editor.onDidChangeConfiguration.bind(this.editor)).filter(e=>e.fontInfo||e.contribInfo).on(n,null,t.disposables),t}renderElement(e,t,i){const n=i,s=e.suggestion
if(wE(e)?n.root.setAttribute("aria-label",Jt("suggestionWithDetailsAriaLabel","{0}, suggestion, has details",s.label)):n.root.setAttribute("aria-label",Jt("suggestionAriaLabel","{0}, suggestion",s.label)),n.icon.className="icon "+s.type,n.colorspan.style.backgroundColor="","color"===s.type){let e=bE(s.label)||"string"==typeof s.documentation&&bE(s.documentation)
e&&(n.icon.className="icon customcolor",n.colorspan.style.backgroundColor=e)}n.highlightedLabel.set(s.label,function(e){let t,i=[]
if(!e)return i
for(const n of e)t&&t.end===n?t.end+=1:(t={start:n,end:n+1},i.push(t))
return i}(e.matches)),n.typeLabel.textContent=(s.detail||"").replace(/\n.*$/m,""),wE(e)?(Pl(n.readMore),n.readMore.onmousedown=(e=>{e.stopPropagation(),e.preventDefault()}),n.readMore.onclick=(e=>{e.stopPropagation(),e.preventDefault(),this.widget.toggleDetails()})):(Fl(n.readMore),n.readMore.onmousedown=null,n.readMore.onclick=null)}disposeTemplate(e){e.highlightedLabel.dispose(),e.disposables=ei(e.disposables)}}(this,this.editor,h)
this.list=new cE(this.listElement,this,[u],{useShadows:!1,selectOnMouseDown:!0}),this.toDispose=[iS(this.list,n,{listInactiveFocusBackground:fE,listInactiveFocusOutline:mc}),n.onThemeChange(e=>this.onThemeChange(e)),e.onDidBlurEditorText(()=>this.onEditorBlur()),e.onDidLayoutChange(()=>this.onEditorLayoutChange()),this.list.onSelectionChange(e=>this.onListSelection(e)),this.list.onFocusChange(e=>this.onListFocus(e)),this.editor.onDidChangeCursorSelection(()=>this.onCursorSelectionChanged())],this.suggestWidgetVisible=qL.Visible.bindTo(i),this.suggestWidgetMultipleSuggestions=qL.MultipleSuggestions.bindTo(i),this.suggestionSupportsAutoAccept=qL.AcceptOnKey.bindTo(i),this.editor.addContentWidget(this),this.setState(0),this.onThemeChange(n.getTheme())}onCursorSelectionChanged(){0!==this.state&&this.editor.layoutContentWidget(this)}onEditorBlur(){}onEditorLayoutChange(){3!==this.state&&5!==this.state||!this.expandDocsSettingFromStorage()||this.expandSideOrBelow()}onListSelection(e){if(!e.elements.length)return
const t=e.elements[0]
this.onDidSelectEmitter.fire(t),vC(Jt("suggestionAriaAccepted","{0}, accepted",t.suggestion.label)),this.editor.focus()}_getSuggestionAriaAlertLabel(e){return wE(e)?Jt("ariaCurrentSuggestionWithDetails","{0}, suggestion, has details",e.suggestion.label):Jt("ariaCurrentSuggestion","{0}, suggestion",e.suggestion.label)}_ariaAlert(e){this._lastAriaAlertLabel!==e&&(this._lastAriaAlertLabel=e,this._lastAriaAlertLabel&&vC(this._lastAriaAlertLabel))}onThemeChange(e){let t=e.getColor(gE)
t&&(this.listElement.style.backgroundColor=t.toString(),this.details.element.style.backgroundColor=t.toString(),this.messageElement.style.backgroundColor=t.toString())
let i=e.getColor(mE)
i&&(this.listElement.style.borderColor=i.toString(),this.details.element.style.borderColor=i.toString(),this.messageElement.style.borderColor=i.toString(),this.detailsBorderColor=i.toString())
let n=e.getColor(cc)
n&&(this.detailsFocusBorderColor=n.toString()),this.details.setBorderWidth("hc"===e.type?2:1)}onListFocus(e){if(this.ignoreFocusEvents)return
if(!e.elements.length)return this.currentSuggestionDetails&&(this.currentSuggestionDetails.cancel(),this.currentSuggestionDetails=null,this.focusedItem=null),void this._ariaAlert(null)
const t=e.elements[0]
if(this._ariaAlert(this._getSuggestionAriaAlertLabel(t)),t===this.focusedItem)return
this.currentSuggestionDetails&&(this.currentSuggestionDetails.cancel(),this.currentSuggestionDetails=null)
const i=e.indexes[0]
this.suggestionSupportsAutoAccept.set(!t.suggestion.noAutoAccept)
const n=this.focusedItem,s=this.focusedItemIndex
this.focusedItemIndex=i,this.focusedItem=t,n&&(this.ignoreFocusEvents=!0,this.list.splice(s,1,[n]),this.ignoreFocusEvents=!1),this.updateListHeight(),this.list.reveal(i),this.currentSuggestionDetails=t.resolve().then(()=>{this.ignoreFocusEvents=!0,this.list.splice(i,1,[t]),this.ignoreFocusEvents=!1,this.list.setFocus([i]),this.list.reveal(i),this.expandDocsSettingFromStorage()?this.showDetails():Qa(this.element,"docs-side")}).then(null,e=>!Lt(e)&&St(e)).then(()=>this.currentSuggestionDetails=null),this.onDidFocusEmitter.fire(t)}setState(t){if(!this.element)return
const i=this.state!==t
switch(this.state=t,el(this.element,"frozen",4===t),t){case 0:Fl(this.messageElement,this.details.element),Pl(this.listElement),this.hide(),i&&this.list.splice(0,this.list.length)
break
case 1:this.messageElement.textContent=e.LOADING_MESSAGE,Fl(this.listElement,this.details.element),Pl(this.messageElement),Qa(this.element,"docs-side"),this.show()
break
case 2:this.messageElement.textContent=e.NO_SUGGESTIONS_MESSAGE,Fl(this.listElement,this.details.element),Pl(this.messageElement),Qa(this.element,"docs-side"),this.show()
break
case 3:Fl(this.messageElement),Pl(this.listElement),this.expandDocsSettingFromStorage()&&wE(this.list.getFocusedElements()[0])?(Pl(this.details.element),this.expandSideOrBelow()):Fl(this.details.element),this.show()
break
case 4:Fl(this.messageElement,this.details.element),Pl(this.listElement),this.show()
break
case 5:Fl(this.messageElement),Pl(this.details.element,this.listElement),this.show(),this._ariaAlert(this.details.getAriaLabel())}i&&this.editor.layoutContentWidget(this)}showTriggered(e){0===this.state&&(this.isAuto=!!e,this.isAuto||(this.loadingTimeout=setTimeout(()=>{this.loadingTimeout=null,this.setState(1)},50)))}showSuggestions(e,t,i){if(this.loadingTimeout&&(clearTimeout(this.loadingTimeout),this.loadingTimeout=null),this.completionModel=e,t&&2!==this.state&&0!==this.state)return void this.setState(4)
let n=this.completionModel.items.length
const s=0===n
if(this.suggestWidgetMultipleSuggestions.set(n>1),s)i?this.setState(0):this.setState(2),this.completionModel=null
else{const{stats:e}=this.completionModel
e.wasAutomaticallyTriggered=!!i,this.telemetryService.publicLog("suggestWidget",Object.assign({},e,this.editor.getTelemetryData())),this.focusedItem=null,this.focusedItemIndex=null,this.list.splice(0,this.list.length,this.completionModel.items),this.list.setFocus([0]),this.list.reveal(0,0),t?this.setState(4):this.setState(3),this.detailsBorderColor&&(this.details.element.style.borderColor=this.detailsBorderColor)}}selectNextPage(){switch(this.state){case 0:return!1
case 5:return this.details.pageDown(),!0
case 1:return!this.isAuto
default:return this.list.focusNextPage(),!0}}selectNext(){switch(this.state){case 0:return!1
case 1:return!this.isAuto
default:return this.list.focusNext(1,!0),!0}}selectLast(){switch(this.state){case 0:return!1
case 5:return this.details.scrollBottom(),!0
case 1:return!this.isAuto
default:return this.list.focusLast(),!0}}selectPreviousPage(){switch(this.state){case 0:return!1
case 5:return this.details.pageUp(),!0
case 1:return!this.isAuto
default:return this.list.focusPreviousPage(),!0}}selectPrevious(){switch(this.state){case 0:return!1
case 1:return!this.isAuto
default:return this.list.focusPrevious(1,!0),!1}}selectFirst(){switch(this.state){case 0:return!1
case 5:return this.details.scrollTop(),!0
case 1:return!this.isAuto
default:return this.list.focusFirst(),!0}}getFocusedItem(){if(0!==this.state&&2!==this.state&&1!==this.state)return this.list.getFocusedElements()[0]}toggleDetailsFocus(){5===this.state?(this.setState(3),this.detailsBorderColor&&(this.details.element.style.borderColor=this.detailsBorderColor)):3===this.state&&this.expandDocsSettingFromStorage()&&(this.setState(5),this.detailsFocusBorderColor&&(this.details.element.style.borderColor=this.detailsFocusBorderColor)),this.telemetryService.publicLog("suggestWidget:toggleDetailsFocus",this.editor.getTelemetryData())}toggleDetails(){if(wE(this.list.getFocusedElements()[0]))if(this.expandDocsSettingFromStorage())this.updateExpandDocsSetting(!1),Fl(this.details.element),Qa(this.element,"docs-side"),Qa(this.element,"docs-below"),this.editor.layoutContentWidget(this),this.telemetryService.publicLog("suggestWidget:collapseDetails",this.editor.getTelemetryData())
else{if(3!==this.state&&5!==this.state)return
this.updateExpandDocsSetting(!0),this.showDetails(),this.telemetryService.publicLog("suggestWidget:expandDetails",this.editor.getTelemetryData())}}showDetails(){this.expandSideOrBelow(),Pl(this.details.element),this.details.render(this.list.getFocusedElements()[0]),this.details.element.style.maxHeight=this.maxWidgetHeight+"px",this.listElement.style.marginTop="0px",this.editor.layoutContentWidget(this),this.adjustDocsPosition(),this.editor.focus(),this._ariaAlert(this.details.getAriaLabel())}show(){this.updateListHeight(),this.suggestWidgetVisible.set(!0),this.showTimeout=bt.timeout(100).then(()=>{Ja(this.element,"visible"),this.onDidShowEmitter.fire(this)})}hide(){this.suggestWidgetVisible.reset(),this.suggestWidgetMultipleSuggestions.reset(),Qa(this.element,"visible")}hideWidget(){clearTimeout(this.loadingTimeout),this.setState(0),this.onDidHideEmitter.fire(this)}getPosition(){return 0===this.state?null:{position:this.editor.getPosition(),preference:[pm.BELOW,pm.ABOVE]}}getDomNode(){return this.element}getId(){return e.ID}updateListHeight(){let e=0
if(2===this.state||1===this.state)e=this.unfocusedHeight
else{const t=this.list.contentHeight/this.unfocusedHeight
e=Math.min(t,12)*this.unfocusedHeight}return this.element.style.lineHeight=`${this.unfocusedHeight}px`,this.listElement.style.height=`${e}px`,this.list.layout(e),this.editor.layoutContentWidget(this),e}adjustDocsPosition(){const e=this.editor.getConfiguration().fontInfo.lineHeight,t=this.editor.getScrolledVisiblePosition(this.editor.getPosition()),i=Cl(this.editor.getDomNode()),n=i.left+t.left,s=i.top+t.top+t.height,r=Cl(this.element),o=r.left,a=r.top
o<n-this.listWidth?Ja(this.element,"list-right"):Qa(this.element,"list-right"),Xa(this.element,"docs-side")&&s-e>a&&this.details.element.offsetHeight>this.listElement.offsetHeight&&(this.listElement.style.marginTop=`${this.details.element.offsetHeight-this.listElement.offsetHeight}px`)}expandSideOrBelow(){let e=this.element.style.maxWidth.match(/(\d+)px/)
!e||Number(e[1])<this.maxWidgetWidth?(Ja(this.element,"docs-below"),Qa(this.element,"docs-side")):(Ja(this.element,"docs-side"),Qa(this.element,"docs-below"))}get maxWidgetHeight(){return 12*this.unfocusedHeight}get unfocusedHeight(){const e=this.editor.getConfiguration()
return e.contribInfo.suggestLineHeight||e.fontInfo.lineHeight}getHeight(e){return this.unfocusedHeight}getTemplateId(e){return"suggestion"}expandDocsSettingFromStorage(){return this.storageServiceAvailable?this.storageService.getBoolean("expandSuggestionDocs",Uu.GLOBAL):this.expandSuggestionDocs}updateExpandDocsSetting(e){this.storageServiceAvailable?this.storageService.store("expandSuggestionDocs",e,Uu.GLOBAL):this.expandSuggestionDocs=e}dispose(){this.state=null,this.suggestionSupportsAutoAccept=null,this.currentSuggestionDetails=null,this.focusedItem=null,this.element=null,this.messageElement=null,this.listElement=null,this.details.dispose(),this.details=null,this.list.dispose(),this.list=null,this.toDispose=ei(this.toDispose),this.loadingTimeout&&(clearTimeout(this.loadingTimeout),this.loadingTimeout=null),this.editorBlurTimeout&&(this.editorBlurTimeout.cancel(),this.editorBlurTimeout=null),this.showTimeout&&(this.showTimeout.cancel(),this.showTimeout=null)}}
vE.ID="editor.widget.suggestWidget",vE.LOADING_MESSAGE=Jt("suggestWidget.loading","Loading..."),vE.NO_SUGGESTIONS_MESSAGE=Jt("suggestWidget.noSuggestions","No suggestions."),vE=Nn([En(1,cw),En(2,Lo),En(3,Mg),En(4,zu),En(5,tC),En(6,XS),En(7,vy)],vE),Wg((e,t)=>{let i=e.getColor(_E)
i&&t.addRule(`.monaco-editor .suggest-widget:not(.frozen) .monaco-list .monaco-list-row .monaco-highlighted-label .highlight { color: ${i}; }`)
let n=e.getColor(pE)
n&&t.addRule(`.monaco-editor .suggest-widget { color: ${n}; }`)
const s=e.getColor(pc)
s&&t.addRule(`.monaco-editor .suggest-widget a { color: ${s}; }`)
let r=e.getColor(fc)
r&&t.addRule(`.monaco-editor .suggest-widget code { background-color: ${r}; }`)})
let SE=NE=class{constructor(t,i,n,s,r){this._editor=t,this._commandService=i,this._telemetryService=n,this._toDispose=[],this._model=new class{constructor(t){this._toDispose=[],this._triggerRefilter=new fa,this._onDidCancel=new ci,this._onDidTrigger=new ci,this._onDidSuggest=new ci,this.onDidCancel=this._onDidCancel.event,this.onDidTrigger=this._onDidTrigger.event,this.onDidSuggest=this._onDidSuggest.event,this._editor=t,this._state=0,this._triggerAutoSuggestPromise=null,this._requestPromise=null,this._completionModel=null,this._context=null,this._currentPosition=this._editor.getPosition()||new e(1,1),this._toDispose.push(this._editor.onDidChangeModel(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.push(this._editor.onDidChangeModelLanguage(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.push(this._editor.onDidChangeConfiguration(()=>{this._updateTriggerCharacters(),this._updateQuickSuggest()})),this._toDispose.push(Os.onDidChange(()=>{this._updateTriggerCharacters(),this._updateActiveSuggestSession()})),this._toDispose.push(this._editor.onDidChangeCursorSelection(e=>{this._onCursorChange(e)})),this._toDispose.push(this._editor.onDidChangeModelContent(e=>{this._refilterCompletionItems()})),this._updateTriggerCharacters(),this._updateQuickSuggest()}dispose(){ei([this._onDidCancel,this._onDidSuggest,this._onDidTrigger,this._triggerCharacterListener,this._triggerRefilter]),this._toDispose=ei(this._toDispose),ei(this._completionModel),this.cancel()}_updateQuickSuggest(){this._quickSuggestDelay=this._editor.getConfiguration().contribInfo.quickSuggestionsDelay,(isNaN(this._quickSuggestDelay)||!this._quickSuggestDelay&&0!==this._quickSuggestDelay||this._quickSuggestDelay<0)&&(this._quickSuggestDelay=10)}_updateTriggerCharacters(){if(ei(this._triggerCharacterListener),this._editor.getConfiguration().readOnly||!this._editor.getModel()||!this._editor.getConfiguration().contribInfo.suggestOnTriggerCharacters)return
const e=Object.create(null)
for(const t of Os.all(this._editor.getModel()))if(!Tn(t.triggerCharacters))for(const i of t.triggerCharacters){const n=e[i]
n?n.push(t):e[i]=[t]}this._triggerCharacterListener=this._editor.onDidType(t=>{const i=t.charAt(t.length-1),n=e[i]
if(n){const e=[]
if(this._completionModel)for(const t of this._completionModel.items)n.indexOf(t.support)<0&&e.push(t)
this.trigger({auto:!0,triggerCharacter:i},Boolean(this._completionModel),n,e)}})}get state(){return this._state}cancel(e=!1){this._triggerAutoSuggestPromise&&(this._triggerAutoSuggestPromise.cancel(),this._triggerAutoSuggestPromise=null),this._requestPromise&&(this._requestPromise.cancel(),this._requestPromise=null),this._state=0,ei(this._completionModel),this._completionModel=null,this._context=null,this._onDidCancel.fire({retrigger:e})}_updateActiveSuggestSession(){0!==this._state&&(Os.has(this._editor.getModel())?this.trigger({auto:2===this._state},!0):this.cancel())}_onCursorChange(e){const t=this._currentPosition
if(this._currentPosition=this._editor.getPosition(),e.selection.isEmpty()&&"keyboard"===e.source&&e.reason===br.NotSet)Os.has(this._editor.getModel())&&this._editor.getModel()&&0===this._state&&!1!==this._editor.getConfiguration().contribInfo.quickSuggestions&&t.isBefore(this._currentPosition)&&(this.cancel(),WN.shouldAutoTrigger(this._editor)&&(this._triggerAutoSuggestPromise=bt.timeout(this._quickSuggestDelay),this._triggerAutoSuggestPromise.then(()=>{const e=this._editor.getModel(),t=this._editor.getPosition()
if(!e)return
const{quickSuggestions:i}=this._editor.getConfiguration().contribInfo
if(!1!==i){if(!0===i);else{e.tokenizeIfCheap(t.lineNumber)
const{tokenType:n}=e.getLineTokens(t.lineNumber).findTokenAtOffset(Math.max(t.column-1-1,0))
if(!(i.other&&0===n||i.comments&&1===n||i.strings&&2===n))return}this._triggerAutoSuggestPromise=null,this.trigger({auto:!0})}})))
else{if(0===this._state)return
this.cancel()}}_refilterCompletionItems(){if(0===this._state)return
const e=this._editor.getModel()
e&&this._triggerRefilter.cancelAndSet(()=>{const t=this._editor.getPosition(),i=new WN(e,t,2===this._state)
this._onNewContext(i)},25)}trigger(e,t=!1,i,n){const s=this._editor.getModel()
if(!s)return
const r=e.auto,o=new WN(s,this._editor.getPosition(),r)
WN.isInEditableRange(this._editor)&&(this.cancel(t),this._state=r?2:1,this._onDidTrigger.fire({auto:r}),this._context=o,this._requestPromise=YL(s,this._editor.getPosition(),this._editor.getConfiguration().contribInfo.snippetSuggestions,i,{triggerCharacter:e.triggerCharacter,triggerKind:e.triggerCharacter?xs.TriggerCharacter:xs.Invoke}).then(e=>{if(this._requestPromise=null,0===this._state)return
const t=this._editor.getModel()
if(!t)return
if(!Tn(n)){const t=tN(this._editor.getConfiguration().contribInfo.snippetSuggestions)
e=e.concat(n).sort(t)}const i=new WN(t,this._editor.getPosition(),r)
ei(this._completionModel),this._completionModel=new FN(e,this._context.column,{leadingLineContent:i.leadingLineContent,characterCountDelta:this._context?i.column-this._context.column:0},this._editor.getConfiguration().contribInfo.snippetSuggestions),this._onNewContext(i)}).then(null,St))}_onNewContext(e){if(this._context)if(e.lineNumber===this._context.lineNumber){if(e.column<this._context.column)e.leadingWord.word?this.trigger({auto:this._context.auto},!0):this.cancel()
else if(this._completionModel)if(e.column>this._context.column&&this._completionModel.incomplete&&0!==e.leadingWord.word.length){const{complete:e,incomplete:t}=this._completionModel.resolveIncompleteInfo()
this.trigger({auto:2===this._state},!0,t,e)}else{let t=this._completionModel.lineContext,i=!1
if(this._completionModel.lineContext={leadingLineContent:e.leadingLineContent,characterCountDelta:e.column-this._context.column},0===this._completionModel.items.length){if(WN.shouldAutoTrigger(this._editor)&&this._context.leadingWord.endColumn<e.leadingWord.startColumn)return void this.trigger({auto:this._context.auto},!0)
if(this._context.auto)return void this.cancel()
if(this._completionModel.lineContext=t,(i=this._completionModel.items.length>0)&&0===e.leadingWord.word.length)return void this.cancel()}this._onDidSuggest.fire({completionModel:this._completionModel,auto:this._context.auto,isFrozen:i})}}else this.cancel()}}(this._editor),this._toDispose.push(this._model.onDidTrigger(e=>this._widget.showTriggered(e.auto))),this._toDispose.push(this._model.onDidSuggest(e=>this._widget.showSuggestions(e.completionModel,e.isFrozen,e.auto))),this._toDispose.push(this._model.onDidCancel(e=>!e.retrigger&&this._widget.hideWidget()))
let o=qL.AcceptSuggestionsOnEnter.bindTo(s),a=()=>{const{acceptSuggestionOnEnter:e}=this._editor.getConfiguration().contribInfo
o.set("on"===e||"smart"===e)}
this._toDispose.push(this._editor.onDidChangeConfiguration(e=>a())),a(),this._widget=r.createInstance(vE,this._editor),this._toDispose.push(this._widget.onDidSelect(this._onDidSelectItem,this))
const l=new class{constructor(e,t,i){this._disposables=[],this._activeAcceptCharacters=new Set,this._disposables.push(t.onDidShow(()=>this._onItem(t.getFocusedItem()))),this._disposables.push(t.onDidFocus(this._onItem,this)),this._disposables.push(t.onDidHide(this.reset,this)),this._disposables.push(e.onWillType(t=>{if(this._activeItem){const n=t[t.length-1]
this._activeAcceptCharacters.has(n)&&e.getConfiguration().contribInfo.acceptSuggestionOnCommitCharacter&&i(this._activeItem)}}))}_onItem(e){if(e&&!Tn(e.suggestion.commitCharacters)){this._activeItem=e,this._activeAcceptCharacters.clear()
for(const t of e.suggestion.commitCharacters)t.length>0&&this._activeAcceptCharacters.add(t[0])}else this.reset()}reset(){this._activeItem=void 0}dispose(){ei(this._disposables)}}(t,this._widget,e=>this._onDidSelectItem(e))
this._toDispose.push(l,this._model.onDidSuggest(e=>{0===e.completionModel.items.length&&l.reset()}))
let h=qL.MakesTextEdit.bindTo(s)
this._toDispose.push(this._widget.onDidFocus(e=>{const t=this._editor.getPosition(),i=e.position.column-e.suggestion.overwriteBefore,n=t.column
let s=!0
"smart"!==this._editor.getConfiguration().contribInfo.acceptSuggestionOnEnter||2!==this._model.state||e.suggestion.command||e.suggestion.additionalTextEdits||"textmate"===e.suggestion.snippetType||n-i!==e.suggestion.insertText.length||(s=this._editor.getModel().getValueInRange({startLineNumber:t.lineNumber,startColumn:i,endLineNumber:t.lineNumber,endColumn:n})!==e.suggestion.insertText)
h.set(s)})),this._toDispose.push({dispose(){h.reset()}})}static get(e){return e.getContribution(NE.ID)}getId(){return NE.ID}dispose(){this._toDispose=ei(this._toDispose),this._widget&&(this._widget.dispose(),this._widget=null),this._model&&(this._model.dispose(),this._model=null)}_onDidSelectItem(e){if(!e)return void this._model.cancel()
const{suggestion:i,position:n}=e,s=this._editor.getPosition().column-n.column
Array.isArray(i.additionalTextEdits)&&(this._editor.pushUndoStop(),this._editor.executeEdits("suggestController.additionalTextEdits",i.additionalTextEdits.map(e=>C_.replace(t.lift(e.range),e.text))),this._editor.pushUndoStop())
let{insertText:r}=i
"textmate"!==i.snippetType&&(r=zL.escape(r)),nN.get(this._editor).insert(r,i.overwriteBefore+s,i.overwriteAfter),i.command?i.command.id===yE.id?this._model.trigger({auto:2===this._model.state},!0):(this._commandService.executeCommand(i.command.id,...i.command.arguments).done(void 0,St),this._model.cancel()):this._model.cancel(),this._alertCompletionItem(e),this._telemetryService.publicLog("suggestSnippetInsert",Object.assign({},this._editor.getTelemetryData(),{suggestionType:i.type}))}_alertCompletionItem({suggestion:e}){vC(Jt("arai.alert.snippet","Accepting '{0}' did insert the following text: {1}",e.label,e.insertText))}triggerSuggest(e){this._model.trigger({auto:!1},!1,e),this._editor.revealLine(this._editor.getPosition().lineNumber,0),this._editor.focus()}acceptSelectedSuggestion(){if(this._widget){const e=this._widget.getFocusedItem()
this._onDidSelectItem(e)}}cancelSuggestWidget(){this._widget&&(this._model.cancel(),this._widget.hideWidget())}selectNextSuggestion(){this._widget&&this._widget.selectNext()}selectNextPageSuggestion(){this._widget&&this._widget.selectNextPage()}selectLastSuggestion(){this._widget&&this._widget.selectLast()}selectPrevSuggestion(){this._widget&&this._widget.selectPrevious()}selectPrevPageSuggestion(){this._widget&&this._widget.selectPreviousPage()}selectFirstSuggestion(){this._widget&&this._widget.selectFirst()}toggleSuggestionDetails(){this._widget&&this._widget.toggleDetails()}toggleSuggestionFocus(){this._widget&&this._widget.toggleDetailsFocus()}}
SE.ID="editor.contrib.suggestController",SE=NE=Nn([iC,En(1,Dr),En(2,cw),En(3,Lo),En(4,Er)],SE)
let yE=EE=class extends To{constructor(){super({id:EE.id,label:Jt("suggest.trigger.label","Trigger Suggest"),alias:"Trigger Suggest",precondition:_o.and(Vo.writable,Vo.hasCompletionItemProvider),kbOpts:{kbExpr:Vo.textFocus,primary:2058,mac:{primary:266}}})}run(e,t){const i=SE.get(t)
i&&i.triggerSuggest()}}
yE.id="editor.action.triggerSuggest",yE=EE=Nn([Oo],yE)
const xE=No.commandWeight(90),LE=Do.bindToContribution(SE.get)
var NE,EE
No.registerEditorCommand(new LE({id:"acceptSelectedSuggestion",precondition:qL.Visible,handler:e=>e.acceptSelectedSuggestion(),kbOpts:{weight:xE,kbExpr:Vo.textFocus,primary:2}})),No.registerEditorCommand(new LE({id:"acceptSelectedSuggestionOnEnter",precondition:qL.Visible,handler:e=>e.acceptSelectedSuggestion(),kbOpts:{weight:xE,kbExpr:_o.and(Vo.textFocus,qL.AcceptSuggestionsOnEnter,qL.MakesTextEdit),primary:3}})),No.registerEditorCommand(new LE({id:"hideSuggestWidget",precondition:qL.Visible,handler:e=>e.cancelSuggestWidget(),kbOpts:{weight:xE,kbExpr:Vo.textFocus,primary:9,secondary:[1033]}})),No.registerEditorCommand(new LE({id:"selectNextSuggestion",precondition:_o.and(qL.Visible,qL.MultipleSuggestions),handler:e=>e.selectNextSuggestion(),kbOpts:{weight:xE,kbExpr:Vo.textFocus,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}})),No.registerEditorCommand(new LE({id:"selectNextPageSuggestion",precondition:_o.and(qL.Visible,qL.MultipleSuggestions),handler:e=>e.selectNextPageSuggestion(),kbOpts:{weight:xE,kbExpr:Vo.textFocus,primary:12,secondary:[2060]}})),No.registerEditorCommand(new LE({id:"selectLastSuggestion",precondition:_o.and(qL.Visible,qL.MultipleSuggestions),handler:e=>e.selectLastSuggestion()})),No.registerEditorCommand(new LE({id:"selectPrevSuggestion",precondition:_o.and(qL.Visible,qL.MultipleSuggestions),handler:e=>e.selectPrevSuggestion(),kbOpts:{weight:xE,kbExpr:Vo.textFocus,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}})),No.registerEditorCommand(new LE({id:"selectPrevPageSuggestion",precondition:_o.and(qL.Visible,qL.MultipleSuggestions),handler:e=>e.selectPrevPageSuggestion(),kbOpts:{weight:xE,kbExpr:Vo.textFocus,primary:11,secondary:[2059]}})),No.registerEditorCommand(new LE({id:"selectFirstSuggestion",precondition:_o.and(qL.Visible,qL.MultipleSuggestions),handler:e=>e.selectFirstSuggestion()})),No.registerEditorCommand(new LE({id:"toggleSuggestionDetails",precondition:qL.Visible,handler:e=>e.toggleSuggestionDetails(),kbOpts:{weight:xE,kbExpr:Vo.textFocus,primary:2058,mac:{primary:266}}})),No.registerEditorCommand(new LE({id:"toggleSuggestionFocus",precondition:qL.Visible,handler:e=>e.toggleSuggestionFocus(),kbOpts:{weight:xE,kbExpr:Vo.textFocus,primary:2570,mac:{primary:778}}}))
const kE=hc("editor.wordHighlightBackground",{dark:"#575757B8",light:"#57575740",hc:null},Jt("wordHighlight","Background color of a symbol during read-access, like reading a variable.")),IE=hc("editor.wordHighlightStrongBackground",{dark:"#004972B8",light:"#0e639c40",hc:null},Jt("wordHighlightStrong","Background color of a symbol during write-access, like writing to a variable.")),ME=hc("editorOverviewRuler.wordHighlightForeground",{dark:"#A0A0A0",light:"#A0A0A0",hc:"#A0A0A0"},Jt("overviewRulerWordHighlightForeground","Overview ruler marker color for symbol highlights.")),DE=hc("editorOverviewRuler.wordHighlightStrongForeground",{dark:"#C0A0C0",light:"#C0A0C0",hc:"#C0A0C0"},Jt("overviewRulerWordHighlightStrongForeground","Overview ruler marker color for write-access symbol highlights.")),TE=new xo("hasWordHighlights",!1)
function OE(e,t){let i=!1
return pa(Fs.ordered(e).map(n=>()=>{if(!i)return ca(i=>n.provideDocumentHighlights(e,t,i)).then(e=>{if(Array.isArray(e)&&e.length>0)return i=!0,e},e=>{yt(e)})})).then(e=>e[0])}No.registerDefaultLanguageCommand("_executeDocumentHighlights",OE)
class RE{constructor(e,t){this.workerRequestTokenId=0,this.workerRequest=null,this.workerRequestCompleted=!1,this.workerRequestValue=[],this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1,this.editor=e,this._hasWordHighlights=TE.bindTo(t),this._ignorePositionChangeEvent=!1,this.occurrencesHighlight=this.editor.getConfiguration().contribInfo.occurrencesHighlight,this.model=this.editor.getModel(),this.toUnhook=[],this.toUnhook.push(e.onDidChangeCursorPosition(e=>{this._ignorePositionChangeEvent||this.occurrencesHighlight&&this._onPositionChanged(e)})),this.toUnhook.push(e.onDidChangeModel(e=>{this._stopAll(),this.model=this.editor.getModel()})),this.toUnhook.push(e.onDidChangeModelContent(e=>{this._stopAll()})),this.toUnhook.push(e.onDidChangeConfiguration(e=>{let t=this.editor.getConfiguration().contribInfo.occurrencesHighlight
this.occurrencesHighlight!==t&&(this.occurrencesHighlight=t,this._stopAll())})),this._lastWordRange=null,this._decorationIds=[],this.workerRequestTokenId=0,this.workerRequest=null,this.workerRequestCompleted=!1,this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1}hasDecorations(){return this._decorationIds.length>0}restore(){this.occurrencesHighlight&&this._run()}_getSortedHighlights(){return this._decorationIds.map(e=>this.model.getDecorationRange(e)).sort(t.compareRangesUsingStarts)}moveNext(){let e=this._getSortedHighlights(),t=e[(Rn(e,e=>e.containsPosition(this.editor.getPosition()))+1)%e.length]
try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(t.getStartPosition()),this.editor.revealRangeInCenter(t)}finally{this._ignorePositionChangeEvent=!1}}moveBack(){let e=this._getSortedHighlights(),t=e[(Rn(e,e=>e.containsPosition(this.editor.getPosition()))-1+e.length)%e.length]
try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(t.getStartPosition()),this.editor.revealRangeInCenter(t)}finally{this._ignorePositionChangeEvent=!1}}_removeDecorations(){this._decorationIds.length>0&&(this._decorationIds=this.editor.deltaDecorations(this._decorationIds,[]),this._hasWordHighlights.set(!1))}_stopAll(){this._lastWordRange=null,this._removeDecorations(),-1!==this.renderDecorationsTimer&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1),null!==this.workerRequest&&(this.workerRequest.cancel(),this.workerRequest=null),this.workerRequestCompleted||(this.workerRequestTokenId++,this.workerRequestCompleted=!0)}_onPositionChanged(e){this.occurrencesHighlight&&e.reason===br.Explicit?this._run():this._stopAll()}_run(){if(Fs.has(this.model)){var e=this.editor.getSelection()
if(e.startLineNumber===e.endLineNumber){var i=e.startLineNumber,n=e.startColumn,s=e.endColumn,r=this.model.getWordAtPosition({lineNumber:i,column:n})
if(!r||r.startColumn>n||r.endColumn<s)this._stopAll()
else{for(var o=new t(i,r.startColumn,i,r.endColumn),a=this._lastWordRange&&this._lastWordRange.equalsRange(o),l=0,h=this._decorationIds.length;!a&&l<h;l++){var d=this.model.getDecorationRange(this._decorationIds[l])
d&&d.startLineNumber===i&&d.startColumn<=n&&d.endColumn>=s&&(a=!0)}if(this.lastCursorPositionChangeTime=(new Date).getTime(),a)this.workerRequestCompleted&&-1!==this.renderDecorationsTimer&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1,this._beginRenderDecorations())
else{this._stopAll()
var u=++this.workerRequestTokenId
this.workerRequestCompleted=!1,this.workerRequest=OE(this.model,this.editor.getPosition()),this.workerRequest.then(e=>{u===this.workerRequestTokenId&&(this.workerRequestCompleted=!0,this.workerRequestValue=e||[],this._beginRenderDecorations())}).done()}this._lastWordRange=o}}else this._stopAll()}else this._stopAll()}_beginRenderDecorations(){var e=(new Date).getTime(),t=this.lastCursorPositionChangeTime+250
e>=t?(this.renderDecorationsTimer=-1,this.renderDecorations()):this.renderDecorationsTimer=setTimeout(()=>{this.renderDecorations()},t-e)}renderDecorations(){this.renderDecorationsTimer=-1
for(var e=[],t=0,i=this.workerRequestValue.length;t<i;t++){var n=this.workerRequestValue[t]
e.push({range:n.range,options:RE._getDecorationOptions(n.kind)})}this._decorationIds=this.editor.deltaDecorations(this._decorationIds,e),this._hasWordHighlights.set(this.hasDecorations())}static _getDecorationOptions(e){return e===Ns.Write?this._WRITE_OPTIONS:e===Ns.Text?this._TEXT_OPTIONS:this._REGULAR_OPTIONS}dispose(){this._stopAll(),this.toUnhook=ei(this.toUnhook)}}RE._WRITE_OPTIONS=Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,className:"wordHighlightStrong",overviewRuler:{color:Dg(DE),darkColor:Dg(DE),position:i.Center}}),RE._TEXT_OPTIONS=Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,className:"selectionHighlight",overviewRuler:{color:Dg(xg),darkColor:Dg(xg),position:i.Center}}),RE._REGULAR_OPTIONS=Ld.register({stickiness:d.NeverGrowsWhenTypingAtEdges,className:"wordHighlight",overviewRuler:{color:Dg(ME),darkColor:Dg(ME),position:i.Center}})
let AE=FE=class{constructor(e,t){this.wordHighligher=new RE(e,t)}static get(e){return e.getContribution(FE.ID)}getId(){return FE.ID}saveViewState(){return!!this.wordHighligher.hasDecorations()}moveNext(){this.wordHighligher.moveNext()}moveBack(){this.wordHighligher.moveBack()}restoreViewState(e){e&&this.wordHighligher.restore()}dispose(){this.wordHighligher.dispose()}}
AE.ID="editor.contrib.wordHighlighter",AE=FE=Nn([Po,En(1,Lo)],AE),Wg((e,t)=>{let i=e.getColor(og)
i&&(t.addRule(`.monaco-editor .focused .selectionHighlight { background-color: ${i}; }`),t.addRule(`.monaco-editor .selectionHighlight { background-color: ${i.transparent(.5)}; }`))
let n=e.getColor(kE)
n&&t.addRule(`.monaco-editor .wordHighlight { background-color: ${n}; }`)
let s=e.getColor(IE)
s&&t.addRule(`.monaco-editor .wordHighlightStrong { background-color: ${s}; }`)
let r=e.getColor(mc)
r&&(t.addRule(`.monaco-editor .selectionHighlight { border: 1px dotted ${r}; box-sizing: border-box; }`),t.addRule(`.monaco-editor .wordHighlight { border: 1px dashed ${r}; box-sizing: border-box; }`),t.addRule(`.monaco-editor .wordHighlightStrong { border: 1px dashed ${r}; box-sizing: border-box; }`))})
class PE extends To{constructor(e,t){super(t),this._isNext=e}run(e,t){const i=AE.get(t)
i&&(this._isNext?i.moveNext():i.moveBack())}}Oo(class extends PE{constructor(){super(!0,{id:"editor.action.wordHighlight.next",label:Jt("wordHighlight.next.label","Go to Next Symbol Highlight"),alias:"Go to Next Symbol Highlight",precondition:TE,kbOpts:{kbExpr:Vo.textFocus,primary:65}})}})
var FE
Oo(class extends PE{constructor(){super(!1,{id:"editor.action.wordHighlight.prev",label:Jt("wordHighlight.previous.label","Go to Previous Symbol Highlight"),alias:"Go to Previous Symbol Highlight",precondition:TE,kbOpts:{kbExpr:Vo.textFocus,primary:1089}})}})
class WE extends Do{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode,this._wordNavigationType=e.wordNavigationType}runEditorCommand(t,i,n){const s=i.getConfiguration(),r=tn(s.wordSeparators),o=i.getModel(),a=i.getSelections().map(t=>{const i=new e(t.positionLineNumber,t.positionColumn),n=this._move(r,o,i,this._wordNavigationType)
return this._moveTo(t,n,this._inSelectionMode)})
if(i._getCursors().setStates("moveWordCommand",br.NotSet,a.map(e=>fr.fromModelSelection(e))),1===a.length){const t=new e(a[0].positionLineNumber,a[0].positionColumn)
i.revealPosition(t,0)}}_moveTo(e,t,i){return i?new At(e.selectionStartLineNumber,e.selectionStartColumn,t.lineNumber,t.column):new At(t.lineNumber,t.column,t.lineNumber,t.column)}}class VE extends WE{_move(e,t,i,n){return Lr.moveWordLeft(e,t,i,n)}}class BE extends WE{_move(e,t,i,n){return Lr.moveWordRight(e,t,i,n)}}Ro(class extends VE{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartLeft",precondition:null,kbOpts:{kbExpr:Vo.textFocus,primary:2063,mac:{primary:527}}})}})
Ro(class extends VE{constructor(){super({inSelectionMode:!1,wordNavigationType:1,id:"cursorWordEndLeft",precondition:null})}})
Ro(class extends VE{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordLeft",precondition:null})}})
Ro(class extends VE{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartLeftSelect",precondition:null,kbOpts:{kbExpr:Vo.textFocus,primary:3087,mac:{primary:1551}}})}})
Ro(class extends VE{constructor(){super({inSelectionMode:!0,wordNavigationType:1,id:"cursorWordEndLeftSelect",precondition:null})}})
Ro(class extends VE{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordLeftSelect",precondition:null})}})
Ro(class extends BE{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartRight",precondition:null})}})
Ro(class extends BE{constructor(){super({inSelectionMode:!1,wordNavigationType:1,id:"cursorWordEndRight",precondition:null,kbOpts:{kbExpr:Vo.textFocus,primary:2065,mac:{primary:529}}})}})
Ro(class extends BE{constructor(){super({inSelectionMode:!1,wordNavigationType:1,id:"cursorWordRight",precondition:null})}})
Ro(class extends BE{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartRightSelect",precondition:null})}})
Ro(class extends BE{constructor(){super({inSelectionMode:!0,wordNavigationType:1,id:"cursorWordEndRightSelect",precondition:null,kbOpts:{kbExpr:Vo.textFocus,primary:3089,mac:{primary:1553}}})}})
Ro(class extends BE{constructor(){super({inSelectionMode:!0,wordNavigationType:1,id:"cursorWordRightSelect",precondition:null})}})
class HE extends Do{constructor(e){super(e),this._whitespaceHeuristics=e.whitespaceHeuristics,this._wordNavigationType=e.wordNavigationType}runEditorCommand(e,t,i){const n=t.getConfiguration(),s=tn(n.wordSeparators),r=t.getModel(),o=t.getSelections().map(e=>{const t=this._delete(s,r,e,this._whitespaceHeuristics,this._wordNavigationType)
return new Ho(t,"")})
t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}class zE extends HE{_delete(e,i,n,s,r){let o=Lr.deleteWordLeft(e,i,n,s,r)
return o||new t(1,1,1,1)}}class UE extends HE{_delete(e,i,n,s,r){let o=Lr.deleteWordRight(e,i,n,s,r)
if(o)return o
const a=i.getLineCount(),l=i.getLineMaxColumn(a)
return new t(a,l,a,l)}}Ro(class extends zE{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartLeft",precondition:Vo.writable})}})
Ro(class extends zE{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:1,id:"deleteWordEndLeft",precondition:Vo.writable})}})
Ro(class extends zE{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordLeft",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:2049,mac:{primary:513}}})}})
Ro(class extends UE{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartRight",precondition:Vo.writable})}})
Ro(class extends UE{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:1,id:"deleteWordEndRight",precondition:Vo.writable})}})
Ro(class extends UE{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:1,id:"deleteWordRight",precondition:Vo.writable,kbOpts:{kbExpr:Vo.textFocus,primary:2068,mac:{primary:532}}})}})
let KE=qE=class{constructor(e){this.editor=e,this.toDispose=[],Da&&(this.toDispose.push(e.onDidChangeConfiguration(()=>this.update())),this.update())}update(){const e=!!this.widget,t=!this.editor.getConfiguration().readOnly
!e&&t?this.widget=new $E(this.editor):e&&!t&&(this.widget.dispose(),this.widget=null)}getId(){return qE.ID}dispose(){this.toDispose=ei(this.toDispose),this.widget&&(this.widget.dispose(),this.widget=null)}}
KE.ID="editor.contrib.iPadShowKeyboard",KE=qE=Nn([iC],KE)
class $E{constructor(e){this.editor=e,this._domNode=document.createElement("textarea"),this._domNode.className="iPadShowKeyboard",this._toDispose=[],this._toDispose.push(il(this._domNode,"touchstart",e=>{this.editor.focus()})),this._toDispose.push(il(this._domNode,"focus",e=>{this.editor.focus()})),this.editor.addOverlayWidget(this)}dispose(){this.editor.removeOverlayWidget(this),this._toDispose=ei(this._toDispose)}getId(){return $E.ID}getDomNode(){return this._domNode}getPosition(){return{preference:_m.BOTTOM_RIGHT_CORNER}}}var qE
$E.ID="editor.contrib.ShowKeyboardWidget"
class GE{constructor(e,t,i=t){this.modifierLabels=[null],this.modifierLabels[2]=e,this.modifierLabels[1]=t,this.modifierLabels[3]=i}toLabel(e,t,i,n,s){return null===t&&null===n?null:function(e,t,i,n,s){let r=JE(e,t,s)
null!==n&&(r+=" ",r+=JE(i,n,s))
return r}(e,t,i,n,this.modifierLabels[s])}}const jE=new GE({ctrlKey:"⌃",shiftKey:"⇧",altKey:"⌥",metaKey:"⌘",separator:""},{ctrlKey:Jt("ctrlKey","Ctrl"),shiftKey:Jt("shiftKey","Shift"),altKey:Jt("altKey","Alt"),metaKey:Jt("windowsKey","Windows"),separator:"+"}),YE=new GE({ctrlKey:Jt("ctrlKey.long","Control"),shiftKey:Jt("shiftKey.long","Shift"),altKey:Jt("altKey.long","Alt"),metaKey:Jt("cmdKey.long","Command"),separator:"+"},{ctrlKey:Jt("ctrlKey.long","Control"),shiftKey:Jt("shiftKey.long","Shift"),altKey:Jt("altKey.long","Alt"),metaKey:Jt("windowsKey.long","Windows"),separator:"+"}),ZE=new GE({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),XE=new GE({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"})
function JE(e,t,i){if(null===t)return""
let n=[]
return e.ctrlKey&&n.push(i.ctrlKey),e.shiftKey&&n.push(i.shiftKey),e.altKey&&n.push(i.altKey),e.metaKey&&n.push(i.metaKey),n.push(t),n.join(i.separator)}const QE=Al
class ek{constructor(e,t){this.os=t,this.domNode=Tl(e,QE(".monaco-keybinding")),this.didEverRender=!1,e.appendChild(this.domNode)}get element(){return this.domNode}set(e,t){this.didEverRender&&this.keybinding===e&&ek.areSame(this.matches,t)||(this.keybinding=e,this.matches=t,this.render())}render(){if(Ga(this.domNode),this.keybinding){let[e,t]=this.keybinding.getParts()
e&&this.renderPart(this.domNode,e,this.matches?this.matches.firstPart:null),t&&(Tl(this.domNode,QE("span.monaco-keybinding-key-chord-separator",null," ")),this.renderPart(this.domNode,t,this.matches?this.matches.chordPart:null)),this.domNode.title=this.keybinding.getAriaLabel()}this.didEverRender=!0}renderPart(e,t,i){const n=jE.modifierLabels[this.os]
t.ctrlKey&&this.renderKey(e,n.ctrlKey,i&&i.ctrlKey,n.separator),t.shiftKey&&this.renderKey(e,n.shiftKey,i&&i.shiftKey,n.separator),t.altKey&&this.renderKey(e,n.altKey,i&&i.altKey,n.separator),t.metaKey&&this.renderKey(e,n.metaKey,i&&i.metaKey,n.separator)
const s=t.keyLabel
s&&this.renderKey(e,s,i&&i.keyCode,"")}renderKey(e,t,i,n){Tl(e,QE("span.monaco-keybinding-key"+(i?".highlight":""),null,t)),n&&Tl(e,QE("span.monaco-keybinding-key-separator",null,n))}dispose(){this.keybinding=null}static areSame(e,t){return e===t||!e&&!t||!!e&&!!t&&Hn(e.firstPart,t.firstPart)&&Hn(e.chordPart,t.chordPart)}}let tk=0
class ik{constructor(e=[]){this.id=(tk++).toString(),this.labelHighlights=e,this.descriptionHighlights=[]}getId(){return this.id}getLabel(){return null}getLabelOptions(){return null}getAriaLabel(){return this.getLabel()}getDetail(){return null}getIcon(){return null}getDescription(){return null}getKeybinding(){return null}getResource(){return null}isHidden(){return this.hidden}setHidden(e){this.hidden=e}setHighlights(e,t,i){this.labelHighlights=e,this.descriptionHighlights=t,this.detailHighlights=i}getHighlights(){return[this.labelHighlights,this.descriptionHighlights,this.detailHighlights]}run(e,t){return!1}isFile(){return!1}}class nk extends ik{constructor(e,t,i){super(),this.entry=e,this.groupLabel=t,this.withBorder=i}getGroupLabel(){return this.groupLabel}setGroupLabel(e){this.groupLabel=e}showBorder(){return this.withBorder}setShowBorder(e){this.withBorder=e}getLabel(){return this.entry?this.entry.getLabel():super.getLabel()}getLabelOptions(){return this.entry?this.entry.getLabelOptions():super.getLabelOptions()}getAriaLabel(){return this.entry?this.entry.getAriaLabel():super.getAriaLabel()}getDetail(){return this.entry?this.entry.getDetail():super.getDetail()}getResource(){return this.entry?this.entry.getResource():super.getResource()}getIcon(){return this.entry?this.entry.getIcon():super.getIcon()}getDescription(){return this.entry?this.entry.getDescription():super.getDescription()}getEntry(){return this.entry}getHighlights(){return this.entry?this.entry.getHighlights():super.getHighlights()}isHidden(){return this.entry?this.entry.isHidden():super.isHidden()}setHighlights(e,t,i){this.entry?this.entry.setHighlights(e,t,i):super.setHighlights(e,t,i)}setHidden(e){this.entry?this.entry.setHidden(e):super.setHidden(e)}run(e,t){return this.entry?this.entry.run(e,t):super.run(e,t)}}class sk{hasActions(e,t){return!1}getActions(e,t){return bt.as(null)}hasSecondaryActions(e,t){return!1}getSecondaryActions(e,t){return bt.as(null)}getActionItem(e,t,i){return null}}const rk="quickOpenEntry",ok="quickOpenEntryGroup"
class ak{constructor(e=new sk,t=null){this.actionProvider=e,this.actionRunner=t}getHeight(e){return e.getDetail()?44:22}getTemplateId(e){return e instanceof nk?ok:rk}renderTemplate(e,t,i){const n=document.createElement("div")
Ja(n,"sub-content"),t.appendChild(n)
const s=Al(".quick-open-row"),r=Al(".quick-open-row"),o=Al(".quick-open-entry",null,s,r)
n.appendChild(o)
const a=document.createElement("span")
s.appendChild(a)
const l=new Kw(s,{supportHighlights:!0}),h=document.createElement("span")
s.appendChild(h),Ja(h,"quick-open-entry-description")
const d=new zw(h),u=document.createElement("span")
s.appendChild(u),Ja(u,"quick-open-entry-keybinding")
const c=new ek(u,W),g=document.createElement("div")
r.appendChild(g),Ja(g,"quick-open-entry-meta")
const m=new zw(g)
let p
e===ok&&(p=document.createElement("div"),Ja(p,"results-group"),t.appendChild(p)),Ja(t,"actions")
const f=document.createElement("div")
return Ja(f,"primary-action-bar"),t.appendChild(f),{container:t,entry:o,icon:a,label:l,detail:m,description:d,keybinding:c,group:p,actionBar:new Z_(f,{actionRunner:this.actionRunner})}}renderElement(e,t,i,n){const s=i
if(this.actionProvider.hasActions(null,e)?Ja(s.container,"has-actions"):Qa(s.container,"has-actions"),s.actionBar.context=e,this.actionProvider.getActions(null,e).then(e=>{s.actionBar.isEmpty()&&e&&e.length>0?s.actionBar.push(e,{icon:!0,label:!1}):s.actionBar.isEmpty()||e&&0!==e.length||s.actionBar.clear()}),e instanceof nk&&e.getGroupLabel()?Ja(s.container,"has-group-label"):Qa(s.container,"has-group-label"),e instanceof nk){const t=e,s=i
t.showBorder()?(Ja(s.container,"results-group-separator"),s.container.style.borderTopColor=n.pickerGroupBorder.toString()):(Qa(s.container,"results-group-separator"),s.container.style.borderTopColor=null)
const r=t.getGroupLabel()||""
s.group.textContent=r,s.group.style.color=n.pickerGroupForeground.toString()}if(e instanceof ik){const[t,i,n]=e.getHighlights(),r=e.getIcon()?"quick-open-entry-icon "+e.getIcon():""
s.icon.className=r
const o=e.getLabelOptions()||Object.create(null)
o.matches=t||[],s.label.setValue(e.getLabel(),null,o),s.detail.set(e.getDetail(),n),s.description.set(e.getDescription(),i||[]),s.description.element.title=e.getDescription(),s.keybinding.set(e.getKeybinding(),null)}}disposeTemplate(e,t){const i=t
i.actionBar.dispose(),i.actionBar=null,i.container=null,i.entry=null,i.description.dispose(),i.description=null,i.keybinding.dispose(),i.keybinding=null,i.detail.dispose(),i.detail=null,i.group=null,i.icon=null,i.label.dispose(),i.label=null}}class lk{constructor(e=[],t=new sk){this._entries=e,this._dataSource=this,this._renderer=new ak(t),this._filter=this,this._runner=this,this._accessibilityProvider=this}get entries(){return this._entries}get dataSource(){return this._dataSource}get renderer(){return this._renderer}get filter(){return this._filter}get runner(){return this._runner}get accessibilityProvider(){return this._accessibilityProvider}set entries(e){this._entries=e}addEntries(e){st(e)&&(this._entries=this._entries.concat(e))}setEntries(e){st(e)&&(this._entries=e)}getEntries(e){return e?this._entries.filter(e=>!e.isHidden()):this._entries}getId(e){return e.getId()}getLabel(e){return e.getLabel()}getAriaLabel(e){return e.getAriaLabel()?Jt("quickOpenAriaLabelEntry","{0}, picker",e.getAriaLabel()):Jt("quickOpenAriaLabel","picker")}isVisible(e){return!e.isHidden()}run(e,t,i){return e.run(t,i)}}var hk,dk;(dk=hk||(hk={}))[dk.PREVIEW=0]="PREVIEW",dk[dk.OPEN=1]="OPEN",dk[dk.OPEN_IN_BACKGROUND=2]="OPEN_IN_BACKGROUND"
class uk{constructor(e){this.modelProvider=gt(e.getModel)?e:{getModel:()=>e}}getId(e,t){if(!t)return null
const i=this.modelProvider.getModel()
return i===t?"__root__":i.dataSource.getId(t)}hasChildren(e,t){const i=this.modelProvider.getModel()
return i&&i===t&&i.entries.length>0}getChildren(e,t){const i=this.modelProvider.getModel()
return bt.as(i===t?i.entries:[])}getParent(e,t){return bt.as(null)}}class ck{constructor(e){this.modelProvider=e}getAriaLabel(e,t){const i=this.modelProvider.getModel()
return i.accessibilityProvider&&i.accessibilityProvider.getAriaLabel(t)}getPosInSet(e,t){const i=this.modelProvider.getModel()
return String(i.entries.indexOf(t)+1)}getSetSize(){const e=this.modelProvider.getModel()
return String(e.entries.length)}}class gk{constructor(e){this.modelProvider=e}isVisible(e,t){const i=this.modelProvider.getModel()
return!i.filter||i.filter.isVisible(t)}}class mk{constructor(e,t){this.modelProvider=e,this.styles=t}updateStyles(e){this.styles=e}getHeight(e,t){return this.modelProvider.getModel().renderer.getHeight(t)}getTemplateId(e,t){return this.modelProvider.getModel().renderer.getTemplateId(t)}renderTemplate(e,t,i){return this.modelProvider.getModel().renderer.renderTemplate(t,i,this.styles)}renderElement(e,t,i,n){this.modelProvider.getModel().renderer.renderElement(t,i,n,this.styles)}disposeTemplate(e,t,i){this.modelProvider.getModel().renderer.disposeTemplate(t,i)}}const pk="done",fk="active",_k="infinite",Ck="discrete",bk="progress-container",wk="progress-bit",vk={progressBarBackground:Td.fromHex("#0E70C0")}
class Sk{constructor(e,t){this.options=t||Object.create(null),Vn(this.options,vk,!1),this.toUnbind=[],this.workedVal=0,this.progressBarBackground=this.options.progressBarBackground,this.create(e)}create(e){e.div({class:bk},e=>{this.element=e.clone(),e.div({class:wk}).on([kl.ANIMATION_START,kl.ANIMATION_END,kl.ANIMATION_ITERATION],e=>{switch(e.type){case kl.ANIMATION_START:case kl.ANIMATION_END:this.animationRunning=e.type===kl.ANIMATION_START
break
case kl.ANIMATION_ITERATION:this.animationStopToken&&this.animationStopToken(null)}},this.toUnbind),this.bit=e.getHTMLElement()}),this.applyStyles()}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.removeClass(fk),this.element.removeClass(_k),this.element.removeClass(Ck),this.workedVal=0,this.totalWork=void 0}done(){return this.doDone(!0)}stop(){return this.doDone(!1)}doDone(e){return this.element.addClass(pk),this.element.hasClass(_k)?(this.bit.style.opacity="0",e?bt.timeout(200).then(()=>this.off()):this.off()):(this.bit.style.width="inherit",e?bt.timeout(200).then(()=>this.off()):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.removeClass(Ck),this.element.removeClass(pk),this.element.addClass(fk),this.element.addClass(_k),this}total(e){return this.workedVal=0,this.totalWork=e,this}hasTotal(){return!isNaN(this.totalWork)}worked(e){return $r(!isNaN(this.totalWork),"Total work not set"),e=Number(e),$r(!isNaN(e),"Value is not a number"),e=Math.max(1,e),this.workedVal+=e,this.workedVal=Math.min(this.totalWork,this.workedVal),this.element.hasClass(_k)&&this.element.removeClass(_k),this.element.hasClass(pk)&&this.element.removeClass(pk),this.element.hasClass(fk)||this.element.addClass(fk),this.element.hasClass(Ck)||this.element.addClass(Ck),this.bit.style.width=this.workedVal/this.totalWork*100+"%",this}getContainer(){return U_(this.element)}style(e){this.progressBarBackground=e.progressBarBackground,this.applyStyles()}applyStyles(){if(this.bit){const e=this.progressBarBackground?this.progressBarBackground.toString():null
this.bit.style.backgroundColor=e}}dispose(){this.toUnbind=ei(this.toUnbind)}}class yk extends jw{onContextMenu(e,t,i){return k?this.onLeftClick(e,t,i):super.onContextMenu(e,t,i)}}var xk,Lk;(Lk=xk||(xk={}))[Lk.ELEMENT_SELECTED=0]="ELEMENT_SELECTED",Lk[Lk.FOCUS_LOST=1]="FOCUS_LOST",Lk[Lk.CANCELED=2]="CANCELED"
const Nk={background:Td.fromHex("#1E1E1E"),foreground:Td.fromHex("#CCCCCC"),pickerGroupForeground:Td.fromHex("#0097FB"),pickerGroupBorder:Td.fromHex("#3F3F46"),widgetShadow:Td.fromHex("#000000"),progressBarBackground:Td.fromHex("#0E70C0")},Ek=Jt("quickOpenAriaLabel","Quick picker. Type to narrow down results.")
class kk{constructor(e,t,i,n){this.isDisposed=!1,this.toUnbind=[],this.container=e,this.callbacks=t,this.options=i,this.styles=i||Object.create(null),Vn(this.styles,Nk,!1),this.usageLogger=n,this.model=null}getElement(){return U_(this.builder)}getModel(){return this.model}setCallbacks(e){this.callbacks=e}create(){return this.builder=U_().div(e=>{e.on(kl.KEY_DOWN,e=>{9===new Wa(e).keyCode&&(Il.stop(e,!0),this.hide(xk.CANCELED))}).on(kl.CONTEXT_MENU,e=>Il.stop(e,!0)).on(kl.FOCUS,e=>this.gainingFocus(),null,!0).on(kl.BLUR,e=>this.loosingFocus(e),null,!0),this.progressBar=new Sk(e.clone(),{progressBarBackground:this.styles.progressBarBackground}),this.progressBar.getContainer().hide(),e.div({class:"quick-open-input"},e=>{this.inputContainer=e,this.inputBox=new DC(e.getHTMLElement(),null,{placeholder:this.options.inputPlaceHolder||"",ariaLabel:Ek,inputBackground:this.styles.inputBackground,inputForeground:this.styles.inputForeground,inputBorder:this.styles.inputBorder,inputValidationInfoBackground:this.styles.inputValidationInfoBackground,inputValidationInfoBorder:this.styles.inputValidationInfoBorder,inputValidationWarningBackground:this.styles.inputValidationWarningBackground,inputValidationWarningBorder:this.styles.inputValidationWarningBorder,inputValidationErrorBackground:this.styles.inputValidationErrorBackground,inputValidationErrorBorder:this.styles.inputValidationErrorBorder}),this.inputElement=this.inputBox.inputElement,this.inputElement.setAttribute("role","combobox"),this.inputElement.setAttribute("aria-haspopup","false"),this.inputElement.setAttribute("aria-autocomplete","list"),il(this.inputBox.inputElement,kl.KEY_DOWN,e=>{const t=new Wa(e),i=this.shouldOpenInBackground(t)
if(2!==t.keyCode)if(18===t.keyCode||16===t.keyCode||12===t.keyCode||11===t.keyCode)Il.stop(e,!0),this.navigateInTree(t.keyCode,t.shiftKey),this.inputBox.inputElement.selectionStart===this.inputBox.inputElement.selectionEnd&&(this.inputBox.inputElement.selectionStart=this.inputBox.value.length)
else if(3===t.keyCode||i){Il.stop(e,!0)
const t=this.tree.getFocus()
t&&this.elementSelected(t,e,i?hk.OPEN_IN_BACKGROUND:hk.OPEN)}}),il(this.inputBox.inputElement,kl.INPUT,e=>{this.onType()})}),this.treeContainer=e.div({class:"quick-open-tree"},e=>{this.tree=new Tv(e.getHTMLElement(),{dataSource:new uk(this),controller:new yk({clickBehavior:$w.ON_MOUSE_UP,keyboardSupport:this.options.keyboardSupport}),renderer:this.renderer=new mk(this,this.styles),filter:new gk(this),accessibilityProvider:new ck(this)},{twistiePixels:11,indentPixels:0,alwaysFocused:!0,verticalScrollMode:hi.Visible,ariaLabel:Jt("treeAriaLabel","Quick Picker"),keyboardSupport:this.options.keyboardSupport,preventRootFocus:!0}),this.treeElement=this.tree.getHTMLElement(),this.toUnbind.push(this.tree.addListener(Xr.FOCUS,e=>{this.elementFocused(e.focus,e)})),this.toUnbind.push(this.tree.addListener(Xr.SELECTION,e=>{e.selection&&e.selection.length>0&&this.elementSelected(e.selection[0],e)}))}).on(kl.KEY_DOWN,e=>{const t=new Wa(e)
this.quickNavigateConfiguration&&(18!==t.keyCode&&16!==t.keyCode&&12!==t.keyCode&&11!==t.keyCode||(Il.stop(e,!0),this.navigateInTree(t.keyCode)))}).on(kl.KEY_UP,e=>{const t=new Wa(e),i=t.keyCode
if(!this.quickNavigateConfiguration)return
const n=this.quickNavigateConfiguration.keybindings
if(3===i||n.some(e=>{const[n,s]=e.getParts()
return!s&&(n.shiftKey&&4===i?!(t.ctrlKey||t.altKey||t.metaKey):!(!n.altKey||6!==i)||(!(!n.ctrlKey||5!==i)||!(!n.metaKey||57!==i)))})){const t=this.tree.getFocus()
t&&this.elementSelected(t,e)}}).clone()}).addClass("quick-open-widget").build(this.container),this.layoutDimensions&&this.layout(this.layoutDimensions),this.applyStyles(),il(this.treeContainer.getHTMLElement(),kl.KEY_DOWN,e=>{const t=new Wa(e)
this.quickNavigateConfiguration||18!==t.keyCode&&16!==t.keyCode&&12!==t.keyCode&&11!==t.keyCode||(Il.stop(e,!0),this.navigateInTree(t.keyCode,t.shiftKey),this.inputBox.inputElement.focus())}),this.builder.getHTMLElement()}style(e){this.styles=e,this.applyStyles()}applyStyles(){if(this.builder){const e=this.styles.foreground?this.styles.foreground.toString():null,t=this.styles.background?this.styles.background.toString():null,i=this.styles.borderColor?this.styles.borderColor.toString():null,n=this.styles.widgetShadow?this.styles.widgetShadow.toString():null
this.builder.style("color",e),this.builder.style("background-color",t),this.builder.style("border-color",i),this.builder.style("border-width",i?"1px":null),this.builder.style("border-style",i?"solid":null),this.builder.style("box-shadow",n?`0 5px 8px ${n}`:null)}this.progressBar&&this.progressBar.style({progressBarBackground:this.styles.progressBarBackground}),this.inputBox&&this.inputBox.style({inputBackground:this.styles.inputBackground,inputForeground:this.styles.inputForeground,inputBorder:this.styles.inputBorder,inputValidationInfoBackground:this.styles.inputValidationInfoBackground,inputValidationInfoBorder:this.styles.inputValidationInfoBorder,inputValidationWarningBackground:this.styles.inputValidationWarningBackground,inputValidationWarningBorder:this.styles.inputValidationWarningBorder,inputValidationErrorBackground:this.styles.inputValidationErrorBackground,inputValidationErrorBorder:this.styles.inputValidationErrorBorder}),this.tree&&this.tree.style(this.styles),this.renderer&&this.renderer.updateStyles(this.styles)}shouldOpenInBackground(e){if(17!==e.keyCode)return!1
if(e.metaKey||e.ctrlKey||e.shiftKey||e.altKey)return!1
const t=this.inputBox.inputElement
return t.selectionEnd===this.inputBox.value.length&&t.selectionStart===t.selectionEnd}onType(){const e=this.inputBox.value
this.helpText&&(e?this.helpText.hide():this.helpText.show()),this.callbacks.onType(e)}navigate(e,t){this.isVisible()&&(!this.quickNavigateConfiguration&&t&&(this.quickNavigateConfiguration=t,this.tree.DOMFocus()),this.navigateInTree(e?18:16))}navigateInTree(e,t){const i=this.tree.getInput(),n=i?i.entries:[],s=this.tree.getFocus()
switch(e){case 18:this.tree.focusNext()
break
case 16:this.tree.focusPrevious()
break
case 12:this.tree.focusNextPage()
break
case 11:this.tree.focusPreviousPage()
break
case 2:t?this.tree.focusPrevious():this.tree.focusNext()}let r=this.tree.getFocus()
n.length>1&&s===r&&(16===e||2===e&&t?this.tree.focusLast():(18===e||2===e&&!t)&&this.tree.focusFirst()),(r=this.tree.getFocus())&&this.tree.reveal(r).done(null,St)}elementFocused(e,t){if(!e||!this.isVisible())return
this.inputElement.setAttribute("aria-activedescendant",this.treeElement.getAttribute("aria-activedescendant"))
const i={event:t,keymods:this.extractKeyMods(t),quickNavigateConfiguration:this.quickNavigateConfiguration}
this.model.runner.run(e,hk.PREVIEW,i)}elementSelected(e,t,i){let n=!0
if(this.isVisible()){let s=i||hk.OPEN
const r={event:t,keymods:this.extractKeyMods(t),quickNavigateConfiguration:this.quickNavigateConfiguration}
n=this.model.runner.run(e,s,r)}if(this.usageLogger){const t=this.model.entries.indexOf(e),i=this.model.entries.length
this.usageLogger.publicLog("quickOpenWidgetItemAccepted",{index:t,count:i,isQuickNavigate:!!this.quickNavigateConfiguration})}n&&this.hide(xk.ELEMENT_SELECTED)}extractKeyMods(e){return e&&(e.ctrlKey||e.metaKey||e.payload&&e.payload.originalEvent&&(e.payload.originalEvent.ctrlKey||e.payload.originalEvent.metaKey))?[2048]:[]}show(e,t){this.visible=!0,this.isLoosingFocus=!1,this.quickNavigateConfiguration=t?t.quickNavigateConfiguration:void 0,this.quickNavigateConfiguration?(this.inputContainer.hide(),this.builder.show(),this.tree.DOMFocus()):(this.inputContainer.show(),this.builder.show(),this.inputBox.focus()),this.helpText&&(this.quickNavigateConfiguration||rt(e)?this.helpText.hide():this.helpText.show()),rt(e)?this.doShowWithPrefix(e):this.doShowWithInput(e,t&&t.autoFocus?t.autoFocus:{}),t&&t.inputSelection&&!this.quickNavigateConfiguration&&this.inputBox.select(t.inputSelection),this.callbacks.onShow&&this.callbacks.onShow()}doShowWithPrefix(e){this.inputBox.value=e,this.callbacks.onType(e)}doShowWithInput(e,t){this.setInput(e,t)}setInputAndLayout(e,t){this.treeContainer.style({height:`${this.getHeight(e)}px`}),this.tree.setInput(null).then(()=>(this.model=e,this.inputElement.setAttribute("aria-haspopup",String(e&&e.entries&&e.entries.length>0)),this.tree.setInput(e))).done(()=>{this.tree.layout(),e&&e.entries.some(t=>this.isElementVisible(e,t))&&this.autoFocus(e,t)},St)}isElementVisible(e,t){return!e.filter||e.filter.isVisible(t)}autoFocus(e,t={}){const i=e.entries.filter(t=>this.isElementVisible(e,t))
if(t.autoFocusPrefixMatch){let n,s
const r=t.autoFocusPrefixMatch,o=r.toLowerCase()
for(let t=0;t<i.length;t++){const a=i[t],l=e.dataSource.getLabel(a)
if(n||0!==l.indexOf(r)?s||0!==l.toLowerCase().indexOf(o)||(s=a):n=a,n&&s)break}const a=n||s
if(a)return this.tree.setFocus(a),void this.tree.reveal(a,.5).done(null,St)}t.autoFocusFirstEntry?(this.tree.focusFirst(),this.tree.reveal(this.tree.getFocus()).done(null,St)):"number"==typeof t.autoFocusIndex?i.length>t.autoFocusIndex&&(this.tree.focusNth(t.autoFocusIndex),this.tree.reveal(this.tree.getFocus()).done(null,St)):t.autoFocusSecondEntry?i.length>1&&this.tree.focusNth(1):t.autoFocusLastEntry&&i.length>1&&this.tree.focusLast()}refresh(e,t){this.isVisible()&&(e||(e=this.tree.getInput()),e&&(this.treeContainer.style({height:`${this.getHeight(e)}px`}),this.tree.refresh().done(()=>{(this.tree.layout(),t)&&(t&&e&&e.entries.some(t=>this.isElementVisible(e,t))&&this.autoFocus(e,t))},St)))}getHeight(e){const t=e.renderer
if(!e){const e=t.getHeight(null)
return this.options.minItemsToShow?this.options.minItemsToShow*e:0}let i,n=0
this.layoutDimensions&&this.layoutDimensions.height&&(i=.4*(this.layoutDimensions.height-50)),(!i||i>kk.MAX_ITEMS_HEIGHT)&&(i=kk.MAX_ITEMS_HEIGHT)
const s=e.entries.filter(t=>this.isElementVisible(e,t)),r=this.options.maxItemsToShow||s.length
for(let e=0;e<r&&e<s.length;e++){const r=t.getHeight(s[e])
if(!(n+r<=i))break
n+=r}return n}hide(e){if(this.isVisible()){if(this.visible=!1,this.builder.hide(),this.builder.domBlur(),e===xk.CANCELED&&this.model){const e=this.model.entries.filter(e=>this.isElementVisible(this.model,e)).length
this.usageLogger&&this.usageLogger.publicLog("quickOpenWidgetCancelled",{count:e,isQuickNavigate:!!this.quickNavigateConfiguration})}this.inputBox.value="",this.tree.setInput(null),this.inputElement.setAttribute("aria-haspopup","false"),this.treeContainer.style({height:(this.options.minItemsToShow?22*this.options.minItemsToShow:0)+"px"}),this.progressBar.stop().getContainer().hide(),this.tree.isDOMFocused()?this.tree.DOMBlur():this.inputBox.hasFocus()&&this.inputBox.blur(),e===xk.ELEMENT_SELECTED?this.callbacks.onOk():this.callbacks.onCancel(),this.callbacks.onHide&&this.callbacks.onHide(e)}}getQuickNavigateConfiguration(){return this.quickNavigateConfiguration}setPlaceHolder(e){this.inputBox&&this.inputBox.setPlaceHolder(e)}setValue(e,t){if(this.inputBox)if(this.inputBox.value=e,Array.isArray(t)){const[e,i]=t
this.inputBox.select({start:e,end:i})}else this.inputBox.select()}setPassword(e){this.inputBox&&(this.inputBox.inputElement.type=e?"password":"text")}setInput(e,t,i){this.isVisible()&&(this.getInput()&&this.onInputChanging(),this.setInputAndLayout(e,t),this.inputBox&&this.inputBox.setAriaLabel(i||Ek))}onInputChanging(){this.inputChangingTimeoutHandle&&(clearTimeout(this.inputChangingTimeoutHandle),this.inputChangingTimeoutHandle=null),this.builder.addClass("content-changing"),this.inputChangingTimeoutHandle=setTimeout(()=>{this.builder.removeClass("content-changing")},500)}getInput(){return this.tree.getInput()}getTree(){return this.tree}showInputDecoration(e){this.inputBox&&this.inputBox.showMessage({type:e===ew.Info?kC.INFO:e===ew.Warning?kC.WARNING:kC.ERROR,content:""})}clearInputDecoration(){this.inputBox&&this.inputBox.hideMessage()}focus(){this.isVisible()&&this.inputBox&&this.inputBox.focus()}accept(){if(this.isVisible()){const e=this.tree.getFocus()
e&&this.elementSelected(e)}}getProgressBar(){return this.progressBar}getInputBox(){return this.inputBox}setExtraClass(e){const t=this.builder.getProperty("extra-class")
t&&this.builder.removeClass(t),e?(this.builder.addClass(e),this.builder.setProperty("extra-class",e)):t&&this.builder.removeProperty("extra-class")}isVisible(){return this.visible}layout(e){this.layoutDimensions=e
const t=Math.min(.62*this.layoutDimensions.width,kk.MAX_WIDTH)
this.builder&&(this.builder.style({width:t+"px",marginLeft:"-"+t/2+"px"}),this.inputContainer.style({width:t-12+"px"}))}gainingFocus(){this.isLoosingFocus=!1}loosingFocus(e){if(!this.isVisible())return
const t=e.relatedTarget
!this.quickNavigateConfiguration&&yl(t,this.builder.getHTMLElement())||(this.isLoosingFocus=!0,bt.timeout(0).then(()=>{if(!this.isLoosingFocus)return
if(this.isDisposed)return
this.callbacks.onFocusLost&&this.callbacks.onFocusLost()||this.hide(xk.FOCUS_LOST)}))}dispose(){this.isDisposed=!0,this.toUnbind=ei(this.toUnbind),this.progressBar.dispose(),this.inputBox.dispose(),this.tree.dispose()}}kk.MAX_WIDTH=600,kk.MAX_ITEMS_HEIGHT=440
class Ik{constructor(e,t,i,n,s,r){this.codeEditor=e,this.themeService=r,this.create(t,i,n,s)}create(e,t,i,n){var s,r
this.domNode=U_().div().getHTMLElement(),this.quickOpenWidget=new kk(this.domNode,{onOk:e,onCancel:t,onType:i},{inputPlaceHolder:null,inputAriaLabel:n.inputAriaLabel,keyboardSupport:!0},null),this.styler=(s=this.quickOpenWidget,tS(this.themeService,{foreground:r&&r.foreground||dc,background:r&&r.background||Qc,borderColor:r&&r.borderColor||gc,widgetShadow:r&&r.widgetShadow||_c,progressBarBackground:r&&r.progressBarBackground||Jc,pickerGroupForeground:r&&r.pickerGroupForeground||Hc,pickerGroupBorder:r&&r.pickerGroupBorder||zc,inputBackground:r&&r.inputBackground||Cc,inputForeground:r&&r.inputForeground||bc,inputBorder:r&&r.inputBorder||wc,inputValidationInfoBorder:r&&r.inputValidationInfoBorder||yc,inputValidationInfoBackground:r&&r.inputValidationInfoBackground||Sc,inputValidationWarningBorder:r&&r.inputValidationWarningBorder||Lc,inputValidationWarningBackground:r&&r.inputValidationWarningBackground||xc,inputValidationErrorBorder:r&&r.inputValidationErrorBorder||Ec,inputValidationErrorBackground:r&&r.inputValidationErrorBackground||Nc,listFocusBackground:r&&r.listFocusBackground||Ic,listFocusForeground:r&&r.listFocusForeground||Mc,listActiveSelectionBackground:r&&r.listActiveSelectionBackground||Lg(Dc,.1),listActiveSelectionForeground:r&&r.listActiveSelectionForeground||Tc,listFocusAndSelectionBackground:r&&r.listFocusAndSelectionBackground||Dc,listFocusAndSelectionForeground:r&&r.listFocusAndSelectionForeground||Tc,listInactiveSelectionBackground:r&&r.listInactiveSelectionBackground||Oc,listInactiveSelectionForeground:r&&r.listInactiveSelectionForeground||Rc,listInactiveFocusBackground:r&&r.listInactiveFocusBackground||Ac,listInactiveFocusForeground:r&&r.listInactiveFocusForeground||Pc,listHoverBackground:r&&r.listHoverBackground||Fc,listHoverForeground:r&&r.listHoverForeground||Wc,listDropBackground:r&&r.listDropBackground||Vc,listFocusOutline:r&&r.listFocusOutline||mc,listSelectionOutline:r&&r.listSelectionOutline||mc,listHoverOutline:r&&r.listHoverOutline||mc},s)),this.quickOpenWidget.create(),this.codeEditor.addOverlayWidget(this)}setInput(e,t){this.quickOpenWidget.setInput(e,t)}getId(){return Ik.ID}getDomNode(){return this.domNode}destroy(){this.codeEditor.removeOverlayWidget(this),this.quickOpenWidget.dispose(),this.styler.dispose()}isVisible(){return this.visible}show(e){this.visible=!0
const t=this.codeEditor.getLayoutInfo()
t&&this.quickOpenWidget.layout(new E_(t.width,t.height)),this.quickOpenWidget.show(e),this.codeEditor.layoutOverlayWidget(this)}hide(){this.visible=!1,this.quickOpenWidget.hide(),this.codeEditor.layoutOverlayWidget(this)}getPosition(){return this.visible?{preference:_m.TOP_CENTER}:null}}Ik.ID="editor.contrib.quickOpenEditorWidget"
let Mk=Tk=class{constructor(e,t){this.themeService=t,this.editor=e}static get(e){return e.getContribution(Tk.ID)}getId(){return Tk.ID}dispose(){this.widget&&(this.widget.destroy(),this.widget=null)}run(e){this.widget&&(this.widget.destroy(),this.widget=null)
let t=e=>{this.clearDecorations(),e&&this.lastKnownEditorSelection&&(this.editor.setSelection(this.lastKnownEditorSelection),this.editor.revealRangeInCenterIfOutsideViewport(this.lastKnownEditorSelection,0)),this.lastKnownEditorSelection=null,this.editor.focus()}
this.widget=new Ik(this.editor,()=>t(!1),()=>t(!0),t=>{this.widget.setInput(e.getModel(t),e.getAutoFocus(t))},{inputAriaLabel:e.inputAriaLabel},this.themeService),this.lastKnownEditorSelection||(this.lastKnownEditorSelection=this.editor.getSelection()),this.widget.show("")}decorateLine(e,t){t.changeDecorations(t=>{const i=[]
this.rangeHighlightDecorationId&&(i.push(this.rangeHighlightDecorationId),this.rangeHighlightDecorationId=null)
const n=[{range:e,options:Tk._RANGE_HIGHLIGHT_DECORATION}],s=t.deltaDecorations(i,n)
this.rangeHighlightDecorationId=s[0]})}clearDecorations(){this.rangeHighlightDecorationId&&this.editor.changeDecorations(e=>{e.deltaDecorations([this.rangeHighlightDecorationId],[]),this.rangeHighlightDecorationId=null})}}
Mk.ID="editor.controller.quickOpenController",Mk._RANGE_HIGHLIGHT_DECORATION=Ld.register({className:"rangeHighlight",isWholeLine:!0}),Mk=Tk=Nn([iC,En(1,Mg)],Mk)
class Dk extends To{constructor(e,t){super(t),this._inputAriaLabel=e}getController(e){return Mk.get(e)}_show(e,t){e.run({inputAriaLabel:this._inputAriaLabel,getModel:e=>t.getModel(e),getAutoFocus:e=>t.getAutoFocus(e)})}}var Tk
function Ok(e){let t=[],i=Ps.all(e).map(i=>ca(t=>i.provideDocumentSymbols(e,t)).then(e=>{Array.isArray(e)&&t.push(...e)},e=>{yt(e)}))
return bt.join(i).then(()=>{let e=[]
return function(e,t,i){for(let n of t)e.push({kind:n.kind,location:n.location,name:n.name,containerName:n.containerName||i})}(e,t,""),e.sort(Rk),{entries:e}})}function Rk(e,i){return t.compareRangesUsingStarts(t.lift(e.location.range),t.lift(i.location.range))}No.registerLanguageCommand("_executeDocumentSymbolProvider",function(e,t){const{resource:i}=t
if(!(i instanceof X))throw Et("resource")
const n=e.get(Zr).getModel(i)
if(!n)throw Et("resource")
return Ok(n)})
let Ak=":"
class Pk extends nk{constructor(e,t,i,n,s,r,o){super(),this.name=e,this.type=t,this.description=i,this.range=n,this.setHighlights(s),this.editor=r,this.decorator=o}getLabel(){return this.name}getAriaLabel(){return Jt("entryAriaLabel","{0}, symbols",this.name)}getIcon(){return this.type}getDescription(){return this.description}getType(){return this.type}getRange(){return this.range}run(e,t){return e===hk.OPEN?this.runOpen(t):this.runPreview()}runOpen(e){let t=this.toSelection()
return this.editor.setSelection(t),this.editor.revealRangeInCenter(t,0),this.editor.focus(),!0}runPreview(){let e=this.toSelection()
return this.editor.revealRangeInCenter(e,0),this.decorator.decorateLine(this.range,this.editor),!1}toSelection(){return new t(this.range.startLineNumber,this.range.startColumn||1,this.range.startLineNumber,this.range.startColumn||1)}}Oo(class extends Dk{constructor(){super(Jt("quickOutlineActionInput","Type the name of an identifier you wish to navigate to"),{id:"editor.action.quickOutline",label:Jt("QuickOutlineAction.label","Go to Symbol..."),alias:"Go to Symbol...",precondition:Vo.hasDocumentSymbolProvider,kbOpts:{kbExpr:Vo.focus,primary:3117},menuOpts:{group:"navigation",order:3}})}run(e,t){let i=t.getModel()
return Ps.has(i)?Ok(i).then(e=>{0!==e.entries.length&&this._run(t,e.entries)}):null}_run(e,t){this._show(this.getController(e),{getModel:i=>new lk(this.toQuickOpenEntries(e,t,i)),getAutoFocus:e=>(0===e.indexOf(Ak)&&(e=e.substr(Ak.length)),{autoFocusPrefixMatch:e,autoFocusFirstEntry:!!e})})}toQuickOpenEntries(e,i,n){const s=this.getController(e)
let r=[],o=n
0===n.indexOf(Ak)&&(o=o.substr(Ak.length))
for(let n=0;n<i.length;n++){let a=i[n],l=ce(a.name),h=SN(o,l)
if(h){let i=null
a.containerName&&(i=a.containerName),r.push(new Pk(l,Ms(a.kind),i,t.lift(a.location.range),h,e,s))}}if(n&&(r=0===n.indexOf(Ak)?r.sort(this.sortScoped.bind(this,n.toLowerCase())):r.sort(this.sortNormal.bind(this,n.toLowerCase()))),r.length>0&&0===n.indexOf(Ak)){let e=null,t=null,i=0
for(let n=0;n<r.length;n++){let s=r[n]
e!==s.getType()?(t&&t.setGroupLabel(this.typeToLabel(e,i)),e=s.getType(),t=s,i=1,s.setShowBorder(n>0)):i++}t&&t.setGroupLabel(this.typeToLabel(e,i))}else r.length>0&&r[0].setGroupLabel(Jt("symbols","symbols ({0})",r.length))
return r}typeToLabel(e,t){switch(e){case"module":return Jt("modules","modules ({0})",t)
case"class":return Jt("class","classes ({0})",t)
case"interface":return Jt("interface","interfaces ({0})",t)
case"method":return Jt("method","methods ({0})",t)
case"function":return Jt("function","functions ({0})",t)
case"property":return Jt("property","properties ({0})",t)
case"variable":return Jt("variable","variables ({0})",t)
case"var":return Jt("variable2","variables ({0})",t)
case"constructor":return Jt("_constructor","constructors ({0})",t)
case"call":return Jt("call","calls ({0})",t)}return e}sortNormal(e,t,i){let n=t.getLabel().toLowerCase(),s=i.getLabel().toLowerCase(),r=n.localeCompare(s)
if(0!==r)return r
let o=t.getRange(),a=i.getRange()
return o.startLineNumber-a.startLineNumber}sortScoped(e,t,i){e=e.substr(Ak.length)
let n=t.getType(),s=i.getType(),r=n.localeCompare(s)
if(0!==r)return r
if(e){let e=t.getLabel().toLowerCase(),n=i.getLabel().toLowerCase(),s=e.localeCompare(n)
if(0!==s)return s}let o=t.getRange(),a=i.getRange()
return o.startLineNumber-a.startLineNumber}})
class Fk extends ik{constructor(e,t,i){super(),this.editor=t,this.decorator=i,this._parseResult=this._parseInput(e)}_parseInput(t){let i,n,s=t.split(",").map(e=>parseInt(e,10)).filter(e=>!isNaN(e))
i=0===s.length?new e(-1,-1):1===s.length?new e(s[0],1):new e(s[0],s[1])
let r,o=(n=p(this.editor)?this.editor.getModel():this.editor.getModel().modified).validatePosition(i).equals(i)
return{position:i,isValid:o,label:r=o?i.column&&i.column>1?Jt("gotoLineLabelValidLineAndColumn","Go to line {0} and character {1}",i.lineNumber,i.column):Jt("gotoLineLabelValidLine","Go to line {0}",i.lineNumber,i.column):i.lineNumber<1||i.lineNumber>n.getLineCount()?Jt("gotoLineLabelEmptyWithLineLimit","Type a line number between 1 and {0} to navigate to",n.getLineCount()):Jt("gotoLineLabelEmptyWithLineAndColumnLimit","Type a character between 1 and {0} to navigate to",n.getLineMaxColumn(i.lineNumber))}}getLabel(){return this._parseResult.label}getAriaLabel(){return Jt("gotoLineAriaLabel","Go to line {0}",this._parseResult.label)}run(e,t){return e===hk.OPEN?this.runOpen():this.runPreview()}runOpen(){if(!this._parseResult.isValid)return!1
let e=this.toSelection()
return this.editor.setSelection(e),this.editor.revealRangeInCenter(e,0),this.editor.focus(),!0}runPreview(){if(!this._parseResult.isValid)return this.decorator.clearDecorations(),!1
let e=this.toSelection()
return this.editor.revealRangeInCenter(e,0),this.decorator.decorateLine(e,this.editor),!1}toSelection(){return new t(this._parseResult.position.lineNumber,this._parseResult.position.column,this._parseResult.position.lineNumber,this._parseResult.position.column)}}Oo(class extends Dk{constructor(){super(Jt("gotoLineActionInput","Type a line number, followed by an optional colon and a character number to navigate to"),{id:"editor.action.gotoLine",label:Jt("GotoLineAction.label","Go to Line..."),alias:"Go to Line...",precondition:null,kbOpts:{kbExpr:Vo.focus,primary:2085,mac:{primary:293}}})}run(e,t){this._show(this.getController(t),{getModel:e=>new lk([new Fk(e,t,this.getController(t))]),getAutoFocus:e=>({autoFocusFirstEntry:e.length>0})})}})
class Wk extends nk{constructor(e,t,i,n){super(),this.key=e,this.setHighlights(t),this.action=i,this.editor=n}getLabel(){return this.action.label}getAriaLabel(){return Jt("ariaLabelEntry","{0}, commands",this.getLabel())}getGroupLabel(){return this.key}run(e,t){return e===hk.OPEN&&(bt.timeout(50).done(()=>{this.editor.focus()
try{(this.action.run()||bt.as(null)).done(null,St)}catch(e){St(e)}},St),!0)}}var Vk,Bk,Hk,zk,Uk,Kk,$k,qk,Gk,jk
Oo(class extends Dk{constructor(){super(Jt("quickCommandActionInput","Type the name of an action you want to execute"),{id:"editor.action.quickCommand",label:Jt("QuickCommandAction.label","Command Palette"),alias:"Command Palette",precondition:null,kbOpts:{kbExpr:Vo.focus,primary:xa?571:59},menuOpts:{}})}run(e,t){const i=e.get(tC)
this._show(this.getController(t),{getModel:e=>new lk(this._editorActionsToEntries(i,t,e)),getAutoFocus:e=>({autoFocusFirstEntry:!0,autoFocusPrefixMatch:e})})}_sort(e,t){let i=e.getLabel().toLowerCase(),n=t.getLabel().toLowerCase()
return i.localeCompare(n)}_editorActionsToEntries(e,t,i){let n=t.getSupportedActions(),s=[]
for(let r=0;r<n.length;r++){let o=n[r],a=e.lookupKeybinding(o.id)
if(o.label){let e=SN(i,o.label)
e&&s.push(new Wk(a?a.getLabel():"",e,o,t))}}return s=s.sort(this._sort)}}),(Bk=Vk||(Vk={}))[Bk.Ignore=0]="Ignore",Bk[Bk.Info=1]="Info",Bk[Bk.Warning=2]="Warning",Bk[Bk.Error=3]="Error"
class Yk{static chord(e,t){return Wr(e,t)}}function Zk(){return{editor:void 0,languages:void 0,CancellationTokenSource:ha,Emitter:ci,KeyCode:Hk,KeyMod:Yk,Position:e,Range:t,Selection:At,SelectionDirection:Ot,Severity:Vk,Promise:bt,Uri:X,Token:gh}}Yk.CtrlCmd=2048,Yk.Shift=1024,Yk.Alt=512,Yk.WinCtrl=256,(zk=Hk||(Hk={}))[zk.Unknown=0]="Unknown",zk[zk.Backspace=1]="Backspace",zk[zk.Tab=2]="Tab",zk[zk.Enter=3]="Enter",zk[zk.Shift=4]="Shift",zk[zk.Ctrl=5]="Ctrl",zk[zk.Alt=6]="Alt",zk[zk.PauseBreak=7]="PauseBreak",zk[zk.CapsLock=8]="CapsLock",zk[zk.Escape=9]="Escape",zk[zk.Space=10]="Space",zk[zk.PageUp=11]="PageUp",zk[zk.PageDown=12]="PageDown",zk[zk.End=13]="End",zk[zk.Home=14]="Home",zk[zk.LeftArrow=15]="LeftArrow",zk[zk.UpArrow=16]="UpArrow",zk[zk.RightArrow=17]="RightArrow",zk[zk.DownArrow=18]="DownArrow",zk[zk.Insert=19]="Insert",zk[zk.Delete=20]="Delete",zk[zk.KEY_0=21]="KEY_0",zk[zk.KEY_1=22]="KEY_1",zk[zk.KEY_2=23]="KEY_2",zk[zk.KEY_3=24]="KEY_3",zk[zk.KEY_4=25]="KEY_4",zk[zk.KEY_5=26]="KEY_5",zk[zk.KEY_6=27]="KEY_6",zk[zk.KEY_7=28]="KEY_7",zk[zk.KEY_8=29]="KEY_8",zk[zk.KEY_9=30]="KEY_9",zk[zk.KEY_A=31]="KEY_A",zk[zk.KEY_B=32]="KEY_B",zk[zk.KEY_C=33]="KEY_C",zk[zk.KEY_D=34]="KEY_D",zk[zk.KEY_E=35]="KEY_E",zk[zk.KEY_F=36]="KEY_F",zk[zk.KEY_G=37]="KEY_G",zk[zk.KEY_H=38]="KEY_H",zk[zk.KEY_I=39]="KEY_I",zk[zk.KEY_J=40]="KEY_J",zk[zk.KEY_K=41]="KEY_K",zk[zk.KEY_L=42]="KEY_L",zk[zk.KEY_M=43]="KEY_M",zk[zk.KEY_N=44]="KEY_N",zk[zk.KEY_O=45]="KEY_O",zk[zk.KEY_P=46]="KEY_P",zk[zk.KEY_Q=47]="KEY_Q",zk[zk.KEY_R=48]="KEY_R",zk[zk.KEY_S=49]="KEY_S",zk[zk.KEY_T=50]="KEY_T",zk[zk.KEY_U=51]="KEY_U",zk[zk.KEY_V=52]="KEY_V",zk[zk.KEY_W=53]="KEY_W",zk[zk.KEY_X=54]="KEY_X",zk[zk.KEY_Y=55]="KEY_Y",zk[zk.KEY_Z=56]="KEY_Z",zk[zk.Meta=57]="Meta",zk[zk.ContextMenu=58]="ContextMenu",zk[zk.F1=59]="F1",zk[zk.F2=60]="F2",zk[zk.F3=61]="F3",zk[zk.F4=62]="F4",zk[zk.F5=63]="F5",zk[zk.F6=64]="F6",zk[zk.F7=65]="F7",zk[zk.F8=66]="F8",zk[zk.F9=67]="F9",zk[zk.F10=68]="F10",zk[zk.F11=69]="F11",zk[zk.F12=70]="F12",zk[zk.F13=71]="F13",zk[zk.F14=72]="F14",zk[zk.F15=73]="F15",zk[zk.F16=74]="F16",zk[zk.F17=75]="F17",zk[zk.F18=76]="F18",zk[zk.F19=77]="F19",zk[zk.NumLock=78]="NumLock",zk[zk.ScrollLock=79]="ScrollLock",zk[zk.US_SEMICOLON=80]="US_SEMICOLON",zk[zk.US_EQUAL=81]="US_EQUAL",zk[zk.US_COMMA=82]="US_COMMA",zk[zk.US_MINUS=83]="US_MINUS",zk[zk.US_DOT=84]="US_DOT",zk[zk.US_SLASH=85]="US_SLASH",zk[zk.US_BACKTICK=86]="US_BACKTICK",zk[zk.US_OPEN_SQUARE_BRACKET=87]="US_OPEN_SQUARE_BRACKET",zk[zk.US_BACKSLASH=88]="US_BACKSLASH",zk[zk.US_CLOSE_SQUARE_BRACKET=89]="US_CLOSE_SQUARE_BRACKET",zk[zk.US_QUOTE=90]="US_QUOTE",zk[zk.OEM_8=91]="OEM_8",zk[zk.OEM_102=92]="OEM_102",zk[zk.NUMPAD_0=93]="NUMPAD_0",zk[zk.NUMPAD_1=94]="NUMPAD_1",zk[zk.NUMPAD_2=95]="NUMPAD_2",zk[zk.NUMPAD_3=96]="NUMPAD_3",zk[zk.NUMPAD_4=97]="NUMPAD_4",zk[zk.NUMPAD_5=98]="NUMPAD_5",zk[zk.NUMPAD_6=99]="NUMPAD_6",zk[zk.NUMPAD_7=100]="NUMPAD_7",zk[zk.NUMPAD_8=101]="NUMPAD_8",zk[zk.NUMPAD_9=102]="NUMPAD_9",zk[zk.NUMPAD_MULTIPLY=103]="NUMPAD_MULTIPLY",zk[zk.NUMPAD_ADD=104]="NUMPAD_ADD",zk[zk.NUMPAD_SEPARATOR=105]="NUMPAD_SEPARATOR",zk[zk.NUMPAD_SUBTRACT=106]="NUMPAD_SUBTRACT",zk[zk.NUMPAD_DECIMAL=107]="NUMPAD_DECIMAL",zk[zk.NUMPAD_DIVIDE=108]="NUMPAD_DIVIDE",zk[zk.KEY_IN_COMPOSITION=109]="KEY_IN_COMPOSITION",zk[zk.ABNT_C1=110]="ABNT_C1",zk[zk.ABNT_C2=111]="ABNT_C2",zk[zk.MAX_VALUE=112]="MAX_VALUE"
class Xk{constructor(e,t,i,n,s){this.toDispose=[],this._contextKeyService=e,this._commandService=t,this._telemetryService=i,this._statusService=s,this._messageService=n,this._currentChord=null,this._currentChordStatusMessage=null,this._onDidUpdateKeybindings=new ci,this.toDispose.push(this._onDidUpdateKeybindings)}dispose(){this.toDispose=ei(this.toDispose)}get onDidUpdateKeybindings(){return this._onDidUpdateKeybindings?this._onDidUpdateKeybindings.event:ui.None}getDefaultKeybindingsContent(){return""}getDefaultKeybindings(){return this._getResolver().getDefaultKeybindings()}getKeybindings(){return this._getResolver().getKeybindings()}customKeybindingsCount(){return 0}lookupKeybindings(e){return this._getResolver().lookupKeybindings(e).map(e=>e.resolvedKeybinding)}lookupKeybinding(e){let t=this._getResolver().lookupPrimaryKeybinding(e)
return t?t.resolvedKeybinding:null}softDispatch(e,t){const i=this.resolveKeyboardEvent(e)
if(i.isChord())return console.warn("Unexpected keyboard event mapped to a chord"),null
const[n]=i.getDispatchParts()
if(null===n)return null
const s=this._contextKeyService.getContext(t),r=this._currentChord?this._currentChord.keypress:null
return this._getResolver().resolve(s,r,n)}_dispatch(e,t){let i=!1
const n=this.resolveKeyboardEvent(e)
if(n.isChord())return console.warn("Unexpected keyboard event mapped to a chord"),null
const[s]=n.getDispatchParts()
if(null===s)return i
const r=this._contextKeyService.getContext(t),o=this._currentChord?this._currentChord.keypress:null,a=n.getLabel(),l=this._getResolver().resolve(r,o,s)
return l&&l.enterChord?(i=!0,this._currentChord={keypress:s,label:a},this._statusService&&(this._currentChordStatusMessage=this._statusService.setStatusMessage(Jt("first.chord","({0}) was pressed. Waiting for second key of chord...",a))),i):(this._statusService&&this._currentChord&&(l&&l.commandId||(this._statusService.setStatusMessage(Jt("missing.chord","The key combination ({0}, {1}) is not a command.",this._currentChord.label,a),1e4),i=!0)),this._currentChordStatusMessage&&(this._currentChordStatusMessage.dispose(),this._currentChordStatusMessage=null),this._currentChord=null,l&&l.commandId&&(l.bubble||(i=!0),this._commandService.executeCommand(l.commandId,l.commandArgs||{}).done(void 0,e=>{this._messageService.show(ew.Warning,e)}),this._telemetryService.publicLog("workbenchActionExecuted",{id:l.commandId,from:"keybinding"})),i)}}class Jk extends Kr{constructor(e,t){super(),this._os=t,null===e?(this._firstPart=null,this._chordPart=null):2===e.type?(this._firstPart=e.firstPart,this._chordPart=e.chordPart):(this._firstPart=e,this._chordPart=null)}_keyCodeToUILabel(e){if(2===this._os)switch(e){case 15:return"←"
case 16:return"↑"
case 17:return"→"
case 18:return"↓"}return Fr.toString(e)}_getUILabelForKeybinding(e){return e?e.isDuplicateModifierCase()?"":this._keyCodeToUILabel(e.keyCode):null}getLabel(){let e=this._getUILabelForKeybinding(this._firstPart),t=this._getUILabelForKeybinding(this._chordPart)
return jE.toLabel(this._firstPart,e,this._chordPart,t,this._os)}_getAriaLabelForKeybinding(e){return e?e.isDuplicateModifierCase()?"":Fr.toString(e.keyCode):null}getAriaLabel(){let e=this._getAriaLabelForKeybinding(this._firstPart),t=this._getAriaLabelForKeybinding(this._chordPart)
return YE.toLabel(this._firstPart,e,this._chordPart,t,this._os)}_keyCodeToElectronAccelerator(e){if(e>=93&&e<=108)return null
switch(e){case 16:return"Up"
case 18:return"Down"
case 15:return"Left"
case 17:return"Right"}return Fr.toString(e)}_getElectronAcceleratorLabelForKeybinding(e){return e?e.isDuplicateModifierCase()?null:this._keyCodeToElectronAccelerator(e.keyCode):null}getElectronAccelerator(){if(null!==this._chordPart)return null
let e=this._getElectronAcceleratorLabelForKeybinding(this._firstPart)
return ZE.toLabel(this._firstPart,e,null,null,this._os)}_getUserSettingsLabelForKeybinding(e){return e?e.isDuplicateModifierCase()?"":Fr.toUserSettingsUS(e.keyCode):null}getUserSettingsLabel(){let e=this._getUserSettingsLabelForKeybinding(this._firstPart),t=this._getUserSettingsLabelForKeybinding(this._chordPart),i=XE.toLabel(this._firstPart,e,this._chordPart,t,this._os)
return i?i.toLowerCase():i}isWYSIWYG(){return!0}isChord(){return!!this._chordPart}getParts(){return[this._toResolvedKeybindingPart(this._firstPart),this._toResolvedKeybindingPart(this._chordPart)]}_toResolvedKeybindingPart(e){return e?new Ur(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,this._getUILabelForKeybinding(e),this._getAriaLabelForKeybinding(e)):null}getDispatchParts(){return[this._firstPart?Jk.getDispatchStr(this._firstPart):null,this._chordPart?Jk.getDispatchStr(this._chordPart):null]}static getDispatchStr(e){if(e.isModifierKey())return null
let t=""
return e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),e.altKey&&(t+="alt+"),e.metaKey&&(t+="meta+"),t+=Fr.toString(e.keyCode)}}class Qk{constructor(e,t){this._defaultKeybindings=e,this._defaultBoundCommands=new Map
for(let t=0,i=e.length;t<i;t++){const i=e[t].command
this._defaultBoundCommands.set(i,!0)}this._map=new Map,this._lookupMap=new Map,this._keybindings=Qk.combine(e,t)
for(let e=0,t=this._keybindings.length;e<t;e++){let t=this._keybindings[e]
null!==t.keypressFirstPart&&this._addKeyPress(t.keypressFirstPart,t)}}static _isTargetedForRemoval(e,t,i,n,s){if(e.command!==n)return!1
if(t&&e.keypressFirstPart!==t)return!1
if(i&&e.keypressChordPart!==i)return!1
if(s){if(!e.when)return!1
if(!s.equals(e.when))return!1}return!0}static combine(e,t){e=e.slice(0)
let i=[]
for(let n=0,s=t.length;n<s;n++){const s=t[n]
if(!s.command||0===s.command.length||"-"!==s.command.charAt(0)){i.push(s)
continue}const r=s.command.substr(1),o=s.keypressFirstPart,a=s.keypressChordPart,l=s.when
for(let t=e.length-1;t>=0;t--)this._isTargetedForRemoval(e[t],o,a,r,l)&&e.splice(t,1)}return e.concat(i)}_addKeyPress(e,t){const i=this._map.get(e)
if(void 0===i)return this._map.set(e,[t]),void this._addToLookupMap(t)
for(let e=i.length-1;e>=0;e--){let n=i[e]
if(n.command===t.command)continue
const s=null!==n.keypressChordPart,r=null!==t.keypressChordPart
s&&r&&n.keypressChordPart!==t.keypressChordPart||Qk.whenIsEntirelyIncluded(!0,n.when,t.when)&&this._removeFromLookupMap(n)}i.push(t),this._addToLookupMap(t)}_addToLookupMap(e){if(!e.command)return
let t=this._lookupMap.get(e.command)
void 0===t?(t=[e],this._lookupMap.set(e.command,t)):t.push(e)}_removeFromLookupMap(e){let t=this._lookupMap.get(e.command)
if(void 0!==t)for(let i=0,n=t.length;i<n;i++)if(t[i]===e)return void t.splice(i,1)}static whenIsEntirelyIncluded(e,t,i){if(e||(t=t?t.normalize():null,i=i?i.normalize():null),!i)return!0
if(!t)return!1
let n=t.serialize().split(" && "),s=i.serialize().split(" && "),r=Object.create(null)
for(let e=0,t=n.length;e<t;e++)r[n[e]]=!0
for(let e=0,t=s.length;e<t;e++)if(!r[s[e]])return!1
return!0}getDefaultBoundCommands(){return this._defaultBoundCommands}getDefaultKeybindings(){return this._defaultKeybindings}getKeybindings(){return this._keybindings}lookupKeybindings(e){let t=this._lookupMap.get(e)
if(void 0===t||0===t.length)return[]
let i=[],n=0
for(let e=t.length-1;e>=0;e--)i[n++]=t[e]
return i}lookupPrimaryKeybinding(e){let t=this._lookupMap.get(e)
return void 0===t||0===t.length?null:t[t.length-1]}resolve(e,t,i){let n=null
if(null!==t){const e=this._map.get(t)
if(void 0===e)return null
n=[]
for(let t=0,s=e.length;t<s;t++){let s=e[t]
s.keypressChordPart===i&&n.push(s)}}else{const e=this._map.get(i)
if(void 0===e)return null
n=e}let s=this._findCommand(e,n)
return s?null===t&&null!==s.keypressChordPart?{enterChord:!0,commandId:null,commandArgs:null,bubble:!1}:{enterChord:!1,commandId:s.command,commandArgs:s.commandArgs,bubble:s.bubble}:null}_findCommand(e,t){for(let i=t.length-1;i>=0;i--){let n=t[i]
if(Qk.contextMatchesRules(e,n.when))return n}return null}static contextMatchesRules(e,t){return!t||t.evaluate(e)}static getAllUnboundCommands(e){const t=Tr.getCommands(),i=[]
for(let n in t)"_"!==n[0]&&0!==n.indexOf("vscode.")&&("object"!=typeof t[n].description||Tn(t[n].description.args))&&!0!==e.get(n)&&i.push(n)
return i}}(Kk=Uk||(Uk={}))[Kk.None=0]="None",Kk[Kk.UnexpectedEndOfComment=1]="UnexpectedEndOfComment",Kk[Kk.UnexpectedEndOfString=2]="UnexpectedEndOfString",Kk[Kk.UnexpectedEndOfNumber=3]="UnexpectedEndOfNumber",Kk[Kk.InvalidUnicode=4]="InvalidUnicode",Kk[Kk.InvalidEscapeCharacter=5]="InvalidEscapeCharacter",Kk[Kk.InvalidCharacter=6]="InvalidCharacter",(qk=$k||($k={}))[qk.Unknown=0]="Unknown",qk[qk.OpenBraceToken=1]="OpenBraceToken",qk[qk.CloseBraceToken=2]="CloseBraceToken",qk[qk.OpenBracketToken=3]="OpenBracketToken",qk[qk.CloseBracketToken=4]="CloseBracketToken",qk[qk.CommaToken=5]="CommaToken",qk[qk.ColonToken=6]="ColonToken",qk[qk.NullKeyword=7]="NullKeyword",qk[qk.TrueKeyword=8]="TrueKeyword",qk[qk.FalseKeyword=9]="FalseKeyword",qk[qk.StringLiteral=10]="StringLiteral",qk[qk.NumericLiteral=11]="NumericLiteral",qk[qk.LineCommentTrivia=12]="LineCommentTrivia",qk[qk.BlockCommentTrivia=13]="BlockCommentTrivia",qk[qk.LineBreakTrivia=14]="LineBreakTrivia",qk[qk.Trivia=15]="Trivia",qk[qk.EOF=16]="EOF",(jk=Gk||(Gk={}))[jk.InvalidSymbol=0]="InvalidSymbol",jk[jk.InvalidNumberFormat=1]="InvalidNumberFormat",jk[jk.PropertyNameExpected=2]="PropertyNameExpected",jk[jk.ValueExpected=3]="ValueExpected",jk[jk.ColonExpected=4]="ColonExpected",jk[jk.CommaExpected=5]="CommaExpected",jk[jk.CloseBraceExpected=6]="CloseBraceExpected",jk[jk.CloseBracketExpected=7]="CloseBracketExpected",jk[jk.EndOfFileExpected=8]="EndOfFileExpected"
class eI{constructor(e={},t=[],i=[]){this._contents=e,this._keys=t,this._overrides=i}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}getSectionContents(e){return this.contents[e]}setValue(e,t){this.addKey(e),fw(this._contents,e,t,e=>{throw new Error(e)})}removeValue(e){this.removeKey(e)&&_w(this._contents,e)}setValueInOverrides(e,t,i){let n=this._overrides.filter(t=>-1!==t.identifiers.indexOf(e))[0]
n||(n={identifiers:[e],contents:{}},this._overrides.push(n)),fw(n.contents,t,i,e=>{throw new Error(e)})}override(e){const t=this.getContentsForOverrideIdentifer(e)
if(!t||"object"!=typeof t||!Object.keys(t).length)return new eI(this._contents)
let i={}
for(const e of On([...Object.keys(this._contents),...Object.keys(t)])){let n=this._contents[e],s=t[e]
s&&("object"==typeof n&&"object"==typeof s?bw(n=Wn(n),s,!0):n=s),i[e]=n}return new eI(i)}merge(e,t=!0){const i=new eI
return this.doMerge(i,this,t),this.doMerge(i,e,t),i}doMerge(e,t,i=!0){bw(e.contents,Wn(t.contents),i)
const n=Wn(e._overrides)
for(const e of t._overrides){const[t]=n.filter(t=>In(t.identifiers,e.identifiers))
t?bw(t.contents,e.contents,i):n.push(e)}e._overrides=n,e._keys=On([...e._keys,...t.keys])}getContentsForOverrideIdentifer(e){for(const t of this._overrides)if(-1!==t.identifiers.indexOf(e))return t.contents
return null}addKey(e){let t=this._keys.length
for(let i=0;i<t;i++)0===e.indexOf(this._keys[i])&&(t=i)
this._keys.splice(t,1,e)}removeKey(e){let t=this._keys.indexOf(e)
return-1!==t&&(this._keys.splice(t,1),!0)}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}}class tI extends eI{constructor(){var e
super(function(){const e=Object.create(null),t=qr.as(cu.Configuration).getConfigurationProperties()
for(let i in t)fw(e,i,t[i].default,e=>console.error(`Conflict in default settings: ${e}`))
return e}()),this._keys=function(){const e=qr.as(cu.Configuration).getConfigurationProperties()
return Object.keys(e)}(),this._overrides=Object.keys(this._contents).filter(e=>Su.test(e)).map(t=>({identifiers:[(e=t,e.substring(1,e.length-1)).trim()],contents:function(e,t){const i=Object.create(null)
for(let n in e)fw(i,n,e[n],t)
return i}(this._contents[t],e=>console.error(`Conflict in default settings file: ${e}`))}))}get keys(){return this._keys}}class iI{constructor(e,t,i=new eI,n=new se,s=new eI,r=new se){this._defaults=e,this._user=t,this._workspaceConfiguration=i,this.folders=n,this._memoryConfiguration=s,this._memoryConfigurationByResource=r,this.merge()}get defaults(){return this._defaults}get user(){return this._user}get workspace(){return this._workspaceConfiguration}merge(){this._globalConfiguration=this._defaults.merge(this._user),this.updateWorkspaceConsolidateConfiguration(),this._foldersConsolidatedConfigurations=new se
for(const e of this.folders.keys())this.mergeFolder(e)}updateWorkspaceConsolidateConfiguration(){this._workspaceConsolidatedConfiguration=this._globalConfiguration.merge(this._workspaceConfiguration).merge(this._memoryConfiguration)}mergeFolder(e){this._foldersConsolidatedConfigurations.set(e,this._workspaceConsolidatedConfiguration.merge(this.folders.get(e)))}getSection(e="",t,i){const n=this.getConsolidateConfigurationModel(t,i)
return Wn(e?n.getSectionContents(e):n.contents)}getValue(e,t,i){return Wn(Cw(this.getConsolidateConfigurationModel(t,i).contents,e))}updateValue(e,t,i={}){let n
i.resource?(n=this._memoryConfigurationByResource.get(i.resource))||(n=new eI,this._memoryConfigurationByResource.set(i.resource,n)):n=this._memoryConfiguration,void 0===t?n.removeValue(e):n.setValue(e,t),i.resource||this.updateWorkspaceConsolidateConfiguration()}lookup(e,t,i){const n=this.getConsolidateConfigurationModel(t,i),s=this.getFolderConfigurationModelForResource(t.resource,i),r=t.resource&&this._memoryConfigurationByResource.get(t.resource)||this._memoryConfiguration
return Wn({default:Cw(t.overrideIdentifier?this._defaults.override(t.overrideIdentifier).contents:this._defaults.contents,e),user:Cw(t.overrideIdentifier?this._user.override(t.overrideIdentifier).contents:this._user.contents,e),workspace:i?Cw(t.overrideIdentifier?this._workspaceConfiguration.override(t.overrideIdentifier).contents:this._workspaceConfiguration.contents,e):void 0,workspaceFolder:s?Cw(t.overrideIdentifier?s.override(t.overrideIdentifier).contents:s.contents,e):void 0,memory:Cw(t.overrideIdentifier?r.override(t.overrideIdentifier).contents:r.contents,e),value:Cw(n.contents,e)})}keys(e){const t=this.getFolderConfigurationModelForResource(null,e)
return Wn({default:this._defaults.keys,user:this._user.keys,workspace:this._workspaceConfiguration.keys,workspaceFolder:t?t.keys:[]})}getConsolidateConfigurationModel(e,t){let i=this.getConsolidatedConfigurationModelForResource(e,t)
return e.overrideIdentifier?i.override(e.overrideIdentifier):i}getConsolidatedConfigurationModelForResource({resource:e},t){if(!t)return this._globalConfiguration
if(!e)return this._workspaceConsolidatedConfiguration
let i=this._workspaceConsolidatedConfiguration
const n=t.getFolder(e)
n&&(i=this._foldersConsolidatedConfigurations.get(n.uri)||this._workspaceConsolidatedConfiguration)
const s=this._memoryConfigurationByResource.get(e)
return s&&(i=i.merge(s)),i}getFolderConfigurationModelForResource(e,t){if(!t||!e)return null
const i=t.getFolder(e)
return i?this.folders.get(i.uri):null}toData(){return{defaults:{contents:this._defaults.contents,overrides:this._defaults.overrides,keys:this._defaults.keys},user:{contents:this._user.contents,overrides:this._user.overrides,keys:this._user.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:this.folders.keys().reduce((e,t)=>{const{contents:i,overrides:n,keys:s}=this.folders.get(t)
return e[t.toString()]={contents:i,overrides:n,keys:s},e},Object.create({}))}}static parse(e){const t=iI.parseConfigurationModel(e.defaults),i=iI.parseConfigurationModel(e.user),n=iI.parseConfigurationModel(e.workspace),s=Object.keys(e.folders).reduce((t,i)=>(t.set(X.parse(i),iI.parseConfigurationModel(e.folders[i])),t),new se)
return new iI(t,i,n,s,new eI,new se)}static parseConfigurationModel(e){return new eI(e.contents,e.keys,e.overrides)}}let nI=class e{constructor(t,i,n,s){this._id=t,this._commandService=n,this._contextKeyService=s,this._menuGroups=[],this._disposables=[],this._onDidChange=new ci,i.then(i=>{const n=so.getMenuItems(t),s=new Set
let r
n.sort(e._compareMenuItems)
for(let t of n){const i=t.group
r&&r[0]===i||(r=[i,[]],this._menuGroups.push(r)),r[1].push(t),e._fillInKbExprKeys(t.when,s)}this._disposables.push(this._contextKeyService.onDidChangeContext(e=>{if(e)for(let t of e)if(s.has(t))return void this._onDidChange.fire()})),this._onDidChange.fire(this)})}dispose(){this._disposables=ei(this._disposables),this._onDidChange.dispose()}get onDidChange(){return this._onDidChange.event}getActions(e){const t=[]
for(let i of this._menuGroups){const[n,s]=i,r=[]
for(const t of s)if(this._contextKeyService.contextMatchesRules(t.when)){const i=new oo(t.command,t.alt,e,this._commandService)
i.order=t.order,r.push(i)}r.length>0&&t.push([n,r])}return t}static _fillInKbExprKeys(e,t){if(e)for(let i of e.keys())t.add(i)}static _compareMenuItems(e,t){let i=e.group,n=t.group
if(i!==n){if(!i)return 1
if(!n)return-1
if("navigation"===i)return-1
if("navigation"===n)return 1
let e=i.localeCompare(n)
if(0!==e)return e}let s=e.order||0,r=t.order||0
if(s<r)return-1
if(s>r)return 1
const o="string"==typeof e.command.title?e.command.title:e.command.title.value,a="string"==typeof t.command.title?t.command.title:t.command.title.value
return o.localeCompare(a)}}
nI=Nn([En(2,Dr),En(3,Lo)],nI)
class sI{constructor(e,t,i,n,s){if(this.resolvedKeybinding=e,e){let[t,i]=e.getDispatchParts()
this.keypressFirstPart=t,this.keypressChordPart=i}else this.keypressFirstPart=null,this.keypressChordPart=null
this.bubble=!!t&&94===t.charCodeAt(0),this.command=this.bubble?t.substr(1):t,this.commandArgs=i,this.when=n,this.isDefault=s}}class rI{constructor(e){this._widget=e}getId(){return"editor"}getControl(){return this._widget}getSelection(){return this._widget.getSelection()}focus(){this._widget.focus()}isVisible(){return!0}withTypedEditor(e,t){return p(this._widget)?e(this._widget):t(this._widget)}}class oI{constructor(e){this.model=e,this._onDispose=new ci}get onDispose(){return this._onDispose.event}load(){return bt.as(this)}get textEditorModel(){return this.model}dispose(){this._onDispose.fire()}}class aI{constructor(){this.openEditorDelegate=null}setEditor(e){this.editor=new rI(e)}setOpenEditorDelegate(e){this.openEditorDelegate=e}openEditor(e,t){return bt.as(this.editor.withTypedEditor(t=>this.doOpenEditor(t,e),t=>this.doOpenEditor(t.getOriginalEditor(),e)||this.doOpenEditor(t.getModifiedEditor(),e)))}doOpenEditor(e,t){if(!this.findModel(e,t)){if(t.resource){if(this.openEditorDelegate)return this.openEditorDelegate(t.resource.toString()),null
{let e=t.resource.scheme
if(e===ru.http||e===ru.https)return Hl(t.resource.toString()),this.editor}}return null}let i=t.options.selection
if(i)if("number"==typeof i.endLineNumber&&"number"==typeof i.endColumn)e.setSelection(i),e.revealRangeInCenter(i,1)
else{let t={lineNumber:i.startLineNumber,column:i.startColumn}
e.setPosition(t),e.revealPositionInCenter(t,1)}return this.editor}findModel(e,t){let i=e.getModel()
return i.uri.toString()!==t.resource.toString()?null:i}}class lI{setEditor(e){this.editor=new rI(e)}createModelReference(e){let t
return(t=this.editor.withTypedEditor(t=>this.findModel(t,e),t=>this.findModel(t.getOriginalEditor(),e)||this.findModel(t.getModifiedEditor(),e)))?bt.as(new si(new oI(t))):bt.as(new si(null))}registerTextModelContentProvider(e,t){return{dispose:function(){}}}findModel(e,t){let i=e.getModel()
return i.uri.toString()!==t.toString()?null:i}}class hI{show(){return hI.NULL_PROGRESS_RUNNER}showWhile(e,t){return null}}hI.NULL_PROGRESS_RUNNER={done:()=>{},total:()=>{},worked:()=>{}}
class dI{show(e,t){switch(e){case ew.Error:console.error(t)
break
case ew.Warning:console.warn(t)
break
default:console.log(t)}return dI.Empty}hideAll(){}confirmSync(e){let t=e.message
return e.detail&&(t=t+"\n\n"+e.detail),window.confirm(t)}confirm(e){return bt.as({confirmed:this.confirmSync(e)})}}dI.Empty=function(){}
class uI{constructor(e){this._onWillExecuteCommand=new ci,this.onWillExecuteCommand=this._onWillExecuteCommand.event,this._instantiationService=e,this._dynamicCommands=Object.create(null)}addCommand(e){const{id:t}=e
return this._dynamicCommands[t]=e,{dispose:()=>{delete this._dynamicCommands[t]}}}executeCommand(e,...t){const i=Tr.getCommand(e)||this._dynamicCommands[e]
if(!i)return bt.wrapError(new Error(`command '${e}' not found`))
try{this._onWillExecuteCommand.fire({commandId:e})
const n=this._instantiationService.invokeFunction.apply(this._instantiationService,[i.handler].concat(t))
return bt.as(n)}catch(e){return bt.wrapError(e)}}}class cI extends Xk{constructor(e,t,i,n,s){super(e,t,i,n),this._cachedResolver=null,this._dynamicKeybindings=[],this.toDispose.push(il(s,kl.KEY_DOWN,e=>{let t=new Wa(e)
this._dispatch(t,t.target)&&t.preventDefault()}))}addDynamicKeybinding(e,t,i,n){let s=[]
this._dynamicKeybindings.push({keybinding:Vr(t,W),command:e,when:n,weight1:1e3,weight2:0}),s.push({dispose:()=>{for(let t=0;t<this._dynamicKeybindings.length;t++){if(this._dynamicKeybindings[t].command===e)return this._dynamicKeybindings.splice(t,1),void this.updateResolver({source:Q_.Default})}}})
let r=this._commandService
if(!(r instanceof uI))throw new Error("Unknown command service!")
return s.push(r.addCommand({id:e,handler:i})),this.updateResolver({source:Q_.Default}),ti(s)}updateResolver(e){this._cachedResolver=null,this._onDidUpdateKeybindings.fire(e)}_getResolver(){if(!this._cachedResolver){const e=this._toNormalizedKeybindingItems(jr.getDefaultKeybindings(),!0),t=this._toNormalizedKeybindingItems(this._dynamicKeybindings,!1)
this._cachedResolver=new Qk(e,t)}return this._cachedResolver}_toNormalizedKeybindingItems(e,t){let i=[],n=0
for(let s=0,r=e.length;s<r;s++){const r=e[s],o=r.when?r.when.normalize():null,a=r.keybinding
if(a){const e=this.resolveKeybinding(a)
for(let s=0;s<e.length;s++)i[n++]=new sI(e[s],r.command,r.commandArgs,o,t)}else i[n++]=new sI(null,r.command,r.commandArgs,o,t)}return i}resolveKeybinding(e){return[new Jk(e,W)]}resolveKeyboardEvent(e){let t=new Hr(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,e.keyCode)
return new Jk(t,W)}resolveUserBinding(e){return[]}}function gI(e){return e&&"object"==typeof e&&(!e.overrideIdentifier||"string"==typeof e.overrideIdentifier)&&(!e.resource||e.resource instanceof X)}class mI{constructor(e){this._commandService=e}createMenu(e,t){return new nI(e,bt.as(!0),this._commandService,t)}}class pI{constructor(){this._onDidChangeWorkspaceName=new ci,this.onDidChangeWorkspaceName=this._onDidChangeWorkspaceName.event,this._onDidChangeWorkspaceFolders=new ci,this.onDidChangeWorkspaceFolders=this._onDidChangeWorkspaceFolders.event,this._onDidChangeWorkbenchState=new ci,this.onDidChangeWorkbenchState=this._onDidChangeWorkbenchState.event
const e=X.from({scheme:pI.SCHEME,authority:"model",path:"/"})
this.workspace={id:"4064f6ec-cb38-4ad0-af64-ee6467e63c82",folders:[new Vw({uri:e,name:"",index:0})],name:e.fsPath}}getWorkspace(){return this.workspace}getWorkbenchState(){return this.workspace?this.workspace.configuration?Fw.WORKSPACE:Fw.FOLDER:Fw.EMPTY}getWorkspaceFolder(e){return e&&e.scheme===pI.SCHEME?this.workspace.folders[0]:void 0}isInsideWorkspace(e){return e&&e.scheme===pI.SCHEME}toResource(e,t){return X.file(e)}isCurrentWorkspace(e){return!0}}const fI=Ir("themeService")
let _I=0,CI=!1
function bI(){var e
CI||(CI=!0,e=document.body,(CC=document.createElement("div")).className="monaco-aria-container",(bC=document.createElement("div")).className="monaco-alert",bC.setAttribute("role","alert"),bC.setAttribute("aria-atomic","true"),CC.appendChild(bC),(wC=document.createElement("div")).className="monaco-status",wC.setAttribute("role","status"),wC.setAttribute("aria-atomic","true"),CC.appendChild(wC),e.appendChild(CC))}let wI=class extends Fv{constructor(e,t,i,n,s,r,o,a){(t=t||{}).ariaLabel=t.ariaLabel||Jt("editorViewAccessibleLabel","Editor content"),t.ariaLabel=t.ariaLabel+";"+(xa?Jt("accessibilityHelpMessageIE","Press Ctrl+F1 for Accessibility Options."):Jt("accessibilityHelpMessage","Press Alt+F1 for Accessibility Options.")),super(e,t,i,n,s,r,a),o instanceof cI&&(this._standaloneKeybindingService=o),bI()}addCommand(e,t,i){if(!this._standaloneKeybindingService)return console.warn("Cannot add command because the editor is configured with an unrecognized KeybindingService"),null
let n="DYNAMIC_"+ ++_I,s=_o.deserialize(i)
return this._standaloneKeybindingService.addDynamicKeybinding(n,e,t,s),n}createContextKey(e,t){return this._contextKeyService.createKey(e,t)}addAction(e){if("string"!=typeof e.id||"string"!=typeof e.label||"function"!=typeof e.run)throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!")
if(!this._standaloneKeybindingService)return console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),Qt
const t=e.id,i=e.label,n=_o.and(_o.equals("editorId",this.getId()),_o.deserialize(e.precondition)),s=e.keybindings,r=_o.and(n,_o.deserialize(e.keybindingContext)),o=e.contextMenuGroupId||null,a=e.contextMenuOrder||0,l=()=>{const t=e.run(this)
return t||bt.as(void 0)}
let h=[]
const d=this.getId()+":"+t
if(h.push(Tr.registerCommand(d,l)),o){let e={command:{id:d,title:i},when:n,group:o,order:a}
h.push(so.appendMenuItem(io.EditorContext,e))}Array.isArray(s)&&(h=h.concat(s.map(e=>this._standaloneKeybindingService.addDynamicKeybinding(d,e,l,r))))
let u=new Xf(d,i,i,n,l,this._contextKeyService)
return this._actions[t]=u,h.push({dispose:()=>{delete this._actions[t]}}),ti(h)}}
wI=Nn([En(2,Er),En(3,Eo),En(4,Dr),En(5,Lo),En(6,tC),En(7,Mg)],wI)
let vI=class extends wI{constructor(e,t,i,n,s,r,o,a,l,h){"string"==typeof(t=t||{}).theme&&h.setTheme(t.theme)
let d=t.model
if(delete t.model,super(e,t,n,s,r,o,a,h),this._contextViewService=l,this._register(i),void 0===d?(d=self.monaco.editor.createModel(t.value||"",t.language||"text/plain"),this._ownsModel=!0):this._ownsModel=!1,this._attachModel(d),d){let e={oldModelUrl:null,newModelUrl:d.uri}
this._onDidChangeModel.fire(e)}}dispose(){super.dispose()}destroy(){this.dispose()}_attachModel(e){super._attachModel(e),this._view&&this._contextViewService.setContainer(this._view.domNode.domNode)}_postDetachModelCleanup(e){super._postDetachModelCleanup(e),e&&this._ownsModel&&(e.dispose(),this._ownsModel=!1)}}
vI=Nn([En(3,Er),En(4,Eo),En(5,Dr),En(6,Lo),En(7,tC),En(8,X_),En(9,fI)],vI)
class SI extends It{constructor(e,t,i={}){super(),U_(e).addClass("monaco-menu-container")
let n=U_(".monaco-menu").appendTo(e)
this.actionBar=new Z_(n,{orientation:G_.VERTICAL,actionItemProvider:i.actionItemProvider,context:i.context,actionRunner:i.actionRunner,isMenu:!0}),this.listener=this.addEmitter(this.actionBar),this.actionBar.push(t,{icon:!0,label:!0})}focus(){this.actionBar.focus(!0)}dispose(){super.dispose(),this.actionBar&&(this.actionBar.dispose(),this.actionBar=null),this.listener&&(this.listener.dispose(),this.listener=null)}}class yI{constructor(e,t,i,n){this.setContainer(e),this.contextViewService=t,this.telemetryService=i,this.messageService=n,this.actionRunner=new Qr,this.menuContainerElement=null,this.toDispose=[]
let s=!1
this.toDispose.push(this.actionRunner.addListener(Xr.BEFORE_RUN,e=>{this.telemetryService&&this.telemetryService.publicLog("workbenchActionExecuted",{id:e.action.id,from:"contextMenu"}),(s=!!e.retainActionItem)||this.contextViewService.hideContextView(!1)})),this.toDispose.push(this.actionRunner.addListener(Xr.RUN,e=>{s&&this.contextViewService.hideContextView(!1),s=!1,e.error&&this.messageService&&this.messageService.show(ew.Error,e.error)}))}setContainer(e){this.$el&&(this.$el.off(["click","mousedown"]),this.$el=null),e&&(this.$el=U_(e),this.$el.on("mousedown",e=>this.onMouseDown(e)))}showContextMenu(e){e.getActions().done(t=>{this.contextViewService.showContextView({getAnchor:()=>e.getAnchor(),canRelayout:!1,render:i=>{this.menuContainerElement=i
let n=e.getMenuClassName?e.getMenuClassName():""
n&&(i.className+=" "+n)
let s=new SI(i,t,{actionItemProvider:e.getActionItem,context:e.getActionsContext?e.getActionsContext():null,actionRunner:this.actionRunner}),r=s.addListener(Xr.CANCEL,e=>{this.contextViewService.hideContextView(!0)}),o=s.addListener(Xr.BLUR,e=>{this.contextViewService.hideContextView(!0)})
return s.focus(),ti([r,o,s])},onHide:t=>{e.onHide&&e.onHide(t),this.menuContainerElement=null}})})}onMouseDown(e){if(!this.menuContainerElement)return
let t=new Ka(e).target
for(;t;){if(t===this.menuContainerElement)return
t=t.parentElement}this.contextViewService.hideContextView()}dispose(){this.setContainer(null)}}class xI{constructor(e,t,i,n){this.contextMenuHandler=new yI(e,n,t,i)}dispose(){this.contextMenuHandler.dispose()}setContainer(e){this.contextMenuHandler.setContainer(e)}showContextMenu(e){this.contextMenuHandler.showContextMenu(e)}}let LI=class{constructor(e,t,i){this.contextView=new NC(e)}dispose(){this.contextView.dispose()}setContainer(e){this.contextView.setContainer(e)}showContextView(e){this.contextView.show(e)}layout(){this.contextView.layout()}hideContextView(e){this.contextView.hide(e)}}
LI=Nn([En(1,cw),En(2,tw)],LI)
class NI{constructor(e){this._hashFn=e,this._nodes=Object.create(null)}roots(){const e=[]
return tL(this._nodes,t=>{ct(t.value.outgoing)&&e.push(t.value)}),e}traverse(e,t,i){const n=this.lookup(e)
n&&this._traverse(n,t,Object.create(null),i)}_traverse(e,t,i,n){const s=this._hashFn(e.data)
i[s]||(i[s]=!0,n(e.data),tL(t?e.outgoing:e.incoming,e=>this._traverse(e.value,t,i,n)))}insertEdge(e,t){const i=this.lookupOrInsertNode(e),n=this.lookupOrInsertNode(t)
i.outgoing[this._hashFn(t)]=n,n.incoming[this._hashFn(e)]=i}removeNode(e){const t=this._hashFn(e)
delete this._nodes[t],tL(this._nodes,e=>{delete e.value.outgoing[t],delete e.value.incoming[t]})}lookupOrInsertNode(e){const t=this._hashFn(e)
let i=this._nodes[t]
return i||(i={data:e,incoming:Object.create(null),outgoing:Object.create(null)},this._nodes[t]=i),i}lookup(e){return this._nodes[this._hashFn(e)]}get length(){return Object.keys(this._nodes).length}toString(){let e=[]
return tL(this._nodes,t=>{e.push(`${t.key}, (incoming)[${Object.keys(t.value.incoming).join(", ")}], (outgoing)[${Object.keys(t.value.outgoing).join(",")}]`)}),e.join("\n")}}class EI{constructor(e=new zl,t=!1){this._services=e,this._strict=t,this._services.set(Er,this)}createChild(e){return this._services.forEach((t,i)=>{e.has(t)||(i instanceof to&&(i=this._createAndCacheServiceInstance(t,i)),e.set(t,i))}),new EI(e,this._strict)}invokeFunction(e,...t){let i
try{return i={get:(e,t)=>{const i=this._getOrCreateServiceInstance(e)
if(!i&&t!==Mr)throw new Error(`[invokeFunction] unkown service '${e}'`)
return i}},e.apply(void 0,[i].concat(t))}finally{i.get=function(){throw(e="service accessor is only valid during the invocation of its target method")?new Error(`Illegal state: ${e}`):new Error("Illegal state")
var e}}}createInstance(e,...t){return e instanceof to?this._createInstance(e,t):this._createInstance(new to(e),t)}_createInstance(e,t){let i=e.staticArguments().concat(t),n=Sr.getServiceDependencies(e.ctor).sort((e,t)=>e.index-t.index),s=[]
for(const t of n){let i=this._getOrCreateServiceInstance(t.id)
if(!i&&this._strict&&!t.optional)throw new Error(`[createInstance] ${e.ctor.name} depends on UNKNOWN service ${t.id}.`)
s.push(i)}let r=n.length>0?n[0].index:i.length
if(i.length!==r){console.warn(`[createInstance] First service dependency of ${e.ctor.name} at position ${r+1} conflicts with ${i.length} static arguments`)
let t=r-i.length
i=t>0?i.concat(new Array(t)):i.slice(0,r)}const o=[e.ctor]
o.push(...i),o.push(...s)
const a=function(e,...t){return new e(...t)}.apply(null,o)
return e._validate(a),a}_getOrCreateServiceInstance(e){let t=this._services.get(e)
return t instanceof to?this._createAndCacheServiceInstance(e,t):t}_createAndCacheServiceInstance(e,t){$r(this._services.get(e)instanceof to)
const i=new NI(e=>e.id.toString())
function n(){const e=new Error("[createInstance] cyclic dependency between services")
throw e.message=i.toString(),e}let s=0
const r=[{id:e,desc:t}]
for(;r.length;){const t=r.pop()
i.lookupOrInsertNode(t),s++>100&&n()
let o=Sr.getServiceDependencies(t.desc.ctor)
for(let n of o){let s=this._services.get(n.id)
if(s||console.warn(`[createInstance] ${e} depends on ${n.id} which is NOT registered.`),s instanceof to){const e={id:n.id,desc:s}
i.insertEdge(t,e),r.push(e)}}}for(;;){let e=i.roots()
if(0===e.length){0!==i.length&&n()
break}for(let t of e){const e=this._createInstance(t.data.desc,[])
this._services.set(t.data.id,e),i.removeNode(t.data)}}return this._services.get(e)}}var kI
!function(e){e.get=function(e,t,i){if(e[t])return e[t][i]},e.set=function(e,t,i,n){e[t]||(e[t]=Object.create(null)),e[t][i]=n},e.remove=function(e,t,i){return!(!e[t]||!e[t][i]||(delete e[t][i],ct(e[t])&&delete e[t],0))}}(kI||(kI={}))
class II{constructor(e){this.errors=0,this.infos=0,this.warnings=0,this.unknowns=0,this._data=Object.create(null),this._service=e,this._subscription=e.onMarkerChanged(this._update,this)}dispose(){this._subscription.dispose(),this._data=void 0}_update(e){for(const t of e){const e=t.toString(),i=this._data[e]
i&&this._substract(i)
const n=this._resourceStats(t)
this._add(n),this._data[e]=n}}_resourceStats(e){const t={errors:0,warnings:0,infos:0,unknowns:0}
if(e.scheme===ru.inMemory||e.scheme===ru.walkThrough||e.scheme===ru.walkThroughSnippet)return t
for(const{severity:i}of this._service.read({resource:e}))i===ew.Error?t.errors+=1:i===ew.Warning?t.warnings+=1:i===ew.Info?t.infos+=1:t.unknowns+=1
return t}_substract(e){this.errors-=e.errors,this.warnings-=e.warnings,this.infos-=e.infos,this.unknowns-=e.unknowns}_add(e){this.errors+=e.errors,this.warnings+=e.warnings,this.infos+=e.infos,this.unknowns+=e.unknowns}}class MI{constructor(){this._onMarkerChanged=new ci,this._onMarkerChangedEvent=gi(this._onMarkerChanged.event,MI._debouncer,0),this._byResource=Object.create(null),this._byOwner=Object.create(null),this._stats=new II(this)}dispose(){this._stats.dispose()}get onMarkerChanged(){return this._onMarkerChangedEvent}getStatistics(){return this._stats}remove(e,t){if(!Tn(t))for(const i of t)this.changeOne(e,i,void 0)}changeOne(e,t,i){if(Tn(i)){const i=kI.remove(this._byResource,t.toString(),e),n=kI.remove(this._byOwner,e,t.toString())
if(i!==n)throw new Error("invalid marker service state")
i&&n&&this._onMarkerChanged.fire([t])}else{const n=[]
for(const s of i){const i=MI._toMarker(e,t,s)
i&&n.push(i)}kI.set(this._byResource,t.toString(),e,n),kI.set(this._byOwner,e,t.toString(),n),this._onMarkerChanged.fire([t])}}static _toMarker(e,t,i){let{code:n,severity:s,message:r,source:o,startLineNumber:a,startColumn:l,endLineNumber:h,endColumn:d}=i
if(r)return{resource:t,owner:e,code:n=n||null,severity:s,message:r,source:o,startLineNumber:a=a>0?a:1,startColumn:l=l>0?l:1,endLineNumber:h=h>=a?h:a,endColumn:d=d>0?d:l}}changeAll(e,t){const i=[],n=this._byOwner[e]
if(n){delete this._byOwner[e]
for(const t in n){const[n]=kI.get(this._byResource,t,e)
n&&i.push(n.resource),kI.remove(this._byResource,t,e)}}if(!Tn(t)){const n=Object.create(null)
for(const{resource:s,marker:r}of t){const t=MI._toMarker(e,s,r)
if(!t)continue
const o=n[s.toString()]
o?o.push(t):(n[s.toString()]=[t],i.push(s))}for(const t in n)kI.set(this._byResource,t,e,n[t]),kI.set(this._byOwner,e,t,n[t])}i.length>0&&this._onMarkerChanged.fire(i)}read(e=Object.create(null)){let{owner:t,resource:i,take:n}=e
if((!n||n<0)&&(n=-1),t&&i){const e=kI.get(this._byResource,i.toString(),t)
return e?e.slice(0,n>0?n:void 0):[]}if(t||i){const e=t?this._byOwner[t]:this._byResource[i.toString()]
if(!e)return[]
const s=[]
for(const t in e)for(const i of e[t]){const e=s.push(i)
if(n>0&&e===n)return s}return s}{const e=[]
for(const t in this._byResource)for(const i in this._byResource[t])for(const s of this._byResource[t][i]){const t=e.push(s)
if(n>0&&t===n)return e}return e}}static _debouncer(e,t){e||(MI._dedupeMap=Object.create(null),e=[])
for(const i of t)void 0===MI._dedupeMap[i.toString()]&&(MI._dedupeMap[i.toString()]=!0,e.push(i))
return e}}const DI="$initialize"
let TI=!1
function OI(e){D&&(TI||(TI=!0,console.warn("Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/Microsoft/monaco-editor#faq")),console.warn(e.message))}class RI{constructor(e){this._workerId=-1,this._handler=e,this._lastSentReq=0,this._pendingReplies=Object.create(null)}setWorkerId(e){this._workerId=e}sendMessage(e,t){let i=String(++this._lastSentReq),n={c:null,e:null},s=new bt((e,t,i)=>{n.c=e,n.e=t},()=>{})
return this._pendingReplies[i]=n,this._send({vsWorker:this._workerId,req:i,method:e,args:t}),s}handleMessage(e){let t
try{t=JSON.parse(e)}catch(e){}t.vsWorker&&(-1!==this._workerId&&t.vsWorker!==this._workerId||this._handleMessage(t))}_handleMessage(e){if(e.seq){let t=e
if(!this._pendingReplies[t.seq])return void console.warn("Got reply to unknown seq")
let i=this._pendingReplies[t.seq]
if(delete this._pendingReplies[t.seq],t.err){let e=t.err
return t.err.$isError&&((e=new Error).name=t.err.name,e.message=t.err.message,e.stack=t.err.stack),void i.e(e)}return void i.c(t.res)}let t=e,i=t.req
this._handler.handleMessage(t.method,t.args).then(e=>{this._send({vsWorker:this._workerId,seq:i,res:e,err:void 0})},e=>{this._send({vsWorker:this._workerId,seq:i,res:void 0,err:function(e){if(e instanceof Error){let{name:t,message:i}=e
return{$isError:!0,name:t,message:i,stack:e.stacktrace||e.stack}}return e}(e)})})}_send(e){let t=JSON.stringify(e)
this._handler.sendMessage(t)}}class AI extends ni{constructor(e,t){super(),this._lastRequestTimestamp=-1
let i=null,n=null
this._worker=this._register(e.create("vs/base/common/worker/simpleWorker",e=>{this._protocol.handleMessage(e)},e=>{n(e)})),this._protocol=new RI({sendMessage:e=>{this._worker.postMessage(e)},handleMessage:(e,t)=>bt.as(null)}),this._protocol.setWorkerId(this._worker.getId())
let s=null,r=self.require
"function"==typeof r.getConfig?s=r.getConfig():void 0!==self.requirejs&&(s=self.requirejs.s.contexts._.config),this._lazyProxy=new bt((e,t,s)=>{i=e,n=t},()=>{}),this._onModuleLoaded=this._protocol.sendMessage(DI,[this._worker.getId(),t,s]),this._onModuleLoaded.then(e=>{let t={}
for(let i=0;i<e.length;i++)t[e[i]]=a(e[i],o)
i(t)},e=>{n(e),this._onError("Worker failed to load "+t,e)})
let o=(e,t)=>this._request(e,t),a=(e,t)=>(function(){let i=Array.prototype.slice.call(arguments,0)
return t(e,i)})}getProxyObject(){return new ga(this._lazyProxy)}getLastRequestTimestamp(){return this._lastRequestTimestamp}_request(e,t){return new bt((i,n,s)=>{this._onModuleLoaded.then(()=>{this._lastRequestTimestamp=Date.now(),this._protocol.sendMessage(e,t).then(i,n)},n)},()=>{})}_onError(e,t){console.error(e),console.info(t)}}var PI=function(e,t=!1){if(O.MonacoEnvironment&&O.MonacoEnvironment.hasOwnProperty(e))return O.MonacoEnvironment[e]
return t}("getWorkerUrl",null)||function(e,t){return require.toUrl("./"+e)+"#"+t}
class FI{constructor(e,t,i,n,s){this.id=t,this.worker=new Worker(PI("workerMain.js",i)),this.postMessage(e),this.worker.onmessage=function(e){n(e.data)},"function"==typeof this.worker.addEventListener&&this.worker.addEventListener("error",s)}getId(){return this.id}postMessage(e){this.worker&&this.worker.postMessage(e)}dispose(){this.worker.terminate(),this.worker=null}}class WI{constructor(e){this._label=e,this._webWorkerFailedBeforeError=!1}create(e,t,i){let n=++WI.LAST_WORKER_ID
if(this._webWorkerFailedBeforeError)throw this._webWorkerFailedBeforeError
return new FI(e,n,this._label||"anonymous"+n,t,e=>{OI(e),this._webWorkerFailedBeforeError=e,i(e)})}}WI.LAST_WORKER_ID=0
const VI=5e3,BI=3
function HI(e,t,i,n){return new mv(e,t,i).ComputeDiff(n)}class zI{constructor(e,t,i){this.buffer=e,this.startMarkers=t,this.endMarkers=i}equals(e){if(!(e instanceof zI))return!1
const t=e
if(this.getLength()!==t.getLength())return!1
for(let e=0,i=this.getLength();e<i;e++){if(this.getElementHash(e)!==t.getElementHash(e))return!1}return!0}getLength(){return this.startMarkers.length}getElementHash(e){return this.buffer.substring(this.startMarkers[e].offset,this.endMarkers[e].offset)}getStartLineNumber(e){return e===this.startMarkers.length?this.startMarkers[e-1].lineNumber+1:this.startMarkers[e].lineNumber}getStartColumn(e){return this.startMarkers[e].column}getEndLineNumber(e){return this.endMarkers[e].lineNumber}getEndColumn(e){return this.endMarkers[e].column}}class UI extends zI{constructor(e){let t="",i=[],n=[]
for(let s=0,r=0,o=e.length;r<o;r++){t+=e[r]
const o=UI._getFirstNonBlankColumn(e[r],1),a=UI._getLastNonBlankColumn(e[r],1)
i.push({offset:s+o-1,lineNumber:r+1,column:o}),n.push({offset:s+a-1,lineNumber:r+1,column:a}),s+=e[r].length}super(t,i,n)}static _getFirstNonBlankColumn(e,t){const i=Le(e)
return-1===i?t:i+1}static _getLastNonBlankColumn(e,t){const i=Ee(e)
return-1===i?t:i+2}getCharSequence(e,t){let i=[],n=[]
for(let s=e;s<=t;s++){const e=this.startMarkers[s],t=this.endMarkers[s]
for(let s=e.offset;s<t.offset;s++)i.push({offset:s,lineNumber:e.lineNumber,column:e.column+(s-e.offset)}),n.push({offset:s+1,lineNumber:e.lineNumber,column:e.column+(s-e.offset)+1})}return new zI(this.buffer,i,n)}}class KI{constructor(e,t,i,n,s,r,o,a){this.originalStartLineNumber=e,this.originalStartColumn=t,this.originalEndLineNumber=i,this.originalEndColumn=n,this.modifiedStartLineNumber=s,this.modifiedStartColumn=r,this.modifiedEndLineNumber=o,this.modifiedEndColumn=a}static createFromDiffChange(e,t,i){let n,s,r,o,a,l,h,d
return 0===e.originalLength?(n=0,s=0,r=0,o=0):(n=t.getStartLineNumber(e.originalStart),s=t.getStartColumn(e.originalStart),r=t.getEndLineNumber(e.originalStart+e.originalLength-1),o=t.getEndColumn(e.originalStart+e.originalLength-1)),0===e.modifiedLength?(a=0,l=0,h=0,d=0):(a=i.getStartLineNumber(e.modifiedStart),l=i.getStartColumn(e.modifiedStart),h=i.getEndLineNumber(e.modifiedStart+e.modifiedLength-1),d=i.getEndColumn(e.modifiedStart+e.modifiedLength-1)),new KI(n,s,r,o,a,l,h,d)}}class $I{constructor(e,t,i,n,s){this.originalStartLineNumber=e,this.originalEndLineNumber=t,this.modifiedStartLineNumber=i,this.modifiedEndLineNumber=n,this.charChanges=s}static createFromDiffResult(e,t,i,n,s){let r,o,a,l,h
if(0===e.originalLength?(r=t.getStartLineNumber(e.originalStart)-1,o=0):(r=t.getStartLineNumber(e.originalStart),o=t.getEndLineNumber(e.originalStart+e.originalLength-1)),0===e.modifiedLength?(a=i.getStartLineNumber(e.modifiedStart)-1,l=0):(a=i.getStartLineNumber(e.modifiedStart),l=i.getEndLineNumber(e.modifiedStart+e.modifiedLength-1)),0!==e.originalLength&&0!==e.modifiedLength&&n()){const r=t.getCharSequence(e.originalStart,e.originalStart+e.originalLength-1),o=i.getCharSequence(e.modifiedStart,e.modifiedStart+e.modifiedLength-1)
let a=HI(r,o,n,!1)
s&&(a=function(e){if(e.length<=1)return e
let t=[e[0]],i=t[0]
for(let n=1,s=e.length;n<s;n++){const s=e[n],r=s.originalStart-(i.originalStart+i.originalLength),o=s.modifiedStart-(i.modifiedStart+i.modifiedLength)
Math.min(r,o)<BI?(i.originalLength=s.originalStart+s.originalLength-i.originalStart,i.modifiedLength=s.modifiedStart+s.modifiedLength-i.modifiedStart):(t.push(s),i=s)}return t}(a)),h=[]
for(let e=0,t=a.length;e<t;e++)h.push(KI.createFromDiffChange(a[e],r,o))}return new $I(r,o,a,l,h)}}class qI{constructor(e,t,i){this.shouldPostProcessCharChanges=i.shouldPostProcessCharChanges,this.shouldIgnoreTrimWhitespace=i.shouldIgnoreTrimWhitespace,this.shouldMakePrettyDiff=i.shouldMakePrettyDiff,this.maximumRunTimeMs=VI,this.originalLines=e,this.modifiedLines=t,this.original=new UI(e),this.modified=new UI(t),i.shouldConsiderTrimWhitespaceInEmptyCase&&this.shouldIgnoreTrimWhitespace&&this.original.equals(this.modified)&&(this.shouldIgnoreTrimWhitespace=!1)}computeDiff(){if(1===this.original.getLength()&&0===this.original.getElementHash(0).length)return[{originalStartLineNumber:1,originalEndLineNumber:1,modifiedStartLineNumber:1,modifiedEndLineNumber:this.modified.getLength(),charChanges:[{modifiedEndColumn:0,modifiedEndLineNumber:0,modifiedStartColumn:0,modifiedStartLineNumber:0,originalEndColumn:0,originalEndLineNumber:0,originalStartColumn:0,originalStartLineNumber:0}]}]
if(1===this.modified.getLength()&&0===this.modified.getElementHash(0).length)return[{originalStartLineNumber:1,originalEndLineNumber:this.original.getLength(),modifiedStartLineNumber:1,modifiedEndLineNumber:1,charChanges:[{modifiedEndColumn:0,modifiedEndLineNumber:0,modifiedStartColumn:0,modifiedStartLineNumber:0,originalEndColumn:0,originalEndLineNumber:0,originalStartColumn:0,originalStartLineNumber:0}]}]
this.computationStartTime=(new Date).getTime()
let e=HI(this.original,this.modified,this._continueProcessingPredicate.bind(this),this.shouldMakePrettyDiff)
if(this.shouldIgnoreTrimWhitespace){let t=[]
for(let i=0,n=e.length;i<n;i++)t.push($I.createFromDiffResult(e[i],this.original,this.modified,this._continueProcessingPredicate.bind(this),this.shouldPostProcessCharChanges))
return t}let t=[],i=0,n=0
for(let s=-1,r=e.length;s<r;s++){const o=s+1<r?e[s+1]:null,a=o?o.originalStart:this.originalLines.length,l=o?o.modifiedStart:this.modifiedLines.length
for(;i<a&&n<l;){const e=this.originalLines[i],s=this.modifiedLines[n]
if(e!==s){{let r=UI._getFirstNonBlankColumn(e,1),o=UI._getFirstNonBlankColumn(s,1)
for(;r>1&&o>1;){if(e.charCodeAt(r-2)!==s.charCodeAt(o-2))break
r--,o--}(r>1||o>1)&&this._pushTrimWhitespaceCharChange(t,i+1,1,r,n+1,1,o)}{let r=UI._getLastNonBlankColumn(e,1),o=UI._getLastNonBlankColumn(s,1)
const a=e.length+1,l=s.length+1
for(;r<a&&o<l;){if(e.charCodeAt(r-1)!==e.charCodeAt(o-1))break
r++,o++}(r<a||o<l)&&this._pushTrimWhitespaceCharChange(t,i+1,r,a,n+1,o,l)}}i++,n++}o&&(t.push($I.createFromDiffResult(o,this.original,this.modified,this._continueProcessingPredicate.bind(this),this.shouldPostProcessCharChanges)),i+=o.originalLength,n+=o.modifiedLength)}return t}_pushTrimWhitespaceCharChange(e,t,i,n,s,r,o){this._mergeTrimWhitespaceCharChange(e,t,i,n,s,r,o)||e.push(new $I(t,t,s,s,[new KI(t,i,t,n,s,r,s,o)]))}_mergeTrimWhitespaceCharChange(e,t,i,n,s,r,o){const a=e.length
if(0===a)return!1
const l=e[a-1]
return 0!==l.originalEndLineNumber&&0!==l.modifiedEndLineNumber&&(l.originalEndLineNumber+1===t&&l.modifiedEndLineNumber+1===s&&(l.originalEndLineNumber=t,l.modifiedEndLineNumber=s,l.charChanges.push(new KI(t,i,t,n,s,r,s,o)),!0))}_continueProcessingPredicate(){if(0===this.maximumRunTimeMs)return!0
return(new Date).getTime()-this.computationStartTime<this.maximumRunTimeMs}}class GI{constructor(e,t,i,n){this._uri=e,this._lines=t,this._eol=i,this._versionId=n}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._lines.join(this._eol)}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null)
const t=e.changes
for(let e=0,i=t.length;e<i;e++){const i=t[e]
this._acceptDeleteRange(i.range),this._acceptInsertText({lineNumber:i.range.startLineNumber,column:i.range.startColumn},i.text)}this._versionId=e.versionId}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,i=new Uint32Array(t)
for(let n=0;n<t;n++)i[n]=this._lines[n].length+e
this._lineStarts=new Xi(i)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.changeValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber!==e.endLineNumber)this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)
else{if(e.startColumn===e.endColumn)return
this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1))}}_acceptInsertText(e,t){if(0===t.length)return
let i=t.split(/\r\n|\r|\n/)
if(1===i.length)return void this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]+this._lines[e.lineNumber-1].substring(e.column-1))
i[i.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0])
let n=new Uint32Array(i.length-1)
for(let t=1;t<i.length;t++)this._lines.splice(e.lineNumber+t-1,0,i[t]),n[t-1]=i[t].length+this._eol.length
this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,n)}}class jI{constructor(e){let t=0,i=0
for(let n=0,s=e.length;n<s;n++){let[s,r,o]=e[n]
r>t&&(t=r),s>i&&(i=s),o>i&&(i=o)}let n=new Gi(++i,++t,0)
for(let t=0,i=e.length;t<i;t++){let[i,s,r]=e[t]
n.set(i,s,r)}this._states=n,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?0:this._states.get(e,t)}}let YI=null
let ZI=null
class XI{static _createLink(e,t,i,n,s){let r=s-1
do{const i=t.charCodeAt(r)
if(2!==e.get(i))break
r--}while(r>n)
if(n>0){const e=t.charCodeAt(n-1),i=t.charCodeAt(r);(40===e&&41===i||91===e&&93===i||123===e&&125===i)&&r--}return{range:{startLineNumber:i,startColumn:n+1,endLineNumber:i,endColumn:r+2},url:t.substring(n,r+1)}}static computeLinks(e){const t=(null===YI&&(YI=new jI([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),YI),i=function(){if(null===ZI){ZI=new Qi(0)
const e=" \t<>'\"、。｡､，．：；？！＠＃＄％＆＊‘“〈《「『【〔（［｛｢｣｝］）〕】』」》〉”’｀～…"
for(let t=0;t<e.length;t++)ZI.set(e.charCodeAt(t),1)
const t=".,;"
for(let e=0;e<t.length;e++)ZI.set(t.charCodeAt(e),2)}return ZI}()
let n=[]
for(let s=1,r=e.getLineCount();s<=r;s++){const r=e.getLineContent(s),o=r.length
let a=0,l=0,h=0,d=1,u=!1,c=!1,g=!1
for(;a<o;){let e=!1
const o=r.charCodeAt(a)
if(13===d){let t
switch(o){case 40:u=!0,t=0
break
case 41:t=u?0:1
break
case 91:c=!0,t=0
break
case 93:t=c?0:1
break
case 123:g=!0,t=0
break
case 125:t=g?0:1
break
case 39:t=34===h||96===h?0:1
break
case 34:t=39===h||96===h?0:1
break
case 96:t=39===h||34===h?0:1
break
default:t=i.get(o)}1===t&&(n.push(XI._createLink(i,r,s,l,a)),e=!0)}else if(12===d){1===i.get(o)?e=!0:d=13}else 0===(d=t.nextState(d,o))&&(e=!0)
e&&(d=1,u=!1,c=!1,g=!1,l=a+1,h=o),a++}13===d&&n.push(XI._createLink(i,r,s,l,o))}return n}}class JI{constructor(){this._defaultValueSet=[["true","false"],["True","False"],["Private","Public","Friend","ReadOnly","Partial","Protected","WriteOnly"],["public","protected","private"]]}navigateValueSet(e,t,i,n,s){if(e&&t){let i=this.doNavigateValueSet(t,s)
if(i)return{range:e,value:i}}if(i&&n){let e=this.doNavigateValueSet(n,s)
if(e)return{range:i,value:e}}return null}doNavigateValueSet(e,t){let i=this.numberReplace(e,t)
return null!==i?i:this.textReplace(e,t)}numberReplace(e,t){var i=Math.pow(10,e.length-(e.lastIndexOf(".")+1)),n=Number(e),s=parseFloat(e)
return isNaN(n)||isNaN(s)||n!==s?null:0!==n||t?(n=Math.floor(n*i),n+=t?i:-i,String(n/i)):null}textReplace(e,t){return this.valueSetsReplace(this._defaultValueSet,e,t)}valueSetsReplace(e,t,i){var n=null
for(let s=0,r=e.length;null===n&&s<r;s++)n=this.valueSetReplace(e[s],t,i)
return n}valueSetReplace(e,t,i){var n=e.indexOf(t)
return n>=0?((n+=i?1:-1)<0?n=e.length-1:n%=e.length,e[n]):null}}JI.INSTANCE=new JI
class QI extends GI{get uri(){return this._uri}get version(){return this._versionId}get eol(){return this._eol}getValue(){return this.getText()}getLinesContent(){return this._lines.slice(0)}getLineCount(){return this._lines.length}getLineContent(e){return this._lines[e-1]}getWordAtPosition(e,i){let n=Ni(e.column,Li(i),this._lines[e.lineNumber-1],0)
return n?new t(e.lineNumber,n.startColumn,e.lineNumber,n.endColumn):null}getWordUntilPosition(e,t){var i=this.getWordAtPosition(e,t)
return i?{word:this._lines[e.lineNumber-1].substring(i.startColumn-1,e.column-1),startColumn:i.startColumn,endColumn:e.column}:{word:"",startColumn:e.column,endColumn:e.column}}_getAllWords(e){var t=[]
return this._lines.forEach(i=>{this._wordenize(i,e).forEach(e=>{t.push(i.substring(e.start,e.end))})}),t}getAllUniqueWords(e,t){var i=!1,n=Object.create(null)
return this._getAllWords(e).filter(e=>t&&!i&&t===e?(i=!0,!1):!n[e]&&(n[e]=!0,!0))}_wordenize(e,t){const i=[]
let n
for(t.lastIndex=0;(n=t.exec(e))&&0!==n[0].length;)i.push({start:n.index,end:n.index+n[0].length})
return i}getValueInRange(e){if((e=this._validateRange(e)).startLineNumber===e.endLineNumber)return this._lines[e.startLineNumber-1].substring(e.startColumn-1,e.endColumn-1)
var t=this._eol,i=e.startLineNumber-1,n=e.endLineNumber-1,s=[]
s.push(this._lines[i].substring(e.startColumn-1))
for(var r=i+1;r<n;r++)s.push(this._lines[r])
return s.push(this._lines[n].substring(0,e.endColumn-1)),s.join(t)}offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getAccumulatedValue(e.lineNumber-2)+(e.column-1)}positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts()
let t=this._lineStarts.getIndexOf(e),i=this._lines[t.index].length
return{lineNumber:1+t.index,column:1+Math.min(t.remainder,i)}}_validateRange(e){const t=this._validatePosition({lineNumber:e.startLineNumber,column:e.startColumn}),i=this._validatePosition({lineNumber:e.endLineNumber,column:e.endColumn})
return t.lineNumber!==e.startLineNumber||t.column!==e.startColumn||i.lineNumber!==e.endLineNumber||i.column!==e.endColumn?{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:i.lineNumber,endColumn:i.column}:e}_validatePosition(t){if(!e.isIPosition(t))throw new Error("bad position")
let{lineNumber:i,column:n}=t,s=!1
if(i<1)i=1,n=1,s=!0
else if(i>this._lines.length)i=this._lines.length,n=this._lines[i-1].length+1,s=!0
else{let e=this._lines[i-1].length+1
n<1?(n=1,s=!0):n>e&&(n=e,s=!0)}return s?{lineNumber:i,column:n}:t}}class eM{constructor(){this._foreignModule=null}computeDiff(e,t,i){let n=this._getModel(e),s=this._getModel(t)
if(!n||!s)return null
let r=n.getLinesContent(),o=s.getLinesContent(),a=new qI(r,o,{shouldPostProcessCharChanges:!0,shouldIgnoreTrimWhitespace:i,shouldConsiderTrimWhitespaceInEmptyCase:!0,shouldMakePrettyDiff:!0})
return bt.as(a.computeDiff())}computeDirtyDiff(e,t,i){let n=this._getModel(e),s=this._getModel(t)
if(!n||!s)return null
let r=n.getLinesContent(),o=s.getLinesContent(),a=new qI(r,o,{shouldPostProcessCharChanges:!1,shouldIgnoreTrimWhitespace:i,shouldConsiderTrimWhitespaceInEmptyCase:!1,shouldMakePrettyDiff:!0})
return bt.as(a.computeDiff())}computeMoreMinimalEdits(e,i){const n=this._getModel(e)
if(!n)return bt.as(i)
const s=[]
let r
for(let{range:e,text:l,eol:h}of i){if("number"==typeof h&&(r=h),!e)continue
const i=n.getValueInRange(e)
if(i===(l=l.replace(/\r\n|\n|\r/g,n.eol)))continue
if(Math.max(l.length,i.length)>eM._diffLimit){s.push({range:e,text:l})
continue}const d=(o=l,a=!1,new mv(lv(i),lv(o)).ComputeDiff(a)),u=n.offsetAt(t.lift(e).getStartPosition())
for(const e of d){const t=n.positionAt(u+e.originalStart),i=n.positionAt(u+e.originalStart+e.originalLength),r={text:l.substr(e.modifiedStart,e.modifiedLength),range:{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:i.lineNumber,endColumn:i.column}}
n.getValueInRange(r.range)!==r.text&&s.push(r)}}var o,a
return"number"==typeof r&&s.push({eol:r,text:void 0,range:void 0}),bt.as(s)}computeLinks(e){let t=this._getModel(e)
return t?bt.as((i=t)&&"function"==typeof i.getLineCount&&"function"==typeof i.getLineContent?XI.computeLinks(i):[]):null
var i}textualSuggest(e,t,i,n){const s=this._getModel(e)
if(s){const e=[],r=new RegExp(i,n),o=s.getWordUntilPosition(t,r).word
for(const t of s.getAllUniqueWords(r))t!==o&&isNaN(Number(t))&&e.push({type:"text",label:t,insertText:t,noAutoAccept:!0,overwriteBefore:o.length})
return bt.as({suggestions:e})}}navigateValueSet(e,t,i,n,s){let r=this._getModel(e)
if(!r)return null
let o=new RegExp(n,s)
t.startColumn===t.endColumn&&(t={startLineNumber:t.startLineNumber,startColumn:t.startColumn,endLineNumber:t.endLineNumber,endColumn:t.endColumn+1})
let a=r.getValueInRange(t),l=r.getWordAtPosition({lineNumber:t.startLineNumber,column:t.startColumn},o),h=null
null!==l&&(h=r.getValueInRange(l))
let d=JI.INSTANCE.navigateValueSet(t,a,l,h,i)
return bt.as(d)}loadForeignModule(e,t){return new bt((i,n)=>{self.require([e],e=>{let n={getMirrorModels:()=>this._getModels()}
this._foreignModule=e.create(n,t)
let s=[]
for(let e in this._foreignModule)"function"==typeof this._foreignModule[e]&&s.push(e)
i(s)},n)})}fmr(e,t){if(!this._foreignModule||"function"!=typeof this._foreignModule[e])return bt.wrapError(new Error("Missing requestHandler or method: "+e))
try{return bt.as(this._foreignModule[e].apply(this._foreignModule,t))}catch(e){return bt.wrapError(e)}}}eM._diffLimit=1e4
class tM extends eM{constructor(){super(),this._models=Object.create(null)}dispose(){this._models=Object.create(null)}_getModel(e){return this._models[e]}_getModels(){let e=[]
return Object.keys(this._models).forEach(t=>e.push(this._models[t])),e}acceptNewModel(e){this._models[e.url]=new QI(X.parse(e.url),e.lines,e.EOL,e.versionId)}acceptModelChanged(e,t){if(!this._models[e])return
this._models[e].onEvents(t)}acceptRemovedModel(e){this._models[e]&&delete this._models[e]}}var iM=self
"function"==typeof iM.importScripts&&(iM.monaco=Zk())
const nM=Ir("textResourceConfigurationService"),sM=6e4,rM=3e5
function oM(e,t){let i=e.getModel(t)
return!!i&&!i.isTooLargeForTokenization()}let aM=class extends ni{constructor(e,t,i){super(),this._modelService=e,this._workerManager=this._register(new class extends ni{constructor(e){super(),this._modelService=e,this._editorWorkerClient=null
let t=this._register(new _a)
t.cancelAndSet(()=>this._checkStopIdleWorker(),Math.round(rM/2)),this._register(this._modelService.onModelRemoved(e=>this._checkStopEmptyWorker()))}dispose(){this._editorWorkerClient&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null),super.dispose()}_checkStopEmptyWorker(){if(!this._editorWorkerClient)return
let e=this._modelService.getModels()
0===e.length&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}_checkStopIdleWorker(){if(!this._editorWorkerClient)return
let e=(new Date).getTime()-this._lastWorkerUsedTime
e>rM&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}withWorker(){return this._lastWorkerUsedTime=(new Date).getTime(),this._editorWorkerClient||(this._editorWorkerClient=new dM(this._modelService,"editorWorkerService")),bt.as(this._editorWorkerClient)}}(this._modelService)),this._register(qs.register("*",{provideLinks:(e,t)=>oM(this._modelService,e.uri)?function(e,t,i){const n=e.onCancellationRequested(()=>t.cancel())
return i&&(t=t.then(void 0,e=>{if(!Lt(e))return bt.wrapError(e)})),ma(t,()=>n.dispose())}(t,this._workerManager.withWorker().then(t=>t.computeLinks(e.uri))):bt.as([])})),this._register(Os.register("*",new class{constructor(e,t,i,n){this._workerManager=e,this._configurationService=t,this._modeService=i,this._modelService=n}provideCompletionItems(e,t){const{wordBasedSuggestions:i}=this._configurationService.getConfiguration(e.uri,t,"editor")
if(i&&oM(this._modelService,e.uri))return this._workerManager.withWorker().then(i=>i.textualSuggest(e.uri,t))}}(this._workerManager,t,i,this._modelService)))}dispose(){super.dispose()}canComputeDiff(e,t){return oM(this._modelService,e)&&oM(this._modelService,t)}computeDiff(e,t,i){return this._workerManager.withWorker().then(n=>n.computeDiff(e,t,i))}canComputeDirtyDiff(e,t){return oM(this._modelService,e)&&oM(this._modelService,t)}computeDirtyDiff(e,t,i){return this._workerManager.withWorker().then(n=>n.computeDirtyDiff(e,t,i))}computeMoreMinimalEdits(e,t){return Array.isArray(t)&&0!==t.length&&oM(this._modelService,e)?this._workerManager.withWorker().then(i=>i.computeMoreMinimalEdits(e,t)):bt.as(t)}canNavigateValueSet(e){return oM(this._modelService,e)}navigateValueSet(e,t,i){return this._workerManager.withWorker().then(n=>n.navigateValueSet(e,t,i))}}
aM=Nn([En(0,Zr),En(1,nM),En(2,XS)],aM)
class lM extends ni{constructor(e,t,i){if(super(),this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),this._proxy=e,this._modelService=t,!i){let e=new _a
e.cancelAndSet(()=>this._checkStopModelSync(),Math.round(sM/2)),this._register(e)}}dispose(){for(let e in this._syncedModels)ei(this._syncedModels[e])
this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),super.dispose()}esureSyncedResources(e){for(let t=0;t<e.length;t++){let i=e[t],n=i.toString()
this._syncedModels[n]||this._beginModelSync(i),this._syncedModels[n]&&(this._syncedModelsLastUsedTime[n]=(new Date).getTime())}}_checkStopModelSync(){let e=(new Date).getTime(),t=[]
for(let i in this._syncedModelsLastUsedTime){e-this._syncedModelsLastUsedTime[i]>sM&&t.push(i)}for(let e=0;e<t.length;e++)this._stopModelSync(t[e])}_beginModelSync(e){let t=this._modelService.getModel(e)
if(!t)return
if(t.isTooLargeForTokenization())return
let i=e.toString()
this._proxy.acceptNewModel({url:t.uri.toString(),lines:t.getLinesContent(),EOL:t.getEOL(),versionId:t.getVersionId()})
let n=[]
n.push(t.onDidChangeContent(e=>{this._proxy.acceptModelChanged(i.toString(),e)})),n.push(t.onWillDispose(()=>{this._stopModelSync(i)})),n.push({dispose:()=>{this._proxy.acceptRemovedModel(i)}}),this._syncedModels[i]=n}_stopModelSync(e){let t=this._syncedModels[e]
delete this._syncedModels[e],delete this._syncedModelsLastUsedTime[e],ei(t)}}class hM{constructor(e){this._instance=e,this._proxyObj=bt.as(this._instance)}dispose(){this._instance.dispose(),this._instance=null,this._proxyObj=null}getProxyObject(){return new ga(this._proxyObj)}}class dM extends ni{constructor(e,t){super(),this._modelService=e,this._workerFactory=new WI(t),this._worker=null,this._modelManager=null}_getOrCreateWorker(){if(!this._worker)try{this._worker=this._register(new AI(this._workerFactory,"vs/editor/common/services/editorSimpleWorker"))}catch(e){OI(e),this._worker=new hM(new tM)}return this._worker}_getProxy(){return new ga(this._getOrCreateWorker().getProxyObject().then(null,e=>(OI(e),this._worker=new hM(new tM),this._getOrCreateWorker().getProxyObject())))}_getOrCreateModelManager(e){return this._modelManager||(this._modelManager=this._register(new lM(e,this._modelService,!1))),this._modelManager}_withSyncedResources(e){return this._getProxy().then(t=>(this._getOrCreateModelManager(t).esureSyncedResources(e),t))}computeDiff(e,t,i){return this._withSyncedResources([e,t]).then(n=>n.computeDiff(e.toString(),t.toString(),i))}computeDirtyDiff(e,t,i){return this._withSyncedResources([e,t]).then(n=>n.computeDirtyDiff(e.toString(),t.toString(),i))}computeMoreMinimalEdits(e,t){return this._withSyncedResources([e]).then(i=>i.computeMoreMinimalEdits(e.toString(),t))}computeLinks(e){return this._withSyncedResources([e]).then(t=>t.computeLinks(e.toString()))}textualSuggest(e,t){return this._withSyncedResources([e]).then(i=>{let n=this._modelService.getModel(e)
if(!n)return null
let s=cr.getWordDefinition(n.getLanguageIdentifier().id),r=s.source,o=(s.global?"g":"")+(s.ignoreCase?"i":"")+(s.multiline?"m":"")
return i.textualSuggest(e.toString(),t,r,o)})}navigateValueSet(e,t,i){return this._withSyncedResources([e]).then(n=>{let s=this._modelService.getModel(e)
if(!s)return null
let r=cr.getWordDefinition(s.getLanguageIdentifier().id),o=r.source,a=(r.global?"g":"")+(r.ignoreCase?"i":"")+(r.multiline?"m":"")
return n.navigateValueSet(e.toString(),t,i,o,a)})}}class uM{constructor(e){this._languageIdentifier=e}getId(){return this._languageIdentifier.language}getLanguageIdentifier(){return this._languageIdentifier}}const cM="text/plain",gM="application/unknown"
let mM=[],pM=[],fM=[]
function _M(e){const t={id:(i=e).id,mime:i.mime,filename:i.filename,extension:i.extension,filepattern:i.filepattern,firstline:i.firstline,userConfigured:i.userConfigured,filenameLowercase:i.filename?i.filename.toLowerCase():void 0,extensionLowercase:i.extension?i.extension.toLowerCase():void 0,filepatternLowercase:i.filepattern?i.filepattern.toLowerCase():void 0,filepatternOnPath:!!i.filepattern&&i.filepattern.indexOf(Un)>=0}
var i
mM.push(t),t.userConfigured?fM.push(t):pM.push(t),t.userConfigured||mM.forEach(e=>{e.mime===t.mime||e.userConfigured||(t.extension&&e.extension===t.extension&&console.warn(`Overwriting extension <<${t.extension}>> to now point to mime <<${t.mime}>>`),t.filename&&e.filename===t.filename&&console.warn(`Overwriting filename <<${t.filename}>> to now point to mime <<${t.mime}>>`),t.filepattern&&e.filepattern===t.filepattern&&console.warn(`Overwriting filepattern <<${t.filepattern}>> to now point to mime <<${t.mime}>>`),t.firstline&&e.firstline===t.firstline&&console.warn(`Overwriting firstline <<${t.firstline}>> to now point to mime <<${t.mime}>>`))})}function CM(e,t){if(!e)return[gM]
let i=qn(e=e.toLowerCase()),n=bM(e,i,fM)
if(n)return[n,cM]
let s=bM(e,i,pM)
if(s)return[s,cM]
if(t){let e=function(e){Qe(e)&&(e=e.substr(1))
if(e.length>0)for(let t=0;t<mM.length;++t){let i=mM[t]
if(!i.firstline)continue
let n=e.match(i.firstline)
if(n&&n.length>0)return i.mime}return null}(t)
if(e)return[e,cM]}return[gM]}function bM(e,t,i){let n,s,r
for(let o=i.length-1;o>=0;o--){let a=i[o]
if(t===a.filenameLowercase){n=a
break}if(a.filepattern&&(!s||a.filepattern.length>s.filepattern.length)){let i=a.filepatternOnPath?e:t
bs(a.filepatternLowercase,i)&&(s=a)}a.extension&&(!r||a.extension.length>r.extension.length)&&_e(t,a.extensionLowercase)&&(r=a)}return n?n.mime:s?s.mime:r?r.mime:null}var wM=new class{constructor(){this._onDidAddLanguages=new ci,this.onDidAddLanguages=this._onDidAddLanguages.event,this._languages=[]}registerLanguage(e){this._languages.push(e),this._onDidAddLanguages.fire([e])}registerLanguages(e){this._languages=this._languages.concat(e),this._onDidAddLanguages.fire(e)}getLanguages(){return this._languages.slice(0)}}
qr.add("editor.modesRegistry",wM)
const vM="plaintext",SM=new ys(vM,1)
wM.registerLanguage({id:vM,extensions:[".txt",".gitignore"],aliases:[Jt("plainText.alias","Plain Text"),"text"],mimetypes:["text/plain"]}),cr.register(SM,{brackets:[["(",")"],["[","]"],["{","}"]]})
var yM=Object.prototype.hasOwnProperty
class xM{constructor(e=!0){this._nextLanguageId=1,this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},this._languageIds=[],e&&(this._registerLanguages(wM.getLanguages()),wM.onDidAddLanguages(e=>this._registerLanguages(e)))}_registerLanguages(e){if(0!==e.length){for(let t=0;t<e.length;t++)this._registerLanguage(e[t])
this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Object.keys(this._languages).forEach(e=>{let t=this._languages[e]
t.name&&(this._nameMap[t.name]=t.identifier),t.aliases.forEach(e=>{this._lowercaseNameMap[e.toLowerCase()]=t.identifier}),t.mimetypes.forEach(e=>{this._mimeTypesMap[e]=t.identifier})}),qr.as(cu.Configuration).registerOverrideIdentifiers(wM.getLanguages().map(e=>e.id))}}_registerLanguage(e){const t=e.id
let i=null
if(yM.call(this._languages,t))i=this._languages[t]
else{let e=this._nextLanguageId++
i={identifier:new ys(t,e),name:null,mimetypes:[],aliases:[],extensions:[],filenames:[],configurationFiles:[]},this._languageIds[e]=t,this._languages[t]=i}xM._mergeLanguage(i,e)}static _mergeLanguage(e,t){const i=t.id
let n=null
if(void 0!==t.mimetypes&&Array.isArray(t.mimetypes))for(let i=0;i<t.mimetypes.length;i++)n||(n=t.mimetypes[i]),e.mimetypes.push(t.mimetypes[i])
if(n||(n=`text/x-${i}`,e.mimetypes.push(n)),Array.isArray(t.extensions))for(let s of t.extensions)_M({id:i,mime:n,extension:s}),e.extensions.push(s)
if(Array.isArray(t.filenames))for(let s of t.filenames)_M({id:i,mime:n,filename:s}),e.filenames.push(s)
if(Array.isArray(t.filenamePatterns))for(let e of t.filenamePatterns)_M({id:i,mime:n,filepattern:e})
if("string"==typeof t.firstLine&&t.firstLine.length>0){let e=t.firstLine
"^"!==e.charAt(0)&&(e="^"+e)
try{let t=new RegExp(e)
be(t)||_M({id:i,mime:n,firstline:t})}catch(e){St(e)}}e.aliases.push(i)
let s=null
if(void 0!==t.aliases&&Array.isArray(t.aliases)&&(s=0===t.aliases.length?[null]:t.aliases),null!==s)for(let t=0;t<s.length;t++)s[t]&&0!==s[t].length&&e.aliases.push(s[t])
let r=null!==s&&s.length>0
if(r&&null===s[0]);else{let t=(r?s[0]:null)||i
!r&&e.name||(e.name=t)}"string"==typeof t.configuration&&e.configurationFiles.push(t.configuration)}isRegisteredMode(e){return!!yM.call(this._mimeTypesMap,e)||yM.call(this._languages,e)}getRegisteredModes(){return Object.keys(this._languages)}getRegisteredLanguageNames(){return Object.keys(this._nameMap)}getLanguageName(e){return yM.call(this._languages,e)?this._languages[e].name:null}getModeIdForLanguageNameLowercase(e){return yM.call(this._lowercaseNameMap,e)?this._lowercaseNameMap[e].language:null}getConfigurationFiles(e){return yM.call(this._languages,e)&&this._languages[e].configurationFiles||[]}getMimeForMode(e){if(!yM.call(this._languages,e))return null
return this._languages[e].mimetypes[0]||null}extractModeIds(e){return e?e.split(",").map(e=>e.trim()).map(e=>yM.call(this._mimeTypesMap,e)?this._mimeTypesMap[e].language:e).filter(e=>yM.call(this._languages,e)):[]}getLanguageIdentifier(e){if(e===_h||0===e)return Ch
let t
if("string"==typeof e)t=e
else if(!(t=this._languageIds[e]))return null
return yM.call(this._languages,t)?this._languages[t].identifier:null}getModeIdsFromLanguageName(e){return e&&yM.call(this._nameMap,e)?[this._nameMap[e].language]:[]}getModeIdsFromFilenameOrFirstLine(e,t){if(!e&&!t)return[]
var i=CM(e,t)
return this.extractModeIds(i.join(","))}getExtensions(e){if(!yM.call(this._nameMap,e))return[]
const t=this._nameMap[e]
return this._languages[t.language].extensions}getFilenames(e){if(!yM.call(this._nameMap,e))return[]
const t=this._nameMap[e]
return this._languages[t.language].filenames}}function LM(e){return e.toString()}class NM{static setMarkers(e,t){let i=t.read({resource:e.model.uri,take:500}).map(t=>({range:this._createDecorationRange(e.model,t),options:this._createDecorationOption(t)}))
e.acceptMarkerDecorations(i)}static _createDecorationRange(e,i){let n=e.validateRange(new t(i.startLineNumber,i.startColumn,i.endLineNumber,i.endColumn)),s=new t(n.startLineNumber,n.startColumn,n.endLineNumber,n.endColumn)
if(s.isEmpty()){let i=e.getWordAtPosition(s.getStartPosition())
if(i)s=new t(s.startLineNumber,i.startColumn,s.endLineNumber,i.endColumn)
else{let i=e.getLineLastNonWhitespaceColumn(n.startLineNumber)||e.getLineMaxColumn(n.startLineNumber)
1===i||(s=s.endColumn>=i?new t(s.startLineNumber,i-1,s.endLineNumber,i):new t(s.startLineNumber,s.startColumn,s.endLineNumber,s.endColumn+1))}}else if(i.endColumn===Number.MAX_VALUE&&1===i.startColumn&&s.startLineNumber===s.endLineNumber){let n=e.getLineFirstNonWhitespaceColumn(i.startLineNumber)
n<s.endColumn&&(s=new t(s.startLineNumber,n,s.endLineNumber,s.endColumn),i.startColumn=n)}return s}static _createDecorationOption(e){let t,n,s
switch(e.severity){case ew.Ignore:break
case ew.Warning:t=qh.EditorWarningDecoration,n=Dg(om),s=Dg(om)
break
case ew.Info:t=qh.EditorInfoDecoration,n=Dg(am),s=Dg(am)
break
case ew.Error:default:t=qh.EditorErrorDecoration,n=Dg(rm),s=Dg(rm)}let r=null,{message:o,source:a}=e
return"string"==typeof o&&(o=o.trim(),a&&(o=/\n/g.test(o)?Jt("diagAndSourceMultiline","[{0}]\n{1}",a,o):Jt("diagAndSource","[{0}] {1}",a,o)),r=(new Mh).appendCodeblock("_",o)),{stickiness:d.NeverGrowsWhenTypingAtEdges,className:t,hoverMessage:r,showIfCollapsed:!0,overviewRuler:{color:n,darkColor:s,position:i.Right}}}}const EM=I||k?o.LF:o.CRLF
let kM=class e{constructor(e,t){this._markerService=e,this._configurationService=t,this._models={},this._modelCreationOptionsByLanguageAndResource=Object.create(null),this._onModelAdded=new ci,this._onModelRemoved=new ci,this._onModelModeChanged=new ci,this._markerService&&(this._markerServiceSubscription=this._markerService.onMarkerChanged(this._handleMarkerChange,this)),this._configurationServiceSubscription=this._configurationService.onDidChangeConfiguration(e=>this._updateModelOptions()),this._updateModelOptions()}static _readModelOptions(e){let t=$i.tabSize
if(e.editor&&void 0!==e.editor.tabSize){let i=parseInt(e.editor.tabSize,10)
isNaN(i)||(t=i)}let i=$i.insertSpaces
e.editor&&void 0!==e.editor.insertSpaces&&(i="false"!==e.editor.insertSpaces&&Boolean(e.editor.insertSpaces))
let n=EM
const s=e.files&&e.files.eol
"\r\n"===s?n=o.CRLF:"\n"===s&&(n=o.LF)
let r=$i.trimAutoWhitespace
e.editor&&void 0!==e.editor.trimAutoWhitespace&&(r="false"!==e.editor.trimAutoWhitespace&&Boolean(e.editor.trimAutoWhitespace))
let a=$i.detectIndentation
return e.editor&&void 0!==e.editor.detectIndentation&&(a="false"!==e.editor.detectIndentation&&Boolean(e.editor.detectIndentation)),{tabSize:t,insertSpaces:i,detectIndentation:a,defaultEOL:n,trimAutoWhitespace:r}}getCreationOptions(t,i){let n=this._modelCreationOptionsByLanguageAndResource[t+i]
return n||(n=e._readModelOptions(this._configurationService.getConfiguration({overrideIdentifier:t,resource:i})),this._modelCreationOptionsByLanguageAndResource[t+i]=n),n}_updateModelOptions(){let t=this._modelCreationOptionsByLanguageAndResource
this._modelCreationOptionsByLanguageAndResource=Object.create(null)
let i=Object.keys(this._models)
for(let n=0,s=i.length;n<s;n++){let s=i[n],r=this._models[s]
const o=r.model.getLanguageIdentifier().language,a=r.model.uri,l=t[o+a],h=this.getCreationOptions(o,a)
e._setModelOptionsForModel(r.model,h,l)}}static _setModelOptionsForModel(e,t,i){i&&i.detectIndentation===t.detectIndentation&&i.insertSpaces===t.insertSpaces&&i.tabSize===t.tabSize&&i.trimAutoWhitespace===t.trimAutoWhitespace||(t.detectIndentation?(e.detectIndentation(t.insertSpaces,t.tabSize),e.updateOptions({trimAutoWhitespace:t.trimAutoWhitespace})):e.updateOptions({insertSpaces:t.insertSpaces,tabSize:t.tabSize,trimAutoWhitespace:t.trimAutoWhitespace}))}dispose(){this._markerServiceSubscription&&this._markerServiceSubscription.dispose(),this._configurationServiceSubscription.dispose()}_handleMarkerChange(e){e.forEach(e=>{let t=LM(e),i=this._models[t]
i&&NM.setMarkers(i,this._markerService)})}_cleanUp(e){e.uri.scheme!==ru.inMemory&&e.uri.scheme!==ru.internal&&e.uri.scheme!==ru.vscode||this._markerService&&this._markerService.read({resource:e.uri}).map(e=>e.owner).forEach(t=>this._markerService.remove(t,[e.uri])),delete this._modelCreationOptionsByLanguageAndResource[e.getLanguageIdentifier().language+e.uri]}_createModelData(e,t,i){const n=this.getCreationOptions(t.language,i),s="string"==typeof e?dn.fromString(e):e
let r=new Pv(s,n,t,i),o=LM(r.uri)
if(this._models[o])throw new Error("ModelService: Cannot add model because it already exists!")
let a=new class{constructor(e,t){this.model=e,this._markerDecorations=[],this._modelEventsListener=e.addBulkListener(e=>t(this,e))}dispose(){this._markerDecorations=this.model.deltaDecorations(this._markerDecorations,[]),this._modelEventsListener.dispose(),this._modelEventsListener=null,this.model=null}getModelId(){return LM(this.model.uri)}acceptMarkerDecorations(e){this._markerDecorations=this.model.deltaDecorations(this._markerDecorations,e)}}(r,(e,t)=>this._onModelEvents(e,t))
return this._models[o]=a,a}updateModel(t,i){let n=this.getCreationOptions(t.getLanguageIdentifier().language,t.uri)
const s=un.create(i,n.defaultEOL)
t.equals(s)||(t.setEOL("\r\n"===s.EOL?l.CRLF:l.LF),t.pushEditOperations([new At(1,1,1,1)],e._computeEdits(t,s),e=>[new At(1,1,1,1)]))}static _computeEdits(e,i){const n=new class{getLength(){return e.getLineCount()}getElementHash(t){return e.getLineContent(t+1)}},s=new class{getLength(){return i.lines.length}getElementHash(e){return i.lines[e]}},r=new mv(n,s).ComputeDiff(!1)
let o=[],a=0
const l=e.getLineCount()
for(let n=0,s=r.length;n<s;n++){const s=r[n],h=s.originalStart,d=s.originalLength,u=s.modifiedStart,c=s.modifiedLength
let g=[]
for(let e=0;e<c;e++)g[e]=i.lines[u+e]
let m,p=g.join("\n")
if(0===d)if(h===l){const i=e.getLineMaxColumn(l)
m=new t(l,i,l,i),p="\n"+p}else m=new t(h+1,1,h+1,1),p+="\n"
else m=0===c?h+d>=l?new t(h,e.getLineMaxColumn(h),h+d,e.getLineMaxColumn(h+d)):new t(h+1,1,h+d+1,1):new t(h+1,1,h+d,e.getLineMaxColumn(h+d))
o[a++]=C_.replace(m,p)}return o}createModel(e,t,i){let n
return!t||bt.is(t)?(n=this._createModelData(e,SM,i),this.setMode(n.model,t)):n=this._createModelData(e,t.getLanguageIdentifier(),i),this._markerService&&NM.setMarkers(n,this._markerService),this._onModelAdded.fire(n.model),n.model}setMode(e,t){t&&(bt.is(t)?t.then(t=>{e.isDisposed()||e.setMode(t.getLanguageIdentifier())}):e.setMode(t.getLanguageIdentifier()))}destroyModel(e){let t=this._models[LM(e)]
t&&t.model.dispose()}getModels(){let e=[],t=Object.keys(this._models)
for(let i=0,n=t.length;i<n;i++){let n=t[i]
e.push(this._models[n].model)}return e}getModel(e){let t=LM(e),i=this._models[t]
return i?i.model:null}get onModelAdded(){return this._onModelAdded?this._onModelAdded.event:null}get onModelRemoved(){return this._onModelRemoved?this._onModelRemoved.event:null}get onModelModeChanged(){return this._onModelModeChanged?this._onModelModeChanged.event:null}_onModelDisposing(e){let t=LM(e.uri),i=this._models[t]
delete this._models[t],i.dispose(),this._cleanUp(e),this._onModelRemoved.fire(e)}_onModelEvents(t,i){for(let e=0,n=i.length;e<n;e++){if(i[e].type===cn.ModelDispose)return void this._onModelDisposing(t.model)}for(let n=0,s=i.length;n<s;n++){let s=i[n]
if(s.type===cn.ModelLanguageChanged){const i=t.model,n=s.data.oldLanguage,r=i.getLanguageIdentifier().language,o=this.getCreationOptions(n,i.uri),a=this.getCreationOptions(r,i.uri)
e._setModelOptionsForModel(i,a,o),this._onModelModeChanged.fire({model:i,oldModeId:n})}}}}
kM=Nn([En(0,ay),En(1,gw)],kM)
class IM{constructor(e,t,i){this.uri=e,this._values={},t.onWillDispose(()=>i._removeWatcher(this))}set(e,t){this._values[e]=t}get(e){return this._values[e]}}let MM=class extends class{constructor(){this._transientWatchers={},this._codeEditors=Object.create(null),this._diffEditors=Object.create(null),this._onCodeEditorAdd=new ci,this._onCodeEditorRemove=new ci,this._onDiffEditorAdd=new ci,this._onDiffEditorRemove=new ci}addCodeEditor(e){this._codeEditors[e.getId()]=e,this._onCodeEditorAdd.fire(e)}get onCodeEditorAdd(){return this._onCodeEditorAdd.event}removeCodeEditor(e){delete this._codeEditors[e.getId()]&&this._onCodeEditorRemove.fire(e)}get onCodeEditorRemove(){return this._onCodeEditorRemove.event}getCodeEditor(e){return this._codeEditors[e]||null}listCodeEditors(){return Object.keys(this._codeEditors).map(e=>this._codeEditors[e])}addDiffEditor(e){this._diffEditors[e.getId()]=e,this._onDiffEditorAdd.fire(e)}get onDiffEditorAdd(){return this._onDiffEditorAdd.event}removeDiffEditor(e){delete this._diffEditors[e.getId()]&&this._onDiffEditorRemove.fire(e)}get onDiffEditorRemove(){return this._onDiffEditorRemove.event}getDiffEditor(e){return this._diffEditors[e]||null}listDiffEditors(){return Object.keys(this._diffEditors).map(e=>this._diffEditors[e])}getFocusedCodeEditor(){let e=null,t=this.listCodeEditors()
for(let i=0;i<t.length;i++){let n=t[i]
if(n.isFocused())return n
n.hasWidgetFocus()&&(e=n)}return e}setTransientModelProperty(e,t,i){const n=e.uri.toString()
let s
this._transientWatchers.hasOwnProperty(n)?s=this._transientWatchers[n]:(s=new IM(n,e,this),this._transientWatchers[n]=s),s.set(t,i)}getTransientModelProperty(e,t){const i=e.uri.toString()
if(this._transientWatchers.hasOwnProperty(i))return this._transientWatchers[i].get(t)}_removeWatcher(e){delete this._transientWatchers[e.uri]}}{constructor(e,t=xl()){super(),this._styleSheet=t,this._decorationOptionProviders=Object.create(null),this._themeService=e}registerDecorationType(e,t,n){let s=this._decorationOptionProviders[e]
if(!s){let r={styleSheet:this._styleSheet,key:e,parentTypeKey:n,options:t}
s=n?new class{constructor(e,t){this._parentTypeKey=t.parentTypeKey,this.refCount=0,this._beforeContentRules=new TM(3,t,e),this._afterContentRules=new TM(4,t,e)}getOptions(e,t){let i=e.resolveDecorationOptions(this._parentTypeKey,!0)
return this._beforeContentRules&&(i.beforeContentClassName=this._beforeContentRules.className),this._afterContentRules&&(i.afterContentClassName=this._afterContentRules.className),i}dispose(){this._beforeContentRules&&(this._beforeContentRules.dispose(),this._beforeContentRules=null),this._afterContentRules&&(this._afterContentRules.dispose(),this._afterContentRules=null)}}(this._themeService,r):new class{constructor(e,t){this.refCount=0,this._disposables=[]
let n=i=>{let n=new TM(i,t,e)
if(n.hasContent)return this._disposables.push(n),n.className}
this.className=n(0),this.inlineClassName=n(1),this.beforeContentClassName=n(3),this.afterContentClassName=n(4),this.glyphMarginClassName=n(2)
let s=t.options
this.isWholeLine=Boolean(s.isWholeLine),this.stickiness=s.rangeBehavior
let r=s.light&&s.light.overviewRulerColor||s.overviewRulerColor,o=s.dark&&s.dark.overviewRulerColor||s.overviewRulerColor
void 0===r&&void 0===o||(this.overviewRuler={color:r||o,darkColor:o||r,position:s.overviewRulerLane||i.Center})}getOptions(e,t){return t?{inlineClassName:this.inlineClassName,beforeContentClassName:this.beforeContentClassName,afterContentClassName:this.afterContentClassName,className:this.className,glyphMarginClassName:this.glyphMarginClassName,isWholeLine:this.isWholeLine,overviewRuler:this.overviewRuler,stickiness:this.stickiness}:this}dispose(){this._disposables=ei(this._disposables)}}(this._themeService,r),this._decorationOptionProviders[e]=s}s.refCount++}removeDecorationType(e){let t=this._decorationOptionProviders[e]
t&&(t.refCount--,t.refCount<=0&&(delete this._decorationOptionProviders[e],t.dispose(),this.listCodeEditors().forEach(t=>t.removeDecorations(e))))}resolveDecorationOptions(e,t){let i=this._decorationOptionProviders[e]
if(!i)throw new Error("Unknown decoration type key: "+e)
return i.getOptions(this,t)}}
MM=Nn([En(0,Mg)],MM)
const DM={color:"color:{0} !important;",backgroundColor:"background-color:{0};",outline:"outline:{0};",outlineColor:"outline-color:{0};",outlineStyle:"outline-style:{0};",outlineWidth:"outline-width:{0};",border:"border:{0};",borderColor:"border-color:{0};",borderRadius:"border-radius:{0};",borderSpacing:"border-spacing:{0};",borderStyle:"border-style:{0};",borderWidth:"border-width:{0};",textDecoration:"text-decoration:{0};",cursor:"cursor:{0};",letterSpacing:"letter-spacing:{0};",gutterIconPath:"background:url('{0}') center center no-repeat;",gutterIconSize:"background-size:{0};",contentText:"content:'{0}';",contentIconPath:"content:url('{0}');",margin:"margin:{0};",width:"width:{0};",height:"height:{0};"}
class TM{constructor(e,t,i){this._theme=i.getTheme(),this._ruleType=e,this._providerArgs=t,this._usesThemeColors=!1,this._hasContent=!1
let n=OM.getClassName(this._providerArgs.key,e)
this._providerArgs.parentTypeKey&&(n=n+" "+OM.getClassName(this._providerArgs.parentTypeKey,e)),this._className=n,this._unThemedSelector=OM.getSelector(this._providerArgs.key,this._providerArgs.parentTypeKey,e),this._buildCSS(),this._usesThemeColors&&(this._themeListener=i.onThemeChange(e=>{this._theme=i.getTheme(),this._removeCSS(),this._buildCSS()}))}dispose(){this._hasContent&&(this._removeCSS(),this._hasContent=!1),this._themeListener&&(this._themeListener.dispose(),this._themeListener=null)}get hasContent(){return this._hasContent}get className(){return this._className}_buildCSS(){let e,t,i,n=this._providerArgs.options
switch(this._ruleType){case 0:e=this.getCSSTextForModelDecorationClassName(n),t=this.getCSSTextForModelDecorationClassName(n.light),i=this.getCSSTextForModelDecorationClassName(n.dark)
break
case 1:e=this.getCSSTextForModelDecorationInlineClassName(n),t=this.getCSSTextForModelDecorationInlineClassName(n.light),i=this.getCSSTextForModelDecorationInlineClassName(n.dark)
break
case 2:e=this.getCSSTextForModelDecorationGlyphMarginClassName(n),t=this.getCSSTextForModelDecorationGlyphMarginClassName(n.light),i=this.getCSSTextForModelDecorationGlyphMarginClassName(n.dark)
break
case 3:e=this.getCSSTextForModelDecorationContentClassName(n.before),t=this.getCSSTextForModelDecorationContentClassName(n.light&&n.light.before),i=this.getCSSTextForModelDecorationContentClassName(n.dark&&n.dark.before)
break
case 4:e=this.getCSSTextForModelDecorationContentClassName(n.after),t=this.getCSSTextForModelDecorationContentClassName(n.light&&n.light.after),i=this.getCSSTextForModelDecorationContentClassName(n.dark&&n.dark.after)
break
default:throw new Error("Unknown rule type: "+this._ruleType)}let s=this._providerArgs.styleSheet.sheet,r=!1
e.length>0&&(s.insertRule(`${this._unThemedSelector} {${e}}`,0),r=!0),t.length>0&&(s.insertRule(`.vs${this._unThemedSelector} {${t}}`,0),r=!0),i.length>0&&(s.insertRule(`.vs-dark${this._unThemedSelector}, .hc-black${this._unThemedSelector} {${i}}`,0),r=!0),this._hasContent=r}_removeCSS(){Nl(this._unThemedSelector,this._providerArgs.styleSheet)}getCSSTextForModelDecorationClassName(e){if(!e)return""
let t=[]
return this.collectCSSText(e,["backgroundColor"],t),this.collectCSSText(e,["outline","outlineColor","outlineStyle","outlineWidth"],t),this.collectBorderSettingsCSSText(e,t),t.join("")}getCSSTextForModelDecorationInlineClassName(e){if(!e)return""
let t=[]
return this.collectCSSText(e,["textDecoration","cursor","color","letterSpacing"],t),t.join("")}getCSSTextForModelDecorationContentClassName(e){if(!e)return""
let t=[]
if(void 0!==e){if(this.collectBorderSettingsCSSText(e,t),"string"==typeof e.contentIconPath?t.push(he(DM.contentIconPath,X.file(e.contentIconPath).toString().replace(/'/g,"%27"))):e.contentIconPath instanceof X&&t.push(he(DM.contentIconPath,e.contentIconPath.toString(!0).replace(/'/g,"%27"))),"string"==typeof e.contentText){const i=e.contentText.match(/^.*$/m)[0].replace(/['\\]/g,"\\$&")
t.push(he(DM.contentText,i))}this.collectCSSText(e,["textDecoration","color","backgroundColor","margin"],t),this.collectCSSText(e,["width","height"],t)&&t.push("display:inline-block;")}return t.join("")}getCSSTextForModelDecorationGlyphMarginClassName(e){if(!e)return""
let t=[]
return void 0!==e.gutterIconPath&&("string"==typeof e.gutterIconPath?t.push(he(DM.gutterIconPath,X.file(e.gutterIconPath).toString())):t.push(he(DM.gutterIconPath,e.gutterIconPath.toString(!0).replace(/'/g,"%27"))),void 0!==e.gutterIconSize&&t.push(he(DM.gutterIconSize,e.gutterIconSize))),t.join("")}collectBorderSettingsCSSText(e,t){return!!this.collectCSSText(e,["border","borderColor","borderRadius","borderSpacing","borderStyle","borderWidth"],t)&&(t.push(he("box-sizing: border-box;")),!0)}collectCSSText(e,t,i){let n=i.length
for(let n of t){let t=this.resolveValue(e[n])
"string"==typeof t&&i.push(he(DM[n],t))}return i.length!==n}resolveValue(e){if((t=e)&&"string"==typeof t.id){this._usesThemeColors=!0
let t=this._theme.getColor(e.id)
return t?t.toString():"transparent"}var t
return e}}class OM{static getClassName(e,t){return"ced-"+e+"-"+t}static getSelector(e,t,i){let n=".monaco-editor ."+this.getClassName(e,i)
return t&&(n=n+"."+this.getClassName(t,i)),3===i?n+="::before":4===i&&(n+="::after"),n}}const RM="data-keybinding-context"
class AM{constructor(e,t){this._id=e,this._parent=t,this._value=Object.create(null),this._value._contextId=e}setValue(e,t){return this._value[e]!==t&&(this._value[e]=t,!0)}removeValue(e){return delete this._value[e]}getValue(e){const t=this._value[e]
return void 0===t&&this._parent?this._parent.getValue(e):t}}class PM{constructor(e,t,i){this._parent=e,this._key=t,this._defaultValue=i,this.reset()}set(e){this._parent.setContext(this._key,e)}reset(){void 0===this._defaultValue?this._parent.removeContext(this._key):this._parent.setContext(this._key,this._defaultValue)}get(){return this._parent.getContextKeyValue(this._key)}}class FM{constructor(e){this._myContextId=e,this._onDidChangeContextKey=new ci}createKey(e,t){return new PM(this,e,t)}get onDidChangeContext(){return this._onDidChangeContext||(this._onDidChangeContext=gi(this._onDidChangeContextKey.event,(e,t)=>(e?e.indexOf(t)<0&&e.push(t):e=[t],e),25)),this._onDidChangeContext}createScoped(e){return new VM(this,this._onDidChangeContextKey,e)}contextMatchesRules(e){const t=this.getContextValuesContainer(this._myContextId)
return Qk.contextMatchesRules(t,e)}getContextKeyValue(e){return this.getContextValuesContainer(this._myContextId).getValue(e)}setContext(e,t){this.getContextValuesContainer(this._myContextId).setValue(e,t)&&this._onDidChangeContextKey.fire(e)}removeContext(e){this.getContextValuesContainer(this._myContextId).removeValue(e)&&this._onDidChangeContextKey.fire(e)}getContext(e){return this.getContextValuesContainer(function(e){for(;e;){if(e.hasAttribute(RM))return parseInt(e.getAttribute(RM),10)
e=e.parentElement}return 0}(e))}}let WM=class extends FM{constructor(e){super(0),this._toDispose=[],this._lastContextId=0,this._contexts=Object.create(null)
const t=new class extends AM{constructor(e,t,i){super(e,null),this._emitter=i,this._configurationService=t,this._subscription=t.onDidChangeConfiguration(this._onConfigurationUpdated,this),this._initFromConfiguration()}dispose(){this._subscription.dispose()}_onConfigurationUpdated(e){if(e.source===mw.DEFAULT)this._initFromConfiguration()
else for(const t of e.affectedKeys){const e=`config.${t}`
e in this._value&&(this._value[e]=this._configurationService.getValue(t),this._emitter.fire(t))}}_initFromConfiguration(){const e=this._configurationService.getConfiguration()
for(let e in this._value)0===e.indexOf("config.")&&delete this._value[e]
const t=(e,i)=>{for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){i.push(n)
let s=e[n]
if("boolean"==typeof s){const e=i.join(".")
this._value[e]=s,this._emitter.fire(e)}else"object"==typeof s&&t(s,i)
i.pop()}}
t(e,["config"])}}(this._myContextId,e,this._onDidChangeContextKey)
this._contexts[String(this._myContextId)]=t,this._toDispose.push(t)}dispose(){this._toDispose=ei(this._toDispose)}getContextValuesContainer(e){return this._contexts[String(e)]}createChildContext(e=this._myContextId){let t=++this._lastContextId
return this._contexts[String(t)]=new AM(t,this.getContextValuesContainer(e)),t}disposeContext(e){delete this._contexts[String(e)]}}
WM=Nn([En(0,gw)],WM)
class VM extends FM{constructor(e,t,i){super(e.createChildContext()),this._parent=e,this._onDidChangeContextKey=t,i&&(this._domNode=i,this._domNode.setAttribute(RM,String(this._myContextId)))}dispose(){this._parent.disposeContext(this._myContextId),this._domNode&&this._domNode.removeAttribute(RM)}get onDidChangeContext(){return this._parent.onDidChangeContext}getContextValuesContainer(e){return this._parent.getContextValuesContainer(e)}createChildContext(e=this._myContextId){return this._parent.createChildContext(e)}disposeContext(e){this._parent.disposeContext(e)}}Tr.registerCommand("setContext",function(e,t,i){e.get(Lo).createKey(String(t),i)})
class BM{constructor(e,t,i,n,s){this.token=e,this.index=t,this.fontStyle=i,this.foreground=n,this.background=s}}class HM{constructor(){this._lastColorId=0,this._id2color=[],this._color2id=new Map}getId(e){if(null===e)return 0
if(e=e.toUpperCase(),!/^[0-9A-F]{6}$/.test(e))throw new Error("Illegal color name: "+e)
let t=this._color2id.get(e)
return t||(t=++this._lastColorId,this._color2id.set(e,t),this._id2color[t]=Td.fromHex("#"+e),t)}getColorMap(){return this._id2color.slice(0)}}class zM{static createFromRawTokenTheme(e){return this.createFromParsedTokenTheme(function(e){if(!e||!Array.isArray(e))return[]
let t=[],i=0
for(let n=0,s=e.length;n<s;n++){let s=e[n],r=-1
if("string"==typeof s.fontStyle){r=0
let e=s.fontStyle.split(" ")
for(let t=0,i=e.length;t<i;t++)switch(e[t]){case"italic":r|=1
break
case"bold":r|=2
break
case"underline":r|=4}}let o=null
"string"==typeof s.foreground&&(o=s.foreground)
let a=null
"string"==typeof s.background&&(a=s.background),t[i++]=new BM(s.token||"",n,r,o,a)}return t}(e))}static createFromParsedTokenTheme(e){return function(e){e.sort((e,n)=>{let s=(t=e.token,i=n.token,t<i?-1:t>i?1:0)
return 0!==s?s:e.index-n.index})
var t,i
let n=0,s="000000",r="ffffff"
for(;e.length>=1&&""===e[0].token;){let t=e.shift();-1!==t.fontStyle&&(n=t.fontStyle),null!==t.foreground&&(s=t.foreground),null!==t.background&&(r=t.background)}let o=new HM,a=new KM(n,o.getId(s),o.getId(r)),l=new qM(a)
for(let t=0,i=e.length;t<i;t++){let i=e[t]
l.insert(i.token,i.fontStyle,o.getId(i.foreground),o.getId(i.background))}return new zM(o,l)}(e)}constructor(e,t){this._colorMap=e,this._root=t,this._cache=new Map}getColorMap(){return this._colorMap.getColorMap()}getThemeTrieElement(){return this._root.toExternalThemeTrieElement()}_match(e){return this._root.match(e)}match(e,t){let i=this._cache.get(t)
if(void 0===i){let e=this._match(t),n=function(e){let t=e.match(UM)
if(!t)return 0
switch(t[1]){case"comment":return 1
case"string":return 2
case"regex":return 4}throw new Error("Unexpected match for standard token type!")}(t)
i=(e.metadata|n<<8)>>>0,this._cache.set(t,i)}return(i|e<<0)>>>0}}const UM=/\b(comment|string|regex)\b/
class KM{constructor(e,t,i){this._fontStyle=e,this._foreground=t,this._background=i,this.metadata=(this._fontStyle<<11|this._foreground<<14|this._background<<23)>>>0}clone(){return new KM(this._fontStyle,this._foreground,this._background)}static cloneArr(e){let t=[]
for(let i=0,n=e.length;i<n;i++)t[i]=e[i].clone()
return t}acceptOverwrite(e,t,i){-1!==e&&(this._fontStyle=e),0!==t&&(this._foreground=t),0!==i&&(this._background=i),this.metadata=(this._fontStyle<<11|this._foreground<<14|this._background<<23)>>>0}}class $M{constructor(e,t){this.mainRule=e,this.children=t||Object.create(null)}}class qM{constructor(e){this._mainRule=e,this._children=new Map}toExternalThemeTrieElement(){let e=Object.create(null)
return this._children.forEach((t,i)=>{e[i]=t.toExternalThemeTrieElement()}),new $M(this._mainRule,e)}match(e){if(""===e)return this._mainRule
let t,i,n=e.indexOf(".");-1===n?(t=e,i=""):(t=e.substring(0,n),i=e.substring(n+1))
let s=this._children.get(t)
return void 0!==s?s.match(i):this._mainRule}insert(e,t,i,n){if(""===e)return void this._mainRule.acceptOverwrite(t,i,n)
let s,r,o=e.indexOf(".");-1===o?(s=e,r=""):(s=e.substring(0,o),r=e.substring(o+1))
let a=this._children.get(s)
void 0===a&&(a=new qM(this._mainRule.clone()),this._children.set(s,a)),a.insert(r,t,i,n)}}const GM={base:"vs",inherit:!1,rules:[{token:"",foreground:"000000",background:"fffffe"},{token:"invalid",foreground:"cd3131"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"001188"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"09885A"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"delimiter.xml",foreground:"0000FF"},{token:"tag",foreground:"800000"},{token:"tag.id.jade",foreground:"4F76AC"},{token:"tag.class.jade",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"FF0000"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"FF0000"},{token:"attribute.value",foreground:"0451A5"},{token:"attribute.value.number",foreground:"09885A"},{token:"attribute.value.unit",foreground:"09885A"},{token:"attribute.value.html",foreground:"0000FF"},{token:"attribute.value.xml",foreground:"0000FF"},{token:"string",foreground:"A31515"},{token:"string.html",foreground:"0000FF"},{token:"string.sql",foreground:"FF0000"},{token:"string.yaml",foreground:"0451A5"},{token:"keyword",foreground:"0000FF"},{token:"keyword.json",foreground:"0451A5"},{token:"keyword.flow",foreground:"AF00DB"},{token:"keyword.flow.scss",foreground:"0000FF"},{token:"operator.scss",foreground:"666666"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[Qc]:"#FFFFFE",[eg]:"#000000",[rg]:"#E5EBF1",[$g]:"#D3D3D3",[og]:"#ADD6FF4D"}},jM={base:"vs-dark",inherit:!1,rules:[{token:"",foreground:"D4D4D4",background:"1E1E1E"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"74B0DF"},{token:"variable.predefined",foreground:"4864AA"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"B5CEA8"},{token:"number.hex",foreground:"5BB498"},{token:"regexp",foreground:"B46695"},{token:"annotation",foreground:"cc6666"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"DCDCDC"},{token:"delimiter.html",foreground:"808080"},{token:"delimiter.xml",foreground:"808080"},{token:"tag",foreground:"569CD6"},{token:"tag.id.jade",foreground:"4F76AC"},{token:"tag.class.jade",foreground:"4F76AC"},{token:"meta.scss",foreground:"A79873"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"DD6A6F"},{token:"metatag.content.html",foreground:"9CDCFE"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"attribute.value.number.css",foreground:"B5CEA8"},{token:"attribute.value.unit.css",foreground:"B5CEA8"},{token:"attribute.value.hex.css",foreground:"D4D4D4"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"keyword.json",foreground:"CE9178"},{token:"keyword.flow.scss",foreground:"569CD6"},{token:"operator.scss",foreground:"909090"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[Qc]:"#1E1E1E",[eg]:"#D4D4D4",[rg]:"#3A3D41",[$g]:"#404040",[og]:"#ADD6FF26"}},YM={base:"hc-black",inherit:!1,rules:[{token:"",foreground:"FFFFFF",background:"000000"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"1AEBFF"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"FFFFFF"},{token:"regexp",foreground:"C0C0C0"},{token:"annotation",foreground:"569CD6"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"FFFF00"},{token:"delimiter.html",foreground:"FFFF00"},{token:"tag",foreground:"569CD6"},{token:"tag.id.jade",foreground:"4F76AC"},{token:"tag.class.jade",foreground:"4F76AC"},{token:"meta",foreground:"D4D4D4"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"569CD6"},{token:"metatag.content.html",foreground:"1AEBFF"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key",foreground:"9CDCFE"},{token:"string.value",foreground:"CE9178"},{token:"attribute.name",foreground:"569CD6"},{token:"attribute.value",foreground:"3FF23F"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[Qc]:"#000000",[eg]:"#FFFFFF",[$g]:"#FFFFFF"}},ZM="vs",XM="vs-dark",JM="hc-black",QM=qr.as(ac),eD=qr.as(Pg)
class tD{constructor(e,t,i,n){t.length>0?(this.id=e+" "+t,this.themeName=t):(this.id=e,this.themeName=e),this.base=e,this.rules=n,this.colors={}
for(let e in i)this.colors[e]=Td.fromHex(i[e])
this.defaultColors={}}getColor(e,t){return this.colors.hasOwnProperty(e)?this.colors[e]:!1!==t?this.getDefault(e):null}getDefault(e){if(this.defaultColors.hasOwnProperty(e))return this.defaultColors[e]
let t=QM.resolveDefaultColor(e,this)
return this.defaultColors[e]=t,t}defines(e){return this.colors.hasOwnProperty(e)}get type(){switch(this.base){case ZM:return"light"
case JM:return"hc"
default:return"dark"}}get tokenTheme(){return this._tokenTheme||(this._tokenTheme=zM.createFromRawTokenTheme(this.rules)),this._tokenTheme}}function iD(e){return e===ZM||e===XM||e===JM}function nD(e){switch(e){case ZM:return GM
case XM:return jM
case JM:return YM}}function sD(e){let t=nD(e)
return new tD(e,"",t.colors,t.rules)}var rD
!function(e){const t=new zl
class i{constructor(e,t){this._serviceId=e,this._factory=t,this._value=null}get id(){return this._serviceId}get(e){if(!this._value){if(e&&(this._value=e[this._serviceId.toString()]),this._value||(this._value=this._factory(e)),!this._value)throw new Error("Service "+this._serviceId+" is missing!")
t.set(this._serviceId,this._value)}return this._value}}e.LazyStaticService=i
let n=[]
function s(e,t){let s=new i(e,t)
return n.push(s),s}e.init=function(e){let t=new zl
for(let i in e)e.hasOwnProperty(i)&&t.set(Ir(i),e[i])
n.forEach(i=>t.set(i.id,i.get(e)))
let i=new EI(t,!0)
return t.set(Er,i),[t,i]},e.instantiationService=s(Er,()=>new EI(t,!0))
const r=new class{constructor(){this._onDidChangeConfiguration=new ci,this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._configuration=new iI(new tI,new eI)}configuration(){return this._configuration}getConfiguration(e,t){const i="string"==typeof e?e:void 0,n=gI(e)?e:gI(t)?t:{}
return this.configuration().getSection(i,n,null)}getValue(e,t={}){return this.configuration().getValue(e,t,null)}updateValue(e,t,i,n){return bt.as(null)}inspect(e,t={}){return this.configuration().lookup(e,t,null)}keys(){return this.configuration().keys(null)}reloadConfiguration(){return bt.as(null)}getConfigurationData(){return null}}
e.configurationService=s(gw,()=>r),e.resourceConfigurationService=s(nM,()=>new class{constructor(e){this.configurationService=e,this._onDidChangeConfigurationEmitter=new ci,this.configurationService.onDidChangeConfiguration(e=>{this._onDidChangeConfigurationEmitter.fire(e)})}getConfiguration(){return this.configurationService.getConfiguration()}}(r)),e.contextService=s(Pw,()=>new pI),e.telemetryService=s(cw,()=>new class{constructor(){this.isOptedIn=!1}publicLog(e,t){return bt.as(null)}getTelemetryInfo(){return null}}),e.messageService=s(tw,()=>new dI),e.markerService=s(ay,()=>new MI),e.modeService=s(XS,e=>new class{constructor(){this._onDidCreateMode=new ci,this.onDidCreateMode=this._onDidCreateMode.event,this._instantiatedModes={},this._registry=new xM}_onReady(){return bt.as(!0)}isRegisteredMode(e){return this._registry.isRegisteredMode(e)}getRegisteredModes(){return this._registry.getRegisteredModes()}getRegisteredLanguageNames(){return this._registry.getRegisteredLanguageNames()}getExtensions(e){return this._registry.getExtensions(e)}getFilenames(e){return this._registry.getFilenames(e)}getMimeForMode(e){return this._registry.getMimeForMode(e)}getLanguageName(e){return this._registry.getLanguageName(e)}getModeIdForLanguageName(e){return this._registry.getModeIdForLanguageNameLowercase(e)}getModeIdByFilenameOrFirstLine(e,t){var i=this._registry.getModeIdsFromFilenameOrFirstLine(e,t)
return i.length>0?i[0]:null}getModeId(e){var t=this._registry.extractModeIds(e)
return t.length>0?t[0]:null}getLanguageIdentifier(e){return this._registry.getLanguageIdentifier(e)}getConfigurationFiles(e){return this._registry.getConfigurationFiles(e)}lookup(e){for(var t=[],i=this._registry.extractModeIds(e),n=0;n<i.length;n++){var s=i[n]
t.push({modeId:s,isInstantiated:this._instantiatedModes.hasOwnProperty(s)})}return t}getMode(e){for(var t=this._registry.extractModeIds(e),i=!1,n=0;n<t.length;n++){if(this._instantiatedModes.hasOwnProperty(t[n]))return this._instantiatedModes[t[n]]
i=i||"plaintext"===t[n]}if(i){var s=null
return this.getOrCreateMode(e).then(e=>{s=e}).done(null,St),s}return null}getOrCreateMode(e){return this._onReady().then(()=>{var t=this.getModeId(e)
return this._getOrCreateMode(t||"plaintext")})}getOrCreateModeByLanguageName(e){return this._onReady().then(()=>{var t=this._getModeIdByLanguageName(e)
return this._getOrCreateMode(t||"plaintext")})}_getModeIdByLanguageName(e){var t=this._registry.getModeIdsFromLanguageName(e)
return t.length>0?t[0]:null}getOrCreateModeByFilenameOrFirstLine(e,t){return this._onReady().then(()=>{var i=this.getModeIdByFilenameOrFirstLine(e,t)
return this._getOrCreateMode(i||"plaintext")})}_getOrCreateMode(e){if(!this._instantiatedModes.hasOwnProperty(e)){let t=this.getLanguageIdentifier(e)
this._instantiatedModes[e]=new uM(t),this._onDidCreateMode.fire(this._instantiatedModes[e])}return this._instantiatedModes[e]}}),e.modelService=s(Zr,t=>new kM(e.markerService.get(t),e.configurationService.get(t))),e.editorWorkerService=s(Jb,t=>new aM(e.modelService.get(t),e.resourceConfigurationService.get(t),e.modeService.get(t))),e.standaloneThemeService=s(fI,()=>new class{constructor(){this._onThemeChange=new ci,this._knownThemes=new Map,this._knownThemes.set(ZM,sD(ZM)),this._knownThemes.set(XM,sD(XM)),this._knownThemes.set(JM,sD(JM)),this._styleElement=xl(),this._styleElement.className="monaco-colors",this.setTheme(ZM)}get onThemeChange(){return this._onThemeChange.event}defineTheme(e,t){if(!/^[a-z0-9\-]+$/i.test(e)||iD(e))throw new Error("Illegal theme name!")
if(!iD(t.base))throw new Error("Illegal theme base!")
let i=[],n={}
if(t.inherit){let e=nD(t.base)
i=i.concat(e.rules)
for(let t in e.colors)n[t]=e.colors[t]}i=i.concat(t.rules)
for(let e in t.colors)n[e]=t.colors[e]
this._knownThemes.set(e,new tD(t.base,e,n,i))}getTheme(){return this._theme}setTheme(e){let t
t=this._knownThemes.has(e)?this._knownThemes.get(e):this._knownThemes.get(ZM),this._theme=t
let i=[],n={},s={addRule:e=>{n[e]||(i.push(e),n[e]=!0)}}
eD.getThemingParticipants().forEach(e=>e(t,s))
let r=t.tokenTheme.getColorMap()
return s.addRule(function(e){let t=[]
for(let i=1,n=e.length;i<n;i++){let n=e[i]
t[i]=`.mtk${i} { color: ${n}; }`}return t.push(".mtki { font-style: italic; }"),t.push(".mtkb { font-weight: bold; }"),t.push(".mtku { text-decoration: underline; }"),t.join("\n")}(r)),this._styleElement.innerHTML=i.join("\n"),js.setColorMap(r),this._onThemeChange.fire(t),t.id}}),e.codeEditorService=s(Eo,t=>new MM(e.standaloneThemeService.get(t))),e.progressService=s(DS,()=>new hI),e.storageService=s(zu,()=>$u)}(rD||(rD={}))
class oD extends ni{constructor(e,t){super()
const[i,n]=rD.init(t)
this._serviceCollection=i,this._instantiationService=n
const s=this.get(gw),r=this.get(tw),o=this.get(cw)
let a=(e,i)=>{let n=null
return t&&(n=t[e.toString()]),n||(n=i()),this._serviceCollection.set(e,n),n},l=a(Lo,()=>this._register(new WM(s))),h=a(Dr,()=>new uI(this._instantiationService))
a(tC,()=>this._register(new cI(l,h,o,r,e)))
let d=a(X_,()=>this._register(new LI(e,o,r)))
a(J_,()=>this._register(new xI(e,o,r,d))),a(no,()=>new mI(h))}get(e){let t=this._serviceCollection.get(e)
if(!t)throw new Error("Missing service "+e)
return t}set(e,t){this._serviceCollection.set(e,t)}has(e){return this._serviceCollection.has(e)}}function aD(e,t){let i
switch(void 0!==t&&null!==t&&(i=t.$mid),i){case 1:return X.revive(t)
case 2:return new RegExp(t.source,t.flags)
default:return t}}Ir("lifecycleService")
var lD,hD,dD,uD,cD,gD;(hD=lD||(lD={}))[hD.CLOSE=1]="CLOSE",hD[hD.QUIT=2]="QUIT",hD[hD.RELOAD=3]="RELOAD",hD[hD.LOAD=4]="LOAD",(uD=dD||(dD={}))[uD.NewWindow=1]="NewWindow",uD[uD.ReloadedWindow=3]="ReloadedWindow",uD[uD.ReopenedWindow=4]="ReopenedWindow",(gD=cD||(cD={}))[gD.Starting=1]="Starting",gD[gD.Running=2]="Running",gD[gD.ShuttingDown=3]="ShuttingDown"
cD.Running,dD.NewWindow,ui.None,ui.None,ui.None
const mD={_serviceBrand:void 0,publicLog:(e,t)=>bt.as(null),isOptedIn:!0,getTelemetryInfo:()=>bt.as({instanceId:"someValue.instanceId",sessionId:"someValue.sessionId",machineId:"someValue.machineId"})}
let pD=class{constructor(e,t,i=mD){this._editorService=e,this._commandService=t,this._telemetryService=i}open(e,t){this._telemetryService.publicLog("openerService",{scheme:e.scheme})
const{scheme:i,path:n,query:s,fragment:r}=e
let o
if(i===ru.http||i===ru.https||i===ru.mailto)Hl(e.toString(!0))
else if("command"===i&&Tr.getCommand(n)){let e=[]
try{a=s,e=JSON.parse(a,aD),Array.isArray(e)||(e=[e])}catch(e){}o=this._commandService.executeCommand(n,...e)}else{let i
const n=/^L?(\d+)(?:,(\d+))?/.exec(r)
if(n&&(i={startLineNumber:parseInt(n[1]),startColumn:n[2]?parseInt(n[2]):1},e=e.with({fragment:""})),!e.scheme)return bt.as(void 0)
e.scheme===ru.file&&(e=e.with({path:Yn(e.path)})),o=this._editorService.openEditor({resource:e,options:{selection:i}},t&&t.openToSide)}var a
return bt.as(o)}}
pD=Nn([En(0,ao),En(1,Dr),En(2,Mr(cw))],pD)
class fD{static colorizeElement(e,t,i,n){let s=(n=n||{}).theme||"vs",r=n.mimeType||i.getAttribute("lang")||i.getAttribute("data-lang")
if(!r)return void console.error("Mode not detected")
e.setTheme(s)
let o=i.firstChild.nodeValue
i.className+="monaco-editor "+s
let a=e=>{i.innerHTML=e}
return this.colorize(t,o,r,n).then(a,e=>console.error(e),a)}static _tokenizationSupportChangedPromise(e){let t=null,i=()=>{t&&(t.dispose(),t=null)}
return new bt((n,s,r)=>{t=js.onDidChange(t=>{t.changedLanguages.indexOf(e)>=0&&(i(),n(void 0))})},i)}static colorize(e,t,i,n){Qe(t)&&(t=t.substr(1))
let s=t.split(/\r\n|\r|\n/),r=e.getModeId(i)
void 0===(n=n||{}).tabSize&&(n.tabSize=4),e.getOrCreateMode(r)
let o=js.get(r)
return o?bt.as(_D(s,n.tabSize,o)):bt.any([this._tokenizationSupportChangedPromise(r),bt.timeout(500)]).then(e=>{let t=js.get(r)
return t?_D(s,n.tabSize,t):function(e,t){let i=[]
for(let n=0,s=e.length;n<s;n++){let s=e[n],r=zm(new Fm(!1,s,!1,0,[new Ft(s.length,16793600)],[],t,0,-1,"none",!1,!1));(i=i.concat(r.html)).push("<br/>")}return i.join("")}(s,n.tabSize)})}static colorizeLine(e,t,i,n=4){return zm(new Fm(!1,e,t,0,i,[],n,0,-1,"none",!1,!1)).html}static colorizeModelLine(e,t,i=4){let n=e.getLineContent(t)
e.forceTokenization(t)
let s=e.getLineTokens(t).inflate()
return this.colorizeLine(n,e.mightContainRTL(),s,i)}}function _D(e,t,i){return function(e,t,i){let n=[],s=i.getInitialState()
for(let r=0,o=e.length;r<o;r++){let o=e[r],a=i.tokenize2(o,s,0),l=new Bt(a.tokens,o),h=zm(new Fm(!1,o,!0,0,l.inflate(),[],t,0,-1,"none",!1,!1));(n=n.concat(h.html)).push("<br/>"),s=a.endState}return n.join("")}(e,t,i)}class CD extends dM{constructor(e,t){super(e,t.label),this._foreignModuleId=t.moduleId,this._foreignModuleCreateData=t.createData||null,this._foreignProxy=null}_getForeignProxy(){return this._foreignProxy||(this._foreignProxy=new ga(this._getProxy().then(e=>e.loadForeignModule(this._foreignModuleId,this._foreignModuleCreateData).then(t=>{this._foreignModuleId=null,this._foreignModuleCreateData=null
let i=(t,i)=>e.fmr(t,i),n=(e,t)=>(function(){let i=Array.prototype.slice.call(arguments,0)
return t(e,i)}),s={}
for(let e=0;e<t.length;e++)s[t[e]]=n(t[e],i)
return s})))),this._foreignProxy}getProxy(){return this._getForeignProxy()}withSyncedResources(e){return this._withSyncedResources(e).then(e=>this.getProxy())}}function bD(e,t,i){return function(e,t,i){let n=new oD(e,t),s=null
n.has(ao)||(s=new aI,n.set(ao,s))
let r=null
n.has(eS)||(r=new lI,n.set(eS,r)),n.has(vy)||n.set(vy,new pD(n.get(ao),n.get(Dr)))
let o=i(n)
return s&&s.setEditor(o),r&&r.setEditor(o),o}(e,i,i=>new vI(e,t,i,i.get(Er),i.get(Eo),i.get(Dr),i.get(Lo),i.get(tC),i.get(X_),i.get(fI)))}function wD(e){return rD.codeEditorService.get().onCodeEditorAdd(t=>{e(t)})}function vD(e,t,i){return rD.modelService.get().createModel(e,t,i)}function SD(e,t,i){if(e=e||"",!t){let t=i?i.path:null,n=e.indexOf("\n"),s=e
return-1!==n&&(s=e.substring(0,n)),vD(e,rD.modeService.get().getOrCreateModeByFilenameOrFirstLine(t,s),i)}return vD(e,rD.modeService.get().getOrCreateMode(t),i)}function yD(e,t){rD.modelService.get().setMode(e,rD.modeService.get().getOrCreateMode(t))}function xD(e,t,i){e&&rD.markerService.get().changeOne(t,e.uri,i)}function LD(e){return rD.markerService.get().read(e)}function ND(e){return rD.modelService.get().getModel(e)}function ED(){return rD.modelService.get().getModels()}function kD(e){return rD.modelService.get().onModelAdded(e)}function ID(e){return rD.modelService.get().onModelRemoved(e)}function MD(e){return rD.modelService.get().onModelModeChanged(t=>{e({model:t.model,oldLanguage:t.oldModeId})})}function DD(e){return t=rD.modelService.get(),new CD(t,e)
var t}function TD(e,t){return fD.colorizeElement(rD.standaloneThemeService.get(),rD.modeService.get(),e,t)}function OD(e,t,i){return fD.colorize(rD.modeService.get(),e,t,i)}function RD(e,t,i=4){return fD.colorizeModelLine(e,t,i)}function AD(e){let t=js.get(e)
return t||{getInitialState:()=>fh,tokenize:(t,r,o)=>(i=e,n=r,s=o,new mh([new gh(s,"",i)],n)),tokenize2:void 0}
var i,n,s}function PD(e,t){rD.modeService.get().getOrCreateMode(t)
let i=AD(t),n=e.split(/\r\n|\r|\n/),s=[],r=i.getInitialState()
for(let e=0,t=n.length;e<t;e++){let t=n[e],o=i.tokenize(t,r,0)
s[e]=o.tokens,r=o.endState}return s}function FD(e,t){rD.standaloneThemeService.get().defineTheme(e,t)}function WD(e){rD.standaloneThemeService.get().setTheme(e)}function VD(){}var BD,HD
function zD(e){return t=e,!Array.isArray(t)
var t}function UD(e){return"string"==typeof e}function KD(e){return!UD(e)}function $D(e){return!e}function qD(e,t){return e.ignoreCase&&t?t.toLowerCase():t}function GD(e){return e.replace(/[&<>'"_]/g,"-")}function jD(e,t){throw new Error(`${e.languageId}: ${t}`)}function YD(e,t,i,n,s){var r=null
return t.replace(/\$((\$)|(#)|(\d\d?)|[sS](\d\d?)|@(\w+))/g,function(t,o,a,l,h,d,u,c,g){return $D(a)?$D(l)?!$D(h)&&h<n.length?qD(e,n[h]):!$D(u)&&e&&"string"==typeof e[u]?e[u]:(null===r&&(r=s.split(".")).unshift(s),!$D(d)&&d<r.length?qD(e,r[d]):""):qD(e,i):"$"})}function ZD(e,t){for(;t&&t.length>0;){var i=e.tokenizer[t]
if(i)return i
var n=t.lastIndexOf(".")
t=n<0?null:t.substr(0,n)}return null}function XD(e,t,i){return"boolean"==typeof e?e:(i&&(e||void 0===t)&&i(),void 0===t?null:t)}function JD(e,t,i){return"string"==typeof e?e:(i&&(e||void 0===t)&&i(),void 0===t?null:t)}function QD(e,t){if("string"!=typeof t)return null
for(var i=0;t.indexOf("@")>=0&&i<5;)i++,t=t.replace(/@(\w+)/g,function(i,n){var s=""
return"string"==typeof e[n]?s=e[n]:e[n]&&e[n]instanceof RegExp?s=e[n].source:void 0===e[n]?jD(e,"language definition does not contain attribute '"+n+"', used at: "+t):jD(e,"attribute reference '"+n+"' must be a string, used at: "+t),$D(s)?"":"(?:"+s+")"})
return new RegExp(t,e.ignoreCase?"i":"")}function eT(e,t,i,n){var s=-1,r=i,o=i.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/)
o&&(o[3]&&(s=parseInt(o[3]),o[2]&&(s+=100)),r=o[4])
var a,l="~",h=r
if(r&&0!==r.length?/^\w*$/.test(h)?l="==":(o=r.match(/^(@|!@|~|!~|==|!=)(.*)$/))&&(l=o[1],h=o[2]):(l="!=",h=""),"~"!==l&&"!~"!==l||!/^(\w|\|)*$/.test(h))if("@"===l||"!@"===l){var d=e[h]
d||jD(e,"the @ match target '"+h+"' is not defined, in rule: "+t),function(e,t){if(!t)return!1
if(!Array.isArray(t))return!1
var i
for(i in t)if(t.hasOwnProperty(i)&&!e(t[i]))return!1
return!0}(function(e){return"string"==typeof e},d)||jD(e,"the @ match target '"+h+"' must be an array of strings, in rule: "+t)
g=zn(d,e.ignoreCase)
a=function(e){return"@"===l?g(e):!g(e)}}else if("~"===l||"!~"===l)if(h.indexOf("$")<0){var u=QD(e,"^"+h+"$")
a=function(e){return"~"===l?u.test(e):!u.test(e)}}else a=function(t,i,n,s){return QD(e,"^"+YD(e,h,i,n,s)+"$").test(t)}
else if(h.indexOf("$")<0){var c=qD(e,h)
a=function(e){return"=="===l?e===c:e!==c}}else{c=qD(e,h)
a=function(t,i,n,s,r){var o=YD(e,c,i,n,s)
return"=="===l?t===o:t!==o}}else{var g=zn(h.split("|"),e.ignoreCase)
a=function(e){return"~"===l?g(e):!g(e)}}return-1===s?{name:i,value:n,test:function(e,t,i,n){return a(e,e,t,i,n)}}:{name:i,value:n,test:function(e,t,i,n){var r=function(e,t,i,n){if(n<0)return e
if(n<t.length)return t[n]
if(n>=100){n-=100
var s=i.split(".")
if(s.unshift(i),n<s.length)return s[n]}return null}(e,t,i,s)
return a(r||"",e,t,i,n)}}}(HD=BD||(BD={}))[HD.Smooth=0]="Smooth",HD[HD.Immediate=1]="Immediate"
class tT{constructor(e){this.regex=new RegExp(""),this.action={token:""},this.matchOnlyAtLineStart=!1,this.name="",this.name=e}setRegex(e,t){var i
"string"==typeof t?i=t:t instanceof RegExp?i=t.source:jD(e,"rules must start with a match string or regular expression: "+this.name),this.matchOnlyAtLineStart=i.length>0&&"^"===i[0],this.name=this.name+": "+i,this.regex=QD(e,"^(?:"+(this.matchOnlyAtLineStart?i.substr(1):i)+")")}setAction(e,t){this.action=function e(t,i,n){if(n){if("string"==typeof n)return n
if(n.token||""===n.token){if("string"!=typeof n.token)return jD(t,"a 'token' attribute must be of type string, in rule: "+i),{token:""}
var s={token:n.token}
if(n.token.indexOf("$")>=0&&(s.tokenSubst=!0),"string"==typeof n.bracket&&("@open"===n.bracket?s.bracket=1:"@close"===n.bracket?s.bracket=-1:jD(t,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+i)),n.next)if("string"!=typeof n.next)jD(t,"the next state must be a string value in rule: "+i)
else{var r=n.next;/^(@pop|@push|@popall)$/.test(r)||("@"===r[0]&&(r=r.substr(1)),r.indexOf("$")<0&&(function(e,t){for(;t&&t.length>0;){if(e.stateNames[t])return!0
var i=t.lastIndexOf(".")
t=i<0?null:t.substr(0,i)}return!1}(t,YD(t,r,"",[],""))||jD(t,"the next state '"+n.next+"' is not defined in rule: "+i))),s.next=r}return"number"==typeof n.goBack&&(s.goBack=n.goBack),"string"==typeof n.switchTo&&(s.switchTo=n.switchTo),"string"==typeof n.log&&(s.log=n.log),"string"==typeof n.nextEmbedded&&(s.nextEmbedded=n.nextEmbedded,t.usesEmbedded=!0),s}if(Array.isArray(n)){var o,a=[]
for(o in n)n.hasOwnProperty(o)&&(a[o]=e(t,i,n[o]))
return{group:a}}if(n.cases){var l,h=[]
for(l in n.cases)if(n.cases.hasOwnProperty(l)){var d=e(t,i,n.cases[l])
"@default"===l||"@"===l||""===l?h.push({test:null,value:d,name:l}):"@eos"===l?h.push({test:function(e,t,i,n){return n},value:d,name:l}):h.push(eT(t,i,l,d))}var u=t.defaultToken
return{test:function(e,t,i,n){var s
for(s in h)if(h.hasOwnProperty(s)&&(!h[s].test||h[s].test(e,t,i,n)))return h[s].value
return u}}}return jD(t,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+i),""}return{token:""}}(e,this.name,t)}}class iT{constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}static create(e,t){return this._INSTANCE.create(e,t)}create(e,t){if(null!==e&&e.depth>=this._maxCacheDepth)return new nT(e,t)
let i=nT.getStackElementId(e)
i.length>0&&(i+="|"),i+=t
let n=this._entries[i]
return n||(n=new nT(e,t),this._entries[i]=n,n)}}iT._INSTANCE=new iT(5)
class nT{constructor(e,t){this.parent=e,this.state=t,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(e){let t=""
for(;null!==e;)t.length>0&&(t+="|"),t+=e.state,e=e.parent
return t}static _equals(e,t){for(;null!==e&&null!==t;){if(e===t)return!0
if(e.state!==t.state)return!1
e=e.parent,t=t.parent}return null===e&&null===t}equals(e){return nT._equals(this,e)}push(e){return iT.create(this,e)}pop(){return this.parent}popall(){let e=this
for(;e.parent;)e=e.parent
return e}switchTo(e){return iT.create(this.parent,e)}}class sT{constructor(e,t){this.modeId=e,this.state=t}equals(e){return this.modeId===e.modeId&&this.state.equals(e.state)}clone(){return this.state.clone()===this.state?this:new sT(this.modeId,this.state)}}class rT{constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}static create(e,t){return this._INSTANCE.create(e,t)}create(e,t){if(null!==t)return new oT(e,t)
if(null!==e&&e.depth>=this._maxCacheDepth)return new oT(e,t)
let i=nT.getStackElementId(e),n=this._entries[i]
return n||(n=new oT(e,null),this._entries[i]=n,n)}}rT._INSTANCE=new rT(5)
class oT{constructor(e,t){this.stack=e,this.embeddedModeData=t}clone(){return(this.embeddedModeData?this.embeddedModeData.clone():null)===this.embeddedModeData?this:rT.create(this.stack,this.embeddedModeData)}equals(e){return e instanceof oT&&(!!this.stack.equals(e.stack)&&(null===this.embeddedModeData&&null===e.embeddedModeData||null!==this.embeddedModeData&&null!==e.embeddedModeData&&this.embeddedModeData.equals(e.embeddedModeData)))}}const aT=Object.hasOwnProperty
class lT{constructor(){this._tokens=[],this._language=null,this._lastTokenType=null,this._lastTokenLanguage=null}enterMode(e,t){this._language=t}emit(e,t){this._lastTokenType===t&&this._lastTokenLanguage===this._language||(this._lastTokenType=t,this._lastTokenLanguage=this._language,this._tokens.push(new gh(e,t,this._language)))}nestedModeTokenize(e,t,i){const n=t.modeId,s=t.state,r=js.get(n)
if(!r)return this.enterMode(i,n),this.emit(i,""),s
let o=r.tokenize(e,s,i)
return this._tokens=this._tokens.concat(o.tokens),this._lastTokenType=null,this._lastTokenLanguage=null,this._language=null,o.endState}finalize(e){return new mh(this._tokens,e)}}class hT{constructor(e,t){this._modeService=e,this._theme=t,this._prependTokens=null,this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0}enterMode(e,t){this._currentLanguageId=this._modeService.getLanguageIdentifier(t).id}emit(e,t){let i=this._theme.match(this._currentLanguageId,t)
this._lastTokenMetadata!==i&&(this._lastTokenMetadata=i,this._tokens.push(e),this._tokens.push(i))}static _merge(e,t,i){let n=null!==e?e.length:0,s=t.length,r=null!==i?i.length:0
if(0===n&&0===s&&0===r)return new Uint32Array(0)
if(0===n&&0===s)return i
if(0===s&&0===r)return e
let o=new Uint32Array(n+s+r)
null!==e&&o.set(e)
for(let e=0;e<s;e++)o[n+e]=t[e]
return null!==i&&o.set(i,n+s),o}nestedModeTokenize(e,t,i){const n=t.modeId,s=t.state,r=js.get(n)
if(!r)return this.enterMode(i,n),this.emit(i,""),s
let o=r.tokenize2(e,s,i)
return this._prependTokens=hT._merge(this._prependTokens,this._tokens,o.tokens),this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0,o.endState}finalize(e){return new ph(hT._merge(this._prependTokens,this._tokens,null),e)}}class dT{constructor(e,t,i,n){this._modeService=e,this._standaloneThemeService=t,this._modeId=i,this._lexer=n,this._embeddedModes=Object.create(null)
let s=!1
this._tokenizationRegistryListener=js.onDidChange(e=>{if(s)return
let t=!1
for(let i=0,n=e.changedLanguages.length;i<n;i++){let n=e.changedLanguages[i]
if(this._embeddedModes[n]){t=!0
break}}t&&(s=!0,js.fire([this._modeId]),s=!1)})}dispose(){this._tokenizationRegistryListener.dispose()}getInitialState(){let e=iT.create(null,this._lexer.start)
return rT.create(e,null)}tokenize(e,t,i){let n=new lT,s=this._tokenize(e,t,i,n)
return n.finalize(s)}tokenize2(e,t,i){let n=new hT(this._modeService,this._standaloneThemeService.getTheme().tokenTheme),s=this._tokenize(e,t,i,n)
return n.finalize(s)}_tokenize(e,t,i,n){return t.embeddedModeData?this._nestedTokenize(e,t,i,n):this._myTokenize(e,t,i,n)}_findLeavingNestedModeOffset(e,t){let i=this._lexer.tokenizer[t.stack.state]
i||(i=ZD(this._lexer,t.stack.state))||jD(this._lexer,"tokenizer state is not defined: "+t.stack.state)
let n=-1,s=!1
for(let t in i){if(!aT.call(i,t))continue
let r=i[t]
if(KD(r.action)&&"@pop"!==r.action.nextEmbedded)continue
s=!0
let o=r.regex,a=r.regex.source
"^(?:"===a.substr(0,4)&&")"===a.substr(a.length-1,1)&&(o=new RegExp(a.substr(4,a.length-5),o.ignoreCase?"i":""))
let l=e.search(o);-1!==l&&((-1===n||l<n)&&(n=l))}return s||jD(this._lexer,'no rule containing nextEmbedded: "@pop" in tokenizer embedded state: '+t.stack.state),n}_nestedTokenize(e,t,i,n){let s=this._findLeavingNestedModeOffset(e,t)
if(-1===s){let s=n.nestedModeTokenize(e,t.embeddedModeData,i)
return rT.create(t.stack,new sT(t.embeddedModeData.modeId,s))}let r=e.substring(0,s)
r.length>0&&n.nestedModeTokenize(r,t.embeddedModeData,i)
let o=e.substring(s)
return this._myTokenize(o,t,i+s,n)}_myTokenize(e,t,i,n){n.enterMode(i,this._modeId)
const s=e.length
let r=t.embeddedModeData,o=t.stack,a=0,l=null,h=null,d=null,u=null
for(;a<s;){const t=a,m=o.depth,p=l?l.length:0,f=o.state
let _=null,C=null,b=null,w=null,v=null
if(l)_=h,C=d.shift(),b=l.shift(),w=u,0===l.length&&(l=null,h=null,d=null,u=null)
else{if(a>=s)break
let t=this._lexer.tokenizer[f]
t||(t=ZD(this._lexer,f))||jD(this._lexer,"tokenizer state is not defined: "+f)
let i=e.substr(a)
for(let e in t)if(aT.call(t,e)){let n=t[e]
if((0===a||!n.matchOnlyAtLineStart)&&(_=i.match(n.regex))){C=_[0],b=n.action
break}}}for(_||(_=[""],C=""),b||(a<s&&(C=(_=[e.charAt(a)])[0]),b=this._lexer.defaultToken),a+=C.length;zD(b)&&KD(b)&&b.test;)b=b.test(C,_,f,a===s)
let S=null
if("string"==typeof b||Array.isArray(b))S=b
else if(b.group)S=b.group
else if(null!==b.token&&void 0!==b.token){if(S=b.tokenSubst?YD(this._lexer,b.token,C,_,f):b.token,b.nextEmbedded&&("@pop"===b.nextEmbedded?(r||jD(this._lexer,"cannot pop embedded mode if not inside one"),r=null):r?jD(this._lexer,"cannot enter embedded mode from within an embedded mode"):v=YD(this._lexer,b.nextEmbedded,C,_,f)),b.goBack&&(a=Math.max(0,a-b.goBack)),b.switchTo&&"string"==typeof b.switchTo){let e=YD(this._lexer,b.switchTo,C,_,f)
"@"===e[0]&&(e=e.substr(1)),ZD(this._lexer,e)?o=o.switchTo(e):jD(this._lexer,"trying to switch to a state '"+e+"' that is undefined in rule: "+w.name)}else if(b.transform&&"function"==typeof b.transform)jD(this._lexer,"action.transform not supported")
else if(b.next)if("@push"===b.next)o.depth>=this._lexer.maxStack?jD(this._lexer,"maximum tokenizer stack size reached: ["+o.state+","+o.parent.state+",...]"):o=o.push(f)
else if("@pop"===b.next)o.depth<=1?jD(this._lexer,"trying to pop an empty stack in rule: "+w.name):o=o.pop()
else if("@popall"===b.next)o=o.popall()
else{let e=YD(this._lexer,b.next,C,_,f)
"@"===e[0]&&(e=e.substr(1)),ZD(this._lexer,e)?o=o.push(e):jD(this._lexer,"trying to set a next state '"+e+"' that is undefined in rule: "+w.name)}b.log&&"string"==typeof b.log&&(c=this._lexer,g=this._lexer.languageId+": "+YD(this._lexer,b.log,C,_,f),console.log(`${c.languageId}: ${g}`))}if(null===S&&jD(this._lexer,"lexer rule has no well-defined action in rule: "+w.name),Array.isArray(S)){l&&l.length>0&&jD(this._lexer,"groups cannot be nested: "+w.name),_.length!==S.length+1&&jD(this._lexer,"matched number of groups does not match the number of actions in rule: "+w.name)
let e=0
for(let t=1;t<_.length;t++)e+=_[t].length
e!==C.length&&jD(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+w.name),h=_,d=_.slice(1),l=S.slice(0),u=w,a-=C.length}else{{if("@rematch"===S&&(a-=C.length,C="",_=null,S=""),0===C.length){if(m!==o.depth||f!==o.state||(l?l.length:0)!==p)continue
jD(this._lexer,"no progress in tokenizer in rule: "+w.name),a=s}let e=null
if(UD(S)&&0===S.indexOf("@brackets")){let t=S.substr("@brackets".length),i=uT(this._lexer,C)
i||(jD(this._lexer,"@brackets token returned but no bracket defined as: "+C),i={token:"",bracketType:0}),e=GD(i.token+t)}else{e=GD(""===S?"":S+this._lexer.tokenPostfix)}n.emit(t+i,e)}if(null!==v){let t=this._modeService.getModeIdForLanguageName(v)
t&&(v=t)
let r=this._getNestedEmbeddedModeData(v)
if(a<s){let t=e.substr(a)
return this._nestedTokenize(t,rT.create(o,r),i+a,n)}return rT.create(o,r)}}}var c,g
return rT.create(o,r)}_getNestedEmbeddedModeData(e){let t=this._locateMode(e)
if(t){let e=js.get(t.getId())
if(e)return new sT(t.getId(),e.getInitialState())}let i=t?t.getId():_h
return new sT(i,fh)}_locateMode(e){if(!e||!this._modeService.isRegisteredMode(e))return null
let t=this._modeService.getModeId(e)
this._modeService.getOrCreateMode(t)
let i=this._modeService.getMode(t)
return i?(this._embeddedModes[t]=!0,i):(this._embeddedModes[t]=!0,null)}}function uT(e,t){if(!t)return null
t=qD(e,t)
for(var i=e.brackets,n=0;n<i.length;n++){var s=i[n]
if(s.open===t)return{token:s.token,bracketType:1}
if(s.close===t)return{token:s.token,bracketType:-1}}return null}function cT(e){wM.registerLanguage(e)}function gT(){let e=[]
return e=e.concat(wM.getLanguages())}function mT(e,t){let i=rD.modeService.get().onDidCreateMode(n=>{n.getId()===e&&(i.dispose(),t())})
return i}function pT(e,t){let i=rD.modeService.get().getLanguageIdentifier(e)
if(!i)throw new Error(`Cannot set configuration for unknown language ${e}`)
return cr.register(i,t)}class fT{constructor(e,t,i){this._standaloneThemeService=e,this._languageIdentifier=t,this._actual=i}getInitialState(){return this._actual.getInitialState()}_toClassicTokens(e,t,i){let n=[],s=0
for(let r=0,o=e.length;r<o;r++){const o=e[r]
let a=o.startIndex
0===r?a=0:a<s&&(a=s),n[r]=new gh(a+i,o.scopes,t),s=a}return n}tokenize(e,t,i){let n,s=this._actual.tokenize(e,t),r=this._toClassicTokens(s.tokens,this._languageIdentifier.language,i)
return n=s.endState.equals(t)?t:s.endState,new mh(r,n)}_toBinaryTokens(e,t){const i=this._languageIdentifier.id,n=this._standaloneThemeService.getTheme().tokenTheme
let s=[],r=0,o=0
for(let a=0,l=e.length;a<l;a++){const l=e[a],h=n.match(i,l.scopes)
if(r>0&&s[r-1]===h)continue
let d=l.startIndex
0===a?d=0:d<o&&(d=o),s[r++]=d+t,s[r++]=h,o=d}let a=new Uint32Array(r)
for(let e=0;e<r;e++)a[e]=s[e]
return a}tokenize2(e,t,i){let n,s=this._actual.tokenize(e,t),r=this._toBinaryTokens(s.tokens,i)
return n=s.endState.equals(t)?t:s.endState,new ph(r,n)}}function _T(e,t){let i=rD.modeService.get().getLanguageIdentifier(e)
if(!i)throw new Error(`Cannot set tokens provider for unknown language ${e}`)
let n=new fT(rD.standaloneThemeService.get(),i,t)
return js.register(e,n)}function CT(e,t){let i=function(e,t){if(!t||"object"!=typeof t)throw new Error("Monarch: expecting a language definition object")
var i={}
i.languageId=e,i.noThrow=!1,i.maxStack=100,i.start=JD(t.start),i.ignoreCase=XD(t.ignoreCase,!1),i.tokenPostfix=JD(t.tokenPostfix,"."+i.languageId),i.defaultToken=JD(t.defaultToken,"source",function(){jD(i,"the 'defaultToken' must be a string")}),i.usesEmbedded=!1
var n,s=t
function r(e,n,o){var a
for(a in o)if(o.hasOwnProperty(a)){var l=o[a],h=l.include
if(h)"string"!=typeof h&&jD(i,"an 'include' attribute must be a string at: "+e),"@"===h[0]&&(h=h.substr(1)),t.tokenizer[h]||jD(i,"include target '"+h+"' is not defined at: "+e),r(e+"."+h,n,t.tokenizer[h])
else{var d=new tT(e)
if(Array.isArray(l)&&l.length>=1&&l.length<=3)if(d.setRegex(s,l[0]),l.length>=3)if("string"==typeof l[1])d.setAction(s,{token:l[1],next:l[2]})
else if("object"==typeof l[1]){var u=l[1]
u.next=l[2],d.setAction(s,u)}else jD(i,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+e)
else d.setAction(s,l[1])
else l.regex||jD(i,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+e),l.name&&(d.name=JD(l.name)),l.matchOnlyAtStart&&(d.matchOnlyAtLineStart=XD(l.matchOnlyAtLineStart)),d.setRegex(s,l.regex),d.setAction(s,l.action)
n.push(d)}}}s.languageId=e,s.ignoreCase=i.ignoreCase,s.noThrow=i.noThrow,s.usesEmbedded=i.usesEmbedded,s.stateNames=t.tokenizer,s.defaultToken=i.defaultToken,t.tokenizer&&"object"==typeof t.tokenizer||jD(i,"a language definition must define the 'tokenizer' attribute as an object"),i.tokenizer=[]
for(n in t.tokenizer)if(t.tokenizer.hasOwnProperty(n)){i.start||(i.start=n)
var o=t.tokenizer[n]
i.tokenizer[n]=new Array,r("tokenizer."+n,i.tokenizer[n],o)}i.usesEmbedded=s.usesEmbedded,t.brackets?Array.isArray(t.brackets)||jD(i,"the 'brackets' attribute must be defined as an array"):t.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}]
var a=[]
for(var l in t.brackets)if(t.brackets.hasOwnProperty(l)){var h=t.brackets[l]
h&&Array.isArray(h)&&3===h.length&&(h={token:h[2],open:h[0],close:h[1]}),h.open===h.close&&jD(i,"open and close brackets in a 'brackets' attribute must be different: "+h.open+"\n hint: use the 'bracket' attribute if matching on equal brackets is required."),"string"==typeof h.open&&"string"==typeof h.token?a.push({token:JD(h.token)+i.tokenPostfix,open:qD(i,JD(h.open)),close:qD(i,JD(h.close))}):jD(i,"every element in the 'brackets' array must be a '{open,close,token}' object or array")}return i.brackets=a,i.noThrow=!0,i}(e,t),n=(s=rD.modeService.get(),r=rD.standaloneThemeService.get(),new dT(s,r,e,i))
var s,r
return js.register(e,n)}function bT(e,t){return Ds.register(e,t)}function wT(e,t){return Ts.register(e,t)}function vT(e,t){return Rs.register(e,t)}function ST(e,i){return As.register(e,{provideHover:(e,n,s)=>{let r=e.getWordAtPosition(n)
return ua(i.provideHover(e,n,s)).then(e=>{if(e)return!e.range&&r&&(e.range=new t(n.lineNumber,r.startColumn,n.lineNumber,r.endColumn)),e.range||(e.range=new t(n.lineNumber,n.column,n.lineNumber,n.column)),e})}})}function yT(e,t){return Ps.register(e,t)}function xT(e,t){return Fs.register(e,t)}function LT(e,t){return Ws.register(e,t)}function NT(e,t){return Vs.register(e,t)}function ET(e,t){return Bs.register(e,t)}function kT(e,t){return Hs.register(e,t)}function IT(e,i){return zs.register(e,{provideCodeActions:(e,n,s)=>{let r=rD.markerService.get().read({resource:e.uri}).filter(e=>t.areIntersectingOrTouching(e,n))
return i.provideCodeActions(e,n,{markers:r},s)}})}function MT(e,t){return Us.register(e,t)}function DT(e,t){return Ks.register(e,t)}function TT(e,t){return $s.register(e,t)}function OT(e,t){return qs.register(e,t)}function RT(e,t){let i=new WT(t)
return Os.register(e,{triggerCharacters:t.triggerCharacters,provideCompletionItems:(e,t,n,s)=>i.provideCompletionItems(e,t,n,s),resolveCompletionItem:(e,t,n,s)=>i.resolveCompletionItem(e,t,n,s)})}function AT(e,t){return Gs.register(e,t)}var PT,FT;(FT=PT||(PT={}))[FT.Text=0]="Text",FT[FT.Method=1]="Method",FT[FT.Function=2]="Function",FT[FT.Constructor=3]="Constructor",FT[FT.Field=4]="Field",FT[FT.Variable=5]="Variable",FT[FT.Class=6]="Class",FT[FT.Interface=7]="Interface",FT[FT.Module=8]="Module",FT[FT.Property=9]="Property",FT[FT.Unit=10]="Unit",FT[FT.Value=11]="Value",FT[FT.Enum=12]="Enum",FT[FT.Keyword=13]="Keyword",FT[FT.Snippet=14]="Snippet",FT[FT.Color=15]="Color",FT[FT.File=16]="File",FT[FT.Reference=17]="Reference",FT[FT.Folder=18]="Folder"
class WT{constructor(e){this._provider=e}static from(e,t,i){let n={_actual:e,label:e.label,insertText:e.label,type:function(e){switch(e){case PT.Method:return"method"
case PT.Function:return"function"
case PT.Constructor:return"constructor"
case PT.Field:return"field"
case PT.Variable:return"variable"
case PT.Class:return"class"
case PT.Interface:return"interface"
case PT.Module:return"module"
case PT.Property:return"property"
case PT.Unit:return"unit"
case PT.Value:return"value"
case PT.Enum:return"enum"
case PT.Keyword:return"keyword"
case PT.Snippet:return"snippet"
case PT.Text:return"text"
case PT.Color:return"color"
case PT.File:return"file"
case PT.Reference:return"reference"
case PT.Folder:return"folder"}return"property"}(e.kind),detail:e.detail,documentation:e.documentation,command:e.command,sortText:e.sortText,filterText:e.filterText,snippetType:"internal"},s=e.textEdit?e.textEdit.range:e.range
if(s){if(!(s.startLineNumber===s.endLineNumber)||s.startLineNumber!==t.lineNumber)return console.warn("INVALID range, must be single line and on the same line"),null
n.overwriteBefore=t.column-s.startColumn,n.overwriteAfter=s.endColumn-t.column}else n.overwriteBefore=t.column-i.column,n.overwriteAfter=0
return e.textEdit?n.insertText=e.textEdit.text:"object"==typeof e.insertText&&"string"==typeof e.insertText.value?(n.insertText=e.insertText.value,n.snippetType="textmate"):"string"==typeof e.insertText&&(n.insertText=e.insertText),n}provideCompletionItems(t,i,n,s){return ua(this._provider.provideCompletionItems(t,i,s,n)).then(n=>{const s={suggestions:[]}
let r=i
const o=t.getWordUntilPosition(i)
let a
if(o&&(r=new e(r.lineNumber,o.startColumn)),Array.isArray(n))a={items:n,isIncomplete:!1}
else if("object"==typeof n&&Array.isArray(n.items))a=n,s.incomplete=a.isIncomplete
else{if(!n)return
console.warn("INVALID result from completion provider. expected CompletionItem-array or CompletionList but got:",n)}for(let e=0;e<a.items.length;e++){const t=a.items[e],n=WT.from(t,i,r)
n&&s.suggestions.push(n)}return s})}resolveCompletionItem(t,i,n,s){if("function"!=typeof this._provider.resolveCompletionItem)return bt.as(n)
let r=n._actual
return r?ua(this._provider.resolveCompletionItem(r,s)).then(n=>{let s=i
const r=t.getWordUntilPosition(i)
return r&&(s=new e(s.lineNumber,r.startColumn)),WT.from(n,i,s)}):bt.as(n)}}let VT={}
self.monaco=VT,qi.wrappingIndent=Ii.None,qi.contribInfo.folding=!1,qi.viewInfo.glyphMargin=!1,qi.autoIndent=!1
let BT=Zk()
for(let e in BT)BT.hasOwnProperty(e)&&(VT[e]=BT[e])
VT.editor={create:bD,onDidCreateEditor:wD,createDiffEditor:VD,createDiffNavigator:VD,createModel:SD,setModelLanguage:yD,setModelMarkers:xD,getModelMarkers:LD,getModels:ED,getModel:ND,onDidCreateModel:kD,onWillDisposeModel:ID,onDidChangeModelLanguage:MD,createWebWorker:DD,colorizeElement:TD,colorize:OD,colorizeModelLine:RD,tokenize:PD,defineTheme:FD,setTheme:WD,ScrollbarVisibility:hi,WrappingIndent:Ii,OverviewRulerLane:i,EndOfLinePreference:s,DefaultEndOfLine:o,EndOfLineSequence:l,TrackedRangeStickiness:d,CursorChangeReason:br,MouseTargetType:bm,TextEditorCursorStyle:Oi,TextEditorCursorBlinkingStyle:Di,ContentWidgetPositionPreference:pm,OverlayWidgetPositionPreference:_m,RenderMinimap:Ei,ScrollType:BD,InternalEditorOptions:Ai,BareFontInfo:Du,FontInfo:Tu,TextModelResolvedOptions:c,FindMatch:g,EditorType:m},VT.languages={register:cT,getLanguages:gT,onLanguage:mT,setLanguageConfiguration:pT,setTokensProvider:_T,setMonarchTokensProvider:CT,registerReferenceProvider:bT,registerRenameProvider:wT,registerCompletionItemProvider:RT,registerSignatureHelpProvider:vT,registerHoverProvider:ST,registerDocumentSymbolProvider:yT,registerDocumentHighlightProvider:xT,registerDefinitionProvider:LT,registerImplementationProvider:NT,registerTypeDefinitionProvider:ET,registerCodeLensProvider:kT,registerCodeActionProvider:IT,registerDocumentFormattingEditProvider:MT,registerDocumentRangeFormattingEditProvider:DT,registerOnTypeFormattingEditProvider:TT,registerLinkProvider:OT,registerColorProvider:AT,DocumentHighlightKind:Ns,CompletionItemKind:PT,SymbolKind:ks,IndentAction:Sn,SuggestTriggerKind:xs}
const HT=monaco.Promise,zT=(monaco.IDisposable,monaco.Uri,12e4)
class UT{constructor(e){this._defaults=e,this._worker=null,this._idleCheckInterval=setInterval(()=>this._checkIfIdle(),3e4),this._lastUsedTime=0,this._configChangeListener=this._defaults.onDidChange(()=>this._stopWorker())}_stopWorker(){this._worker&&(this._worker.dispose(),this._worker=null),this._client=null}dispose(){clearInterval(this._idleCheckInterval),this._configChangeListener.dispose(),this._stopWorker()}_checkIfIdle(){if(!this._worker)return
Date.now()-this._lastUsedTime>zT&&this._stopWorker()}_getClient(){return this._lastUsedTime=Date.now(),this._client||(this._worker=monaco.editor.createWebWorker({moduleId:"vs/language/html/htmlWorker",createData:{languageSettings:this._defaults.options,languageId:this._defaults.languageId},label:this._defaults.languageId}),this._client=this._worker.getProxy()),this._client}getLanguageServiceWorker(...e){let t
return function(e){let t,i,n=new HT((e,n)=>{t=e,i=n},()=>{})
return e.then(t,i),n}(this._getClient().then(e=>{t=e}).then(t=>this._worker.withSyncedResources(e)).then(e=>t))}}var KT,$T,qT,GT,jT,YT,ZT,XT,JT,QT,eO,tO,iO,nO,sO,rO,oO,aO,lO,hO,dO,uO,cO,gO,mO,pO,fO,_O,CO,bO,wO,vO,SO,yO,xO,LO,NO
!function(e){e.create=function(e,t){return{line:e,character:t}},e.is=function(e){let t=e
return NO.defined(t)&&NO.number(t.line)&&NO.number(t.character)}}(KT||(KT={})),function(e){e.create=function(e,t,i,n){if(NO.number(e)&&NO.number(t)&&NO.number(i)&&NO.number(n))return{start:KT.create(e,t),end:KT.create(i,n)}
if(KT.is(e)&&KT.is(t))return{start:e,end:t}
throw new Error(`Range#create called with invalid arguments[${e}, ${t}, ${i}, ${n}]`)},e.is=function(e){let t=e
return NO.defined(t)&&KT.is(t.start)&&KT.is(t.end)}}($T||($T={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){let t=e
return NO.defined(t)&&$T.is(t.range)&&(NO.string(t.uri)||NO.undefined(t.uri))}}(qT||(qT={})),(jT=GT||(GT={})).Error=1,jT.Warning=2,jT.Information=3,jT.Hint=4,function(e){e.create=function(e,t,i,n,s){let r={range:e,message:t}
return NO.defined(i)&&(r.severity=i),NO.defined(n)&&(r.code=n),NO.defined(s)&&(r.source=s),r},e.is=function(e){let t=e
return NO.defined(t)&&$T.is(t.range)&&NO.string(t.message)&&(NO.number(t.severity)||NO.undefined(t.severity))&&(NO.number(t.code)||NO.string(t.code)||NO.undefined(t.code))&&(NO.string(t.source)||NO.undefined(t.source))}}(YT||(YT={})),function(e){e.create=function(e,t,...i){let n={title:e,command:t}
return NO.defined(i)&&i.length>0&&(n.arguments=i),n},e.is=function(e){let t=e
return NO.defined(t)&&NO.string(t.title)&&NO.string(t.title)}}(ZT||(ZT={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}}}(XT||(XT={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){let t=e
return NO.defined(t)&&eO.is(t.textDocument)&&Array.isArray(t.edits)}}(JT||(JT={})),function(e){e.create=function(e){return{uri:e}},e.is=function(e){let t=e
return NO.defined(t)&&NO.string(t.uri)}}(QT||(QT={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){let t=e
return NO.defined(t)&&NO.string(t.uri)&&NO.number(t.version)}}(eO||(eO={})),function(e){e.create=function(e,t,i,n){return{uri:e,languageId:t,version:i,text:n}},e.is=function(e){let t=e
return NO.defined(t)&&NO.string(t.uri)&&NO.string(t.languageId)&&NO.number(t.version)&&NO.string(t.text)}}(tO||(tO={})),(nO=iO||(iO={})).PlainText="plaintext",nO.Markdown="markdown",(rO=sO||(sO={})).Text=1,rO.Method=2,rO.Function=3,rO.Constructor=4,rO.Field=5,rO.Variable=6,rO.Class=7,rO.Interface=8,rO.Module=9,rO.Property=10,rO.Unit=11,rO.Value=12,rO.Enum=13,rO.Keyword=14,rO.Snippet=15,rO.Color=16,rO.File=17,rO.Reference=18,rO.Folder=19,rO.EnumMember=20,rO.Constant=21,rO.Struct=22,rO.Event=23,rO.Operator=24,rO.TypeParameter=25,(aO=oO||(oO={})).PlainText=1,aO.Snippet=2,function(e){(lO||(lO={})).create=function(e){return{label:e}}}(),function(e){(hO||(hO={})).create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(),function(e){(dO||(dO={})).fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}}(),function(e){(uO||(uO={})).create=function(e,t){return t?{contents:e,range:t}:{contents:e}}}(),function(e){(cO||(cO={})).create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(),function(e){(gO||(gO={})).create=function(e,t,...i){let n={label:e}
return NO.defined(t)&&(n.documentation=t),NO.defined(i)?n.parameters=i:n.parameters=[],n}}(),(pO=mO||(mO={})).Text=1,pO.Read=2,pO.Write=3,function(e){(fO||(fO={})).create=function(e,t){let i={range:e}
return NO.number(t)&&(i.kind=t),i}}(),(CO=_O||(_O={})).File=1,CO.Module=2,CO.Namespace=3,CO.Package=4,CO.Class=5,CO.Method=6,CO.Property=7,CO.Field=8,CO.Constructor=9,CO.Enum=10,CO.Interface=11,CO.Function=12,CO.Variable=13,CO.Constant=14,CO.String=15,CO.Number=16,CO.Boolean=17,CO.Array=18,CO.Object=19,CO.Key=20,CO.Null=21,CO.EnumMember=22,CO.Struct=23,CO.Event=24,CO.Operator=25,CO.TypeParameter=26,function(e){(bO||(bO={})).create=function(e,t,i,n,s){let r={name:e,kind:t,location:{uri:n,range:i}}
return s&&(r.containerName=s),r}}(),function(e){e.create=function(e){return{diagnostics:e}},e.is=function(e){let t=e
return NO.defined(t)&&NO.typedArray(t.diagnostics,YT.is)}}(wO||(wO={})),function(e){e.create=function(e,t){let i={range:e}
return NO.defined(t)&&(i.data=t),i},e.is=function(e){let t=e
return NO.defined(t)&&$T.is(t.range)&&(NO.undefined(t.command)||ZT.is(t.command))}}(vO||(vO={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){let t=e
return NO.defined(t)&&NO.number(t.tabSize)&&NO.boolean(t.insertSpaces)}}(SO||(SO={}))
class EO{}!function(e){e.create=function(e,t){return{range:e,target:t}},e.is=function(e){let t=e
return NO.defined(t)&&$T.is(t.range)&&(NO.undefined(t.target)||NO.string(t.target))}}(EO||(EO={})),function(e){e.create=function(e,t,i,n){return new kO(e,t,i,n)},e.is=function(e){let t=e
return!!(NO.defined(t)&&NO.string(t.uri)&&(NO.undefined(t.languageId)||NO.string(t.languageId))&&NO.number(t.lineCount)&&NO.func(t.getText)&&NO.func(t.positionAt)&&NO.func(t.offsetAt))}}(yO||(yO={})),(LO=xO||(xO={})).Manual=1,LO.AfterDelay=2,LO.FocusOut=3
class kO{constructor(e,t,i,n){this._uri=e,this._languageId=t,this._version=i,this._content=n,this._lineOffsets=null}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let t=this.offsetAt(e.start),i=this.offsetAt(e.end)
return this._content.substring(t,i)}return this._content}update(e,t){this._content=e.text,this._version=t,this._lineOffsets=null}getLineOffsets(){if(null===this._lineOffsets){let e=[],t=this._content,i=!0
for(let n=0;n<t.length;n++){i&&(e.push(n),i=!1)
let s=t.charAt(n)
i="\r"===s||"\n"===s,"\r"===s&&n+1<t.length&&"\n"===t.charAt(n+1)&&n++}i&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0)
let t=this.getLineOffsets(),i=0,n=t.length
if(0===n)return KT.create(0,e)
for(;i<n;){let s=Math.floor((i+n)/2)
t[s]>e?n=s:i=s+1}let s=i-1
return KT.create(s,e-t[s])}offsetAt(e){let t=this.getLineOffsets()
if(e.line>=t.length)return this._content.length
if(e.line<0)return 0
let i=t[e.line],n=e.line+1<t.length?t[e.line+1]:this._content.length
return Math.max(Math.min(i+e.character,n),i)}get lineCount(){return this.getLineOffsets().length}}!function(e){const t=Object.prototype.toString
e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.func=function(e){return"[object Function]"===t.call(e)},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(NO||(NO={}))
monaco.Uri,monaco.Position
const IO=monaco.Range
monaco.Thenable,monaco.Promise,monaco.CancellationToken,monaco.IDisposable
class MO{constructor(e,t){this._languageId=e,this._worker=t,this._disposables=[],this._listener=Object.create(null)
const i=e=>{let t,i=e.getModeId()
i===this._languageId&&(this._listener[e.uri.toString()]=e.onDidChangeContent(()=>{clearTimeout(t),t=setTimeout(()=>this._doValidate(e.uri,i),500)}),this._doValidate(e.uri,i))},n=e=>{monaco.editor.setModelMarkers(e,this._languageId,[])
let t=e.uri.toString(),i=this._listener[t]
i&&(i.dispose(),delete this._listener[t])}
this._disposables.push(monaco.editor.onDidCreateModel(i)),this._disposables.push(monaco.editor.onWillDisposeModel(e=>{n(e)})),this._disposables.push(monaco.editor.onDidChangeModelLanguage(e=>{n(e.model),i(e.model)})),this._disposables.push({dispose:()=>{for(let e in this._listener)this._listener[e].dispose()}}),monaco.editor.getModels().forEach(i)}dispose(){this._disposables.forEach(e=>e&&e.dispose()),this._disposables=[]}_doValidate(e,t){this._worker(e).then(i=>i.doValidation(e.toString()).then(i=>{const n=i.map(e=>(function(e,t){let i="number"==typeof t.code?String(t.code):t.code
return{severity:function(e){switch(e){case GT.Error:return monaco.Severity.Error
case GT.Warning:return monaco.Severity.Warning
case GT.Information:case GT.Hint:default:return monaco.Severity.Info}}(t.severity),startLineNumber:t.range.start.line+1,startColumn:t.range.start.character+1,endLineNumber:t.range.end.line+1,endColumn:t.range.end.character+1,message:t.message,code:i,source:t.source}})(0,e))
monaco.editor.setModelMarkers(monaco.editor.getModel(e),t,n)})).then(void 0,e=>{console.error(e)})}}function DO(e){if(e)return{character:e.column-1,line:e.lineNumber-1}}function TO(e){if(e)return new IO(e.start.line+1,e.start.character+1,e.end.line+1,e.end.character+1)}function OO(e){if(e)return{range:TO(e.range),text:e.newText}}class RO{constructor(e){this._worker=e}get triggerCharacters(){return[".",":","<",'"',"=","/"]}provideCompletionItems(e,t,i){e.getWordUntilPosition(t)
const n=e.uri
return BO(i,this._worker(n).then(e=>e.doComplete(n.toString(),DO(t))).then(e=>{if(!e)return
let t=e.items.map(e=>{let t={label:e.label,insertText:e.insertText,sortText:e.sortText,filterText:e.filterText,documentation:e.documentation,detail:e.detail,kind:function(e){let t=monaco.languages.CompletionItemKind
switch(e){case sO.Text:return t.Text
case sO.Method:return t.Method
case sO.Function:return t.Function
case sO.Constructor:return t.Constructor
case sO.Field:return t.Field
case sO.Variable:return t.Variable
case sO.Class:return t.Class
case sO.Interface:return t.Interface
case sO.Module:return t.Module
case sO.Property:return t.Property
case sO.Unit:return t.Unit
case sO.Value:return t.Value
case sO.Enum:return t.Enum
case sO.Keyword:return t.Keyword
case sO.Snippet:return t.Snippet
case sO.Color:return t.Color
case sO.File:return t.File
case sO.Reference:return t.Reference}return t.Property}(e.kind)}
return e.textEdit&&(t.range=TO(e.textEdit.range),t.insertText=e.textEdit.newText),e.insertTextFormat===oO.Snippet&&(t.insertText={value:t.insertText}),t})
return{isIncomplete:e.isIncomplete,items:t}}))}}class AO{constructor(e){this._worker=e}provideDocumentHighlights(e,t,i){const n=e.uri
return BO(i,this._worker(n).then(e=>e.findDocumentHighlights(n.toString(),DO(t))).then(e=>{if(e)return e.map(e=>({range:TO(e.range),kind:function(e){let t=monaco.languages.DocumentHighlightKind
switch(e){case mO.Read:return t.Read
case mO.Write:return t.Write
case mO.Text:return t.Text}return t.Text}(e.kind)}))}))}}class PO{constructor(e){this._worker=e}provideLinks(e,t){const i=e.uri
return BO(t,this._worker(i).then(e=>e.findDocumentLinks(i.toString())).then(e=>{if(e)return e.map(e=>({range:TO(e.range),url:e.target}))}))}}function FO(e){return{tabSize:e.tabSize,insertSpaces:e.insertSpaces}}class WO{constructor(e){this._worker=e}provideDocumentFormattingEdits(e,t,i){const n=e.uri
return BO(i,this._worker(n).then(e=>e.format(n.toString(),null,FO(t)).then(e=>{if(e&&0!==e.length)return e.map(OO)})))}}class VO{constructor(e){this._worker=e}provideDocumentRangeFormattingEdits(e,t,i,n){const s=e.uri
return BO(n,this._worker(s).then(e=>e.format(s.toString(),function(e){if(e)return{start:DO(e.getStartPosition()),end:DO(e.getEndPosition())}}(t),FO(i)).then(e=>{if(e&&0!==e.length)return e.map(OO)})))}}function BO(e,t){return t.cancel&&e.onCancellationRequested(()=>t.cancel()),t}monaco.Promise,monaco.Uri,monaco.IDisposable
var HO=Object.freeze({setupMode:function(e){let t=[]
const i=new UT(e)
t.push(i)
const n=(...e)=>i.getLanguageServiceWorker(...e)
let s=e.languageId
t.push(monaco.languages.registerCompletionItemProvider(s,new RO(n))),t.push(monaco.languages.registerDocumentHighlightProvider(s,new AO(n))),t.push(monaco.languages.registerLinkProvider(s,new PO(n))),"html"===s&&(t.push(monaco.languages.registerDocumentFormattingEditProvider(s,new WO(n))),t.push(monaco.languages.registerDocumentRangeFormattingEditProvider(s,new VO(n))),t.push(new MO(s,n)))}})
const zO=monaco.Emitter
monaco.IEvent,monaco.IDisposable
class UO{constructor(e,t){this._onDidChange=new zO,this._languageId=e,this.setOptions(t)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get options(){return this._options}setOptions(e){this._options=e||Object.create(null),this._onDidChange.fire(this)}}const KO={tabSize:4,insertSpaces:!1,wrapLineLength:120,unformatted:'default": "a, abbr, acronym, b, bdo, big, br, button, cite, code, dfn, em, i, img, input, kbd, label, map, object, q, samp, select, small, span, strong, sub, sup, textarea, tt, var',contentUnformatted:"pre",indentInnerHtml:!1,preserveNewLines:!0,maxPreserveNewLines:null,indentHandlebars:!1,endWithNewline:!1,extraLiners:"head, body, /html",wrapAttributes:"auto"},$O={format:KO,suggest:{html5:!0}},qO={format:KO,suggest:{html5:!0,razor:!0}},GO="handlebars",jO=new UO("html",{format:KO,suggest:{html5:!0,angular1:!0,ionic:!0}}),YO=new UO(GO,$O),ZO=new UO("razor",qO)
function XO(e){e(HO)}monaco.languages.html={htmlDefaults:jO,razorDefaults:ZO,handlebarDefaults:YO},monaco.languages.onLanguage("html",()=>{XO(e=>e.setupMode(jO))}),monaco.languages.onLanguage(GO,()=>{XO(e=>e.setupMode(YO))}),monaco.languages.onLanguage("razor",()=>{XO(e=>e.setupMode(ZO))})
const JO=monaco.Promise,QO=(monaco.IDisposable,monaco.Uri,12e4)
class eR{constructor(e){this._defaults=e,this._worker=null,this._idleCheckInterval=setInterval(()=>this._checkIfIdle(),3e4),this._lastUsedTime=0,this._configChangeListener=this._defaults.onDidChange(()=>this._stopWorker())}_stopWorker(){this._worker&&(this._worker.dispose(),this._worker=null),this._client=null}dispose(){clearInterval(this._idleCheckInterval),this._configChangeListener.dispose(),this._stopWorker()}_checkIfIdle(){if(!this._worker)return
Date.now()-this._lastUsedTime>QO&&this._stopWorker()}_getClient(){return this._lastUsedTime=Date.now(),this._client||(this._worker=monaco.editor.createWebWorker({moduleId:"vs/language/css/cssWorker",label:this._defaults.languageId,createData:{languageSettings:this._defaults.diagnosticsOptions,languageId:this._defaults.languageId}}),this._client=this._worker.getProxy()),this._client}getLanguageServiceWorker(...e){let t
return function(e){let t,i,n=new JO((e,n)=>{t=e,i=n},()=>{})
return e.then(t,i),n}(this._getClient().then(e=>{t=e}).then(t=>this._worker.withSyncedResources(e)).then(e=>t))}}const tR=monaco.Uri,iR=(monaco.Position,monaco.Range)
monaco.Thenable,monaco.Promise,monaco.CancellationToken,monaco.IDisposable
class nR{constructor(e,t){this._languageId=e,this._worker=t,this._disposables=[],this._listener=Object.create(null)
const i=e=>{let t,i=e.getModeId()
i===this._languageId&&(this._listener[e.uri.toString()]=e.onDidChangeContent(()=>{clearTimeout(t),t=setTimeout(()=>this._doValidate(e.uri,i),500)}),this._doValidate(e.uri,i))},n=e=>{monaco.editor.setModelMarkers(e,this._languageId,[]),delete this._listener[e.uri.toString()]}
this._disposables.push(monaco.editor.onDidCreateModel(i)),this._disposables.push(monaco.editor.onWillDisposeModel(n)),this._disposables.push(monaco.editor.onDidChangeModelLanguage(e=>{n(e.model),i(e.model)})),this._disposables.push({dispose:()=>{for(let e in this._listener)this._listener[e].dispose()}}),monaco.editor.getModels().forEach(i)}dispose(){this._disposables.forEach(e=>e&&e.dispose()),this._disposables=[]}_doValidate(e,t){this._worker(e).then(t=>t.doValidation(e.toString())).then(i=>{const n=i.map(e=>(function(e,t){let i="number"==typeof t.code?String(t.code):t.code
return{severity:function(e){switch(e){case GT.Error:return monaco.Severity.Error
case GT.Warning:return monaco.Severity.Warning
case GT.Information:case GT.Hint:default:return monaco.Severity.Info}}(t.severity),startLineNumber:t.range.start.line+1,startColumn:t.range.start.character+1,endLineNumber:t.range.end.line+1,endColumn:t.range.end.character+1,message:t.message,code:i,source:t.source}})(0,e))
monaco.editor.setModelMarkers(monaco.editor.getModel(e),t,n)}).done(void 0,e=>{console.error(e)})}}function sR(e){if(e)return{character:e.column-1,line:e.lineNumber-1}}function rR(e){if(e)return new iR(e.start.line+1,e.start.character+1,e.end.line+1,e.end.character+1)}class oR{constructor(e){this._worker=e}get triggerCharacters(){return[" ",":"]}provideCompletionItems(e,t,i){e.getWordUntilPosition(t)
const n=e.uri
return mR(i,this._worker(n).then(e=>e.doComplete(n.toString(),sR(t))).then(e=>{if(!e)return
let t=e.items.map(e=>({label:e.label,insertText:e.insertText,sortText:e.sortText,filterText:e.filterText,documentation:e.documentation,detail:e.detail,kind:function(e){let t=monaco.languages.CompletionItemKind
switch(e){case sO.Text:return t.Text
case sO.Method:return t.Method
case sO.Function:return t.Function
case sO.Constructor:return t.Constructor
case sO.Field:return t.Field
case sO.Variable:return t.Variable
case sO.Class:return t.Class
case sO.Interface:return t.Interface
case sO.Module:return t.Module
case sO.Property:return t.Property
case sO.Unit:return t.Unit
case sO.Value:return t.Value
case sO.Enum:return t.Enum
case sO.Keyword:return t.Keyword
case sO.Snippet:return t.Snippet
case sO.Color:return t.Color
case sO.File:return t.File
case sO.Reference:return t.Reference}return t.Property}(e.kind),textEdit:function(e){if(e)return{range:rR(e.range),text:e.newText}}(e.textEdit)}))
return{isIncomplete:e.isIncomplete,items:t}}))}}class aR{constructor(e){this._worker=e}provideHover(e,t,i){let n=e.uri
return mR(i,this._worker(n).then(e=>e.doHover(n.toString(),sR(t))).then(e=>{if(e)return{range:rR(e.range),contents:function(e){if(e)return Array.isArray(e)?e:[e]}(e.contents)}}))}}class lR{constructor(e){this._worker=e}provideDocumentHighlights(e,t,i){const n=e.uri
return mR(i,this._worker(n).then(e=>e.findDocumentHighlights(n.toString(),sR(t))).then(e=>{if(e)return e.map(e=>({range:rR(e.range),kind:function(e){switch(e){case mO.Read:return monaco.languages.DocumentHighlightKind.Read
case mO.Write:return monaco.languages.DocumentHighlightKind.Write
case mO.Text:return monaco.languages.DocumentHighlightKind.Text}return monaco.languages.DocumentHighlightKind.Text}(e.kind)}))}))}}function hR(e){return{uri:tR.parse(e.uri),range:rR(e.range)}}class dR{constructor(e){this._worker=e}provideDefinition(e,t,i){const n=e.uri
return mR(i,this._worker(n).then(e=>e.findDefinition(n.toString(),sR(t))).then(e=>{if(e)return[hR(e)]}))}}class uR{constructor(e){this._worker=e}provideReferences(e,t,i,n){const s=e.uri
return mR(n,this._worker(s).then(e=>e.findReferences(s.toString(),sR(t))).then(e=>{if(e)return e.map(hR)}))}}class cR{constructor(e){this._worker=e}provideRenameEdits(e,t,i,n){const s=e.uri
return mR(n,this._worker(s).then(e=>e.doRename(s.toString(),sR(t),i)).then(e=>(function(e){if(!e||!e.changes)return
let t=[]
for(let i in e.changes){let n=e.changes[i]
for(let e of n)t.push({resource:tR.parse(i),range:rR(e.range),newText:e.newText})}return{edits:t}})(e)))}}class gR{constructor(e){this._worker=e}provideDocumentSymbols(e,t){const i=e.uri
return mR(t,this._worker(i).then(e=>e.findDocumentSymbols(i.toString())).then(e=>{if(e)return e.map(e=>({name:e.name,containerName:e.containerName,kind:function(e){let t=monaco.languages.SymbolKind
switch(e){case _O.File:return t.Array
case _O.Module:return t.Module
case _O.Namespace:return t.Namespace
case _O.Package:return t.Package
case _O.Class:return t.Class
case _O.Method:return t.Method
case _O.Property:return t.Property
case _O.Field:return t.Field
case _O.Constructor:return t.Constructor
case _O.Enum:return t.Enum
case _O.Interface:return t.Interface
case _O.Function:return t.Function
case _O.Variable:return t.Variable
case _O.Constant:return t.Constant
case _O.String:return t.String
case _O.Number:return t.Number
case _O.Boolean:return t.Boolean
case _O.Array:return t.Array}return t.Function}(e.kind),location:hR(e.location)}))}))}}function mR(e,t){return e.onCancellationRequested(()=>t.cancel()),t}monaco.Promise,monaco.Uri,monaco.IDisposable
var pR=Object.freeze({setupMode:function(e){let t=[]
const i=new eR(e)
t.push(i)
const n=(e,...t)=>i.getLanguageServiceWorker(...[e].concat(t))
let s=e.languageId
t.push(monaco.languages.registerCompletionItemProvider(s,new oR(n))),t.push(monaco.languages.registerHoverProvider(s,new aR(n))),t.push(monaco.languages.registerDocumentHighlightProvider(s,new lR(n))),t.push(monaco.languages.registerDefinitionProvider(s,new dR(n))),t.push(monaco.languages.registerReferenceProvider(s,new uR(n))),t.push(monaco.languages.registerDocumentSymbolProvider(s,new gR(n))),t.push(monaco.languages.registerRenameProvider(s,new cR(n))),t.push(new nR(s,n))}})
const fR=monaco.Emitter
monaco.IEvent,monaco.IDisposable
class _R{constructor(e,t){this._onDidChange=new fR,this._languageId=e,this.setDiagnosticsOptions(t)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get diagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(e){this._diagnosticsOptions=e||Object.create(null),this._onDidChange.fire(this)}}const CR={validate:!0,lint:{compatibleVendorPrefixes:"ignore",vendorPrefix:"warning",duplicateProperties:"warning",emptyRules:"warning",importStatement:"ignore",boxModel:"ignore",universalSelector:"ignore",zeroUnits:"ignore",fontFaceProperties:"warning",hexColorLength:"error",argumentsInColorFunction:"error",unknownProperties:"warning",ieHack:"ignore",unknownVendorSpecificProperties:"ignore",propertyIgnoredDueToDisplay:"warning",important:"ignore",float:"ignore",idSelector:"ignore"}},bR=new _R("css",CR),wR=new _R("scss",CR),vR=new _R("less",CR)
function SR(e){e(pR)}monaco.languages.css={cssDefaults:bR,lessDefaults:vR,scssDefaults:wR},monaco.languages.onLanguage("less",()=>{SR(e=>e.setupMode(vR))}),monaco.languages.onLanguage("scss",()=>{SR(e=>e.setupMode(wR))}),monaco.languages.onLanguage("css",()=>{SR(e=>e.setupMode(bR))})
const yR=monaco.Promise
monaco.IDisposable,monaco.Uri
class xR{constructor(e,t){this._modeId=e,this._defaults=t,this._worker=null,this._idleCheckInterval=setInterval(()=>this._checkIfIdle(),3e4),this._lastUsedTime=0,this._configChangeListener=this._defaults.onDidChange(()=>this._stopWorker())}_stopWorker(){this._worker&&(this._worker.dispose(),this._worker=null),this._client=null}dispose(){clearInterval(this._idleCheckInterval),this._configChangeListener.dispose(),this._stopWorker()}_checkIfIdle(){if(!this._worker)return
const e=this._defaults.getWorkerMaxIdleTime(),t=Date.now()-this._lastUsedTime
e>0&&t>e&&this._stopWorker()}_getClient(){if(this._lastUsedTime=Date.now(),!this._client){this._worker=monaco.editor.createWebWorker({moduleId:"vs/language/typescript/src/worker",label:this._modeId,createData:{compilerOptions:this._defaults.getCompilerOptions(),extraLibs:this._defaults.getExtraLibs()}})
let e=this._worker.getProxy()
this._defaults.getEagerModelSync()&&(e=e.then(e=>this._worker.withSyncedResources(monaco.editor.getModels().filter(e=>e.getModeId()===this._modeId).map(e=>e.uri)))),this._client=e}return this._client}getLanguageServiceWorker(...e){let t
return function(e){let t,i,n=new yR((e,n)=>{t=e,i=n},()=>{})
return e.then(t,i),n}(this._getClient().then(e=>{t=e}).then(t=>this._worker.withSyncedResources(e)).then(e=>t))}}function LR(e){return e?e.map(e=>e.text).join(""):""}function NR(e){return{value:e}}const ER=monaco.Uri,kR=(monaco.Position,monaco.Range,monaco.Thenable,monaco.Promise)
monaco.CancellationToken,monaco.IDisposable
class IR{constructor(e){this._worker=e}_positionToOffset(e,t){return monaco.editor.getModel(e).getOffsetAt(t)}_offsetToPosition(e,t){return monaco.editor.getModel(e).getPositionAt(t)}_textSpanToRange(e,t){let i=this._offsetToPosition(e,t.start),n=this._offsetToPosition(e,t.start+t.length),{lineNumber:s,column:r}=i,{lineNumber:o,column:a}=n
return{startLineNumber:s,startColumn:r,endLineNumber:o,endColumn:a}}}class MR extends IR{constructor(e,t,i){super(i),this._defaults=e,this._selector=t,this._disposables=[],this._listener=Object.create(null)
const n=e=>{if(e.getModeId()!==t)return
let i
const n=e.onDidChangeContent(()=>{clearTimeout(i),i=setTimeout(()=>this._doValidate(e.uri),500)})
this._listener[e.uri.toString()]={dispose(){n.dispose(),clearTimeout(i)}},this._doValidate(e.uri)},s=e=>{monaco.editor.setModelMarkers(e,this._selector,[])
const t=e.uri.toString()
this._listener[t]&&(this._listener[t].dispose(),delete this._listener[t])}
this._disposables.push(monaco.editor.onDidCreateModel(n)),this._disposables.push(monaco.editor.onWillDisposeModel(s)),this._disposables.push(monaco.editor.onDidChangeModelLanguage(e=>{s(e.model),n(e.model)})),this._disposables.push({dispose(){for(const e of monaco.editor.getModels())s(e)}}),this._disposables.push(this._defaults.onDidChange(()=>{for(const e of monaco.editor.getModels())s(e),n(e)})),monaco.editor.getModels().forEach(n)}dispose(){this._disposables.forEach(e=>e&&e.dispose()),this._disposables=[]}_doValidate(e){this._worker(e).then(t=>{if(!monaco.editor.getModel(e))return null
const i=[],{noSyntaxValidation:n,noSemanticValidation:s}=this._defaults.getDiagnosticsOptions()
return n||i.push(t.getSyntacticDiagnostics(e.toString())),s||i.push(t.getSemanticDiagnostics(e.toString())),kR.join(i)}).then(t=>{if(!t||!monaco.editor.getModel(e))return null
const i=t.reduce((e,t)=>t.concat(e),[]).map(t=>this._convertDiagnostics(e,t))
monaco.editor.setModelMarkers(monaco.editor.getModel(e),this._selector,i)}).done(void 0,e=>{console.error(e)})}_convertDiagnostics(e,t){const{lineNumber:i,column:n}=this._offsetToPosition(e,t.start),{lineNumber:s,column:r}=this._offsetToPosition(e,t.start+t.length)
return{severity:monaco.Severity.Error,startLineNumber:i,startColumn:n,endLineNumber:s,endColumn:r,message:function(e,t){if("string"==typeof e)return e
for(var i=e,n="",s=0;i;){if(s){n+=t
for(var r=0;r<s;r++)n+="  "}n+=i.messageText,s++,i=i.next}return n}(t.messageText,"\n")}}}class DR extends IR{get triggerCharacters(){return["."]}provideCompletionItems(e,t,i){e.getWordUntilPosition(t)
const n=e.uri,s=this._positionToOffset(n,t)
return UR(i,this._worker(n).then(e=>e.getCompletionsAtPosition(n.toString(),s)).then(e=>{if(!e)return
return e.entries.map(e=>({uri:n,position:t,label:e.name,sortText:e.sortText,kind:DR.convertKind(e.kind)}))}))}resolveCompletionItem(e,t){let i=e
const n=i.uri,s=i.position
return UR(t,this._worker(n).then(e=>e.getCompletionEntryDetails(n.toString(),this._positionToOffset(n,s),i.label)).then(e=>e?{uri:n,position:s,label:e.name,kind:DR.convertKind(e.kind),detail:LR(e.displayParts),documentation:LR(e.documentation)}:i))}static convertKind(e){switch(e){case WR.primitiveType:case WR.keyword:return monaco.languages.CompletionItemKind.Keyword
case WR.variable:case WR.localVariable:return monaco.languages.CompletionItemKind.Variable
case WR.memberVariable:case WR.memberGetAccessor:case WR.memberSetAccessor:return monaco.languages.CompletionItemKind.Field
case WR.function:case WR.memberFunction:case WR.constructSignature:case WR.callSignature:case WR.indexSignature:return monaco.languages.CompletionItemKind.Function
case WR.enum:return monaco.languages.CompletionItemKind.Enum
case WR.module:return monaco.languages.CompletionItemKind.Module
case WR.class:return monaco.languages.CompletionItemKind.Class
case WR.interface:return monaco.languages.CompletionItemKind.Interface
case WR.warning:return monaco.languages.CompletionItemKind.File}return monaco.languages.CompletionItemKind.Property}}class TR extends IR{constructor(){super(...arguments),this.signatureHelpTriggerCharacters=["(",","]}provideSignatureHelp(e,t,i){let n=e.uri
return UR(i,this._worker(n).then(e=>e.getSignatureHelpItems(n.toString(),this._positionToOffset(n,t))).then(e=>{if(!e)return
let t={activeSignature:e.selectedItemIndex,activeParameter:e.argumentIndex,signatures:[]}
return e.items.forEach(e=>{let i={label:"",documentation:null,parameters:[]}
i.label+=LR(e.prefixDisplayParts),e.parameters.forEach((t,n,s)=>{let r=LR(t.displayParts),o={label:r,documentation:LR(t.documentation)}
i.label+=r,i.parameters.push(o),n<s.length-1&&(i.label+=LR(e.separatorDisplayParts))}),i.label+=LR(e.suffixDisplayParts),t.signatures.push(i)}),t}))}}class OR extends IR{provideHover(e,t,i){let n=e.uri
return UR(i,this._worker(n).then(e=>e.getQuickInfoAtPosition(n.toString(),this._positionToOffset(n,t))).then(e=>{if(!e)return
let t=LR(e.documentation),i=e.tags?e.tags.map(e=>{const t=`*@${e.name}*`
return e.text?t+(e.text.match(/\r\n|\n/g)?" \n"+e.text:` - ${e.text}`):t}).join("  \n\n"):"",s=LR(e.displayParts)
return{range:this._textSpanToRange(n,e.textSpan),contents:[NR(s),NR(t+(i?"\n\n"+i:""))]}}))}}class RR extends IR{provideDocumentHighlights(e,t,i){const n=e.uri
return UR(i,this._worker(n).then(e=>e.getOccurrencesAtPosition(n.toString(),this._positionToOffset(n,t))).then(e=>{if(e)return e.map(e=>({range:this._textSpanToRange(n,e.textSpan),kind:e.isWriteAccess?monaco.languages.DocumentHighlightKind.Write:monaco.languages.DocumentHighlightKind.Text}))}))}}class AR extends IR{provideDefinition(e,t,i){const n=e.uri
return UR(i,this._worker(n).then(e=>e.getDefinitionAtPosition(n.toString(),this._positionToOffset(n,t))).then(e=>{if(!e)return
const t=[]
for(let i of e){const e=ER.parse(i.fileName)
monaco.editor.getModel(e)&&t.push({uri:e,range:this._textSpanToRange(e,i.textSpan)})}return t}))}}class PR extends IR{provideReferences(e,t,i,n){const s=e.uri
return UR(n,this._worker(s).then(e=>e.getReferencesAtPosition(s.toString(),this._positionToOffset(s,t))).then(e=>{if(!e)return
const t=[]
for(let i of e){const e=ER.parse(i.fileName)
monaco.editor.getModel(e)&&t.push({uri:e,range:this._textSpanToRange(e,i.textSpan)})}return t}))}}class FR extends IR{provideDocumentSymbols(e,t){const i=e.uri
return UR(t,this._worker(i).then(e=>e.getNavigationBarItems(i.toString())).then(e=>{if(!e)return
const t=(e,n,s)=>{let r={name:n.text,kind:VR[n.kind]||monaco.languages.SymbolKind.Variable,location:{uri:i,range:this._textSpanToRange(i,n.spans[0])},containerName:s}
if(n.childItems&&n.childItems.length>0)for(let i of n.childItems)t(e,i,r.name)
e.push(r)}
let n=[]
return e.forEach(e=>t(n,e)),n}))}}class WR{}WR.unknown="",WR.keyword="keyword",WR.script="script",WR.module="module",WR.class="class",WR.interface="interface",WR.type="type",WR.enum="enum",WR.variable="var",WR.localVariable="local var",WR.function="function",WR.localFunction="local function",WR.memberFunction="method",WR.memberGetAccessor="getter",WR.memberSetAccessor="setter",WR.memberVariable="property",WR.constructorImplementation="constructor",WR.callSignature="call",WR.indexSignature="index",WR.constructSignature="construct",WR.parameter="parameter",WR.typeParameter="type parameter",WR.primitiveType="primitive type",WR.label="label",WR.alias="alias",WR.const="const",WR.let="let",WR.warning="warning"
let VR=Object.create(null)
VR[WR.module]=monaco.languages.SymbolKind.Module,VR[WR.class]=monaco.languages.SymbolKind.Class,VR[WR.enum]=monaco.languages.SymbolKind.Enum,VR[WR.interface]=monaco.languages.SymbolKind.Interface,VR[WR.memberFunction]=monaco.languages.SymbolKind.Method,VR[WR.memberVariable]=monaco.languages.SymbolKind.Property,VR[WR.memberGetAccessor]=monaco.languages.SymbolKind.Property,VR[WR.memberSetAccessor]=monaco.languages.SymbolKind.Property,VR[WR.variable]=monaco.languages.SymbolKind.Variable,VR[WR.const]=monaco.languages.SymbolKind.Variable,VR[WR.localVariable]=monaco.languages.SymbolKind.Variable,VR[WR.variable]=monaco.languages.SymbolKind.Variable,VR[WR.function]=monaco.languages.SymbolKind.Function,VR[WR.localFunction]=monaco.languages.SymbolKind.Function
class BR extends IR{static _convertOptions(e){return{ConvertTabsToSpaces:e.insertSpaces,TabSize:e.tabSize,IndentSize:e.tabSize,IndentStyle:2,NewLineCharacter:"\n",InsertSpaceAfterCommaDelimiter:!0,InsertSpaceAfterSemicolonInForStatements:!0,InsertSpaceBeforeAndAfterBinaryOperators:!0,InsertSpaceAfterKeywordsInControlFlowStatements:!0,InsertSpaceAfterFunctionKeywordForAnonymousFunctions:!0,InsertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis:!1,InsertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets:!1,InsertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces:!1,PlaceOpenBraceOnNewLineForControlBlocks:!1,PlaceOpenBraceOnNewLineForFunctions:!1}}_convertTextChanges(e,t){return{text:t.newText,range:this._textSpanToRange(e,t.span)}}}class HR extends BR{provideDocumentRangeFormattingEdits(e,t,i,n){const s=e.uri
return UR(n,this._worker(s).then(e=>e.getFormattingEditsForRange(s.toString(),this._positionToOffset(s,{lineNumber:t.startLineNumber,column:t.startColumn}),this._positionToOffset(s,{lineNumber:t.endLineNumber,column:t.endColumn}),BR._convertOptions(i))).then(e=>{if(e)return e.map(e=>this._convertTextChanges(s,e))}))}}class zR extends BR{get autoFormatTriggerCharacters(){return[";","}","\n"]}provideOnTypeFormattingEdits(e,t,i,n,s){const r=e.uri
return UR(s,this._worker(r).then(e=>e.getFormattingEditsAfterKeystroke(r.toString(),this._positionToOffset(r,t),i,BR._convertOptions(n))).then(e=>{if(e)return e.map(e=>this._convertTextChanges(r,e))}))}}function UR(e,t){return e.onCancellationRequested(()=>t.cancel()),t}monaco.Promise,monaco.Uri,monaco.IDisposable,monaco.languages.IMonarchLanguage
let KR,$R
function qR(e,t,i){let n=[],s=window.MonacoEnvironment
var r=jR,o=GR
const a=new xR(t,e)
n.push(a)
const l=(e,...t)=>a.getLanguageServiceWorker(...[e].concat(t))
return n.push(monaco.languages.registerCompletionItemProvider(t,new DR(l))),n.push(monaco.languages.registerSignatureHelpProvider(t,new TR(l))),n.push(monaco.languages.registerHoverProvider(t,new OR(l))),n.push(monaco.languages.registerDocumentHighlightProvider(t,new RR(l))),n.push(monaco.languages.registerDefinitionProvider(t,new AR(l))),n.push(monaco.languages.registerReferenceProvider(t,new PR(l))),n.push(monaco.languages.registerDocumentSymbolProvider(t,new FR(l))),n.push(monaco.languages.registerDocumentRangeFormattingEditProvider(t,new HR(l))),n.push(monaco.languages.registerOnTypeFormattingEditProvider(t,new zR(l))),n.push(new MR(e,t,l)),s[t]&&(r=s[t].language||r,o=s[t].conf||o),n.push(monaco.languages.setLanguageConfiguration(t,o)),n.push(monaco.languages.setMonarchTokensProvider(t,r)),l}const GR={wordPattern:/(-?\d*\.\d\w*)|([^\`\~\!\@\#\%\^\&\*\(\)\-\=\+\[\{\]\}\\\|\;\:\'\"\,\.\<\>\/\?\s]+)/g,comments:{lineComment:"//",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],onEnterRules:[{beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/,afterText:/^\s*\*\/$/,action:{indentAction:monaco.languages.IndentAction.IndentOutdent,appendText:" * "}},{beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/,action:{indentAction:monaco.languages.IndentAction.None,appendText:" * "}},{beforeText:/^(\t|(\ \ ))*\ \*(\ ([^\*]|\*(?!\/))*)?$/,action:{indentAction:monaco.languages.IndentAction.None,appendText:"* "}},{beforeText:/^(\t|(\ \ ))*\ \*\/\s*$/,action:{indentAction:monaco.languages.IndentAction.None,removeText:1}}],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"',notIn:["string"]},{open:"'",close:"'",notIn:["string","comment"]},{open:"`",close:"`",notIn:["string","comment"]},{open:"/**",close:" */",notIn:["string"]}]},jR={tokenPostfix:".js",keywords:["boolean","break","byte","case","catch","char","class","const","continue","debugger","default","delete","do","double","else","enum","export","extends","false","final","finally","float","for","function","goto","if","implements","import","in","instanceof","int","interface","long","native","new","null","package","private","protected","public","return","short","static","super","switch","synchronized","this","throw","throws","transient","true","try","typeof","var","void","volatile","while","with"],builtins:["define","require","window","document","undefined"],operators:["=",">","<","!","~","?",":","==","<=",">=","!=","&&","||","++","--","+","-","*","/","&","|","^","%","<<",">>",">>>","+=","-=","*=","/=","&=","|=","^=","%=","<<=",">>=",">>>="],brackets:[{open:"(",close:")",token:"bracket.parenthesis"},{open:"{",close:"}",token:"bracket.curly"},{open:"[",close:"]",token:"bracket.square"}],symbols:/[~!@#%\^&*-+=|\\:`<>.?\/]+/,escapes:/\\(?:[btnfr\\"']|[0-7][0-7]?|[0-3][0-7]{2})/,exponent:/[eE][\-+]?[0-9]+/,regexpctl:/[(){}\[\]\$\^|\-*+?\.]/,regexpesc:/\\(?:[bBdDfnrstvwWn0\\\/]|@regexpctl|c[A-Z]|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4})/,tokenizer:{root:[[/([a-zA-Z_\$][\w\$]*)(\s*)(:?)/,{cases:{"$1@keywords":["keyword","white","delimiter"],$3:["key.identifier","white","delimiter"],"$1@builtins":["predefined.identifier","white","delimiter"],"@default":["identifier","white","delimiter"]}}],{include:"@whitespace"},[/\/(?=([^\\\/]|\\.)+\/)/,{token:"regexp.slash",bracket:"@open",next:"@regexp"}],[/(<)([:\w]+)/,["start.delimiter.tag",{token:"tag",next:"@tagContent"}]],[/(<\/)(\w+)/,["start.delimiter.tag",{token:"tag",next:"@tagContent"}]],[/[{}()\[\]]/,"@brackets"],[/[;,.]/,"delimiter"],[/@symbols/,{cases:{"@operators":"operator","@default":""}}],[/\d+\.\d*(@exponent)?/,"number.float"],[/\.\d+(@exponent)?/,"number.float"],[/\d+@exponent/,"number.float"],[/0[xX][\da-fA-F]+/,"number.hex"],[/0[0-7]+/,"number.octal"],[/\d+/,"number"],[/"([^"\\]|\\.)*$/,"string.invalid"],[/'([^'\\]|\\.)*$/,"string.invalid"],[/"/,"string",'@string."'],[/'/,"string","@string.'"]],tagContent:[[/\/?>/,"end.delimiter.tag","@pop"],[/"([^"]*)"/,"attribute.value"],[/'([^']*)'/,"attribute.value"],[/[\w\-]+/,"attribute.name"],[/=/,"delimiter"],[/[ \t\r\n]+/]],whitespace:[[/[ \t\r\n]+/,"white"],[/\/\*/,"comment","@comment"],[/\/\/.*$/,"comment"]],comment:[[/[^\/*]+/,"comment"],[/\/\*/,"comment.invalid"],["\\*/","comment","@pop"],[/[\/*]/,"comment"]],string:[[/[^\\"']+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/["']/,{cases:{"$#==$S2":{token:"string",next:"@pop"},"@default":"string"}}]],regexp:[[/(\{)(\d+(?:,\d*)?)(\})/,["@brackets.regexp.escape.control","regexp.escape.control","@brackets.regexp.escape.control"]],[/(\[)(\^?)(?=(?:[^\]\\\/]|\\.)+)/,["@brackets.regexp.escape.control",{token:"regexp.escape.control",next:"@regexrange"}]],[/(\()(\?:|\?=|\?!)/,["@brackets.regexp.escape.control","regexp.escape.control"]],[/[()]/,"@brackets.regexp.escape.control"],[/@regexpctl/,"regexp.escape.control"],[/[^\\\/]/,"regexp"],[/@regexpesc/,"regexp.escape"],[/\\\./,"regexp.invalid"],["/",{token:"regexp.slash",bracket:"@close"},"@pop"]],regexrange:[[/-/,"regexp.escape.control"],[/\^/,"regexp.invalid"],[/@regexpesc/,"regexp.escape"],[/[^\]]/,"regexp"],[/\]/,"@brackets.regexp.escape.control","@pop"]]}}
var YR=Object.freeze({setupTypeScript:function(e){$R=qR(e,"typescript")},setupJavaScript:function(e){KR=qR(e,"javascript")},getJavaScriptWorker:function(){return new monaco.Promise((e,t)=>{if(!KR)return t("JavaScript not registered!")
e(KR)})},getTypeScriptWorker:function(){return new monaco.Promise((e,t)=>{if(!$R)return t("TypeScript not registered!")
e($R)})}})
const ZR=monaco.Emitter
monaco.IEvent,monaco.IDisposable
class XR{constructor(e,t){this._onDidChange=new ZR,this._extraLibs=Object.create(null),this._workerMaxIdleTime=12e4,this.setCompilerOptions(e),this.setDiagnosticsOptions(t)}get onDidChange(){return this._onDidChange.event}getExtraLibs(){const e=Object.create(null)
for(var t in this._extraLibs)e[t]=this._extraLibs[t]
return Object.freeze(e)}addExtraLib(e,t){if(void 0===t&&(t=`ts:extralib-${Date.now()}`),this._extraLibs[t])throw new Error(`${t} already a extra lib`)
return this._extraLibs[t]=e,this._onDidChange.fire(this),{dispose:()=>{delete this._extraLibs[t]&&this._onDidChange.fire(this)}}}getCompilerOptions(){return this._compilerOptions}setCompilerOptions(e){this._compilerOptions=e||Object.create(null),this._onDidChange.fire(this)}getDiagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(e){this._diagnosticsOptions=e||Object.create(null),this._onDidChange.fire(this)}setMaximunWorkerIdleTime(e){this._workerMaxIdleTime=e}getWorkerMaxIdleTime(){return this._workerMaxIdleTime}setEagerModelSync(e){this._eagerModelSync=e}getEagerModelSync(){return this._eagerModelSync}}var JR,QR,eA,tA,iA,nA,sA,rA,oA,aA,lA,hA,dA,uA;(QR=JR||(JR={}))[QR.None=0]="None",QR[QR.CommonJS=1]="CommonJS",QR[QR.AMD=2]="AMD",QR[QR.UMD=3]="UMD",QR[QR.System=4]="System",QR[QR.ES2015=5]="ES2015",(tA=eA||(eA={}))[tA.None=0]="None",tA[tA.Preserve=1]="Preserve",tA[tA.React=2]="React",(nA=iA||(iA={}))[nA.CarriageReturnLineFeed=0]="CarriageReturnLineFeed",nA[nA.LineFeed=1]="LineFeed",(rA=sA||(sA={}))[rA.Unknown=0]="Unknown",rA[rA.JS=1]="JS",rA[rA.JSX=2]="JSX",rA[rA.TS=3]="TS",rA[rA.TSX=4]="TSX",(aA=oA||(oA={}))[aA.ES3=0]="ES3",aA[aA.ES5=1]="ES5",aA[aA.ES2015=2]="ES2015",aA[aA.ES2016=3]="ES2016",aA[aA.ES2017=4]="ES2017",aA[aA.ESNext=5]="ESNext",aA[aA.Latest=5]="Latest",(hA=lA||(lA={}))[hA.Standard=0]="Standard",hA[hA.JSX=1]="JSX",(uA=dA||(dA={}))[uA.Classic=1]="Classic",uA[uA.NodeJs=2]="NodeJs"
const cA=new XR({allowNonTsExtensions:!0,target:oA.Latest},{noSemanticValidation:!1,noSyntaxValidation:!1}),gA=new XR({allowNonTsExtensions:!0,allowJs:!0,target:oA.Latest},{noSemanticValidation:!0,noSyntaxValidation:!1})
function mA(){return new monaco.Promise((e,t)=>{fA(i=>{i.getTypeScriptWorker().then(e,t)})})}function pA(){return new monaco.Promise((e,t)=>{fA(i=>{i.getJavaScriptWorker().then(e,t)})})}function fA(e){e(YR)}if(monaco.languages.typescript={ModuleKind:JR,JsxEmit:eA,NewLineKind:iA,ScriptTarget:oA,ModuleResolutionKind:dA,typescriptDefaults:cA,javascriptDefaults:gA,getTypeScriptWorker:mA,getJavaScriptWorker:pA},monaco.languages.register({id:"typescript",extensions:[".ts",".tsx"],aliases:["TypeScript","ts","typescript"],mimetypes:["text/typescript"]}),monaco.languages.onLanguage("typescript",()=>{fA(e=>e.setupTypeScript(cA))}),monaco.languages.register({id:"javascript",extensions:[".js",".es6",".jsx"],firstLine:"^#!.*\\bnode",filenames:["jakefile"],aliases:["JavaScript","javascript","js"],mimetypes:["text/javascript"]}),monaco.languages.onLanguage("javascript",()=>{fA(e=>e.setupJavaScript(gA))}),window.MonacoEnvironment){var _A=window.MonacoEnvironment.didLoad
_A&&_A(window.monaco)}}()
